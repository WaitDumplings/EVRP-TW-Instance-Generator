nohup: ignoring input
---------------- Training Info ---------------------
exp_name DRL_train
seed 1234
cuda_id 1
torch_deterministic True
cuda True
track False
wandb_project_name cleanRL
wandb_entity None
capture_video False
problem evrptw
env_id evrptw-v0
env_entry_point evrptw_gen.benchmarks.DRL_Solver.envs.evrp_vector_env:EVRPTWVectorEnv
total_timesteps 500000000
learning_rate 3e-05
critic_lr 3e-05
weight_decay 1e-05
num_envs 512
num_steps 60
anneal_lr True
gamma 0.99
gae_lambda 0.95
num_minibatches 8
update_epochs 3
tanh_clipping 10.0
n_encode_layers 3
norm_adv True
clip_coef 0.2
clip_vloss True
ent_coef 0.001
vf_coef 0.5
max_grad_norm_backbone 2.0
max_grad_norm_critic 10.0
target_kl 0.01
n_traj 100
n_test None
test_sample_mode greedy
multi_greedy_inference True
test_agent 1
use_graph_token True
lambda_fail_init 10.0
target_success 0.95
lambda_lr 1.0
lambda_max 50.0
lambda_lr_up 1.0
lambda_lr_down 2.0
lambda_tolerance 0.05
env_mode train
accum_steps 1
save_dir ./checkpoint
eval_batch_size 1000
eval_data_path ./eval/Cus_15/pickle/evrptw_15C_5R.pkl
config_path ./evrptw_gen/configs/config.yaml
----------------------------------------------------
  0%|          | 0/5000 [00:00<?, ?it/s]/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:175: UserWarning: [33mWARN: Future gym versions will require that `Env.reset` can be passed a `seed` instead of using `Env.seed` for resetting the environment random number generator.[0m
  logger.warn(
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:188: UserWarning: [33mWARN: Future gym versions will require that `Env.reset` can be passed `options` to allow the environment initialisation to be passed additional information.[0m
  logger.warn(
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:196: UserWarning: [33mWARN: The result returned by `env.reset()` was not a tuple of the form `(obs, info)`, where `obs` is a observation and `info` is a dictionary containing additional information. Actual type: `<class 'dict'>`[0m
  logger.warn(
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:220: DeprecationWarning: [33mWARN: Core environment is written in old step API which returns one bool instead of two. It is recommended to rewrite the environment with new step API. [0m
  logger.deprecation(
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:226: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  if not isinstance(done, (bool, np.bool8)):
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:227: UserWarning: [33mWARN: Expects `done` signal to be a boolean, actual type: <class 'numpy.ndarray'>[0m
  logger.warn(
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:142: UserWarning: [33mWARN: The obs returned by the `step()` method was expecting numpy array dtype to be float32, actual type: float64[0m
  logger.warn(
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:166: UserWarning: [33mWARN: The obs returned by the `step()` method is not within the observation space.[0m
  logger.warn(f"{pre} is not within the observation space.")
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:253: UserWarning: [33mWARN: The reward returned by `step()` must be a float, int, np.integer or np.floating, actual type: <class 'numpy.ndarray'>[0m
  logger.warn(
------------------ Training Record ------------------
Epoch: 0/5000
Customer Numbers: 15 Charging Stations Numbers: 1
Avg Customer Visits: 15.00
Finish Rate: 51045/51200 = 0.997
Current lambda_fail (before): 10.000
Updated lambda_fail: 10.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.653, reward_valid_mean=-0.2326, reward_valid_std=1.5897
[BatchDiag] adv_mean=-1.2966, adv_std=4.9111, adv_abs_mean=4.3794 | ret_mean=-1.2966, ret_std=4.9111 | val_mean=-0.0000, val_std=0.0000 | explained_var=0.000002
[GradSplit pre-clip] backbone=4.280428, critic=0.079341
[Loss] pg_loss=0.026525, entropy_loss=0.000794, value_loss=0.510933
[EarlyStop] epoch=0 mean_kl=0.18597 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.18597 max_kl=0.41981
[Time] Env Create Time: 2.9522s |Rollout Collect Time: 9.4875s |Loss & Update :1.8189
[PPODiag] kl_mean=0.1860, kl_p90=0.3852, kl_max=0.4198 | clipfrac_mean=0.452, logratio_std_mean=0.626, ratio_p95_mean=1.695 | valid_ratio_mb_mean=0.653, p10=0.650, min=0.648 | pg_loss_mean=0.0732, v_loss_mean=1.9485, ent_mean=0.7747 | gn_bb_mean=4.945, gn_bb_max=9.983 | gn_v_mean=0.075, gn_v_max=0.082
[AttnScore] scale=0.9998, C=10.0

  0%|          | 1/5000 [00:14<19:48:01, 14.26s/it]------------------ Training Record ------------------
Epoch: 1/5000
Customer Numbers: 15 Charging Stations Numbers: 1
Avg Customer Visits: 15.00
Finish Rate: 51117/51200 = 0.998
Current lambda_fail (before): 10.000
Updated lambda_fail: 10.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.681, reward_valid_mean=-0.2436, reward_valid_std=1.5598
[BatchDiag] adv_mean=-1.5086, adv_std=4.9221, adv_abs_mean=4.4606 | ret_mean=-1.5098, ret_std=4.9222 | val_mean=-0.0013, val_std=0.0001 | explained_var=0.000021
[GradSplit pre-clip] backbone=2.521993, critic=0.086366
[Loss] pg_loss=0.023674, entropy_loss=0.000798, value_loss=0.520926
[EarlyStop] epoch=0 mean_kl=0.01038 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01038 max_kl=0.02824
[Time] Env Create Time: 2.7382s |Rollout Collect Time: 9.4693s |Loss & Update :1.6026
[PPODiag] kl_mean=0.0104, kl_p90=0.0221, kl_max=0.0282 | clipfrac_mean=0.094, logratio_std_mean=0.123, ratio_p95_mean=1.206 | valid_ratio_mb_mean=0.681, p10=0.678, min=0.676 | pg_loss_mean=0.0005, v_loss_mean=1.9886, ent_mean=0.8442 | gn_bb_mean=2.673, gn_bb_max=5.032 | gn_v_mean=0.084, gn_v_max=0.091

  0%|          | 2/5000 [00:28<19:25:48, 14.00s/it]------------------ Training Record ------------------
Epoch: 2/5000
Customer Numbers: 15 Charging Stations Numbers: 1
Avg Customer Visits: 15.00
Finish Rate: 51176/51200 = 1.000
Current lambda_fail (before): 10.000
Updated lambda_fail: 10.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.607, reward_valid_mean=-0.2102, reward_valid_std=1.6472
[BatchDiag] adv_mean=-0.8593, adv_std=4.7763, adv_abs_mean=4.1651 | ret_mean=-0.8625, ret_std=4.7764 | val_mean=-0.0032, val_std=0.0003 | explained_var=0.000049
[GradSplit pre-clip] backbone=1.984990, critic=0.067374
[Loss] pg_loss=0.019627, entropy_loss=0.000758, value_loss=0.481054
[EarlyStop] epoch=0 mean_kl=0.01194 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01194 max_kl=0.02436
[Time] Env Create Time: 2.7320s |Rollout Collect Time: 9.5158s |Loss & Update :1.5906
[PPODiag] kl_mean=0.0119, kl_p90=0.0225, kl_max=0.0244 | clipfrac_mean=0.121, logratio_std_mean=0.144, ratio_p95_mean=1.242 | valid_ratio_mb_mean=0.607, p10=0.604, min=0.602 | pg_loss_mean=0.0005, v_loss_mean=1.8417, ent_mean=0.7821 | gn_bb_mean=2.795, gn_bb_max=5.928 | gn_v_mean=0.065, gn_v_max=0.074

  0%|          | 3/5000 [00:41<19:19:37, 13.92s/it]------------------ Training Record ------------------
Epoch: 3/5000
Customer Numbers: 15 Charging Stations Numbers: 1
Avg Customer Visits: 15.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 10.000
Updated lambda_fail: 9.900
----------------------------------------------------
[RolloutDiag] valid_step=58, valid_ratio=0.610, reward_valid_mean=-0.2028, reward_valid_std=1.6704
[BatchDiag] adv_mean=-0.7034, adv_std=4.7433, adv_abs_mean=4.1021 | ret_mean=-0.7091, ret_std=4.7436 | val_mean=-0.0056, val_std=0.0008 | explained_var=0.000151
[GradSplit pre-clip] backbone=1.785333, critic=0.064927
[Loss] pg_loss=0.016764, entropy_loss=0.000752, value_loss=0.470166
[EpochKL] epoch=0 mean_kl=0.00872 max_kl=0.01906
[EpochKL] epoch=1 mean_kl=0.00774 max_kl=0.01386
[EpochKL] epoch=2 mean_kl=0.00753 max_kl=0.01468
[Time] Env Create Time: 2.6199s |Rollout Collect Time: 9.3232s |Loss & Update :4.4489
[PPODiag] kl_mean=0.0080, kl_p90=0.0144, kl_max=0.0191 | clipfrac_mean=0.094, logratio_std_mean=0.119, ratio_p95_mean=1.222 | valid_ratio_mb_mean=0.610, p10=0.607, min=0.605 | pg_loss_mean=-0.0023, v_loss_mean=1.8094, ent_mean=0.7823 | gn_bb_mean=2.379, gn_bb_max=5.992 | gn_v_mean=0.074, gn_v_max=0.095

  0%|          | 4/5000 [00:58<20:40:32, 14.90s/it]------------------ Training Record ------------------
Epoch: 4/5000
Customer Numbers: 15 Charging Stations Numbers: 1
Avg Customer Visits: 15.00
Finish Rate: 51162/51200 = 0.999
Current lambda_fail (before): 9.900
Updated lambda_fail: 9.900
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.565, reward_valid_mean=-0.1895, reward_valid_std=1.7035
[BatchDiag] adv_mean=-0.4614, adv_std=4.6742, adv_abs_mean=4.0013 | ret_mean=-0.4762, ret_std=4.6804 | val_mean=-0.0148, val_std=0.0114 | explained_var=0.002615
[GradSplit pre-clip] backbone=1.822270, critic=0.089581
[Loss] pg_loss=0.005732, entropy_loss=0.000718, value_loss=0.453875
[EarlyStop] epoch=0 mean_kl=0.01079 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01079 max_kl=0.02566
[Time] Env Create Time: 2.7833s |Rollout Collect Time: 9.5982s |Loss & Update :1.5814
[PPODiag] kl_mean=0.0108, kl_p90=0.0219, kl_max=0.0257 | clipfrac_mean=0.130, logratio_std_mean=0.129, ratio_p95_mean=1.272 | valid_ratio_mb_mean=0.565, p10=0.561, min=0.561 | pg_loss_mean=0.0021, v_loss_mean=1.7599, ent_mean=0.7450 | gn_bb_mean=3.300, gn_bb_max=6.578 | gn_v_mean=0.095, gn_v_max=0.112

  0%|          | 5/5000 [01:12<20:12:13, 14.56s/it]------------------ Training Record ------------------
Epoch: 5/5000
Customer Numbers: 15 Charging Stations Numbers: 1
Avg Customer Visits: 15.00
Finish Rate: 51165/51200 = 0.999
Current lambda_fail (before): 9.900
Updated lambda_fail: 9.900
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.561, reward_valid_mean=-0.1856, reward_valid_std=1.7094
[BatchDiag] adv_mean=-0.4007, adv_std=4.6556, adv_abs_mean=3.9734 | ret_mean=-0.4206, ret_std=4.6652 | val_mean=-0.0199, val_std=0.0174 | explained_var=0.004105
[GradSplit pre-clip] backbone=1.528489, critic=0.107934
[Loss] pg_loss=0.017519, entropy_loss=0.000705, value_loss=0.453712
[EpochKL] epoch=0 mean_kl=0.00622 max_kl=0.01386
[EpochKL] epoch=1 mean_kl=0.00927 max_kl=0.01503
[EpochKL] epoch=2 mean_kl=0.00976 max_kl=0.01664
[Time] Env Create Time: 2.7875s |Rollout Collect Time: 9.6569s |Loss & Update :4.6132
[PPODiag] kl_mean=0.0084, kl_p90=0.0139, kl_max=0.0166 | clipfrac_mean=0.081, logratio_std_mean=0.132, ratio_p95_mean=1.206 | valid_ratio_mb_mean=0.561, p10=0.557, min=0.556 | pg_loss_mean=-0.0017, v_loss_mean=1.7430, ent_mean=0.7320 | gn_bb_mean=2.208, gn_bb_max=5.917 | gn_v_mean=0.138, gn_v_max=0.177
[AttnScore] scale=0.9995, C=10.0

  0%|          | 6/5000 [01:29<21:22:38, 15.41s/it]------------------ Training Record ------------------
Epoch: 6/5000
Customer Numbers: 15 Charging Stations Numbers: 1
Avg Customer Visits: 15.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 9.900
Updated lambda_fail: 9.800
----------------------------------------------------
[RolloutDiag] valid_step=43, valid_ratio=0.750, reward_valid_mean=-0.1724, reward_valid_std=1.7443
[BatchDiag] adv_mean=-0.1521, adv_std=4.5869, adv_abs_mean=3.8809 | ret_mean=-0.1917, ret_std=4.6137 | val_mean=-0.0395, val_std=0.0468 | explained_var=0.011594
[GradSplit pre-clip] backbone=1.434878, critic=0.173761
[Loss] pg_loss=0.019712, entropy_loss=0.000956, value_loss=0.441861
[EpochKL] epoch=0 mean_kl=0.00642 max_kl=0.02006
[EpochKL] epoch=1 mean_kl=0.00617 max_kl=0.01594
[EpochKL] epoch=2 mean_kl=0.00962 max_kl=0.01613
[Time] Env Create Time: 2.6262s |Rollout Collect Time: 7.0221s |Loss & Update :3.4266
[PPODiag] kl_mean=0.0074, kl_p90=0.0159, kl_max=0.0201 | clipfrac_mean=0.103, logratio_std_mean=0.106, ratio_p95_mean=1.213 | valid_ratio_mb_mean=0.750, p10=0.746, min=0.742 | pg_loss_mean=0.0016, v_loss_mean=1.6938, ent_mean=0.9879 | gn_bb_mean=2.697, gn_bb_max=7.009 | gn_v_mean=0.220, gn_v_max=0.299

  0%|          | 7/5000 [01:42<20:18:51, 14.65s/it]------------------ Training Record ------------------
Epoch: 7/5000
Customer Numbers: 15 Charging Stations Numbers: 1
Avg Customer Visits: 15.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 9.800
Updated lambda_fail: 9.700
----------------------------------------------------
[RolloutDiag] valid_step=42, valid_ratio=0.735, reward_valid_mean=-0.1532, reward_valid_std=1.7810
[BatchDiag] adv_mean=0.1360, adv_std=4.4672, adv_abs_mean=3.7493 | ret_mean=0.0987, ret_std=4.5328 | val_mean=-0.0372, val_std=0.0956 | explained_var=0.028710
[GradSplit pre-clip] backbone=1.550507, critic=0.283043
[Loss] pg_loss=0.022661, entropy_loss=0.000960, value_loss=0.426515
[EpochKL] epoch=0 mean_kl=0.00521 max_kl=0.01391
[EpochKL] epoch=1 mean_kl=0.00484 max_kl=0.01184
[EpochKL] epoch=2 mean_kl=0.00546 max_kl=0.01390
[Time] Env Create Time: 2.7577s |Rollout Collect Time: 6.8335s |Loss & Update :3.3342
[PPODiag] kl_mean=0.0052, kl_p90=0.0113, kl_max=0.0139 | clipfrac_mean=0.076, logratio_std_mean=0.093, ratio_p95_mean=1.182 | valid_ratio_mb_mean=0.735, p10=0.731, min=0.729 | pg_loss_mean=-0.0006, v_loss_mean=1.6219, ent_mean=0.9966 | gn_bb_mean=2.474, gn_bb_max=5.751 | gn_v_mean=0.376, gn_v_max=0.489

  0%|          | 8/5000 [01:55<19:33:02, 14.10s/it]------------------ Training Record ------------------
Epoch: 8/5000
Customer Numbers: 15 Charging Stations Numbers: 1
Avg Customer Visits: 15.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 9.700
Updated lambda_fail: 9.600
----------------------------------------------------
[RolloutDiag] valid_step=39, valid_ratio=0.745, reward_valid_mean=-0.1292, reward_valid_std=1.8313
[BatchDiag] adv_mean=0.4996, adv_std=4.3154, adv_abs_mean=3.5963 | ret_mean=0.4648, ret_std=4.4417 | val_mean=-0.0348, val_std=0.1730 | explained_var=0.056065
[GradSplit pre-clip] backbone=1.907617, critic=0.409494
[Loss] pg_loss=0.029579, entropy_loss=0.001005, value_loss=0.406135
[EpochKL] epoch=0 mean_kl=0.00588 max_kl=0.01769
[EpochKL] epoch=1 mean_kl=0.00741 max_kl=0.01587
[EpochKL] epoch=2 mean_kl=0.00673 max_kl=0.01751
[Time] Env Create Time: 2.6201s |Rollout Collect Time: 6.3463s |Loss & Update :3.1141
[PPODiag] kl_mean=0.0067, kl_p90=0.0162, kl_max=0.0177 | clipfrac_mean=0.092, logratio_std_mean=0.102, ratio_p95_mean=1.178 | valid_ratio_mb_mean=0.745, p10=0.742, min=0.737 | pg_loss_mean=0.0008, v_loss_mean=1.5468, ent_mean=1.0273 | gn_bb_mean=2.832, gn_bb_max=6.454 | gn_v_mean=0.513, gn_v_max=0.592

  0%|          | 9/5000 [02:07<18:40:19, 13.47s/it]------------------ Training Record ------------------
Epoch: 9/5000
Customer Numbers: 15 Charging Stations Numbers: 1
Avg Customer Visits: 15.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 9.600
Updated lambda_fail: 9.500
----------------------------------------------------
[RolloutDiag] valid_step=40, valid_ratio=0.719, reward_valid_mean=-0.1274, reward_valid_std=1.8401
[BatchDiag] adv_mean=0.5466, adv_std=4.2376, adv_abs_mean=3.5251 | ret_mean=0.5199, ret_std=4.4337 | val_mean=-0.0267, val_std=0.2782 | explained_var=0.086496
[GradSplit pre-clip] backbone=1.892245, critic=0.522404
[Loss] pg_loss=0.022718, entropy_loss=0.000968, value_loss=0.396710
[EpochKL] epoch=0 mean_kl=0.00454 max_kl=0.00960
[EpochKL] epoch=1 mean_kl=0.00329 max_kl=0.00523
[EpochKL] epoch=2 mean_kl=0.00549 max_kl=0.01106
[Time] Env Create Time: 2.7751s |Rollout Collect Time: 6.5253s |Loss & Update :3.1983
[PPODiag] kl_mean=0.0044, kl_p90=0.0094, kl_max=0.0111 | clipfrac_mean=0.058, logratio_std_mean=0.087, ratio_p95_mean=1.157 | valid_ratio_mb_mean=0.719, p10=0.715, min=0.711 | pg_loss_mean=-0.0014, v_loss_mean=1.5110, ent_mean=0.9923 | gn_bb_mean=2.062, gn_bb_max=4.170 | gn_v_mean=0.680, gn_v_max=0.918

/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 0 episodes: nan, Step: 59, Avg Done Step: 0.00, #CS visited: 30.00
D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D->R->D
Eval cost : 9.8942s
-----------------------------
  0%|          | 10/5000 [02:29<22:29:34, 16.23s/it]------------------ Training Record ------------------
Epoch: 10/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 13.96
Finish Rate: 49059/51200 = 0.958
Current lambda_fail (before): 9.500
Updated lambda_fail: 9.500
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.668, reward_valid_mean=-0.2537, reward_valid_std=1.5404
[BatchDiag] adv_mean=-1.8018, adv_std=4.8582, adv_abs_mean=4.4714 | ret_mean=-1.6142, ret_std=4.9721 | val_mean=0.1876, val_std=0.3277 | explained_var=0.045295
[GradSplit pre-clip] backbone=4.841663, critic=1.317296
[Loss] pg_loss=-0.008909, entropy_loss=0.000872, value_loss=0.513147
[EarlyStop] epoch=0 mean_kl=0.01425 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01425 max_kl=0.03834
[Time] Env Create Time: 2.8626s |Rollout Collect Time: 9.9396s |Loss & Update :1.6045
[PPODiag] kl_mean=0.0143, kl_p90=0.0304, kl_max=0.0383 | clipfrac_mean=0.195, logratio_std_mean=0.142, ratio_p95_mean=1.288 | valid_ratio_mb_mean=0.668, p10=0.666, min=0.665 | pg_loss_mean=0.0049, v_loss_mean=1.9759, ent_mean=0.8911 | gn_bb_mean=5.992, gn_bb_max=9.007 | gn_v_mean=0.564, gn_v_max=1.317
[AttnScore] scale=0.9993, C=10.0

  0%|          | 11/5000 [02:44<21:42:58, 15.67s/it]------------------ Training Record ------------------
Epoch: 11/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 13.91
Finish Rate: 46762/51200 = 0.913
Current lambda_fail (before): 9.500
Updated lambda_fail: 9.500
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.732, reward_valid_mean=-0.2895, reward_valid_std=1.4388
[BatchDiag] adv_mean=-2.3930, adv_std=4.8743, adv_abs_mean=4.7282 | ret_mean=-2.3393, ret_std=5.0333 | val_mean=0.0536, val_std=0.3836 | explained_var=0.062215
[GradSplit pre-clip] backbone=4.654346, critic=1.317070
[Loss] pg_loss=-0.009077, entropy_loss=0.000937, value_loss=0.545639
[EpochKL] epoch=0 mean_kl=0.00729 max_kl=0.01852
[EpochKL] epoch=1 mean_kl=0.00639 max_kl=0.01146
[EpochKL] epoch=2 mean_kl=0.00820 max_kl=0.02776
[Time] Env Create Time: 2.8317s |Rollout Collect Time: 9.8451s |Loss & Update :4.6624
[PPODiag] kl_mean=0.0073, kl_p90=0.0129, kl_max=0.0278 | clipfrac_mean=0.097, logratio_std_mean=0.108, ratio_p95_mean=1.220 | valid_ratio_mb_mean=0.732, p10=0.725, min=0.720 | pg_loss_mean=-0.0060, v_loss_mean=2.0964, ent_mean=0.9797 | gn_bb_mean=3.272, gn_bb_max=7.025 | gn_v_mean=0.624, gn_v_max=1.317

  0%|          | 12/5000 [03:01<22:24:56, 16.18s/it]------------------ Training Record ------------------
Epoch: 12/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51056/51200 = 0.997
Current lambda_fail (before): 9.500
Updated lambda_fail: 9.500
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.560, reward_valid_mean=-0.1842, reward_valid_std=1.7097
[BatchDiag] adv_mean=-0.3329, adv_std=4.5848, adv_abs_mean=3.8828 | ret_mean=-0.5649, ret_std=4.8288 | val_mean=-0.2320, val_std=0.4663 | explained_var=0.098505
[GradSplit pre-clip] backbone=4.651610, critic=0.771615
[Loss] pg_loss=0.001519, entropy_loss=0.000803, value_loss=0.439096
[EpochKL] epoch=0 mean_kl=0.00648 max_kl=0.01529
[EpochKL] epoch=1 mean_kl=0.00606 max_kl=0.01141
[EpochKL] epoch=2 mean_kl=0.00725 max_kl=0.01171
[Time] Env Create Time: 2.6801s |Rollout Collect Time: 9.7503s |Loss & Update :4.6502
[PPODiag] kl_mean=0.0066, kl_p90=0.0114, kl_max=0.0153 | clipfrac_mean=0.089, logratio_std_mean=0.107, ratio_p95_mean=1.192 | valid_ratio_mb_mean=0.560, p10=0.553, min=0.551 | pg_loss_mean=-0.0075, v_loss_mean=1.6882, ent_mean=0.8157 | gn_bb_mean=3.649, gn_bb_max=6.623 | gn_v_mean=0.900, gn_v_max=1.349

  0%|          | 13/5000 [03:18<22:47:24, 16.45s/it]------------------ Training Record ------------------
Epoch: 13/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51163/51200 = 0.999
Current lambda_fail (before): 9.500
Updated lambda_fail: 9.500
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.518, reward_valid_mean=-0.1543, reward_valid_std=1.7742
[BatchDiag] adv_mean=0.1430, adv_std=4.3546, adv_abs_mean=3.6332 | ret_mean=-0.0305, ret_std=4.6805 | val_mean=-0.1735, val_std=0.5920 | explained_var=0.134404
[GradSplit pre-clip] backbone=4.621476, critic=0.743890
[Loss] pg_loss=-0.018050, entropy_loss=0.000746, value_loss=0.401920
[EarlyStop] epoch=0 mean_kl=0.01254 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01254 max_kl=0.03535
[Time] Env Create Time: 2.8114s |Rollout Collect Time: 9.6875s |Loss & Update :1.6079
[PPODiag] kl_mean=0.0125, kl_p90=0.0293, kl_max=0.0353 | clipfrac_mean=0.179, logratio_std_mean=0.129, ratio_p95_mean=1.241 | valid_ratio_mb_mean=0.518, p10=0.516, min=0.515 | pg_loss_mean=0.0025, v_loss_mean=1.5757, ent_mean=0.7553 | gn_bb_mean=5.614, gn_bb_max=9.171 | gn_v_mean=0.917, gn_v_max=1.405

  0%|          | 14/5000 [03:32<21:48:17, 15.74s/it]------------------ Training Record ------------------
Epoch: 14/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51161/51200 = 0.999
Current lambda_fail (before): 9.500
Updated lambda_fail: 9.500
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.528, reward_valid_mean=-0.1605, reward_valid_std=1.7594
[BatchDiag] adv_mean=0.0033, adv_std=4.3205, adv_abs_mean=3.6010 | ret_mean=-0.0722, ret_std=4.6910 | val_mean=-0.0755, val_std=0.6621 | explained_var=0.151752
[GradSplit pre-clip] backbone=4.588476, critic=0.728547
[Loss] pg_loss=-0.004766, entropy_loss=0.000764, value_loss=0.403499
[EpochKL] epoch=0 mean_kl=0.00643 max_kl=0.01462
[EpochKL] epoch=1 mean_kl=0.00711 max_kl=0.01310
[EarlyStop] epoch=2 mean_kl=0.01023 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01023 max_kl=0.02346
[Time] Env Create Time: 2.8289s |Rollout Collect Time: 9.7253s |Loss & Update :4.6493
[PPODiag] kl_mean=0.0079, kl_p90=0.0142, kl_max=0.0235 | clipfrac_mean=0.113, logratio_std_mean=0.115, ratio_p95_mean=1.201 | valid_ratio_mb_mean=0.528, p10=0.523, min=0.518 | pg_loss_mean=-0.0075, v_loss_mean=1.5414, ent_mean=0.7773 | gn_bb_mean=4.093, gn_bb_max=8.049 | gn_v_mean=0.879, gn_v_max=1.233

  0%|          | 15/5000 [03:49<22:24:35, 16.18s/it]------------------ Training Record ------------------
Epoch: 15/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51198/51200 = 1.000
Current lambda_fail (before): 9.500
Updated lambda_fail: 9.500
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.482, reward_valid_mean=-0.1261, reward_valid_std=1.8367
[BatchDiag] adv_mean=0.5277, adv_std=4.0519, adv_abs_mean=3.3492 | ret_mean=0.5325, ret_std=4.5069 | val_mean=0.0047, val_std=0.8133 | explained_var=0.191718
[GradSplit pre-clip] backbone=4.357095, critic=0.737882
[Loss] pg_loss=-0.018363, entropy_loss=0.000706, value_loss=0.369324
[EpochKL] epoch=0 mean_kl=0.00546 max_kl=0.01214
[EpochKL] epoch=1 mean_kl=0.00783 max_kl=0.01561
[EarlyStop] epoch=2 mean_kl=0.01506 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01506 max_kl=0.03834
[Time] Env Create Time: 2.6743s |Rollout Collect Time: 9.5946s |Loss & Update :4.6502
[PPODiag] kl_mean=0.0094, kl_p90=0.0239, kl_max=0.0383 | clipfrac_mean=0.125, logratio_std_mean=0.123, ratio_p95_mean=1.196 | valid_ratio_mb_mean=0.482, p10=0.479, min=0.473 | pg_loss_mean=-0.0066, v_loss_mean=1.4188, ent_mean=0.7130 | gn_bb_mean=3.814, gn_bb_max=7.982 | gn_v_mean=1.003, gn_v_max=1.466
[AttnScore] scale=0.9989, C=10.0

  0%|          | 16/5000 [04:06<22:42:43, 16.41s/it]------------------ Training Record ------------------
Epoch: 16/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51196/51200 = 1.000
Current lambda_fail (before): 9.500
Updated lambda_fail: 9.500
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.496, reward_valid_mean=-0.1380, reward_valid_std=1.8107
[BatchDiag] adv_mean=0.3367, adv_std=4.0078, adv_abs_mean=3.2982 | ret_mean=0.4129, ret_std=4.5487 | val_mean=0.0763, val_std=0.9918 | explained_var=0.223678
[GradSplit pre-clip] backbone=4.517259, critic=0.942768
[Loss] pg_loss=-0.011870, entropy_loss=0.000726, value_loss=0.361891
[EpochKL] epoch=0 mean_kl=0.00923 max_kl=0.02338
[EpochKL] epoch=1 mean_kl=0.00940 max_kl=0.02567
[EarlyStop] epoch=2 mean_kl=0.01077 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01077 max_kl=0.02134
[Time] Env Create Time: 2.8218s |Rollout Collect Time: 9.6615s |Loss & Update :4.6509
[PPODiag] kl_mean=0.0098, kl_p90=0.0208, kl_max=0.0257 | clipfrac_mean=0.147, logratio_std_mean=0.126, ratio_p95_mean=1.217 | valid_ratio_mb_mean=0.496, p10=0.493, min=0.488 | pg_loss_mean=-0.0028, v_loss_mean=1.4039, ent_mean=0.7313 | gn_bb_mean=4.602, gn_bb_max=7.741 | gn_v_mean=1.880, gn_v_max=2.670

  0%|          | 17/5000 [04:24<23:00:40, 16.62s/it]------------------ Training Record ------------------
Epoch: 17/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51199/51200 = 1.000
Current lambda_fail (before): 9.500
Updated lambda_fail: 9.500
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.452, reward_valid_mean=-0.0968, reward_valid_std=1.8915
[BatchDiag] adv_mean=0.8701, adv_std=3.6911, adv_abs_mean=3.0491 | ret_mean=1.0803, ret_std=4.3156 | val_mean=0.2102, val_std=1.1371 | explained_var=0.268500
[GradSplit pre-clip] backbone=4.150876, critic=0.855914
[Loss] pg_loss=-0.023608, entropy_loss=0.000664, value_loss=0.327464
[EpochKL] epoch=0 mean_kl=0.00698 max_kl=0.01934
[EarlyStop] epoch=1 mean_kl=0.01027 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01027 max_kl=0.01954
[Time] Env Create Time: 2.8191s |Rollout Collect Time: 9.5215s |Loss & Update :3.1181
[PPODiag] kl_mean=0.0086, kl_p90=0.0185, kl_max=0.0195 | clipfrac_mean=0.122, logratio_std_mean=0.118, ratio_p95_mean=1.178 | valid_ratio_mb_mean=0.452, p10=0.449, min=0.445 | pg_loss_mean=-0.0050, v_loss_mean=1.2906, ent_mean=0.6639 | gn_bb_mean=3.945, gn_bb_max=5.903 | gn_v_mean=1.769, gn_v_max=2.997

  0%|          | 18/5000 [04:39<22:31:19, 16.27s/it]------------------ Training Record ------------------
Epoch: 18/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 9.500
Updated lambda_fail: 9.400
----------------------------------------------------
[RolloutDiag] valid_step=44, valid_ratio=0.573, reward_valid_mean=-0.0636, reward_valid_std=1.9564
[BatchDiag] adv_mean=1.3321, adv_std=3.4881, adv_abs_mean=2.9868 | ret_mean=1.5281, ret_std=4.1739 | val_mean=0.1960, val_std=1.2738 | explained_var=0.301605
[GradSplit pre-clip] backbone=3.775926, critic=1.722794
[Loss] pg_loss=-0.028186, entropy_loss=0.000833, value_loss=0.321827
[EpochKL] epoch=0 mean_kl=0.00763 max_kl=0.01941
[EarlyStop] epoch=1 mean_kl=0.01328 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01328 max_kl=0.02509
[Time] Env Create Time: 2.8209s |Rollout Collect Time: 7.0918s |Loss & Update :2.3593
[PPODiag] kl_mean=0.0105, kl_p90=0.0196, kl_max=0.0251 | clipfrac_mean=0.118, logratio_std_mean=0.139, ratio_p95_mean=1.172 | valid_ratio_mb_mean=0.573, p10=0.569, min=0.567 | pg_loss_mean=-0.0046, v_loss_mean=1.2613, ent_mean=0.8244 | gn_bb_mean=3.006, gn_bb_max=4.160 | gn_v_mean=1.681, gn_v_max=3.202

  0%|          | 19/5000 [04:51<20:51:15, 15.07s/it]------------------ Training Record ------------------
Epoch: 19/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 9.400
Updated lambda_fail: 9.300
----------------------------------------------------
[RolloutDiag] valid_step=49, valid_ratio=0.490, reward_valid_mean=-0.0388, reward_valid_std=2.0018
[BatchDiag] adv_mean=1.4211, adv_std=3.3340, adv_abs_mean=2.8687 | ret_mean=1.9629, ret_std=3.9778 | val_mean=0.5419, val_std=1.2404 | explained_var=0.297513
[GradSplit pre-clip] backbone=2.999236, critic=1.411996
[Loss] pg_loss=-0.028362, entropy_loss=0.000687, value_loss=0.306282
[EpochKL] epoch=0 mean_kl=0.00663 max_kl=0.01628
[EarlyStop] epoch=1 mean_kl=0.01196 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01196 max_kl=0.01589
[Time] Env Create Time: 2.6645s |Rollout Collect Time: 7.8008s |Loss & Update :2.5810
[PPODiag] kl_mean=0.0093, kl_p90=0.0158, kl_max=0.0163 | clipfrac_mean=0.092, logratio_std_mean=0.136, ratio_p95_mean=1.148 | valid_ratio_mb_mean=0.490, p10=0.486, min=0.483 | pg_loss_mean=-0.0043, v_loss_mean=1.2230, ent_mean=0.6756 | gn_bb_mean=2.354, gn_bb_max=3.119 | gn_v_mean=2.401, gn_v_max=3.441

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -15.450, Step: 44, Avg Done Step: 30.28, #CS visited: 8.07
D->R->C6->C13->C7->C11->C4->C15->C14->R->C10->C3->C5->D->R->C12->C1->D->R->C9->D->R->C8->D->R->C2->D
Eval cost : 7.4060s
-----------------------------
  0%|          | 20/5000 [05:12<23:05:46, 16.70s/it]------------------ Training Record ------------------
Epoch: 20/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 9.300
Updated lambda_fail: 9.200
----------------------------------------------------
[RolloutDiag] valid_step=36, valid_ratio=0.648, reward_valid_mean=-0.0234, reward_valid_std=2.0273
[BatchDiag] adv_mean=1.3898, adv_std=3.2471, adv_abs_mean=2.7924 | ret_mean=2.2542, ret_std=3.8344 | val_mean=0.8643, val_std=1.2081 | explained_var=0.282883
[GradSplit pre-clip] backbone=2.500353, critic=0.910558
[Loss] pg_loss=-0.033948, entropy_loss=0.000891, value_loss=0.296156
[EpochKL] epoch=0 mean_kl=0.00507 max_kl=0.01217
[EpochKL] epoch=1 mean_kl=0.00537 max_kl=0.00927
[EpochKL] epoch=2 mean_kl=0.00561 max_kl=0.00865
[Time] Env Create Time: 2.8362s |Rollout Collect Time: 5.8621s |Loss & Update :2.8942
[PPODiag] kl_mean=0.0053, kl_p90=0.0090, kl_max=0.0122 | clipfrac_mean=0.080, logratio_std_mean=0.099, ratio_p95_mean=1.144 | valid_ratio_mb_mean=0.648, p10=0.643, min=0.636 | pg_loss_mean=-0.0050, v_loss_mean=1.1723, ent_mean=0.8804 | gn_bb_mean=1.990, gn_bb_max=4.376 | gn_v_mean=2.703, gn_v_max=4.453
[AttnScore] scale=0.9988, C=10.0

  0%|          | 21/5000 [05:23<20:58:22, 15.16s/it]------------------ Training Record ------------------
Epoch: 21/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 9.200
Updated lambda_fail: 9.100
----------------------------------------------------
[RolloutDiag] valid_step=33, valid_ratio=0.685, reward_valid_mean=-0.0061, reward_valid_std=2.0556
[BatchDiag] adv_mean=1.6151, adv_std=3.0807, adv_abs_mean=2.7629 | ret_mean=2.4552, ret_std=3.7792 | val_mean=0.8401, val_std=1.4080 | explained_var=0.335488
[GradSplit pre-clip] backbone=2.360131, critic=2.412792
[Loss] pg_loss=-0.045989, entropy_loss=0.000926, value_loss=0.294565
[EpochKL] epoch=0 mean_kl=0.00654 max_kl=0.01918
[EpochKL] epoch=1 mean_kl=0.00618 max_kl=0.01459
[EpochKL] epoch=2 mean_kl=0.00791 max_kl=0.01539
[Time] Env Create Time: 2.8196s |Rollout Collect Time: 5.3907s |Loss & Update :2.6796
[PPODiag] kl_mean=0.0069, kl_p90=0.0145, kl_max=0.0192 | clipfrac_mean=0.102, logratio_std_mean=0.103, ratio_p95_mean=1.144 | valid_ratio_mb_mean=0.685, p10=0.680, min=0.674 | pg_loss_mean=-0.0021, v_loss_mean=1.1524, ent_mean=0.9045 | gn_bb_mean=2.783, gn_bb_max=4.126 | gn_v_mean=2.244, gn_v_max=3.688

  0%|          | 22/5000 [05:34<19:11:42, 13.88s/it]------------------ Training Record ------------------
Epoch: 22/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 9.100
Updated lambda_fail: 9.000
----------------------------------------------------
[RolloutDiag] valid_step=33, valid_ratio=0.675, reward_valid_mean=0.0077, reward_valid_std=2.0688
[BatchDiag] adv_mean=1.6249, adv_std=2.9642, adv_abs_mean=2.6795 | ret_mean=2.6683, ret_std=3.6730 | val_mean=1.0435, val_std=1.4872 | explained_var=0.348723
[GradSplit pre-clip] backbone=2.176859, critic=2.864045
[Loss] pg_loss=-0.054866, entropy_loss=0.000888, value_loss=0.284433
[EpochKL] epoch=0 mean_kl=0.00487 max_kl=0.01379
[EpochKL] epoch=1 mean_kl=0.00451 max_kl=0.00985
[EpochKL] epoch=2 mean_kl=0.00528 max_kl=0.00858
[Time] Env Create Time: 2.8508s |Rollout Collect Time: 5.3955s |Loss & Update :2.6907
[PPODiag] kl_mean=0.0049, kl_p90=0.0095, kl_max=0.0138 | clipfrac_mean=0.069, logratio_std_mean=0.091, ratio_p95_mean=1.123 | valid_ratio_mb_mean=0.675, p10=0.669, min=0.668 | pg_loss_mean=-0.0037, v_loss_mean=1.1045, ent_mean=0.8702 | gn_bb_mean=2.042, gn_bb_max=3.571 | gn_v_mean=2.626, gn_v_max=5.100

  0%|          | 23/5000 [05:45<17:58:11, 13.00s/it]------------------ Training Record ------------------
Epoch: 23/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 9.000
Updated lambda_fail: 8.900
----------------------------------------------------
[RolloutDiag] valid_step=32, valid_ratio=0.672, reward_valid_mean=0.0251, reward_valid_std=2.1002
[BatchDiag] adv_mean=1.8361, adv_std=2.8487, adv_abs_mean=2.7279 | ret_mean=2.8607, ret_std=3.6197 | val_mean=1.0246, val_std=1.6693 | explained_var=0.380649
[GradSplit pre-clip] backbone=2.074293, critic=5.151865
[Loss] pg_loss=-0.038229, entropy_loss=0.000857, value_loss=0.293503
[EpochKL] epoch=0 mean_kl=0.00496 max_kl=0.01384
[EpochKL] epoch=1 mean_kl=0.00399 max_kl=0.00844
[EpochKL] epoch=2 mean_kl=0.00420 max_kl=0.00631
[Time] Env Create Time: 2.6642s |Rollout Collect Time: 5.2115s |Loss & Update :2.6044
[PPODiag] kl_mean=0.0044, kl_p90=0.0094, kl_max=0.0138 | clipfrac_mean=0.057, logratio_std_mean=0.088, ratio_p95_mean=1.105 | valid_ratio_mb_mean=0.672, p10=0.668, min=0.665 | pg_loss_mean=-0.0032, v_loss_mean=1.1207, ent_mean=0.8344 | gn_bb_mean=1.647, gn_bb_max=2.725 | gn_v_mean=2.814, gn_v_max=5.289

  0%|          | 24/5000 [05:56<16:55:19, 12.24s/it]------------------ Training Record ------------------
Epoch: 24/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 8.900
Updated lambda_fail: 8.800
----------------------------------------------------
[RolloutDiag] valid_step=30, valid_ratio=0.697, reward_valid_mean=0.0457, reward_valid_std=2.1276
[BatchDiag] adv_mean=1.8917, adv_std=2.7363, adv_abs_mean=2.6842 | ret_mean=3.1249, ret_std=3.5018 | val_mean=1.2332, val_std=1.6842 | explained_var=0.389417
[GradSplit pre-clip] backbone=1.899575, critic=5.701648
[Loss] pg_loss=-0.033301, entropy_loss=0.000866, value_loss=0.284290
[EpochKL] epoch=0 mean_kl=0.00424 max_kl=0.01141
[EpochKL] epoch=1 mean_kl=0.00393 max_kl=0.00745
[EpochKL] epoch=2 mean_kl=0.00378 max_kl=0.00724
[Time] Env Create Time: 2.8248s |Rollout Collect Time: 4.9045s |Loss & Update :2.4525
[PPODiag] kl_mean=0.0040, kl_p90=0.0074, kl_max=0.0114 | clipfrac_mean=0.048, logratio_std_mean=0.085, ratio_p95_mean=1.093 | valid_ratio_mb_mean=0.697, p10=0.692, min=0.686 | pg_loss_mean=-0.0024, v_loss_mean=1.0996, ent_mean=0.8422 | gn_bb_mean=1.617, gn_bb_max=2.509 | gn_v_mean=3.663, gn_v_max=6.897

  0%|          | 25/5000 [06:06<16:03:51, 11.62s/it]------------------ Training Record ------------------
Epoch: 25/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 8.800
Updated lambda_fail: 8.700
----------------------------------------------------
[RolloutDiag] valid_step=30, valid_ratio=0.682, reward_valid_mean=0.0591, reward_valid_std=2.1467
[BatchDiag] adv_mean=1.9499, adv_std=2.6373, adv_abs_mean=2.6748 | ret_mean=3.2882, ret_std=3.4308 | val_mean=1.3383, val_std=1.7605 | explained_var=0.409079
[GradSplit pre-clip] backbone=1.748809, critic=7.933743
[Loss] pg_loss=-0.085289, entropy_loss=0.000824, value_loss=0.290455
[EpochKL] epoch=0 mean_kl=0.00276 max_kl=0.00743
[EpochKL] epoch=1 mean_kl=0.00417 max_kl=0.00808
[EpochKL] epoch=2 mean_kl=0.00366 max_kl=0.00476
[Time] Env Create Time: 2.8357s |Rollout Collect Time: 4.8769s |Loss & Update :2.4627
[PPODiag] kl_mean=0.0035, kl_p90=0.0073, kl_max=0.0081 | clipfrac_mean=0.044, logratio_std_mean=0.080, ratio_p95_mean=1.088 | valid_ratio_mb_mean=0.682, p10=0.676, min=0.670 | pg_loss_mean=-0.0031, v_loss_mean=1.0839, ent_mean=0.7985 | gn_bb_mean=1.216, gn_bb_max=2.378 | gn_v_mean=3.352, gn_v_max=7.934
[AttnScore] scale=0.9998, C=10.0

  1%|          | 26/5000 [06:16<15:27:38, 11.19s/it]------------------ Training Record ------------------
Epoch: 26/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 8.700
Updated lambda_fail: 8.600
----------------------------------------------------
[RolloutDiag] valid_step=28, valid_ratio=0.720, reward_valid_mean=0.0680, reward_valid_std=2.1581
[BatchDiag] adv_mean=1.8276, adv_std=2.5624, adv_abs_mean=2.5618 | ret_mean=3.4584, ret_std=3.3367 | val_mean=1.6309, val_std=1.7165 | explained_var=0.410269
[GradSplit pre-clip] backbone=1.536359, critic=7.362887
[Loss] pg_loss=-0.042782, entropy_loss=0.000842, value_loss=0.271067
[EpochKL] epoch=0 mean_kl=0.00326 max_kl=0.00691
[EpochKL] epoch=1 mean_kl=0.00249 max_kl=0.00465
[EpochKL] epoch=2 mean_kl=0.00338 max_kl=0.00440
[Time] Env Create Time: 2.6808s |Rollout Collect Time: 4.5939s |Loss & Update :2.3234
[PPODiag] kl_mean=0.0030, kl_p90=0.0047, kl_max=0.0069 | clipfrac_mean=0.034, logratio_std_mean=0.077, ratio_p95_mean=1.083 | valid_ratio_mb_mean=0.720, p10=0.715, min=0.713 | pg_loss_mean=-0.0029, v_loss_mean=1.0351, ent_mean=0.8160 | gn_bb_mean=0.964, gn_bb_max=1.536 | gn_v_mean=3.384, gn_v_max=8.035

  1%|          | 27/5000 [06:26<14:47:52, 10.71s/it]------------------ Training Record ------------------
Epoch: 27/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 8.600
Updated lambda_fail: 8.500
----------------------------------------------------
[RolloutDiag] valid_step=27, valid_ratio=0.733, reward_valid_mean=0.0847, reward_valid_std=2.1746
[BatchDiag] adv_mean=1.6874, adv_std=2.4657, adv_abs_mean=2.4307 | ret_mean=3.7164, ret_std=3.2018 | val_mean=2.0291, val_std=1.6138 | explained_var=0.406981
[GradSplit pre-clip] backbone=1.407007, critic=7.359618
[Loss] pg_loss=-0.071299, entropy_loss=0.000822, value_loss=0.255387
[EpochKL] epoch=0 mean_kl=0.00252 max_kl=0.00640
[EpochKL] epoch=1 mean_kl=0.00274 max_kl=0.00482
[EpochKL] epoch=2 mean_kl=0.00342 max_kl=0.00468
[Time] Env Create Time: 2.8273s |Rollout Collect Time: 4.4237s |Loss & Update :2.2349
[PPODiag] kl_mean=0.0029, kl_p90=0.0048, kl_max=0.0064 | clipfrac_mean=0.033, logratio_std_mean=0.075, ratio_p95_mean=1.082 | valid_ratio_mb_mean=0.733, p10=0.727, min=0.721 | pg_loss_mean=-0.0026, v_loss_mean=0.9734, ent_mean=0.7978 | gn_bb_mean=0.832, gn_bb_max=1.583 | gn_v_mean=3.679, gn_v_max=7.360

  1%|          | 28/5000 [06:35<14:17:12, 10.34s/it]------------------ Training Record ------------------
Epoch: 28/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 8.500
Updated lambda_fail: 8.400
----------------------------------------------------
[RolloutDiag] valid_step=27, valid_ratio=0.725, reward_valid_mean=0.0943, reward_valid_std=2.1828
[BatchDiag] adv_mean=1.6255, adv_std=2.3943, adv_abs_mean=2.3668 | ret_mean=3.8557, ret_std=3.1221 | val_mean=2.2302, val_std=1.6276 | explained_var=0.411884
[GradSplit pre-clip] backbone=1.317787, critic=7.372653
[Loss] pg_loss=-0.055233, entropy_loss=0.000788, value_loss=0.245761
[EpochKL] epoch=0 mean_kl=0.00181 max_kl=0.00404
[EpochKL] epoch=1 mean_kl=0.00282 max_kl=0.00422
[EpochKL] epoch=2 mean_kl=0.00447 max_kl=0.00743
[Time] Env Create Time: 2.8325s |Rollout Collect Time: 4.4279s |Loss & Update :2.2467
[PPODiag] kl_mean=0.0030, kl_p90=0.0050, kl_max=0.0074 | clipfrac_mean=0.035, logratio_std_mean=0.076, ratio_p95_mean=1.082 | valid_ratio_mb_mean=0.725, p10=0.720, min=0.716 | pg_loss_mean=-0.0025, v_loss_mean=0.9395, ent_mean=0.7617 | gn_bb_mean=0.861, gn_bb_max=1.504 | gn_v_mean=3.633, gn_v_max=7.373

  1%|          | 29/5000 [06:45<13:56:14, 10.09s/it]------------------ Training Record ------------------
Epoch: 29/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 8.400
Updated lambda_fail: 8.300
----------------------------------------------------
[RolloutDiag] valid_step=27, valid_ratio=0.717, reward_valid_mean=0.1028, reward_valid_std=2.1904
[BatchDiag] adv_mean=1.5898, adv_std=2.3081, adv_abs_mean=2.2918 | ret_mean=3.9804, ret_std=3.0573 | val_mean=2.3906, val_std=1.6793 | explained_var=0.430078
[GradSplit pre-clip] backbone=1.365032, critic=8.050144
[Loss] pg_loss=-0.057935, entropy_loss=0.000760, value_loss=0.239231
[EpochKL] epoch=0 mean_kl=0.00167 max_kl=0.00403
[EpochKL] epoch=1 mean_kl=0.00241 max_kl=0.00343
[EpochKL] epoch=2 mean_kl=0.00349 max_kl=0.00506
[Time] Env Create Time: 2.9017s |Rollout Collect Time: 4.4248s |Loss & Update :2.2391
[PPODiag] kl_mean=0.0025, kl_p90=0.0041, kl_max=0.0051 | clipfrac_mean=0.029, logratio_std_mean=0.069, ratio_p95_mean=1.073 | valid_ratio_mb_mean=0.717, p10=0.714, min=0.711 | pg_loss_mean=-0.0024, v_loss_mean=0.8985, ent_mean=0.7323 | gn_bb_mean=0.754, gn_bb_max=1.365 | gn_v_mean=3.012, gn_v_max=8.050

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -8.194, Step: 23, Avg Done Step: 19.42, #CS visited: 2.15
D->C6->C13->C12->C1->C15->C14->C10->R->C3->C5->C2->C8->D->C7->C4->C11->C9->D
Eval cost : 4.2957s
-----------------------------
  1%|          | 30/5000 [06:58<15:30:56, 11.24s/it]------------------ Training Record ------------------
Epoch: 30/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 8.300
Updated lambda_fail: 8.200
----------------------------------------------------
[RolloutDiag] valid_step=28, valid_ratio=0.685, reward_valid_mean=0.1102, reward_valid_std=2.1985
[BatchDiag] adv_mean=1.5439, adv_std=2.2624, adv_abs_mean=2.2486 | ret_mean=4.0852, ret_std=3.0077 | val_mean=2.5412, val_std=1.6865 | explained_var=0.434195
[GradSplit pre-clip] backbone=1.293154, critic=7.892414
[Loss] pg_loss=-0.082565, entropy_loss=0.000698, value_loss=0.236703
[EpochKL] epoch=0 mean_kl=0.00173 max_kl=0.00501
[EpochKL] epoch=1 mean_kl=0.00387 max_kl=0.00532
[EpochKL] epoch=2 mean_kl=0.00433 max_kl=0.00542
[Time] Env Create Time: 2.7059s |Rollout Collect Time: 4.5788s |Loss & Update :2.3292
[PPODiag] kl_mean=0.0033, kl_p90=0.0053, kl_max=0.0054 | clipfrac_mean=0.033, logratio_std_mean=0.079, ratio_p95_mean=1.082 | valid_ratio_mb_mean=0.685, p10=0.680, min=0.678 | pg_loss_mean=-0.0020, v_loss_mean=0.8963, ent_mean=0.6697 | gn_bb_mean=0.837, gn_bb_max=1.299 | gn_v_mean=2.820, gn_v_max=7.892
[AttnScore] scale=1.0014, C=10.0

  1%|          | 31/5000 [07:08<14:50:23, 10.75s/it]------------------ Training Record ------------------
Epoch: 31/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 8.200
Updated lambda_fail: 8.100
----------------------------------------------------
[RolloutDiag] valid_step=26, valid_ratio=0.730, reward_valid_mean=0.1202, reward_valid_std=2.2083
[BatchDiag] adv_mean=1.4873, adv_std=2.1753, adv_abs_mean=2.1790 | ret_mean=4.2616, ret_std=2.9267 | val_mean=2.7743, val_std=1.8735 | explained_var=0.447567
[GradSplit pre-clip] backbone=1.224140, critic=10.373578
[Loss] pg_loss=-0.111484, entropy_loss=0.000713, value_loss=0.230880
[EpochKL] epoch=0 mean_kl=0.00132 max_kl=0.00300
[EpochKL] epoch=1 mean_kl=0.00286 max_kl=0.00456
[EpochKL] epoch=2 mean_kl=0.00449 max_kl=0.00588
[Time] Env Create Time: 2.8328s |Rollout Collect Time: 4.2623s |Loss & Update :2.1532
[PPODiag] kl_mean=0.0029, kl_p90=0.0048, kl_max=0.0059 | clipfrac_mean=0.029, logratio_std_mean=0.074, ratio_p95_mean=1.078 | valid_ratio_mb_mean=0.730, p10=0.725, min=0.721 | pg_loss_mean=-0.0018, v_loss_mean=0.8526, ent_mean=0.6860 | gn_bb_mean=0.675, gn_bb_max=1.224 | gn_v_mean=4.476, gn_v_max=11.867

  1%|          | 32/5000 [07:17<14:12:53, 10.30s/it]------------------ Training Record ------------------
Epoch: 32/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 8.100
Updated lambda_fail: 8.000
----------------------------------------------------
[RolloutDiag] valid_step=26, valid_ratio=0.721, reward_valid_mean=0.1327, reward_valid_std=2.2189
[BatchDiag] adv_mean=1.6008, adv_std=2.1261, adv_abs_mean=2.2455 | ret_mean=4.3838, ret_std=2.8837 | val_mean=2.7830, val_std=2.0841 | explained_var=0.456399
[GradSplit pre-clip] backbone=1.145647, critic=12.015963
[Loss] pg_loss=-0.091597, entropy_loss=0.000682, value_loss=0.238661
[EpochKL] epoch=0 mean_kl=0.00140 max_kl=0.00272
[EpochKL] epoch=1 mean_kl=0.00295 max_kl=0.00452
[EpochKL] epoch=2 mean_kl=0.00467 max_kl=0.00631
[Time] Env Create Time: 2.8368s |Rollout Collect Time: 4.2581s |Loss & Update :2.1502
[PPODiag] kl_mean=0.0030, kl_p90=0.0049, kl_max=0.0063 | clipfrac_mean=0.030, logratio_std_mean=0.076, ratio_p95_mean=1.078 | valid_ratio_mb_mean=0.721, p10=0.715, min=0.713 | pg_loss_mean=-0.0021, v_loss_mean=0.8908, ent_mean=0.6485 | gn_bb_mean=0.528, gn_bb_max=1.146 | gn_v_mean=3.009, gn_v_max=12.016

  1%|          | 33/5000 [07:27<13:46:30,  9.98s/it]------------------ Training Record ------------------
Epoch: 33/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 8.000
Updated lambda_fail: 7.900
----------------------------------------------------
[RolloutDiag] valid_step=26, valid_ratio=0.714, reward_valid_mean=0.1445, reward_valid_std=2.2271
[BatchDiag] adv_mean=1.5598, adv_std=2.0928, adv_abs_mean=2.2168 | ret_mean=4.5413, ret_std=2.8091 | val_mean=2.9815, val_std=2.1643 | explained_var=0.444981
[GradSplit pre-clip] backbone=0.934833, critic=13.179380
[Loss] pg_loss=-0.102877, entropy_loss=0.000638, value_loss=0.235335
[EpochKL] epoch=0 mean_kl=0.00137 max_kl=0.00322
[EpochKL] epoch=1 mean_kl=0.00336 max_kl=0.00478
[EpochKL] epoch=2 mean_kl=0.00472 max_kl=0.00580
[Time] Env Create Time: 2.8507s |Rollout Collect Time: 4.2380s |Loss & Update :2.1535
[PPODiag] kl_mean=0.0031, kl_p90=0.0050, kl_max=0.0058 | clipfrac_mean=0.030, logratio_std_mean=0.078, ratio_p95_mean=1.079 | valid_ratio_mb_mean=0.714, p10=0.709, min=0.708 | pg_loss_mean=-0.0018, v_loss_mean=0.8622, ent_mean=0.6085 | gn_bb_mean=0.497, gn_bb_max=0.935 | gn_v_mean=3.823, gn_v_max=13.179

  1%|          | 34/5000 [07:36<13:27:56,  9.76s/it]------------------ Training Record ------------------
Epoch: 34/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 7.900
Updated lambda_fail: 7.800
----------------------------------------------------
[RolloutDiag] valid_step=42, valid_ratio=0.440, reward_valid_mean=0.1487, reward_valid_std=2.2288
[BatchDiag] adv_mean=1.3220, adv_std=2.0446, adv_abs_mean=2.0325 | ret_mean=4.6692, ret_std=2.7303 | val_mean=3.3472, val_std=2.0564 | explained_var=0.439193
[GradSplit pre-clip] backbone=0.650877, critic=11.795759
[Loss] pg_loss=-0.083785, entropy_loss=0.000374, value_loss=0.207971
[EpochKL] epoch=0 mean_kl=0.00099 max_kl=0.00243
[EpochKL] epoch=1 mean_kl=0.00350 max_kl=0.00496
[EpochKL] epoch=2 mean_kl=0.00375 max_kl=0.00515
[Time] Env Create Time: 2.6930s |Rollout Collect Time: 6.6894s |Loss & Update :3.3189
[PPODiag] kl_mean=0.0027, kl_p90=0.0047, kl_max=0.0052 | clipfrac_mean=0.026, logratio_std_mean=0.072, ratio_p95_mean=1.075 | valid_ratio_mb_mean=0.440, p10=0.438, min=0.437 | pg_loss_mean=-0.0016, v_loss_mean=0.7905, ent_mean=0.3583 | gn_bb_mean=0.537, gn_bb_max=0.763 | gn_v_mean=4.520, gn_v_max=11.796

  1%|          | 35/5000 [07:49<14:40:45, 10.64s/it]------------------ Training Record ------------------
Epoch: 35/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 7.800
Updated lambda_fail: 7.700
----------------------------------------------------
[RolloutDiag] valid_step=25, valid_ratio=0.737, reward_valid_mean=0.1539, reward_valid_std=2.2321
[BatchDiag] adv_mean=0.8584, adv_std=1.9957, adv_abs_mean=1.7627 | ret_mean=4.8491, ret_std=2.6081 | val_mean=3.9907, val_std=1.5978 | explained_var=0.414486
[GradSplit pre-clip] backbone=0.695512, critic=5.301324
[Loss] pg_loss=-0.063482, entropy_loss=0.000601, value_loss=0.170692
[EpochKL] epoch=0 mean_kl=0.00159 max_kl=0.00294
[EpochKL] epoch=1 mean_kl=0.00287 max_kl=0.00476
[EpochKL] epoch=2 mean_kl=0.00281 max_kl=0.00405
[Time] Env Create Time: 2.8542s |Rollout Collect Time: 4.1077s |Loss & Update :2.0809
[PPODiag] kl_mean=0.0024, kl_p90=0.0040, kl_max=0.0048 | clipfrac_mean=0.021, logratio_std_mean=0.069, ratio_p95_mean=1.079 | valid_ratio_mb_mean=0.737, p10=0.733, min=0.730 | pg_loss_mean=-0.0013, v_loss_mean=0.6773, ent_mean=0.5799 | gn_bb_mean=0.560, gn_bb_max=1.036 | gn_v_mean=3.698, gn_v_max=6.953
[AttnScore] scale=1.0027, C=10.0

  1%|          | 36/5000 [07:58<14:00:51, 10.16s/it]------------------ Training Record ------------------
Epoch: 36/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 7.700
Updated lambda_fail: 7.600
----------------------------------------------------
[RolloutDiag] valid_step=24, valid_ratio=0.763, reward_valid_mean=0.1621, reward_valid_std=2.2370
[BatchDiag] adv_mean=0.7345, adv_std=1.9937, adv_abs_mean=1.7317 | ret_mean=4.9357, ret_std=2.5623 | val_mean=4.2012, val_std=1.3478 | explained_var=0.394575
[GradSplit pre-clip] backbone=0.600260, critic=3.588318
[Loss] pg_loss=-0.101693, entropy_loss=0.000595, value_loss=0.165911
[EpochKL] epoch=0 mean_kl=0.00149 max_kl=0.00332
[EpochKL] epoch=1 mean_kl=0.00264 max_kl=0.00408
[EpochKL] epoch=2 mean_kl=0.00320 max_kl=0.00431
[Time] Env Create Time: 2.8548s |Rollout Collect Time: 3.9430s |Loss & Update :2.0084
[PPODiag] kl_mean=0.0024, kl_p90=0.0040, kl_max=0.0043 | clipfrac_mean=0.019, logratio_std_mean=0.069, ratio_p95_mean=1.068 | valid_ratio_mb_mean=0.763, p10=0.758, min=0.754 | pg_loss_mean=-0.0009, v_loss_mean=0.6518, ent_mean=0.5727 | gn_bb_mean=0.553, gn_bb_max=1.021 | gn_v_mean=2.952, gn_v_max=5.407

  1%|          | 37/5000 [08:06<13:27:01,  9.76s/it]------------------ Training Record ------------------
Epoch: 37/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 7.600
Updated lambda_fail: 7.500
----------------------------------------------------
[RolloutDiag] valid_step=24, valid_ratio=0.756, reward_valid_mean=0.1707, reward_valid_std=2.2435
[BatchDiag] adv_mean=0.7741, adv_std=1.9307, adv_abs_mean=1.7013 | ret_mean=5.0236, ret_std=2.5259 | val_mean=4.2495, val_std=1.5083 | explained_var=0.415712
[GradSplit pre-clip] backbone=0.516927, critic=3.994075
[Loss] pg_loss=-0.085821, entropy_loss=0.000564, value_loss=0.161809
[EpochKL] epoch=0 mean_kl=0.00091 max_kl=0.00196
[EpochKL] epoch=1 mean_kl=0.00216 max_kl=0.00274
[EpochKL] epoch=2 mean_kl=0.00268 max_kl=0.00326
[Time] Env Create Time: 2.6936s |Rollout Collect Time: 3.9347s |Loss & Update :2.0151
[PPODiag] kl_mean=0.0019, kl_p90=0.0032, kl_max=0.0033 | clipfrac_mean=0.017, logratio_std_mean=0.060, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.756, p10=0.751, min=0.749 | pg_loss_mean=-0.0014, v_loss_mean=0.6534, ent_mean=0.5442 | gn_bb_mean=0.306, gn_bb_max=0.517 | gn_v_mean=3.718, gn_v_max=6.458

  1%|          | 38/5000 [08:15<12:59:15,  9.42s/it]------------------ Training Record ------------------
Epoch: 38/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 7.500
Updated lambda_fail: 7.400
----------------------------------------------------
[RolloutDiag] valid_step=24, valid_ratio=0.754, reward_valid_mean=0.1719, reward_valid_std=2.2462
[BatchDiag] adv_mean=0.5889, adv_std=1.9214, adv_abs_mean=1.6466 | ret_mean=5.1147, ret_std=2.4806 | val_mean=4.5258, val_std=1.4379 | explained_var=0.400015
[GradSplit pre-clip] backbone=0.443408, critic=3.017900
[Loss] pg_loss=-0.089709, entropy_loss=0.000534, value_loss=0.152055
[EpochKL] epoch=0 mean_kl=0.00144 max_kl=0.00248
[EpochKL] epoch=1 mean_kl=0.00190 max_kl=0.00240
[EpochKL] epoch=2 mean_kl=0.00246 max_kl=0.00301
[Time] Env Create Time: 2.8508s |Rollout Collect Time: 3.9556s |Loss & Update :2.0195
[PPODiag] kl_mean=0.0019, kl_p90=0.0026, kl_max=0.0030 | clipfrac_mean=0.015, logratio_std_mean=0.062, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.754, p10=0.751, min=0.747 | pg_loss_mean=-0.0014, v_loss_mean=0.6141, ent_mean=0.5185 | gn_bb_mean=0.233, gn_bb_max=0.450 | gn_v_mean=3.143, gn_v_max=5.894

  1%|          | 39/5000 [08:24<12:44:18,  9.24s/it]------------------ Training Record ------------------
Epoch: 39/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 7.400
Updated lambda_fail: 7.300
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.784, reward_valid_mean=0.1794, reward_valid_std=2.2481
[BatchDiag] adv_mean=0.7176, adv_std=1.9060, adv_abs_mean=1.6710 | ret_mean=5.1539, ret_std=2.4689 | val_mean=4.4363, val_std=1.6402 | explained_var=0.403981
[GradSplit pre-clip] backbone=0.338404, critic=4.743067
[Loss] pg_loss=-0.099161, entropy_loss=0.000529, value_loss=0.158755
[EpochKL] epoch=0 mean_kl=0.00190 max_kl=0.00347
[EpochKL] epoch=1 mean_kl=0.00247 max_kl=0.00315
[EpochKL] epoch=2 mean_kl=0.00267 max_kl=0.00335
[Time] Env Create Time: 2.8583s |Rollout Collect Time: 3.7809s |Loss & Update :1.9455
[PPODiag] kl_mean=0.0023, kl_p90=0.0033, kl_max=0.0035 | clipfrac_mean=0.016, logratio_std_mean=0.070, ratio_p95_mean=1.065 | valid_ratio_mb_mean=0.784, p10=0.780, min=0.776 | pg_loss_mean=-0.0015, v_loss_mean=0.6269, ent_mean=0.5155 | gn_bb_mean=0.165, gn_bb_max=0.338 | gn_v_mean=3.303, gn_v_max=5.321

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -7.337, Step: 22, Avg Done Step: 18.77, #CS visited: 1.18
D->C13->C12->C1->C15->C14->C10->C9->C8->R->C2->D->C6->C4->C7->C11->D->C3->C5->D
Eval cost : 4.1873s
-----------------------------
  1%|          | 40/5000 [08:37<14:12:42, 10.31s/it]------------------ Training Record ------------------
Epoch: 40/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 7.300
Updated lambda_fail: 7.200
----------------------------------------------------
[RolloutDiag] valid_step=25, valid_ratio=0.718, reward_valid_mean=0.1895, reward_valid_std=2.2512
[BatchDiag] adv_mean=0.7689, adv_std=1.8874, adv_abs_mean=1.6738 | ret_mean=5.2466, ret_std=2.4341 | val_mean=4.4776, val_std=1.7312 | explained_var=0.398768
[GradSplit pre-clip] backbone=0.279803, critic=5.174872
[Loss] pg_loss=-0.092470, entropy_loss=0.000467, value_loss=0.160800
[EpochKL] epoch=0 mean_kl=0.00105 max_kl=0.00226
[EpochKL] epoch=1 mean_kl=0.00259 max_kl=0.00301
[EpochKL] epoch=2 mean_kl=0.00208 max_kl=0.00250
[Time] Env Create Time: 2.8728s |Rollout Collect Time: 4.0637s |Loss & Update :2.0922
[PPODiag] kl_mean=0.0019, kl_p90=0.0029, kl_max=0.0030 | clipfrac_mean=0.014, logratio_std_mean=0.061, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.718, p10=0.714, min=0.712 | pg_loss_mean=-0.0015, v_loss_mean=0.6301, ent_mean=0.4515 | gn_bb_mean=0.158, gn_bb_max=0.280 | gn_v_mean=3.598, gn_v_max=5.580
[AttnScore] scale=1.0042, C=10.0

  1%|          | 41/5000 [08:46<13:40:39,  9.93s/it]------------------ Training Record ------------------
Epoch: 41/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 7.200
Updated lambda_fail: 7.100
----------------------------------------------------
[RolloutDiag] valid_step=31, valid_ratio=0.576, reward_valid_mean=0.1953, reward_valid_std=2.2561
[BatchDiag] adv_mean=0.8289, adv_std=1.8935, adv_abs_mean=1.7004 | ret_mean=5.2759, ret_std=2.4246 | val_mean=4.4469, val_std=1.7836 | explained_var=0.390141
[GradSplit pre-clip] backbone=0.170928, critic=5.705864
[Loss] pg_loss=-0.108470, entropy_loss=0.000358, value_loss=0.169148
[EpochKL] epoch=0 mean_kl=0.00089 max_kl=0.00238
[EpochKL] epoch=1 mean_kl=0.00312 max_kl=0.00358
[EpochKL] epoch=2 mean_kl=0.00294 max_kl=0.00346
[Time] Env Create Time: 2.8489s |Rollout Collect Time: 4.9828s |Loss & Update :2.5239
[PPODiag] kl_mean=0.0023, kl_p90=0.0034, kl_max=0.0036 | clipfrac_mean=0.014, logratio_std_mean=0.070, ratio_p95_mean=1.064 | valid_ratio_mb_mean=0.576, p10=0.573, min=0.571 | pg_loss_mean=-0.0015, v_loss_mean=0.6259, ent_mean=0.3502 | gn_bb_mean=0.165, gn_bb_max=0.336 | gn_v_mean=2.162, gn_v_max=5.706

  1%|          | 42/5000 [08:56<13:51:03, 10.06s/it]------------------ Training Record ------------------
Epoch: 42/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 7.100
Updated lambda_fail: 7.000
----------------------------------------------------
[RolloutDiag] valid_step=24, valid_ratio=0.743, reward_valid_mean=0.1997, reward_valid_std=2.2570
[BatchDiag] adv_mean=0.6609, adv_std=1.8449, adv_abs_mean=1.6132 | ret_mean=5.3827, ret_std=2.3677 | val_mean=4.7219, val_std=1.7169 | explained_var=0.392824
[GradSplit pre-clip] backbone=0.165596, critic=5.217623
[Loss] pg_loss=-0.123971, entropy_loss=0.000444, value_loss=0.152183
[EpochKL] epoch=0 mean_kl=0.00085 max_kl=0.00158
[EpochKL] epoch=1 mean_kl=0.00166 max_kl=0.00210
[EpochKL] epoch=2 mean_kl=0.00189 max_kl=0.00244
[Time] Env Create Time: 2.6919s |Rollout Collect Time: 3.8999s |Loss & Update :2.0064
[PPODiag] kl_mean=0.0015, kl_p90=0.0021, kl_max=0.0024 | clipfrac_mean=0.011, logratio_std_mean=0.054, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.743, p10=0.737, min=0.736 | pg_loss_mean=-0.0016, v_loss_mean=0.5818, ent_mean=0.4356 | gn_bb_mean=0.223, gn_bb_max=0.456 | gn_v_mean=2.258, gn_v_max=5.218

  1%|          | 43/5000 [09:05<13:14:44,  9.62s/it]------------------ Training Record ------------------
Epoch: 43/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 7.000
Updated lambda_fail: 6.900
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.773, reward_valid_mean=0.2052, reward_valid_std=2.2570
[BatchDiag] adv_mean=0.6088, adv_std=1.7921, adv_abs_mean=1.5610 | ret_mean=5.4559, ret_std=2.3259 | val_mean=4.8471, val_std=1.6903 | explained_var=0.406289
[GradSplit pre-clip] backbone=0.234335, critic=5.463677
[Loss] pg_loss=-0.138886, entropy_loss=0.000450, value_loss=0.145674
[EpochKL] epoch=0 mean_kl=0.00113 max_kl=0.00267
[EpochKL] epoch=1 mean_kl=0.00224 max_kl=0.00370
[EpochKL] epoch=2 mean_kl=0.00186 max_kl=0.00275
[Time] Env Create Time: 2.8282s |Rollout Collect Time: 3.7691s |Loss & Update :1.9529
[PPODiag] kl_mean=0.0017, kl_p90=0.0027, kl_max=0.0037 | clipfrac_mean=0.017, logratio_std_mean=0.057, ratio_p95_mean=1.071 | valid_ratio_mb_mean=0.773, p10=0.767, min=0.764 | pg_loss_mean=-0.0015, v_loss_mean=0.5588, ent_mean=0.4394 | gn_bb_mean=0.456, gn_bb_max=1.034 | gn_v_mean=2.335, gn_v_max=5.464

  1%|          | 44/5000 [09:13<12:48:05,  9.30s/it]------------------ Training Record ------------------
Epoch: 44/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 6.900
Updated lambda_fail: 6.800
----------------------------------------------------
[RolloutDiag] valid_step=38, valid_ratio=0.467, reward_valid_mean=0.2108, reward_valid_std=2.2589
[BatchDiag] adv_mean=0.4668, adv_std=1.7215, adv_abs_mean=1.4645 | ret_mean=5.5529, ret_std=2.2777 | val_mean=5.0862, val_std=1.5801 | explained_var=0.428747
[GradSplit pre-clip] backbone=0.371267, critic=4.847203
[Loss] pg_loss=-0.126789, entropy_loss=0.000266, value_loss=0.134453
[EpochKL] epoch=0 mean_kl=0.00228 max_kl=0.00607
[EpochKL] epoch=1 mean_kl=0.00270 max_kl=0.00609
[EpochKL] epoch=2 mean_kl=0.00457 max_kl=0.00796
[Time] Env Create Time: 2.8509s |Rollout Collect Time: 6.0297s |Loss & Update :3.0472
[PPODiag] kl_mean=0.0032, kl_p90=0.0061, kl_max=0.0080 | clipfrac_mean=0.033, logratio_std_mean=0.076, ratio_p95_mean=1.088 | valid_ratio_mb_mean=0.467, p10=0.464, min=0.463 | pg_loss_mean=-0.0003, v_loss_mean=0.5131, ent_mean=0.2559 | gn_bb_mean=1.084, gn_bb_max=2.219 | gn_v_mean=2.560, gn_v_max=5.069

  1%|          | 45/5000 [09:25<13:53:04, 10.09s/it]------------------ Training Record ------------------
Epoch: 45/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 6.800
Updated lambda_fail: 6.700
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.771, reward_valid_mean=0.2130, reward_valid_std=2.2592
[BatchDiag] adv_mean=0.3543, adv_std=1.6571, adv_abs_mean=1.3882 | ret_mean=5.6154, ret_std=2.2421 | val_mean=5.2611, val_std=1.5115 | explained_var=0.453737
[GradSplit pre-clip] backbone=0.636774, critic=4.419337
[Loss] pg_loss=-0.136928, entropy_loss=0.000417, value_loss=0.121808
[EpochKL] epoch=0 mean_kl=0.00221 max_kl=0.00384
[EpochKL] epoch=1 mean_kl=0.00316 max_kl=0.00540
[EpochKL] epoch=2 mean_kl=0.00208 max_kl=0.00396
[Time] Env Create Time: 2.7139s |Rollout Collect Time: 3.7850s |Loss & Update :1.9460
[PPODiag] kl_mean=0.0025, kl_p90=0.0041, kl_max=0.0054 | clipfrac_mean=0.026, logratio_std_mean=0.068, ratio_p95_mean=1.076 | valid_ratio_mb_mean=0.771, p10=0.766, min=0.761 | pg_loss_mean=-0.0007, v_loss_mean=0.4744, ent_mean=0.4101 | gn_bb_mean=1.061, gn_bb_max=2.523 | gn_v_mean=2.194, gn_v_max=4.419
[AttnScore] scale=1.0056, C=10.0

  1%|          | 46/5000 [09:34<13:12:13,  9.60s/it]------------------ Training Record ------------------
Epoch: 46/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 6.700
Updated lambda_fail: 6.600
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.767, reward_valid_mean=0.2225, reward_valid_std=2.2624
[BatchDiag] adv_mean=0.3813, adv_std=1.6011, adv_abs_mean=1.3455 | ret_mean=5.7042, ret_std=2.2068 | val_mean=5.3229, val_std=1.5907 | explained_var=0.473595
[GradSplit pre-clip] backbone=0.342965, critic=5.668230
[Loss] pg_loss=-0.151796, entropy_loss=0.000403, value_loss=0.118087
[EpochKL] epoch=0 mean_kl=0.00141 max_kl=0.00298
[EpochKL] epoch=1 mean_kl=0.00323 max_kl=0.00526
[EpochKL] epoch=2 mean_kl=0.00275 max_kl=0.00368
[Time] Env Create Time: 2.8559s |Rollout Collect Time: 3.7558s |Loss & Update :1.9600
[PPODiag] kl_mean=0.0025, kl_p90=0.0043, kl_max=0.0053 | clipfrac_mean=0.026, logratio_std_mean=0.068, ratio_p95_mean=1.077 | valid_ratio_mb_mean=0.767, p10=0.762, min=0.759 | pg_loss_mean=-0.0008, v_loss_mean=0.4638, ent_mean=0.3922 | gn_bb_mean=1.013, gn_bb_max=2.250 | gn_v_mean=3.130, gn_v_max=7.045

  1%|          | 47/5000 [09:42<12:46:44,  9.29s/it]------------------ Training Record ------------------
Epoch: 47/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 6.600
Updated lambda_fail: 6.500
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.767, reward_valid_mean=0.2269, reward_valid_std=2.2637
[BatchDiag] adv_mean=0.2514, adv_std=1.5718, adv_abs_mean=1.2998 | ret_mean=5.7926, ret_std=2.1631 | val_mean=5.5412, val_std=1.5492 | explained_var=0.471976
[GradSplit pre-clip] backbone=0.433229, critic=3.922891
[Loss] pg_loss=-0.120328, entropy_loss=0.000379, value_loss=0.111885
[EpochKL] epoch=0 mean_kl=0.00319 max_kl=0.00799
[EpochKL] epoch=1 mean_kl=0.00407 max_kl=0.00853
[EpochKL] epoch=2 mean_kl=0.00315 max_kl=0.00525
[Time] Env Create Time: 2.8498s |Rollout Collect Time: 3.7288s |Loss & Update :1.9555
[PPODiag] kl_mean=0.0035, kl_p90=0.0062, kl_max=0.0085 | clipfrac_mean=0.033, logratio_std_mean=0.081, ratio_p95_mean=1.080 | valid_ratio_mb_mean=0.767, p10=0.761, min=0.760 | pg_loss_mean=0.0001, v_loss_mean=0.4455, ent_mean=0.3779 | gn_bb_mean=1.562, gn_bb_max=2.809 | gn_v_mean=2.652, gn_v_max=5.126

  1%|          | 48/5000 [09:51<12:27:55,  9.06s/it]------------------ Training Record ------------------
Epoch: 48/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 6.500
Updated lambda_fail: 6.400
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.767, reward_valid_mean=0.2250, reward_valid_std=2.2602
[BatchDiag] adv_mean=0.2501, adv_std=1.5762, adv_abs_mean=1.2979 | ret_mean=5.7823, ret_std=2.1685 | val_mean=5.5322, val_std=1.6240 | explained_var=0.471661
[GradSplit pre-clip] backbone=0.484200, critic=4.588901
[Loss] pg_loss=-0.146227, entropy_loss=0.000377, value_loss=0.111711
[EpochKL] epoch=0 mean_kl=0.00265 max_kl=0.00642
[EpochKL] epoch=1 mean_kl=0.00210 max_kl=0.00512
[EpochKL] epoch=2 mean_kl=0.00295 max_kl=0.00679
[Time] Env Create Time: 2.8535s |Rollout Collect Time: 3.7209s |Loss & Update :1.9480
[PPODiag] kl_mean=0.0026, kl_p90=0.0049, kl_max=0.0068 | clipfrac_mean=0.026, logratio_std_mean=0.069, ratio_p95_mean=1.073 | valid_ratio_mb_mean=0.767, p10=0.761, min=0.760 | pg_loss_mean=-0.0008, v_loss_mean=0.4497, ent_mean=0.3680 | gn_bb_mean=1.162, gn_bb_max=2.666 | gn_v_mean=3.039, gn_v_max=6.992

  1%|          | 49/5000 [09:59<12:14:25,  8.90s/it]------------------ Training Record ------------------
Epoch: 49/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 6.400
Updated lambda_fail: 6.300
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.766, reward_valid_mean=0.2330, reward_valid_std=2.2633
[BatchDiag] adv_mean=0.0125, adv_std=1.5302, adv_abs_mean=1.2363 | ret_mean=5.9254, ret_std=2.0908 | val_mean=5.9129, val_std=1.4120 | explained_var=0.464371
[GradSplit pre-clip] backbone=0.506991, critic=2.188007
[Loss] pg_loss=-0.174224, entropy_loss=0.000362, value_loss=0.102173
[EarlyStop] epoch=0 mean_kl=0.02674 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02674 max_kl=0.07576
[Time] Env Create Time: 2.7169s |Rollout Collect Time: 3.7836s |Loss & Update :0.6852
[PPODiag] kl_mean=0.0267, kl_p90=0.0570, kl_max=0.0758 | clipfrac_mean=0.087, logratio_std_mean=0.217, ratio_p95_mean=1.140 | valid_ratio_mb_mean=0.766, p10=0.759, min=0.758 | pg_loss_mean=0.0110, v_loss_mean=0.4218, ent_mean=0.3563 | gn_bb_mean=3.233, gn_bb_max=4.456 | gn_v_mean=2.534, gn_v_max=3.870

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -6.715, Step: 21, Avg Done Step: 18.54, #CS visited: 0.78
D->C12->C1->C15->C14->C5->C2->C8->D->C13->C4->C7->C11->C10->C3->D->C6->C9->D
Eval cost : 4.0223s
-----------------------------
  1%|          | 50/5000 [10:10<13:12:38,  9.61s/it]------------------ Training Record ------------------
Epoch: 50/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 6.300
Updated lambda_fail: 6.200
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.802, reward_valid_mean=0.2310, reward_valid_std=2.2593
[BatchDiag] adv_mean=0.0945, adv_std=1.5627, adv_abs_mean=1.2679 | ret_mean=5.9001, ret_std=2.1183 | val_mean=5.8056, val_std=1.5319 | explained_var=0.455801
[GradSplit pre-clip] backbone=0.498260, critic=2.113709
[Loss] pg_loss=-0.100569, entropy_loss=0.000375, value_loss=0.107764
[EpochKL] epoch=0 mean_kl=0.00848 max_kl=0.02552
[EarlyStop] epoch=1 mean_kl=0.01026 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01026 max_kl=0.02921
[Time] Env Create Time: 2.8578s |Rollout Collect Time: 3.6098s |Loss & Update :1.2710
[PPODiag] kl_mean=0.0094, kl_p90=0.0243, kl_max=0.0292 | clipfrac_mean=0.052, logratio_std_mean=0.126, ratio_p95_mean=1.096 | valid_ratio_mb_mean=0.802, p10=0.796, min=0.795 | pg_loss_mean=0.0027, v_loss_mean=0.4318, ent_mean=0.3722 | gn_bb_mean=2.090, gn_bb_max=3.688 | gn_v_mean=1.419, gn_v_max=2.487
[AttnScore] scale=1.0067, C=10.0

  1%|          | 51/5000 [10:18<12:26:14,  9.05s/it]------------------ Training Record ------------------
Epoch: 51/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 6.200
Updated lambda_fail: 6.100
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.766, reward_valid_mean=0.2351, reward_valid_std=2.2578
[BatchDiag] adv_mean=0.1093, adv_std=1.5729, adv_abs_mean=1.2731 | ret_mean=5.9004, ret_std=2.0922 | val_mean=5.7911, val_std=1.5844 | explained_var=0.434778
[GradSplit pre-clip] backbone=0.528839, critic=2.809866
[Loss] pg_loss=-0.153483, entropy_loss=0.000348, value_loss=0.109008
[EpochKL] epoch=0 mean_kl=0.00517 max_kl=0.00917
[EpochKL] epoch=1 mean_kl=0.00352 max_kl=0.01080
[EpochKL] epoch=2 mean_kl=0.00245 max_kl=0.00412
[Time] Env Create Time: 2.8671s |Rollout Collect Time: 3.7550s |Loss & Update :1.9454
[PPODiag] kl_mean=0.0037, kl_p90=0.0084, kl_max=0.0108 | clipfrac_mean=0.031, logratio_std_mean=0.081, ratio_p95_mean=1.072 | valid_ratio_mb_mean=0.766, p10=0.762, min=0.757 | pg_loss_mean=0.0003, v_loss_mean=0.4379, ent_mean=0.3446 | gn_bb_mean=1.353, gn_bb_max=3.184 | gn_v_mean=3.012, gn_v_max=5.350

  1%|          | 52/5000 [10:27<12:14:13,  8.90s/it]------------------ Training Record ------------------
Epoch: 52/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 6.100
Updated lambda_fail: 6.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.767, reward_valid_mean=0.2366, reward_valid_std=2.2571
[BatchDiag] adv_mean=-0.0625, adv_std=1.5463, adv_abs_mean=1.2429 | ret_mean=5.9844, ret_std=2.0520 | val_mean=6.0470, val_std=1.4341 | explained_var=0.432180
[GradSplit pre-clip] backbone=0.536532, critic=1.121547
[Loss] pg_loss=-0.145325, entropy_loss=0.000329, value_loss=0.101321
[EpochKL] epoch=0 mean_kl=0.00264 max_kl=0.00660
[EpochKL] epoch=1 mean_kl=0.00679 max_kl=0.01081
[EpochKL] epoch=2 mean_kl=0.00548 max_kl=0.01260
[Time] Env Create Time: 2.8504s |Rollout Collect Time: 3.7384s |Loss & Update :1.9370
[PPODiag] kl_mean=0.0050, kl_p90=0.0096, kl_max=0.0126 | clipfrac_mean=0.036, logratio_std_mean=0.096, ratio_p95_mean=1.076 | valid_ratio_mb_mean=0.767, p10=0.763, min=0.758 | pg_loss_mean=0.0015, v_loss_mean=0.4225, ent_mean=0.3329 | gn_bb_mean=1.872, gn_bb_max=3.301 | gn_v_mean=2.504, gn_v_max=5.408

  1%|          | 53/5000 [10:35<12:04:45,  8.79s/it]------------------ Training Record ------------------
Epoch: 53/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 6.000
Updated lambda_fail: 5.900
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.764, reward_valid_mean=0.2407, reward_valid_std=2.2602
[BatchDiag] adv_mean=-0.0600, adv_std=1.5308, adv_abs_mean=1.2294 | ret_mean=6.0085, ret_std=2.0347 | val_mean=6.0685, val_std=1.4095 | explained_var=0.433984
[GradSplit pre-clip] backbone=0.468173, critic=1.016263
[Loss] pg_loss=-0.123089, entropy_loss=0.000320, value_loss=0.101418
[EpochKL] epoch=0 mean_kl=0.00171 max_kl=0.00496
[EpochKL] epoch=1 mean_kl=0.00189 max_kl=0.00307
[EpochKL] epoch=2 mean_kl=0.00231 max_kl=0.00379
[Time] Env Create Time: 2.7053s |Rollout Collect Time: 3.7768s |Loss & Update :1.9423
[PPODiag] kl_mean=0.0020, kl_p90=0.0030, kl_max=0.0050 | clipfrac_mean=0.021, logratio_std_mean=0.061, ratio_p95_mean=1.060 | valid_ratio_mb_mean=0.764, p10=0.760, min=0.755 | pg_loss_mean=-0.0005, v_loss_mean=0.4087, ent_mean=0.3220 | gn_bb_mean=1.020, gn_bb_max=2.066 | gn_v_mean=1.228, gn_v_max=2.950

  1%|          | 54/5000 [10:44<11:55:34,  8.68s/it]------------------ Training Record ------------------
Epoch: 54/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 5.900
Updated lambda_fail: 5.800
----------------------------------------------------
[RolloutDiag] valid_step=25, valid_ratio=0.704, reward_valid_mean=0.2414, reward_valid_std=2.2588
[BatchDiag] adv_mean=-0.0113, adv_std=1.5213, adv_abs_mean=1.2130 | ret_mean=6.0111, ret_std=2.0397 | val_mean=6.0224, val_std=1.4806 | explained_var=0.443724
[GradSplit pre-clip] backbone=0.330097, critic=1.274108
[Loss] pg_loss=-0.116293, entropy_loss=0.000290, value_loss=0.104403
[EpochKL] epoch=0 mean_kl=0.00187 max_kl=0.00331
[EpochKL] epoch=1 mean_kl=0.00159 max_kl=0.00225
[EpochKL] epoch=2 mean_kl=0.00285 max_kl=0.00448
[Time] Env Create Time: 2.8560s |Rollout Collect Time: 4.0429s |Loss & Update :2.1007
[PPODiag] kl_mean=0.0021, kl_p90=0.0032, kl_max=0.0045 | clipfrac_mean=0.021, logratio_std_mean=0.064, ratio_p95_mean=1.059 | valid_ratio_mb_mean=0.704, p10=0.700, min=0.699 | pg_loss_mean=-0.0003, v_loss_mean=0.4043, ent_mean=0.2888 | gn_bb_mean=1.007, gn_bb_max=2.283 | gn_v_mean=1.597, gn_v_max=3.865

  1%|          | 55/5000 [10:53<12:03:19,  8.78s/it]------------------ Training Record ------------------
Epoch: 55/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 5.800
Updated lambda_fail: 5.700
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.764, reward_valid_mean=0.2437, reward_valid_std=2.2602
[BatchDiag] adv_mean=0.0142, adv_std=1.5298, adv_abs_mean=1.2266 | ret_mean=6.0255, ret_std=2.0397 | val_mean=6.0113, val_std=1.5300 | explained_var=0.437469
[GradSplit pre-clip] backbone=0.798627, critic=1.603161
[Loss] pg_loss=-0.124663, entropy_loss=0.000305, value_loss=0.103976
[EpochKL] epoch=0 mean_kl=0.00281 max_kl=0.00538
[EpochKL] epoch=1 mean_kl=0.00332 max_kl=0.00573
[EpochKL] epoch=2 mean_kl=0.00506 max_kl=0.01095
[Time] Env Create Time: 2.8771s |Rollout Collect Time: 3.7592s |Loss & Update :1.9396
[PPODiag] kl_mean=0.0037, kl_p90=0.0057, kl_max=0.0109 | clipfrac_mean=0.033, logratio_std_mean=0.084, ratio_p95_mean=1.074 | valid_ratio_mb_mean=0.764, p10=0.759, min=0.755 | pg_loss_mean=0.0007, v_loss_mean=0.4072, ent_mean=0.3062 | gn_bb_mean=1.606, gn_bb_max=3.049 | gn_v_mean=1.239, gn_v_max=2.812
[AttnScore] scale=1.0078, C=10.0

  1%|          | 56/5000 [11:01<11:58:14,  8.72s/it]------------------ Training Record ------------------
Epoch: 56/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 5.700
Updated lambda_fail: 5.600
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.797, reward_valid_mean=0.2513, reward_valid_std=2.2617
[BatchDiag] adv_mean=-0.0118, adv_std=1.4958, adv_abs_mean=1.1968 | ret_mean=6.1130, ret_std=1.9977 | val_mean=6.1248, val_std=1.4940 | explained_var=0.439371
[GradSplit pre-clip] backbone=0.512012, critic=1.245066
[Loss] pg_loss=-0.119995, entropy_loss=0.000299, value_loss=0.095117
[EpochKL] epoch=0 mean_kl=0.00157 max_kl=0.00355
[EpochKL] epoch=1 mean_kl=0.00122 max_kl=0.00248
[EpochKL] epoch=2 mean_kl=0.00159 max_kl=0.00327
[Time] Env Create Time: 2.7091s |Rollout Collect Time: 3.5947s |Loss & Update :1.8794
[PPODiag] kl_mean=0.0015, kl_p90=0.0029, kl_max=0.0035 | clipfrac_mean=0.015, logratio_std_mean=0.052, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.797, p10=0.792, min=0.789 | pg_loss_mean=-0.0005, v_loss_mean=0.3921, ent_mean=0.3054 | gn_bb_mean=0.710, gn_bb_max=2.299 | gn_v_mean=0.857, gn_v_max=2.691

  1%|          | 57/5000 [11:09<11:44:55,  8.56s/it]------------------ Training Record ------------------
Epoch: 57/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 5.600
Updated lambda_fail: 5.500
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.763, reward_valid_mean=0.2492, reward_valid_std=2.2614
[BatchDiag] adv_mean=0.0635, adv_std=1.5179, adv_abs_mean=1.2113 | ret_mean=6.0664, ret_std=2.0230 | val_mean=6.0029, val_std=1.5978 | explained_var=0.437000
[GradSplit pre-clip] backbone=0.455889, critic=1.922467
[Loss] pg_loss=-0.118870, entropy_loss=0.000280, value_loss=0.098965
[EpochKL] epoch=0 mean_kl=0.00097 max_kl=0.00215
[EpochKL] epoch=1 mean_kl=0.00161 max_kl=0.00194
[EpochKL] epoch=2 mean_kl=0.00181 max_kl=0.00330
[Time] Env Create Time: 2.8859s |Rollout Collect Time: 3.7426s |Loss & Update :1.9485
[PPODiag] kl_mean=0.0015, kl_p90=0.0021, kl_max=0.0033 | clipfrac_mean=0.015, logratio_std_mean=0.053, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.763, p10=0.758, min=0.751 | pg_loss_mean=-0.0008, v_loss_mean=0.4028, ent_mean=0.2835 | gn_bb_mean=0.663, gn_bb_max=1.425 | gn_v_mean=1.623, gn_v_max=3.922

  1%|          | 58/5000 [11:18<11:45:17,  8.56s/it]------------------ Training Record ------------------
Epoch: 58/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 5.500
Updated lambda_fail: 5.400
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.762, reward_valid_mean=0.2519, reward_valid_std=2.2598
[BatchDiag] adv_mean=-0.0518, adv_std=1.4818, adv_abs_mean=1.1775 | ret_mean=6.1266, ret_std=1.9867 | val_mean=6.1784, val_std=1.4905 | explained_var=0.443659
[GradSplit pre-clip] backbone=0.394300, critic=1.120268
[Loss] pg_loss=-0.127834, entropy_loss=0.000278, value_loss=0.092882
[EpochKL] epoch=0 mean_kl=0.00137 max_kl=0.00453
[EpochKL] epoch=1 mean_kl=0.00199 max_kl=0.00478
[EpochKL] epoch=2 mean_kl=0.00166 max_kl=0.00260
[Time] Env Create Time: 2.8659s |Rollout Collect Time: 3.7538s |Loss & Update :1.9540
[PPODiag] kl_mean=0.0017, kl_p90=0.0026, kl_max=0.0048 | clipfrac_mean=0.017, logratio_std_mean=0.055, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.762, p10=0.757, min=0.755 | pg_loss_mean=-0.0005, v_loss_mean=0.3812, ent_mean=0.2720 | gn_bb_mean=0.765, gn_bb_max=2.050 | gn_v_mean=0.737, gn_v_max=1.520

  1%|          | 59/5000 [11:27<11:45:25,  8.57s/it]------------------ Training Record ------------------
Epoch: 59/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 5.400
Updated lambda_fail: 5.300
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.796, reward_valid_mean=0.2567, reward_valid_std=2.2616
[BatchDiag] adv_mean=-0.0261, adv_std=1.4555, adv_abs_mean=1.1557 | ret_mean=6.1603, ret_std=1.9664 | val_mean=6.1864, val_std=1.4678 | explained_var=0.452132
[GradSplit pre-clip] backbone=0.304222, critic=1.347539
[Loss] pg_loss=-0.162826, entropy_loss=0.000273, value_loss=0.094076
[EpochKL] epoch=0 mean_kl=0.00126 max_kl=0.00181
[EpochKL] epoch=1 mean_kl=0.00237 max_kl=0.00336
[EpochKL] epoch=2 mean_kl=0.00373 max_kl=0.00569
[Time] Env Create Time: 2.8793s |Rollout Collect Time: 3.5968s |Loss & Update :1.8856
[PPODiag] kl_mean=0.0025, kl_p90=0.0048, kl_max=0.0057 | clipfrac_mean=0.025, logratio_std_mean=0.068, ratio_p95_mean=1.064 | valid_ratio_mb_mean=0.796, p10=0.791, min=0.787 | pg_loss_mean=0.0001, v_loss_mean=0.3712, ent_mean=0.2723 | gn_bb_mean=1.157, gn_bb_max=2.432 | gn_v_mean=0.772, gn_v_max=2.225

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -6.575, Step: 21, Avg Done Step: 18.57, #CS visited: 0.66
D->C12->C1->C15->C14->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->C3->D
Eval cost : 4.0123s
-----------------------------
  1%|          | 60/5000 [11:39<13:20:43,  9.73s/it]------------------ Training Record ------------------
Epoch: 60/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 5.300
Updated lambda_fail: 5.200
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.798, reward_valid_mean=0.2576, reward_valid_std=2.2576
[BatchDiag] adv_mean=-0.0729, adv_std=1.4109, adv_abs_mean=1.1197 | ret_mean=6.1932, ret_std=1.9486 | val_mean=6.2660, val_std=1.4143 | explained_var=0.475778
[GradSplit pre-clip] backbone=0.335072, critic=0.637675
[Loss] pg_loss=-0.106378, entropy_loss=0.000271, value_loss=0.085755
[EpochKL] epoch=0 mean_kl=0.00653 max_kl=0.01044
[EpochKL] epoch=1 mean_kl=0.00412 max_kl=0.00763
[EpochKL] epoch=2 mean_kl=0.00198 max_kl=0.00246
[Time] Env Create Time: 2.6961s |Rollout Collect Time: 3.5630s |Loss & Update :1.8715
[PPODiag] kl_mean=0.0042, kl_p90=0.0084, kl_max=0.0104 | clipfrac_mean=0.035, logratio_std_mean=0.088, ratio_p95_mean=1.076 | valid_ratio_mb_mean=0.798, p10=0.793, min=0.789 | pg_loss_mean=0.0014, v_loss_mean=0.3563, ent_mean=0.2655 | gn_bb_mean=1.631, gn_bb_max=3.147 | gn_v_mean=0.917, gn_v_max=2.492
[AttnScore] scale=1.0090, C=10.0

  1%|          | 61/5000 [11:47<12:41:11,  9.25s/it]------------------ Training Record ------------------
Epoch: 61/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 5.200
Updated lambda_fail: 5.100
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.797, reward_valid_mean=0.2576, reward_valid_std=2.2592
[BatchDiag] adv_mean=-0.2110, adv_std=1.3948, adv_abs_mean=1.1100 | ret_mean=6.2234, ret_std=1.9236 | val_mean=6.4345, val_std=1.3575 | explained_var=0.474260
[GradSplit pre-clip] backbone=0.343549, critic=0.290155
[Loss] pg_loss=-0.133123, entropy_loss=0.000259, value_loss=0.084190
[EpochKL] epoch=0 mean_kl=0.00173 max_kl=0.00373
[EpochKL] epoch=1 mean_kl=0.00563 max_kl=0.01440
[EpochKL] epoch=2 mean_kl=0.00403 max_kl=0.00687
[Time] Env Create Time: 2.8298s |Rollout Collect Time: 3.6006s |Loss & Update :1.8899
[PPODiag] kl_mean=0.0038, kl_p90=0.0066, kl_max=0.0144 | clipfrac_mean=0.032, logratio_std_mean=0.082, ratio_p95_mean=1.071 | valid_ratio_mb_mean=0.797, p10=0.793, min=0.789 | pg_loss_mean=0.0008, v_loss_mean=0.3553, ent_mean=0.2610 | gn_bb_mean=1.455, gn_bb_max=3.123 | gn_v_mean=1.224, gn_v_max=2.939

  1%|          | 62/5000 [11:56<12:18:10,  8.97s/it]------------------ Training Record ------------------
Epoch: 62/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 5.100
Updated lambda_fail: 5.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.763, reward_valid_mean=0.2604, reward_valid_std=2.2576
[BatchDiag] adv_mean=-0.0111, adv_std=1.3969, adv_abs_mean=1.1061 | ret_mean=6.1828, ret_std=1.9623 | val_mean=6.1939, val_std=1.4197 | explained_var=0.493289
[GradSplit pre-clip] backbone=0.376523, critic=0.902364
[Loss] pg_loss=-0.088743, entropy_loss=0.000247, value_loss=0.087019
[EpochKL] epoch=0 mean_kl=0.00132 max_kl=0.00250
[EpochKL] epoch=1 mean_kl=0.00326 max_kl=0.00466
[EpochKL] epoch=2 mean_kl=0.00258 max_kl=0.00345
[Time] Env Create Time: 2.8551s |Rollout Collect Time: 3.7129s |Loss & Update :1.9618
[PPODiag] kl_mean=0.0024, kl_p90=0.0034, kl_max=0.0047 | clipfrac_mean=0.025, logratio_std_mean=0.067, ratio_p95_mean=1.063 | valid_ratio_mb_mean=0.763, p10=0.758, min=0.757 | pg_loss_mean=0.0001, v_loss_mean=0.3511, ent_mean=0.2475 | gn_bb_mean=1.207, gn_bb_max=1.925 | gn_v_mean=1.055, gn_v_max=2.955

  1%|▏         | 63/5000 [12:04<12:07:10,  8.84s/it]------------------ Training Record ------------------
Epoch: 63/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 5.000
Updated lambda_fail: 4.900
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.795, reward_valid_mean=0.2657, reward_valid_std=2.2624
[BatchDiag] adv_mean=0.0171, adv_std=1.3745, adv_abs_mean=1.0874 | ret_mean=6.2409, ret_std=1.9381 | val_mean=6.2238, val_std=1.4639 | explained_var=0.497013
[GradSplit pre-clip] backbone=0.337599, critic=1.633022
[Loss] pg_loss=-0.132432, entropy_loss=0.000246, value_loss=0.084714
[EpochKL] epoch=0 mean_kl=0.00251 max_kl=0.00566
[EpochKL] epoch=1 mean_kl=0.00326 max_kl=0.00688
[EpochKL] epoch=2 mean_kl=0.00342 max_kl=0.00577
[Time] Env Create Time: 2.8708s |Rollout Collect Time: 3.5747s |Loss & Update :1.8742
[PPODiag] kl_mean=0.0031, kl_p90=0.0055, kl_max=0.0069 | clipfrac_mean=0.028, logratio_std_mean=0.076, ratio_p95_mean=1.065 | valid_ratio_mb_mean=0.795, p10=0.791, min=0.788 | pg_loss_mean=0.0007, v_loss_mean=0.3415, ent_mean=0.2461 | gn_bb_mean=1.551, gn_bb_max=2.838 | gn_v_mean=1.054, gn_v_max=3.041

  1%|▏         | 64/5000 [12:12<11:54:16,  8.68s/it]------------------ Training Record ------------------
Epoch: 64/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 4.900
Updated lambda_fail: 4.800
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.795, reward_valid_mean=0.2660, reward_valid_std=2.2619
[BatchDiag] adv_mean=-0.1013, adv_std=1.3354, adv_abs_mean=1.0508 | ret_mean=6.2790, ret_std=1.9064 | val_mean=6.3803, val_std=1.4277 | explained_var=0.509354
[GradSplit pre-clip] backbone=0.368250, critic=1.030360
[Loss] pg_loss=-0.167621, entropy_loss=0.000246, value_loss=0.074605
[EpochKL] epoch=0 mean_kl=0.00457 max_kl=0.00844
[EpochKL] epoch=1 mean_kl=0.00484 max_kl=0.00939
[EpochKL] epoch=2 mean_kl=0.00519 max_kl=0.00937
[Time] Env Create Time: 2.6881s |Rollout Collect Time: 3.5482s |Loss & Update :1.8858
[PPODiag] kl_mean=0.0049, kl_p90=0.0079, kl_max=0.0094 | clipfrac_mean=0.038, logratio_std_mean=0.097, ratio_p95_mean=1.078 | valid_ratio_mb_mean=0.795, p10=0.790, min=0.785 | pg_loss_mean=0.0015, v_loss_mean=0.3295, ent_mean=0.2420 | gn_bb_mean=1.677, gn_bb_max=2.824 | gn_v_mean=0.961, gn_v_max=2.657

  1%|▏         | 65/5000 [12:20<11:40:18,  8.51s/it]------------------ Training Record ------------------
Epoch: 65/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 4.800
Updated lambda_fail: 4.700
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.759, reward_valid_mean=0.2682, reward_valid_std=2.2651
[BatchDiag] adv_mean=-0.0787, adv_std=1.3223, adv_abs_mean=1.0372 | ret_mean=6.3040, ret_std=1.9055 | val_mean=6.3827, val_std=1.4492 | explained_var=0.518441
[GradSplit pre-clip] backbone=0.294899, critic=1.184262
[Loss] pg_loss=-0.170769, entropy_loss=0.000234, value_loss=0.076019
[EpochKL] epoch=0 mean_kl=0.00154 max_kl=0.00338
[EpochKL] epoch=1 mean_kl=0.00273 max_kl=0.00457
[EpochKL] epoch=2 mean_kl=0.00318 max_kl=0.00491
[Time] Env Create Time: 2.8513s |Rollout Collect Time: 3.7415s |Loss & Update :1.9690
[PPODiag] kl_mean=0.0025, kl_p90=0.0044, kl_max=0.0049 | clipfrac_mean=0.024, logratio_std_mean=0.069, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.759, p10=0.754, min=0.750 | pg_loss_mean=0.0001, v_loss_mean=0.3213, ent_mean=0.2239 | gn_bb_mean=1.188, gn_bb_max=1.980 | gn_v_mean=0.904, gn_v_max=2.073
[AttnScore] scale=1.0102, C=10.0

  1%|▏         | 66/5000 [12:29<11:41:21,  8.53s/it]------------------ Training Record ------------------
Epoch: 66/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 4.700
Updated lambda_fail: 4.600
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.795, reward_valid_mean=0.2660, reward_valid_std=2.2632
[BatchDiag] adv_mean=-0.0184, adv_std=1.3340, adv_abs_mean=1.0460 | ret_mean=6.2672, ret_std=1.9282 | val_mean=6.2856, val_std=1.4593 | explained_var=0.521354
[GradSplit pre-clip] backbone=0.397879, critic=1.393583
[Loss] pg_loss=-0.164411, entropy_loss=0.000230, value_loss=0.075684
[EpochKL] epoch=0 mean_kl=0.00378 max_kl=0.00788
[EpochKL] epoch=1 mean_kl=0.00640 max_kl=0.01060
[EpochKL] epoch=2 mean_kl=0.00614 max_kl=0.01625
[Time] Env Create Time: 2.8711s |Rollout Collect Time: 3.5818s |Loss & Update :1.8582
[PPODiag] kl_mean=0.0054, kl_p90=0.0080, kl_max=0.0163 | clipfrac_mean=0.038, logratio_std_mean=0.101, ratio_p95_mean=1.073 | valid_ratio_mb_mean=0.795, p10=0.789, min=0.785 | pg_loss_mean=0.0017, v_loss_mean=0.3250, ent_mean=0.2321 | gn_bb_mean=1.697, gn_bb_max=2.582 | gn_v_mean=0.895, gn_v_max=2.575

  1%|▏         | 67/5000 [12:37<11:35:51,  8.46s/it]------------------ Training Record ------------------
Epoch: 67/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 4.600
Updated lambda_fail: 4.500
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.792, reward_valid_mean=0.2719, reward_valid_std=2.2662
[BatchDiag] adv_mean=-0.0491, adv_std=1.2988, adv_abs_mean=1.0200 | ret_mean=6.3271, ret_std=1.8981 | val_mean=6.3762, val_std=1.4621 | explained_var=0.531800
[GradSplit pre-clip] backbone=0.415141, critic=0.898560
[Loss] pg_loss=-0.120737, entropy_loss=0.000226, value_loss=0.077868
[EpochKL] epoch=0 mean_kl=0.00279 max_kl=0.00636
[EpochKL] epoch=1 mean_kl=0.00334 max_kl=0.00562
[EpochKL] epoch=2 mean_kl=0.00229 max_kl=0.00344
[Time] Env Create Time: 2.6955s |Rollout Collect Time: 3.5700s |Loss & Update :1.8785
[PPODiag] kl_mean=0.0028, kl_p90=0.0047, kl_max=0.0064 | clipfrac_mean=0.028, logratio_std_mean=0.073, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.792, p10=0.787, min=0.783 | pg_loss_mean=0.0004, v_loss_mean=0.3098, ent_mean=0.2276 | gn_bb_mean=1.220, gn_bb_max=2.486 | gn_v_mean=0.647, gn_v_max=1.798

  1%|▏         | 68/5000 [12:46<11:27:50,  8.37s/it]------------------ Training Record ------------------
Epoch: 68/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 4.500
Updated lambda_fail: 4.400
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.793, reward_valid_mean=0.2694, reward_valid_std=2.2645
[BatchDiag] adv_mean=-0.1377, adv_std=1.2814, adv_abs_mean=1.0033 | ret_mean=6.3471, ret_std=1.8841 | val_mean=6.4848, val_std=1.4565 | explained_var=0.537451
[GradSplit pre-clip] backbone=0.372657, critic=0.296063
[Loss] pg_loss=-0.109080, entropy_loss=0.000225, value_loss=0.072371
[EpochKL] epoch=0 mean_kl=0.00148 max_kl=0.00261
[EpochKL] epoch=1 mean_kl=0.00285 max_kl=0.00654
[EpochKL] epoch=2 mean_kl=0.00241 max_kl=0.00405
[Time] Env Create Time: 2.8449s |Rollout Collect Time: 3.5708s |Loss & Update :1.8706
[PPODiag] kl_mean=0.0022, kl_p90=0.0038, kl_max=0.0065 | clipfrac_mean=0.023, logratio_std_mean=0.064, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.793, p10=0.789, min=0.789 | pg_loss_mean=0.0001, v_loss_mean=0.3038, ent_mean=0.2219 | gn_bb_mean=1.188, gn_bb_max=2.294 | gn_v_mean=0.764, gn_v_max=2.322

  1%|▏         | 69/5000 [12:54<11:25:42,  8.34s/it]------------------ Training Record ------------------
Epoch: 69/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51199/51200 = 1.000
Current lambda_fail (before): 4.400
Updated lambda_fail: 4.400
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.290, reward_valid_mean=0.2752, reward_valid_std=2.2659
[BatchDiag] adv_mean=-0.1555, adv_std=1.2664, adv_abs_mean=0.9855 | ret_mean=6.4000, ret_std=1.8556 | val_mean=6.5556, val_std=1.4300 | explained_var=0.534195
[GradSplit pre-clip] backbone=0.364821, critic=0.310962
[Loss] pg_loss=-0.120999, entropy_loss=0.000081, value_loss=0.068742
[EpochKL] epoch=0 mean_kl=0.00361 max_kl=0.00707
[EpochKL] epoch=1 mean_kl=0.00399 max_kl=0.00627
[EpochKL] epoch=2 mean_kl=0.00399 max_kl=0.00609
[Time] Env Create Time: 2.8503s |Rollout Collect Time: 9.3333s |Loss & Update :4.6454
[PPODiag] kl_mean=0.0039, kl_p90=0.0059, kl_max=0.0071 | clipfrac_mean=0.033, logratio_std_mean=0.087, ratio_p95_mean=1.068 | valid_ratio_mb_mean=0.290, p10=0.288, min=0.286 | pg_loss_mean=0.0007, v_loss_mean=0.2969, ent_mean=0.0787 | gn_bb_mean=1.520, gn_bb_max=2.542 | gn_v_mean=0.978, gn_v_max=2.560

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -6.389, Step: 21, Avg Done Step: 18.45, #CS visited: 0.60
D->C12->C1->C15->C14->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->C3->D
Eval cost : 4.0380s
-----------------------------
  1%|▏         | 70/5000 [13:15<16:35:18, 12.11s/it]------------------ Training Record ------------------
Epoch: 70/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 4.400
Updated lambda_fail: 4.300
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.793, reward_valid_mean=0.2712, reward_valid_std=2.2651
[BatchDiag] adv_mean=-0.1406, adv_std=1.2886, adv_abs_mean=1.0070 | ret_mean=6.3585, ret_std=1.8764 | val_mean=6.4992, val_std=1.4434 | explained_var=0.528419
[GradSplit pre-clip] backbone=0.275437, critic=0.734647
[Loss] pg_loss=-0.163932, entropy_loss=0.000209, value_loss=0.070663
[EpochKL] epoch=0 mean_kl=0.00165 max_kl=0.00372
[EpochKL] epoch=1 mean_kl=0.00318 max_kl=0.00440
[EpochKL] epoch=2 mean_kl=0.00446 max_kl=0.00802
[Time] Env Create Time: 2.8676s |Rollout Collect Time: 3.5535s |Loss & Update :1.8760
[PPODiag] kl_mean=0.0031, kl_p90=0.0053, kl_max=0.0080 | clipfrac_mean=0.029, logratio_std_mean=0.076, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.793, p10=0.787, min=0.783 | pg_loss_mean=0.0007, v_loss_mean=0.3069, ent_mean=0.2095 | gn_bb_mean=1.343, gn_bb_max=2.230 | gn_v_mean=1.179, gn_v_max=2.706
[AttnScore] scale=1.0114, C=10.0

  1%|▏         | 71/5000 [13:23<15:01:04, 10.97s/it]------------------ Training Record ------------------
Epoch: 71/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 4.300
Updated lambda_fail: 4.200
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.2782, reward_valid_std=2.2690
[BatchDiag] adv_mean=-0.2178, adv_std=1.2421, adv_abs_mean=0.9827 | ret_mean=6.4434, ret_std=1.8314 | val_mean=6.6611, val_std=1.3828 | explained_var=0.540022
[GradSplit pre-clip] backbone=0.353957, critic=0.275119
[Loss] pg_loss=-0.144262, entropy_loss=0.000209, value_loss=0.067789
[EpochKL] epoch=0 mean_kl=0.00253 max_kl=0.00586
[EpochKL] epoch=1 mean_kl=0.00283 max_kl=0.00519
[EpochKL] epoch=2 mean_kl=0.00593 max_kl=0.01113
[Time] Env Create Time: 2.8670s |Rollout Collect Time: 3.5379s |Loss & Update :1.8764
[PPODiag] kl_mean=0.0038, kl_p90=0.0061, kl_max=0.0111 | clipfrac_mean=0.033, logratio_std_mean=0.083, ratio_p95_mean=1.068 | valid_ratio_mb_mean=0.790, p10=0.785, min=0.782 | pg_loss_mean=0.0012, v_loss_mean=0.2927, ent_mean=0.2112 | gn_bb_mean=1.712, gn_bb_max=3.208 | gn_v_mean=0.939, gn_v_max=1.966

  1%|▏         | 72/5000 [13:31<13:54:40, 10.16s/it]------------------ Training Record ------------------
Epoch: 72/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 4.200
Updated lambda_fail: 4.100
----------------------------------------------------
[RolloutDiag] valid_step=32, valid_ratio=0.545, reward_valid_mean=0.2778, reward_valid_std=2.2648
[BatchDiag] adv_mean=-0.1481, adv_std=1.2274, adv_abs_mean=0.9613 | ret_mean=6.4191, ret_std=1.8488 | val_mean=6.5672, val_std=1.3794 | explained_var=0.559245
[GradSplit pre-clip] backbone=0.415910, critic=0.549220
[Loss] pg_loss=-0.155617, entropy_loss=0.000143, value_loss=0.066297
[EpochKL] epoch=0 mean_kl=0.00676 max_kl=0.01560
[EpochKL] epoch=1 mean_kl=0.00678 max_kl=0.00971
[EpochKL] epoch=2 mean_kl=0.00511 max_kl=0.00973
[Time] Env Create Time: 2.6956s |Rollout Collect Time: 5.0592s |Loss & Update :2.5946
[PPODiag] kl_mean=0.0062, kl_p90=0.0097, kl_max=0.0156 | clipfrac_mean=0.045, logratio_std_mean=0.109, ratio_p95_mean=1.079 | valid_ratio_mb_mean=0.545, p10=0.541, min=0.539 | pg_loss_mean=0.0026, v_loss_mean=0.2854, ent_mean=0.1400 | gn_bb_mean=1.889, gn_bb_max=3.678 | gn_v_mean=0.911, gn_v_max=1.836

  1%|▏         | 73/5000 [13:42<13:59:07, 10.22s/it]------------------ Training Record ------------------
Epoch: 73/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 4.100
Updated lambda_fail: 4.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.2808, reward_valid_std=2.2662
[BatchDiag] adv_mean=-0.1269, adv_std=1.2072, adv_abs_mean=0.9434 | ret_mean=6.4379, ret_std=1.8335 | val_mean=6.5648, val_std=1.4310 | explained_var=0.566501
[GradSplit pre-clip] backbone=0.239759, critic=0.646665
[Loss] pg_loss=-0.139665, entropy_loss=0.000202, value_loss=0.064438
[EpochKL] epoch=0 mean_kl=0.00139 max_kl=0.00295
[EpochKL] epoch=1 mean_kl=0.00236 max_kl=0.00421
[EpochKL] epoch=2 mean_kl=0.00249 max_kl=0.00401
[Time] Env Create Time: 2.8479s |Rollout Collect Time: 3.5596s |Loss & Update :1.8581
[PPODiag] kl_mean=0.0021, kl_p90=0.0036, kl_max=0.0042 | clipfrac_mean=0.021, logratio_std_mean=0.062, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.791, p10=0.788, min=0.782 | pg_loss_mean=0.0001, v_loss_mean=0.2779, ent_mean=0.2001 | gn_bb_mean=1.070, gn_bb_max=1.835 | gn_v_mean=0.947, gn_v_max=2.211

  1%|▏         | 74/5000 [13:50<13:10:51,  9.63s/it]------------------ Training Record ------------------
Epoch: 74/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 4.000
Updated lambda_fail: 3.900
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.755, reward_valid_mean=0.2843, reward_valid_std=2.2701
[BatchDiag] adv_mean=-0.1406, adv_std=1.1980, adv_abs_mean=0.9389 | ret_mean=6.4753, ret_std=1.8290 | val_mean=6.6159, val_std=1.3902 | explained_var=0.570974
[GradSplit pre-clip] backbone=0.286705, critic=0.383699
[Loss] pg_loss=-0.121322, entropy_loss=0.000181, value_loss=0.063268
[EpochKL] epoch=0 mean_kl=0.00197 max_kl=0.00379
[EpochKL] epoch=1 mean_kl=0.00914 max_kl=0.01694
[EpochKL] epoch=2 mean_kl=0.00634 max_kl=0.00983
[Time] Env Create Time: 2.8476s |Rollout Collect Time: 3.6872s |Loss & Update :1.9444
[PPODiag] kl_mean=0.0058, kl_p90=0.0109, kl_max=0.0169 | clipfrac_mean=0.039, logratio_std_mean=0.103, ratio_p95_mean=1.071 | valid_ratio_mb_mean=0.755, p10=0.750, min=0.746 | pg_loss_mean=0.0021, v_loss_mean=0.2744, ent_mean=0.1869 | gn_bb_mean=1.733, gn_bb_max=2.763 | gn_v_mean=0.953, gn_v_max=2.566

  2%|▏         | 75/5000 [13:58<12:42:18,  9.29s/it]------------------ Training Record ------------------
Epoch: 75/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 3.900
Updated lambda_fail: 3.800
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.2818, reward_valid_std=2.2678
[BatchDiag] adv_mean=-0.1263, adv_std=1.2175, adv_abs_mean=0.9551 | ret_mean=6.4385, ret_std=1.8363 | val_mean=6.5648, val_std=1.3978 | explained_var=0.560357
[GradSplit pre-clip] backbone=0.396469, critic=0.357084
[Loss] pg_loss=-0.076156, entropy_loss=0.000197, value_loss=0.062351
[EpochKL] epoch=0 mean_kl=0.00558 max_kl=0.01032
[EpochKL] epoch=1 mean_kl=0.00772 max_kl=0.01339
[EpochKL] epoch=2 mean_kl=0.00866 max_kl=0.01323
[Time] Env Create Time: 2.6893s |Rollout Collect Time: 3.5427s |Loss & Update :1.8826
[PPODiag] kl_mean=0.0073, kl_p90=0.0124, kl_max=0.0134 | clipfrac_mean=0.049, logratio_std_mean=0.121, ratio_p95_mean=1.083 | valid_ratio_mb_mean=0.790, p10=0.785, min=0.784 | pg_loss_mean=0.0031, v_loss_mean=0.2842, ent_mean=0.1976 | gn_bb_mean=1.862, gn_bb_max=3.092 | gn_v_mean=0.849, gn_v_max=2.297
[AttnScore] scale=1.0127, C=10.0

  2%|▏         | 76/5000 [14:06<12:13:17,  8.94s/it]------------------ Training Record ------------------
Epoch: 76/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 3.800
Updated lambda_fail: 3.700
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.757, reward_valid_mean=0.2804, reward_valid_std=2.2655
[BatchDiag] adv_mean=-0.1261, adv_std=1.2201, adv_abs_mean=0.9574 | ret_mean=6.4238, ret_std=1.8519 | val_mean=6.5499, val_std=1.3843 | explained_var=0.565935
[GradSplit pre-clip] backbone=0.285529, critic=0.633508
[Loss] pg_loss=-0.130341, entropy_loss=0.000181, value_loss=0.068975
[EpochKL] epoch=0 mean_kl=0.00478 max_kl=0.00847
[EpochKL] epoch=1 mean_kl=0.00432 max_kl=0.00792
[EpochKL] epoch=2 mean_kl=0.00279 max_kl=0.00372
[Time] Env Create Time: 2.8461s |Rollout Collect Time: 3.6991s |Loss & Update :1.9445
[PPODiag] kl_mean=0.0040, kl_p90=0.0078, kl_max=0.0085 | clipfrac_mean=0.032, logratio_std_mean=0.087, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.757, p10=0.752, min=0.751 | pg_loss_mean=0.0013, v_loss_mean=0.2810, ent_mean=0.1837 | gn_bb_mean=1.373, gn_bb_max=1.878 | gn_v_mean=0.612, gn_v_max=1.774

  2%|▏         | 77/5000 [14:15<12:02:11,  8.80s/it]------------------ Training Record ------------------
Epoch: 77/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 3.700
Updated lambda_fail: 3.600
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.756, reward_valid_mean=0.2823, reward_valid_std=2.2646
[BatchDiag] adv_mean=-0.0644, adv_std=1.2109, adv_abs_mean=0.9420 | ret_mean=6.4263, ret_std=1.8503 | val_mean=6.4907, val_std=1.4439 | explained_var=0.571763
[GradSplit pre-clip] backbone=0.342248, critic=1.113216
[Loss] pg_loss=-0.137946, entropy_loss=0.000181, value_loss=0.067482
[EpochKL] epoch=0 mean_kl=0.00366 max_kl=0.00605
[EpochKL] epoch=1 mean_kl=0.00399 max_kl=0.00550
[EpochKL] epoch=2 mean_kl=0.00426 max_kl=0.00742
[Time] Env Create Time: 2.8454s |Rollout Collect Time: 3.6987s |Loss & Update :1.9614
[PPODiag] kl_mean=0.0040, kl_p90=0.0059, kl_max=0.0074 | clipfrac_mean=0.035, logratio_std_mean=0.088, ratio_p95_mean=1.065 | valid_ratio_mb_mean=0.756, p10=0.752, min=0.745 | pg_loss_mean=0.0015, v_loss_mean=0.2781, ent_mean=0.1811 | gn_bb_mean=1.509, gn_bb_max=2.372 | gn_v_mean=0.911, gn_v_max=2.361

  2%|▏         | 78/5000 [14:23<11:54:45,  8.71s/it]------------------ Training Record ------------------
Epoch: 78/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 3.600
Updated lambda_fail: 3.500
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.2850, reward_valid_std=2.2667
[BatchDiag] adv_mean=-0.0073, adv_std=1.1730, adv_abs_mean=0.9150 | ret_mean=6.4343, ret_std=1.8517 | val_mean=6.4416, val_std=1.4487 | explained_var=0.598707
[GradSplit pre-clip] backbone=0.502953, critic=1.288843
[Loss] pg_loss=-0.143159, entropy_loss=0.000188, value_loss=0.063694
[EpochKL] epoch=0 mean_kl=0.00360 max_kl=0.00747
[EpochKL] epoch=1 mean_kl=0.00493 max_kl=0.00685
[EpochKL] epoch=2 mean_kl=0.00382 max_kl=0.00658
[Time] Env Create Time: 2.8554s |Rollout Collect Time: 3.5466s |Loss & Update :1.8796
[PPODiag] kl_mean=0.0041, kl_p90=0.0066, kl_max=0.0075 | clipfrac_mean=0.036, logratio_std_mean=0.088, ratio_p95_mean=1.065 | valid_ratio_mb_mean=0.790, p10=0.784, min=0.780 | pg_loss_mean=0.0020, v_loss_mean=0.2656, ent_mean=0.1854 | gn_bb_mean=1.614, gn_bb_max=2.902 | gn_v_mean=0.958, gn_v_max=2.645

  2%|▏         | 79/5000 [14:32<11:44:00,  8.58s/it]------------------ Training Record ------------------
Epoch: 79/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 3.500
Updated lambda_fail: 3.400
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.828, reward_valid_mean=0.2854, reward_valid_std=2.2668
[BatchDiag] adv_mean=-0.1290, adv_std=1.1766, adv_abs_mean=0.9179 | ret_mean=6.4898, ret_std=1.8352 | val_mean=6.6188, val_std=1.4006 | explained_var=0.588968
[GradSplit pre-clip] backbone=0.640661, critic=0.363536
[Loss] pg_loss=-0.118561, entropy_loss=0.000196, value_loss=0.064628
[EpochKL] epoch=0 mean_kl=0.00377 max_kl=0.00715
[EpochKL] epoch=1 mean_kl=0.00959 max_kl=0.02861
[EarlyStop] epoch=2 mean_kl=0.01452 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01452 max_kl=0.02883
[Time] Env Create Time: 2.7023s |Rollout Collect Time: 3.3691s |Loss & Update :1.8119
[PPODiag] kl_mean=0.0093, kl_p90=0.0197, kl_max=0.0288 | clipfrac_mean=0.042, logratio_std_mean=0.135, ratio_p95_mean=1.071 | valid_ratio_mb_mean=0.828, p10=0.823, min=0.818 | pg_loss_mean=0.0025, v_loss_mean=0.2669, ent_mean=0.1912 | gn_bb_mean=1.461, gn_bb_max=2.354 | gn_v_mean=0.975, gn_v_max=2.158

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -6.324, Step: 21, Avg Done Step: 18.48, #CS visited: 0.55
D->C12->C1->C15->C14->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->C3->D
Eval cost : 4.0161s
-----------------------------
  2%|▏         | 80/5000 [14:44<13:06:30,  9.59s/it]------------------ Training Record ------------------
Epoch: 80/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 3.400
Updated lambda_fail: 3.300
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.755, reward_valid_mean=0.2829, reward_valid_std=2.2679
[BatchDiag] adv_mean=-0.0604, adv_std=1.1834, adv_abs_mean=0.9222 | ret_mean=6.4474, ret_std=1.8582 | val_mean=6.5078, val_std=1.4474 | explained_var=0.594407
[GradSplit pre-clip] backbone=0.392023, critic=1.141494
[Loss] pg_loss=-0.148533, entropy_loss=0.000169, value_loss=0.064311
[EpochKL] epoch=0 mean_kl=0.00593 max_kl=0.01225
[EpochKL] epoch=1 mean_kl=0.00399 max_kl=0.00912
[EpochKL] epoch=2 mean_kl=0.00395 max_kl=0.00567
[Time] Env Create Time: 2.8804s |Rollout Collect Time: 3.7027s |Loss & Update :1.9493
[PPODiag] kl_mean=0.0046, kl_p90=0.0092, kl_max=0.0123 | clipfrac_mean=0.032, logratio_std_mean=0.094, ratio_p95_mean=1.060 | valid_ratio_mb_mean=0.755, p10=0.751, min=0.745 | pg_loss_mean=0.0014, v_loss_mean=0.2689, ent_mean=0.1729 | gn_bb_mean=1.295, gn_bb_max=2.222 | gn_v_mean=0.994, gn_v_max=2.235
[AttnScore] scale=1.0139, C=10.0

  2%|▏         | 81/5000 [14:52<12:40:18,  9.27s/it]------------------ Training Record ------------------
Epoch: 81/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 3.300
Updated lambda_fail: 3.200
----------------------------------------------------
[RolloutDiag] valid_step=24, valid_ratio=0.725, reward_valid_mean=0.2817, reward_valid_std=2.2664
[BatchDiag] adv_mean=-0.0295, adv_std=1.1822, adv_abs_mean=0.9259 | ret_mean=6.4275, ret_std=1.8685 | val_mean=6.4570, val_std=1.4743 | explained_var=0.599720
[GradSplit pre-clip] backbone=0.439619, critic=1.535284
[Loss] pg_loss=-0.169446, entropy_loss=0.000167, value_loss=0.060479
[EpochKL] epoch=0 mean_kl=0.00187 max_kl=0.00349
[EpochKL] epoch=1 mean_kl=0.00355 max_kl=0.00591
[EpochKL] epoch=2 mean_kl=0.00390 max_kl=0.00703
[Time] Env Create Time: 2.8540s |Rollout Collect Time: 3.8628s |Loss & Update :2.0191
[PPODiag] kl_mean=0.0031, kl_p90=0.0050, kl_max=0.0070 | clipfrac_mean=0.028, logratio_std_mean=0.077, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.725, p10=0.721, min=0.717 | pg_loss_mean=0.0009, v_loss_mean=0.2687, ent_mean=0.1665 | gn_bb_mean=1.445, gn_bb_max=2.491 | gn_v_mean=0.777, gn_v_max=2.060

  2%|▏         | 82/5000 [15:01<12:26:56,  9.11s/it]------------------ Training Record ------------------
Epoch: 82/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 3.200
Updated lambda_fail: 3.100
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.757, reward_valid_mean=0.2838, reward_valid_std=2.2681
[BatchDiag] adv_mean=-0.1316, adv_std=1.1678, adv_abs_mean=0.9041 | ret_mean=6.4891, ret_std=1.8471 | val_mean=6.6206, val_std=1.4520 | explained_var=0.600309
[GradSplit pre-clip] backbone=0.425944, critic=0.482392
[Loss] pg_loss=-0.121798, entropy_loss=0.000171, value_loss=0.060794
[EpochKL] epoch=0 mean_kl=0.00203 max_kl=0.00501
[EpochKL] epoch=1 mean_kl=0.00384 max_kl=0.00584
[EpochKL] epoch=2 mean_kl=0.00224 max_kl=0.00276
[Time] Env Create Time: 2.8739s |Rollout Collect Time: 3.6839s |Loss & Update :1.9431
[PPODiag] kl_mean=0.0027, kl_p90=0.0047, kl_max=0.0058 | clipfrac_mean=0.025, logratio_std_mean=0.071, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.757, p10=0.751, min=0.747 | pg_loss_mean=0.0005, v_loss_mean=0.2639, ent_mean=0.1741 | gn_bb_mean=1.247, gn_bb_max=2.384 | gn_v_mean=1.020, gn_v_max=2.596

  2%|▏         | 83/5000 [15:09<12:11:45,  8.93s/it]------------------ Training Record ------------------
Epoch: 83/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 3.100
Updated lambda_fail: 3.000
----------------------------------------------------
[RolloutDiag] valid_step=24, valid_ratio=0.725, reward_valid_mean=0.2846, reward_valid_std=2.2671
[BatchDiag] adv_mean=-0.1045, adv_std=1.1502, adv_abs_mean=0.8941 | ret_mean=6.4885, ret_std=1.8289 | val_mean=6.5931, val_std=1.4486 | explained_var=0.604454
[GradSplit pre-clip] backbone=0.537000, critic=0.640926
[Loss] pg_loss=-0.124713, entropy_loss=0.000165, value_loss=0.060156
[EpochKL] epoch=0 mean_kl=0.00260 max_kl=0.00454
[EpochKL] epoch=1 mean_kl=0.00425 max_kl=0.00613
[EpochKL] epoch=2 mean_kl=0.00402 max_kl=0.00607
[Time] Env Create Time: 2.6838s |Rollout Collect Time: 3.8645s |Loss & Update :2.0162
[PPODiag] kl_mean=0.0036, kl_p90=0.0055, kl_max=0.0061 | clipfrac_mean=0.032, logratio_std_mean=0.085, ratio_p95_mean=1.064 | valid_ratio_mb_mean=0.725, p10=0.720, min=0.718 | pg_loss_mean=0.0012, v_loss_mean=0.2579, ent_mean=0.1641 | gn_bb_mean=1.498, gn_bb_max=2.352 | gn_v_mean=0.960, gn_v_max=2.391

  2%|▏         | 84/5000 [15:18<12:02:39,  8.82s/it]------------------ Training Record ------------------
Epoch: 84/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 3.000
Updated lambda_fail: 2.900
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.792, reward_valid_mean=0.2850, reward_valid_std=2.2640
[BatchDiag] adv_mean=-0.0064, adv_std=1.1548, adv_abs_mean=0.9018 | ret_mean=6.4545, ret_std=1.8564 | val_mean=6.4609, val_std=1.4755 | explained_var=0.613066
[GradSplit pre-clip] backbone=0.633970, critic=1.045441
[Loss] pg_loss=-0.100448, entropy_loss=0.000178, value_loss=0.063797
[EpochKL] epoch=0 mean_kl=0.00330 max_kl=0.00673
[EpochKL] epoch=1 mean_kl=0.00474 max_kl=0.00669
[EpochKL] epoch=2 mean_kl=0.00415 max_kl=0.00532
[Time] Env Create Time: 2.8255s |Rollout Collect Time: 3.5288s |Loss & Update :1.8774
[PPODiag] kl_mean=0.0041, kl_p90=0.0064, kl_max=0.0067 | clipfrac_mean=0.036, logratio_std_mean=0.089, ratio_p95_mean=1.066 | valid_ratio_mb_mean=0.792, p10=0.787, min=0.784 | pg_loss_mean=0.0017, v_loss_mean=0.2591, ent_mean=0.1783 | gn_bb_mean=1.494, gn_bb_max=2.206 | gn_v_mean=0.860, gn_v_max=1.868

  2%|▏         | 85/5000 [15:26<11:48:03,  8.64s/it]------------------ Training Record ------------------
Epoch: 85/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 2.900
Updated lambda_fail: 2.800
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.2866, reward_valid_std=2.2667
[BatchDiag] adv_mean=-0.0875, adv_std=1.1477, adv_abs_mean=0.8906 | ret_mean=6.5052, ret_std=1.8380 | val_mean=6.5927, val_std=1.4650 | explained_var=0.610098
[GradSplit pre-clip] backbone=0.422396, critic=0.881883
[Loss] pg_loss=-0.150736, entropy_loss=0.000172, value_loss=0.060980
[EpochKL] epoch=0 mean_kl=0.00227 max_kl=0.00398
[EpochKL] epoch=1 mean_kl=0.00391 max_kl=0.00553
[EpochKL] epoch=2 mean_kl=0.00554 max_kl=0.00973
[Time] Env Create Time: 2.8533s |Rollout Collect Time: 3.5480s |Loss & Update :1.8728
[PPODiag] kl_mean=0.0039, kl_p90=0.0059, kl_max=0.0097 | clipfrac_mean=0.034, logratio_std_mean=0.086, ratio_p95_mean=1.065 | valid_ratio_mb_mean=0.791, p10=0.787, min=0.784 | pg_loss_mean=0.0017, v_loss_mean=0.2555, ent_mean=0.1759 | gn_bb_mean=1.520, gn_bb_max=2.301 | gn_v_mean=0.856, gn_v_max=2.202
[AttnScore] scale=1.0153, C=10.0

  2%|▏         | 86/5000 [15:35<11:38:51,  8.53s/it]------------------ Training Record ------------------
Epoch: 86/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 2.800
Updated lambda_fail: 2.700
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.2848, reward_valid_std=2.2679
[BatchDiag] adv_mean=0.0418, adv_std=1.1472, adv_abs_mean=0.8999 | ret_mean=6.4495, ret_std=1.8698 | val_mean=6.4077, val_std=1.4878 | explained_var=0.623569
[GradSplit pre-clip] backbone=0.432494, critic=1.660340
[Loss] pg_loss=-0.158290, entropy_loss=0.000176, value_loss=0.060290
[EpochKL] epoch=0 mean_kl=0.00449 max_kl=0.00749
[EpochKL] epoch=1 mean_kl=0.00405 max_kl=0.00478
[EpochKL] epoch=2 mean_kl=0.00283 max_kl=0.00585
[Time] Env Create Time: 2.8554s |Rollout Collect Time: 3.5282s |Loss & Update :1.8773
[PPODiag] kl_mean=0.0038, kl_p90=0.0057, kl_max=0.0075 | clipfrac_mean=0.032, logratio_std_mean=0.085, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.791, p10=0.786, min=0.784 | pg_loss_mean=0.0015, v_loss_mean=0.2583, ent_mean=0.1754 | gn_bb_mean=1.428, gn_bb_max=2.488 | gn_v_mean=1.125, gn_v_max=2.935

  2%|▏         | 87/5000 [15:43<11:32:02,  8.45s/it]------------------ Training Record ------------------
Epoch: 87/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 2.700
Updated lambda_fail: 2.600
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.2866, reward_valid_std=2.2671
[BatchDiag] adv_mean=-0.1452, adv_std=1.1146, adv_abs_mean=0.8658 | ret_mean=6.5280, ret_std=1.8127 | val_mean=6.6732, val_std=1.4612 | explained_var=0.621946
[GradSplit pre-clip] backbone=0.432149, critic=0.191778
[Loss] pg_loss=-0.093699, entropy_loss=0.000171, value_loss=0.058298
[EpochKL] epoch=0 mean_kl=0.00247 max_kl=0.00426
[EpochKL] epoch=1 mean_kl=0.00320 max_kl=0.00417
[EpochKL] epoch=2 mean_kl=0.00360 max_kl=0.00547
[Time] Env Create Time: 2.6845s |Rollout Collect Time: 3.5329s |Loss & Update :1.8748
[PPODiag] kl_mean=0.0031, kl_p90=0.0042, kl_max=0.0055 | clipfrac_mean=0.028, logratio_std_mean=0.077, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.790, p10=0.785, min=0.783 | pg_loss_mean=0.0011, v_loss_mean=0.2462, ent_mean=0.1718 | gn_bb_mean=1.336, gn_bb_max=1.913 | gn_v_mean=1.239, gn_v_max=2.832

  2%|▏         | 88/5000 [15:51<11:23:04,  8.34s/it]------------------ Training Record ------------------
Epoch: 88/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 2.600
Updated lambda_fail: 2.500
----------------------------------------------------
[RolloutDiag] valid_step=24, valid_ratio=0.726, reward_valid_mean=0.2869, reward_valid_std=2.2661
[BatchDiag] adv_mean=0.0112, adv_std=1.1514, adv_abs_mean=0.8970 | ret_mean=6.4833, ret_std=1.8627 | val_mean=6.4720, val_std=1.4892 | explained_var=0.617892
[GradSplit pre-clip] backbone=0.483928, critic=1.446982
[Loss] pg_loss=-0.124328, entropy_loss=0.000153, value_loss=0.061287
[EpochKL] epoch=0 mean_kl=0.00236 max_kl=0.00461
[EpochKL] epoch=1 mean_kl=0.00372 max_kl=0.00573
[EpochKL] epoch=2 mean_kl=0.00318 max_kl=0.00454
[Time] Env Create Time: 2.8548s |Rollout Collect Time: 3.8504s |Loss & Update :2.0326
[PPODiag] kl_mean=0.0031, kl_p90=0.0046, kl_max=0.0057 | clipfrac_mean=0.030, logratio_std_mean=0.078, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.726, p10=0.721, min=0.719 | pg_loss_mean=0.0009, v_loss_mean=0.2576, ent_mean=0.1628 | gn_bb_mean=1.436, gn_bb_max=2.394 | gn_v_mean=1.019, gn_v_max=2.259

  2%|▏         | 89/5000 [16:00<11:32:37,  8.46s/it]------------------ Training Record ------------------
Epoch: 89/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 2.500
Updated lambda_fail: 2.400
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.755, reward_valid_mean=0.2901, reward_valid_std=2.2721
[BatchDiag] adv_mean=-0.0316, adv_std=1.1302, adv_abs_mean=0.8721 | ret_mean=6.5245, ret_std=1.8455 | val_mean=6.5561, val_std=1.4960 | explained_var=0.624994
[GradSplit pre-clip] backbone=0.554868, critic=1.284073
[Loss] pg_loss=-0.148721, entropy_loss=0.000167, value_loss=0.058603
[EpochKL] epoch=0 mean_kl=0.00616 max_kl=0.00972
[EpochKL] epoch=1 mean_kl=0.00422 max_kl=0.00620
[EpochKL] epoch=2 mean_kl=0.00439 max_kl=0.00574
[Time] Env Create Time: 2.8568s |Rollout Collect Time: 3.7288s |Loss & Update :1.9396
[PPODiag] kl_mean=0.0049, kl_p90=0.0069, kl_max=0.0097 | clipfrac_mean=0.041, logratio_std_mean=0.098, ratio_p95_mean=1.073 | valid_ratio_mb_mean=0.755, p10=0.750, min=0.748 | pg_loss_mean=0.0019, v_loss_mean=0.2513, ent_mean=0.1667 | gn_bb_mean=1.569, gn_bb_max=2.443 | gn_v_mean=0.996, gn_v_max=3.465

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -6.186, Step: 21, Avg Done Step: 18.45, #CS visited: 0.48
D->C12->C1->C15->C14->C5->C2->D->C13->C4->C7->C11->C10->C9->C8->D->C6->C3->D
Eval cost : 4.0002s
-----------------------------
  2%|▏         | 90/5000 [16:12<13:13:37,  9.70s/it]------------------ Training Record ------------------
Epoch: 90/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 2.400
Updated lambda_fail: 2.300
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.2909, reward_valid_std=2.2684
[BatchDiag] adv_mean=-0.1240, adv_std=1.1214, adv_abs_mean=0.8667 | ret_mean=6.5620, ret_std=1.8243 | val_mean=6.6860, val_std=1.4688 | explained_var=0.622179
[GradSplit pre-clip] backbone=0.647365, critic=0.633887
[Loss] pg_loss=-0.158901, entropy_loss=0.000177, value_loss=0.058917
[EpochKL] epoch=0 mean_kl=0.00210 max_kl=0.00672
[EpochKL] epoch=1 mean_kl=0.00308 max_kl=0.00460
[EpochKL] epoch=2 mean_kl=0.00446 max_kl=0.00797
[Time] Env Create Time: 2.6962s |Rollout Collect Time: 3.5285s |Loss & Update :1.8767
[PPODiag] kl_mean=0.0032, kl_p90=0.0063, kl_max=0.0080 | clipfrac_mean=0.029, logratio_std_mean=0.077, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.790, p10=0.785, min=0.780 | pg_loss_mean=0.0011, v_loss_mean=0.2497, ent_mean=0.1739 | gn_bb_mean=1.342, gn_bb_max=2.632 | gn_v_mean=1.398, gn_v_max=3.111
[AttnScore] scale=1.0168, C=10.0

  2%|▏         | 91/5000 [16:20<12:34:17,  9.22s/it]------------------ Training Record ------------------
Epoch: 91/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 2.300
Updated lambda_fail: 2.200
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.758, reward_valid_mean=0.2881, reward_valid_std=2.2679
[BatchDiag] adv_mean=-0.0315, adv_std=1.1134, adv_abs_mean=0.8691 | ret_mean=6.5238, ret_std=1.8427 | val_mean=6.5553, val_std=1.4838 | explained_var=0.634876
[GradSplit pre-clip] backbone=0.511293, critic=0.659607
[Loss] pg_loss=-0.068337, entropy_loss=0.000169, value_loss=0.059895
[EpochKL] epoch=0 mean_kl=0.00233 max_kl=0.00394
[EpochKL] epoch=1 mean_kl=0.00328 max_kl=0.00478
[EpochKL] epoch=2 mean_kl=0.00410 max_kl=0.00633
[Time] Env Create Time: 2.8250s |Rollout Collect Time: 3.7100s |Loss & Update :1.9463
[PPODiag] kl_mean=0.0032, kl_p90=0.0049, kl_max=0.0063 | clipfrac_mean=0.030, logratio_std_mean=0.079, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.758, p10=0.754, min=0.751 | pg_loss_mean=0.0009, v_loss_mean=0.2464, ent_mean=0.1652 | gn_bb_mean=1.338, gn_bb_max=2.373 | gn_v_mean=0.695, gn_v_max=1.551

  2%|▏         | 92/5000 [16:29<12:16:02,  9.00s/it]------------------ Training Record ------------------
Epoch: 92/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 2.200
Updated lambda_fail: 2.100
----------------------------------------------------
[RolloutDiag] valid_step=31, valid_ratio=0.561, reward_valid_mean=0.2914, reward_valid_std=2.2689
[BatchDiag] adv_mean=0.0326, adv_std=1.1254, adv_abs_mean=0.8685 | ret_mean=6.5263, ret_std=1.8499 | val_mean=6.4937, val_std=1.5277 | explained_var=0.629878
[GradSplit pre-clip] backbone=0.642482, critic=1.731413
[Loss] pg_loss=-0.128172, entropy_loss=0.000115, value_loss=0.060652
[EpochKL] epoch=0 mean_kl=0.00227 max_kl=0.00379
[EpochKL] epoch=1 mean_kl=0.00387 max_kl=0.00673
[EpochKL] epoch=2 mean_kl=0.00992 max_kl=0.02100
[Time] Env Create Time: 2.8524s |Rollout Collect Time: 4.9042s |Loss & Update :2.5482
[PPODiag] kl_mean=0.0054, kl_p90=0.0092, kl_max=0.0210 | clipfrac_mean=0.038, logratio_std_mean=0.099, ratio_p95_mean=1.067 | valid_ratio_mb_mean=0.561, p10=0.558, min=0.555 | pg_loss_mean=0.0021, v_loss_mean=0.2458, ent_mean=0.1200 | gn_bb_mean=1.681, gn_bb_max=2.932 | gn_v_mean=0.763, gn_v_max=2.295

  2%|▏         | 93/5000 [16:39<12:47:57,  9.39s/it]------------------ Training Record ------------------
Epoch: 93/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 2.100
Updated lambda_fail: 2.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.2890, reward_valid_std=2.2674
[BatchDiag] adv_mean=-0.0364, adv_std=1.1115, adv_abs_mean=0.8578 | ret_mean=6.5186, ret_std=1.8370 | val_mean=6.5550, val_std=1.5276 | explained_var=0.633896
[GradSplit pre-clip] backbone=0.527547, critic=1.420118
[Loss] pg_loss=-0.155807, entropy_loss=0.000176, value_loss=0.056207
[EpochKL] epoch=0 mean_kl=0.00338 max_kl=0.00660
[EpochKL] epoch=1 mean_kl=0.00350 max_kl=0.00457
[EpochKL] epoch=2 mean_kl=0.00340 max_kl=0.00443
[Time] Env Create Time: 2.8809s |Rollout Collect Time: 3.5614s |Loss & Update :1.8798
[PPODiag] kl_mean=0.0034, kl_p90=0.0045, kl_max=0.0066 | clipfrac_mean=0.031, logratio_std_mean=0.082, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.791, p10=0.786, min=0.785 | pg_loss_mean=0.0012, v_loss_mean=0.2407, ent_mean=0.1722 | gn_bb_mean=1.436, gn_bb_max=2.555 | gn_v_mean=0.582, gn_v_max=1.420

  2%|▏         | 94/5000 [16:47<12:21:36,  9.07s/it]------------------ Training Record ------------------
Epoch: 94/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 2.000
Updated lambda_fail: 1.900
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.2903, reward_valid_std=2.2686
[BatchDiag] adv_mean=-0.0402, adv_std=1.1135, adv_abs_mean=0.8591 | ret_mean=6.5238, ret_std=1.8358 | val_mean=6.5640, val_std=1.4847 | explained_var=0.632087
[GradSplit pre-clip] backbone=0.501413, critic=1.262560
[Loss] pg_loss=-0.155491, entropy_loss=0.000170, value_loss=0.055744
[EpochKL] epoch=0 mean_kl=0.00208 max_kl=0.00331
[EpochKL] epoch=1 mean_kl=0.00387 max_kl=0.00485
[EpochKL] epoch=2 mean_kl=0.00539 max_kl=0.00683
[Time] Env Create Time: 2.6976s |Rollout Collect Time: 3.5423s |Loss & Update :1.8742
[PPODiag] kl_mean=0.0038, kl_p90=0.0059, kl_max=0.0068 | clipfrac_mean=0.033, logratio_std_mean=0.085, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.789, p10=0.786, min=0.785 | pg_loss_mean=0.0014, v_loss_mean=0.2427, ent_mean=0.1693 | gn_bb_mean=1.415, gn_bb_max=2.067 | gn_v_mean=0.528, gn_v_max=1.263

  2%|▏         | 95/5000 [16:56<11:58:02,  8.78s/it]------------------ Training Record ------------------
Epoch: 95/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 1.900
Updated lambda_fail: 1.800
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.757, reward_valid_mean=0.2899, reward_valid_std=2.2668
[BatchDiag] adv_mean=-0.0487, adv_std=1.1063, adv_abs_mean=0.8546 | ret_mean=6.5468, ret_std=1.8229 | val_mean=6.5956, val_std=1.5446 | explained_var=0.631680
[GradSplit pre-clip] backbone=0.486228, critic=1.171408
[Loss] pg_loss=-0.126650, entropy_loss=0.000149, value_loss=0.056202
[EpochKL] epoch=0 mean_kl=0.00217 max_kl=0.00326
[EpochKL] epoch=1 mean_kl=0.00443 max_kl=0.00566
[EpochKL] epoch=2 mean_kl=0.00573 max_kl=0.00920
[Time] Env Create Time: 2.8515s |Rollout Collect Time: 3.6927s |Loss & Update :1.9519
[PPODiag] kl_mean=0.0041, kl_p90=0.0061, kl_max=0.0092 | clipfrac_mean=0.035, logratio_std_mean=0.088, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.757, p10=0.752, min=0.748 | pg_loss_mean=0.0017, v_loss_mean=0.2416, ent_mean=0.1584 | gn_bb_mean=1.620, gn_bb_max=2.579 | gn_v_mean=0.881, gn_v_max=1.790
[AttnScore] scale=1.0185, C=10.0

  2%|▏         | 96/5000 [17:04<11:50:51,  8.70s/it]------------------ Training Record ------------------
Epoch: 96/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 1.800
Updated lambda_fail: 1.700
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.755, reward_valid_mean=0.2919, reward_valid_std=2.2693
[BatchDiag] adv_mean=0.0151, adv_std=1.1045, adv_abs_mean=0.8532 | ret_mean=6.5304, ret_std=1.8380 | val_mean=6.5153, val_std=1.5492 | explained_var=0.638868
[GradSplit pre-clip] backbone=0.545370, critic=1.453097
[Loss] pg_loss=-0.098677, entropy_loss=0.000157, value_loss=0.060714
[EpochKL] epoch=0 mean_kl=0.00269 max_kl=0.00466
[EpochKL] epoch=1 mean_kl=0.00691 max_kl=0.01119
[EpochKL] epoch=2 mean_kl=0.00555 max_kl=0.01025
[Time] Env Create Time: 2.8580s |Rollout Collect Time: 3.6781s |Loss & Update :1.9540
[PPODiag] kl_mean=0.0051, kl_p90=0.0077, kl_max=0.0112 | clipfrac_mean=0.039, logratio_std_mean=0.099, ratio_p95_mean=1.070 | valid_ratio_mb_mean=0.755, p10=0.752, min=0.751 | pg_loss_mean=0.0022, v_loss_mean=0.2409, ent_mean=0.1593 | gn_bb_mean=1.674, gn_bb_max=2.601 | gn_v_mean=1.151, gn_v_max=2.538

  2%|▏         | 97/5000 [17:13<11:45:38,  8.64s/it]------------------ Training Record ------------------
Epoch: 97/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 1.700
Updated lambda_fail: 1.600
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.2926, reward_valid_std=2.2705
[BatchDiag] adv_mean=-0.1952, adv_std=1.0918, adv_abs_mean=0.8450 | ret_mean=6.6127, ret_std=1.7918 | val_mean=6.8078, val_std=1.4558 | explained_var=0.628721
[GradSplit pre-clip] backbone=0.630019, critic=0.575656
[Loss] pg_loss=-0.065990, entropy_loss=0.000155, value_loss=0.062248
[EpochKL] epoch=0 mean_kl=0.00261 max_kl=0.00383
[EpochKL] epoch=1 mean_kl=0.00342 max_kl=0.00529
[EpochKL] epoch=2 mean_kl=0.00413 max_kl=0.00788
[Time] Env Create Time: 2.8342s |Rollout Collect Time: 3.5267s |Loss & Update :1.8698
[PPODiag] kl_mean=0.0034, kl_p90=0.0053, kl_max=0.0079 | clipfrac_mean=0.031, logratio_std_mean=0.080, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.789, p10=0.785, min=0.783 | pg_loss_mean=0.0015, v_loss_mean=0.2380, ent_mean=0.1654 | gn_bb_mean=1.412, gn_bb_max=2.451 | gn_v_mean=1.159, gn_v_max=2.251

  2%|▏         | 98/5000 [17:21<11:35:35,  8.51s/it]------------------ Training Record ------------------
Epoch: 98/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 1.600
Updated lambda_fail: 1.500
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.756, reward_valid_mean=0.2914, reward_valid_std=2.2677
[BatchDiag] adv_mean=-0.1242, adv_std=1.0879, adv_abs_mean=0.8391 | ret_mean=6.5598, ret_std=1.8057 | val_mean=6.6840, val_std=1.4806 | explained_var=0.636983
[GradSplit pre-clip] backbone=0.522207, critic=0.696003
[Loss] pg_loss=-0.143745, entropy_loss=0.000156, value_loss=0.053841
[EpochKL] epoch=0 mean_kl=0.00152 max_kl=0.00262
[EpochKL] epoch=1 mean_kl=0.00371 max_kl=0.00728
[EpochKL] epoch=2 mean_kl=0.00224 max_kl=0.00326
[Time] Env Create Time: 2.6953s |Rollout Collect Time: 3.6715s |Loss & Update :1.9433
[PPODiag] kl_mean=0.0025, kl_p90=0.0033, kl_max=0.0073 | clipfrac_mean=0.024, logratio_std_mean=0.068, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.756, p10=0.751, min=0.750 | pg_loss_mean=0.0007, v_loss_mean=0.2380, ent_mean=0.1551 | gn_bb_mean=1.244, gn_bb_max=2.297 | gn_v_mean=1.486, gn_v_max=3.077

  2%|▏         | 99/5000 [17:29<11:30:28,  8.45s/it]------------------ Training Record ------------------
Epoch: 99/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 1.500
Updated lambda_fail: 1.400
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.2939, reward_valid_std=2.2724
[BatchDiag] adv_mean=-0.0214, adv_std=1.1164, adv_abs_mean=0.8616 | ret_mean=6.5539, ret_std=1.8398 | val_mean=6.5753, val_std=1.5086 | explained_var=0.631837
[GradSplit pre-clip] backbone=0.421261, critic=1.009181
[Loss] pg_loss=-0.085637, entropy_loss=0.000156, value_loss=0.057558
[EpochKL] epoch=0 mean_kl=0.00174 max_kl=0.00263
[EpochKL] epoch=1 mean_kl=0.00265 max_kl=0.00341
[EpochKL] epoch=2 mean_kl=0.00415 max_kl=0.00663
[Time] Env Create Time: 2.8522s |Rollout Collect Time: 3.5462s |Loss & Update :1.8704
[PPODiag] kl_mean=0.0028, kl_p90=0.0043, kl_max=0.0066 | clipfrac_mean=0.027, logratio_std_mean=0.073, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.781 | pg_loss_mean=0.0010, v_loss_mean=0.2423, ent_mean=0.1587 | gn_bb_mean=1.237, gn_bb_max=2.333 | gn_v_mean=0.762, gn_v_max=1.780

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -6.114, Step: 21, Avg Done Step: 18.40, #CS visited: 0.47
D->C12->C1->C15->C14->C5->C2->D->C13->C4->C7->C11->C10->C9->C8->D->C6->C3->D
Eval cost : 4.0436s
-----------------------------
  2%|▏         | 100/5000 [17:41<13:06:11,  9.63s/it]------------------ Training Record ------------------
Epoch: 100/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 1.400
Updated lambda_fail: 1.300
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.2922, reward_valid_std=2.2666
[BatchDiag] adv_mean=-0.1276, adv_std=1.0780, adv_abs_mean=0.8339 | ret_mean=6.5692, ret_std=1.7948 | val_mean=6.6968, val_std=1.4656 | explained_var=0.639228
[GradSplit pre-clip] backbone=0.556131, critic=0.652425
[Loss] pg_loss=-0.163464, entropy_loss=0.000159, value_loss=0.053585
[EpochKL] epoch=0 mean_kl=0.00236 max_kl=0.00419
[EpochKL] epoch=1 mean_kl=0.00450 max_kl=0.00651
[EpochKL] epoch=2 mean_kl=0.00479 max_kl=0.00635
[Time] Env Create Time: 2.8318s |Rollout Collect Time: 3.3631s |Loss & Update :1.7943
[PPODiag] kl_mean=0.0039, kl_p90=0.0058, kl_max=0.0065 | clipfrac_mean=0.033, logratio_std_mean=0.086, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.827, p10=0.822, min=0.821 | pg_loss_mean=0.0016, v_loss_mean=0.2321, ent_mean=0.1686 | gn_bb_mean=1.627, gn_bb_max=2.332 | gn_v_mean=0.861, gn_v_max=1.746
[AttnScore] scale=1.0201, C=10.0

  2%|▏         | 101/5000 [17:49<12:25:55,  9.14s/it]------------------ Training Record ------------------
Epoch: 101/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 1.300
Updated lambda_fail: 1.200
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.2942, reward_valid_std=2.2694
[BatchDiag] adv_mean=-0.0424, adv_std=1.0819, adv_abs_mean=0.8345 | ret_mean=6.5469, ret_std=1.8074 | val_mean=6.5893, val_std=1.4851 | explained_var=0.641722
[GradSplit pre-clip] backbone=0.511940, critic=1.097141
[Loss] pg_loss=-0.125698, entropy_loss=0.000166, value_loss=0.058807
[EpochKL] epoch=0 mean_kl=0.00397 max_kl=0.00655
[EpochKL] epoch=1 mean_kl=0.00705 max_kl=0.01003
[EpochKL] epoch=2 mean_kl=0.00676 max_kl=0.01330
[Time] Env Create Time: 2.8472s |Rollout Collect Time: 3.5262s |Loss & Update :1.8747
[PPODiag] kl_mean=0.0059, kl_p90=0.0089, kl_max=0.0133 | clipfrac_mean=0.042, logratio_std_mean=0.107, ratio_p95_mean=1.070 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.781 | pg_loss_mean=0.0026, v_loss_mean=0.2330, ent_mean=0.1624 | gn_bb_mean=1.721, gn_bb_max=2.804 | gn_v_mean=0.784, gn_v_max=2.084

  2%|▏         | 102/5000 [17:58<12:04:03,  8.87s/it]------------------ Training Record ------------------
Epoch: 102/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 1.200
Updated lambda_fail: 1.100
----------------------------------------------------
[RolloutDiag] valid_step=41, valid_ratio=0.424, reward_valid_mean=0.2920, reward_valid_std=2.2671
[BatchDiag] adv_mean=-0.0349, adv_std=1.0930, adv_abs_mean=0.8407 | ret_mean=6.5210, ret_std=1.8294 | val_mean=6.5560, val_std=1.4872 | explained_var=0.643025
[GradSplit pre-clip] backbone=0.496389, critic=1.060711
[Loss] pg_loss=-0.124000, entropy_loss=0.000095, value_loss=0.055770
[EpochKL] epoch=0 mean_kl=0.00214 max_kl=0.00381
[EpochKL] epoch=1 mean_kl=0.00269 max_kl=0.00394
[EpochKL] epoch=2 mean_kl=0.00184 max_kl=0.00249
[Time] Env Create Time: 2.6719s |Rollout Collect Time: 6.3803s |Loss & Update :3.2768
[PPODiag] kl_mean=0.0022, kl_p90=0.0038, kl_max=0.0039 | clipfrac_mean=0.022, logratio_std_mean=0.065, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.424, p10=0.421, min=0.421 | pg_loss_mean=0.0006, v_loss_mean=0.2334, ent_mean=0.0893 | gn_bb_mean=1.141, gn_bb_max=1.664 | gn_v_mean=0.639, gn_v_max=1.555

  2%|▏         | 103/5000 [18:10<13:28:41,  9.91s/it]------------------ Training Record ------------------
Epoch: 103/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51191/51200 = 1.000
Current lambda_fail (before): 1.100
Updated lambda_fail: 1.100
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.289, reward_valid_mean=0.2935, reward_valid_std=2.2683
[BatchDiag] adv_mean=-0.0760, adv_std=1.0968, adv_abs_mean=0.8384 | ret_mean=6.5572, ret_std=1.8207 | val_mean=6.6332, val_std=1.4858 | explained_var=0.637138
[GradSplit pre-clip] backbone=0.622963, critic=0.966991
[Loss] pg_loss=-0.148872, entropy_loss=0.000064, value_loss=0.053921
[EpochKL] epoch=0 mean_kl=0.00354 max_kl=0.00530
[EpochKL] epoch=1 mean_kl=0.00492 max_kl=0.01433
[EpochKL] epoch=2 mean_kl=0.00589 max_kl=0.01318
[Time] Env Create Time: 2.8327s |Rollout Collect Time: 9.2437s |Loss & Update :4.6250
[PPODiag] kl_mean=0.0048, kl_p90=0.0063, kl_max=0.0143 | clipfrac_mean=0.034, logratio_std_mean=0.097, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.289, p10=0.287, min=0.286 | pg_loss_mean=0.0014, v_loss_mean=0.2361, ent_mean=0.0612 | gn_bb_mean=1.397, gn_bb_max=2.183 | gn_v_mean=0.880, gn_v_max=1.809

  2%|▏         | 104/5000 [18:27<16:14:49, 11.95s/it]------------------ Training Record ------------------
Epoch: 104/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 1.100
Updated lambda_fail: 1.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.756, reward_valid_mean=0.2928, reward_valid_std=2.2653
[BatchDiag] adv_mean=-0.0516, adv_std=1.0865, adv_abs_mean=0.8362 | ret_mean=6.5456, ret_std=1.8217 | val_mean=6.5972, val_std=1.4714 | explained_var=0.644302
[GradSplit pre-clip] backbone=0.525156, critic=1.279443
[Loss] pg_loss=-0.189748, entropy_loss=0.000161, value_loss=0.054744
[EpochKL] epoch=0 mean_kl=0.00185 max_kl=0.00320
[EpochKL] epoch=1 mean_kl=0.00791 max_kl=0.01667
[EpochKL] epoch=2 mean_kl=0.00524 max_kl=0.00800
[Time] Env Create Time: 2.8430s |Rollout Collect Time: 3.6615s |Loss & Update :1.9499
[PPODiag] kl_mean=0.0050, kl_p90=0.0083, kl_max=0.0167 | clipfrac_mean=0.034, logratio_std_mean=0.097, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.756, p10=0.749, min=0.748 | pg_loss_mean=0.0016, v_loss_mean=0.2330, ent_mean=0.1540 | gn_bb_mean=1.467, gn_bb_max=2.256 | gn_v_mean=0.883, gn_v_max=2.182

  2%|▏         | 105/5000 [18:35<14:49:10, 10.90s/it]------------------ Training Record ------------------
Epoch: 105/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 1.000
Updated lambda_fail: 0.900
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.755, reward_valid_mean=0.2945, reward_valid_std=2.2685
[BatchDiag] adv_mean=-0.0656, adv_std=1.0771, adv_abs_mean=0.8387 | ret_mean=6.5588, ret_std=1.8143 | val_mean=6.6245, val_std=1.4526 | explained_var=0.647543
[GradSplit pre-clip] backbone=0.636214, critic=0.927972
[Loss] pg_loss=-0.134694, entropy_loss=0.000156, value_loss=0.058620
[EpochKL] epoch=0 mean_kl=0.00522 max_kl=0.00871
[EpochKL] epoch=1 mean_kl=0.00608 max_kl=0.00904
[EpochKL] epoch=2 mean_kl=0.00667 max_kl=0.01042
[Time] Env Create Time: 2.8524s |Rollout Collect Time: 3.6725s |Loss & Update :1.9445
[PPODiag] kl_mean=0.0060, kl_p90=0.0088, kl_max=0.0104 | clipfrac_mean=0.043, logratio_std_mean=0.109, ratio_p95_mean=1.068 | valid_ratio_mb_mean=0.755, p10=0.750, min=0.749 | pg_loss_mean=0.0027, v_loss_mean=0.2334, ent_mean=0.1562 | gn_bb_mean=1.759, gn_bb_max=2.514 | gn_v_mean=0.934, gn_v_max=2.185
[AttnScore] scale=1.0215, C=10.0

  2%|▏         | 106/5000 [18:44<13:49:33, 10.17s/it]------------------ Training Record ------------------
Epoch: 106/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.900
Updated lambda_fail: 0.800
----------------------------------------------------
[RolloutDiag] valid_step=39, valid_ratio=0.446, reward_valid_mean=0.2945, reward_valid_std=2.2680
[BatchDiag] adv_mean=-0.0369, adv_std=1.1034, adv_abs_mean=0.8533 | ret_mean=6.5457, ret_std=1.8181 | val_mean=6.5826, val_std=1.4736 | explained_var=0.631703
[GradSplit pre-clip] backbone=0.592710, critic=1.005497
[Loss] pg_loss=-0.116041, entropy_loss=0.000093, value_loss=0.055818
[EpochKL] epoch=0 mean_kl=0.00219 max_kl=0.00437
[EpochKL] epoch=1 mean_kl=0.00313 max_kl=0.00565
[EpochKL] epoch=2 mean_kl=0.00375 max_kl=0.00510
[Time] Env Create Time: 2.7051s |Rollout Collect Time: 6.0597s |Loss & Update :3.1212
[PPODiag] kl_mean=0.0030, kl_p90=0.0047, kl_max=0.0057 | clipfrac_mean=0.026, logratio_std_mean=0.077, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.446, p10=0.443, min=0.442 | pg_loss_mean=0.0011, v_loss_mean=0.2377, ent_mean=0.0931 | gn_bb_mean=1.342, gn_bb_max=2.073 | gn_v_mean=0.817, gn_v_max=2.177

  2%|▏         | 107/5000 [18:56<14:31:22, 10.69s/it]------------------ Training Record ------------------
Epoch: 107/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.800
Updated lambda_fail: 0.700
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.2994, reward_valid_std=2.2728
[BatchDiag] adv_mean=-0.0728, adv_std=1.0607, adv_abs_mean=0.8248 | ret_mean=6.6006, ret_std=1.7853 | val_mean=6.6734, val_std=1.4265 | explained_var=0.647001
[GradSplit pre-clip] backbone=0.688947, critic=0.810043
[Loss] pg_loss=-0.140701, entropy_loss=0.000176, value_loss=0.052954
[EpochKL] epoch=0 mean_kl=0.00232 max_kl=0.00407
[EpochKL] epoch=1 mean_kl=0.00412 max_kl=0.00610
[EpochKL] epoch=2 mean_kl=0.00510 max_kl=0.00829
[Time] Env Create Time: 2.8283s |Rollout Collect Time: 3.3685s |Loss & Update :1.8000
[PPODiag] kl_mean=0.0038, kl_p90=0.0061, kl_max=0.0083 | clipfrac_mean=0.033, logratio_std_mean=0.087, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.823, p10=0.818, min=0.815 | pg_loss_mean=0.0014, v_loss_mean=0.2267, ent_mean=0.1718 | gn_bb_mean=1.513, gn_bb_max=2.137 | gn_v_mean=1.027, gn_v_max=1.824

  2%|▏         | 108/5000 [19:04<13:25:27,  9.88s/it]------------------ Training Record ------------------
Epoch: 108/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.700
Updated lambda_fail: 0.600
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.753, reward_valid_mean=0.2970, reward_valid_std=2.2709
[BatchDiag] adv_mean=-0.0444, adv_std=1.0770, adv_abs_mean=0.8301 | ret_mean=6.5686, ret_std=1.8048 | val_mean=6.6131, val_std=1.4576 | explained_var=0.643915
[GradSplit pre-clip] backbone=0.806071, critic=0.839659
[Loss] pg_loss=-0.096740, entropy_loss=0.000157, value_loss=0.054918
[EpochKL] epoch=0 mean_kl=0.00732 max_kl=0.01287
[EpochKL] epoch=1 mean_kl=0.00681 max_kl=0.00923
[EpochKL] epoch=2 mean_kl=0.00462 max_kl=0.00759
[Time] Env Create Time: 2.8591s |Rollout Collect Time: 3.6601s |Loss & Update :1.9493
[PPODiag] kl_mean=0.0062, kl_p90=0.0101, kl_max=0.0129 | clipfrac_mean=0.042, logratio_std_mean=0.112, ratio_p95_mean=1.073 | valid_ratio_mb_mean=0.753, p10=0.748, min=0.745 | pg_loss_mean=0.0030, v_loss_mean=0.2309, ent_mean=0.1574 | gn_bb_mean=1.670, gn_bb_max=2.998 | gn_v_mean=0.931, gn_v_max=2.943

  2%|▏         | 109/5000 [19:12<12:50:48,  9.46s/it]------------------ Training Record ------------------
Epoch: 109/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.600
Updated lambda_fail: 0.500
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.754, reward_valid_mean=0.2957, reward_valid_std=2.2699
[BatchDiag] adv_mean=-0.0638, adv_std=1.0654, adv_abs_mean=0.8283 | ret_mean=6.5454, ret_std=1.8033 | val_mean=6.6092, val_std=1.4197 | explained_var=0.650946
[GradSplit pre-clip] backbone=0.510705, critic=1.214767
[Loss] pg_loss=-0.193189, entropy_loss=0.000146, value_loss=0.049714
[EpochKL] epoch=0 mean_kl=0.00294 max_kl=0.00510
[EpochKL] epoch=1 mean_kl=0.00316 max_kl=0.00422
[EpochKL] epoch=2 mean_kl=0.00352 max_kl=0.00512
[Time] Env Create Time: 2.6812s |Rollout Collect Time: 3.6634s |Loss & Update :1.9474
[PPODiag] kl_mean=0.0032, kl_p90=0.0044, kl_max=0.0051 | clipfrac_mean=0.029, logratio_std_mean=0.079, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.754, p10=0.750, min=0.742 | pg_loss_mean=0.0011, v_loss_mean=0.2284, ent_mean=0.1558 | gn_bb_mean=1.410, gn_bb_max=2.219 | gn_v_mean=1.022, gn_v_max=3.126

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -6.044, Step: 21, Avg Done Step: 18.32, #CS visited: 0.47
D->C12->C1->C15->C14->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->C3->D
Eval cost : 4.0096s
-----------------------------
  2%|▏         | 110/5000 [19:24<14:01:32, 10.33s/it]------------------ Training Record ------------------
Epoch: 110/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.500
Updated lambda_fail: 0.400
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.2985, reward_valid_std=2.2722
[BatchDiag] adv_mean=-0.0531, adv_std=1.0732, adv_abs_mean=0.8213 | ret_mean=6.5775, ret_std=1.8019 | val_mean=6.6307, val_std=1.4932 | explained_var=0.645282
[GradSplit pre-clip] backbone=0.606382, critic=1.078190
[Loss] pg_loss=-0.141974, entropy_loss=0.000167, value_loss=0.052092
[EpochKL] epoch=0 mean_kl=0.00228 max_kl=0.00398
[EpochKL] epoch=1 mean_kl=0.00338 max_kl=0.00510
[EarlyStop] epoch=2 mean_kl=0.01136 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01136 max_kl=0.01949
[Time] Env Create Time: 2.8439s |Rollout Collect Time: 3.5283s |Loss & Update :1.8660
[PPODiag] kl_mean=0.0057, kl_p90=0.0131, kl_max=0.0195 | clipfrac_mean=0.037, logratio_std_mean=0.102, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.787, p10=0.781, min=0.777 | pg_loss_mean=0.0020, v_loss_mean=0.2283, ent_mean=0.1575 | gn_bb_mean=1.576, gn_bb_max=2.683 | gn_v_mean=0.917, gn_v_max=1.904
[AttnScore] scale=1.0232, C=10.0

  2%|▏         | 111/5000 [19:33<13:10:21,  9.70s/it]------------------ Training Record ------------------
Epoch: 111/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.400
Updated lambda_fail: 0.300
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.2973, reward_valid_std=2.2706
[BatchDiag] adv_mean=-0.0060, adv_std=1.0765, adv_abs_mean=0.8278 | ret_mean=6.5619, ret_std=1.8153 | val_mean=6.5679, val_std=1.5272 | explained_var=0.648355
[GradSplit pre-clip] backbone=0.632103, critic=1.183918
[Loss] pg_loss=-0.101190, entropy_loss=0.000157, value_loss=0.054026
[EpochKL] epoch=0 mean_kl=0.00386 max_kl=0.00564
[EpochKL] epoch=1 mean_kl=0.00430 max_kl=0.00899
[EpochKL] epoch=2 mean_kl=0.00528 max_kl=0.00754
[Time] Env Create Time: 2.8362s |Rollout Collect Time: 3.5247s |Loss & Update :1.8685
[PPODiag] kl_mean=0.0045, kl_p90=0.0064, kl_max=0.0090 | clipfrac_mean=0.035, logratio_std_mean=0.094, ratio_p95_mean=1.063 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.779 | pg_loss_mean=0.0020, v_loss_mean=0.2287, ent_mean=0.1593 | gn_bb_mean=1.611, gn_bb_max=2.886 | gn_v_mean=0.851, gn_v_max=1.874

  2%|▏         | 112/5000 [19:41<12:34:16,  9.26s/it]------------------ Training Record ------------------
Epoch: 112/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.300
Updated lambda_fail: 0.200
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.2973, reward_valid_std=2.2705
[BatchDiag] adv_mean=-0.0899, adv_std=1.0800, adv_abs_mean=0.8294 | ret_mean=6.5808, ret_std=1.7962 | val_mean=6.6708, val_std=1.4700 | explained_var=0.638498
[GradSplit pre-clip] backbone=0.725564, critic=0.739819
[Loss] pg_loss=-0.144261, entropy_loss=0.000167, value_loss=0.055470
[EpochKL] epoch=0 mean_kl=0.00327 max_kl=0.00602
[EpochKL] epoch=1 mean_kl=0.00288 max_kl=0.00575
[EpochKL] epoch=2 mean_kl=0.00223 max_kl=0.00339
[Time] Env Create Time: 2.8670s |Rollout Collect Time: 3.3809s |Loss & Update :1.7996
[PPODiag] kl_mean=0.0028, kl_p90=0.0050, kl_max=0.0060 | clipfrac_mean=0.025, logratio_std_mean=0.073, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.825, p10=0.819, min=0.815 | pg_loss_mean=0.0010, v_loss_mean=0.2304, ent_mean=0.1666 | gn_bb_mean=1.296, gn_bb_max=2.767 | gn_v_mean=0.741, gn_v_max=2.476

  2%|▏         | 113/5000 [19:49<12:04:31,  8.90s/it]------------------ Training Record ------------------
Epoch: 113/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.200
Updated lambda_fail: 0.100
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3029, reward_valid_std=2.2744
[BatchDiag] adv_mean=0.0166, adv_std=1.0636, adv_abs_mean=0.8247 | ret_mean=6.6110, ret_std=1.7975 | val_mean=6.5944, val_std=1.5224 | explained_var=0.649863
[GradSplit pre-clip] backbone=0.745892, critic=1.495045
[Loss] pg_loss=-0.108882, entropy_loss=0.000166, value_loss=0.056687
[EpochKL] epoch=0 mean_kl=0.00263 max_kl=0.00592
[EpochKL] epoch=1 mean_kl=0.00425 max_kl=0.00558
[EpochKL] epoch=2 mean_kl=0.00555 max_kl=0.00811
[Time] Env Create Time: 2.6829s |Rollout Collect Time: 3.5166s |Loss & Update :1.8705
[PPODiag] kl_mean=0.0041, kl_p90=0.0059, kl_max=0.0081 | clipfrac_mean=0.034, logratio_std_mean=0.090, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.785, p10=0.781, min=0.780 | pg_loss_mean=0.0016, v_loss_mean=0.2254, ent_mean=0.1614 | gn_bb_mean=1.535, gn_bb_max=2.053 | gn_v_mean=0.691, gn_v_max=1.495

  2%|▏         | 114/5000 [19:57<11:44:13,  8.65s/it]------------------ Training Record ------------------
Epoch: 114/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.100
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3037, reward_valid_std=2.2735
[BatchDiag] adv_mean=-0.0306, adv_std=1.0738, adv_abs_mean=0.8186 | ret_mean=6.6282, ret_std=1.7857 | val_mean=6.6589, val_std=1.5091 | explained_var=0.638389
[GradSplit pre-clip] backbone=0.385687, critic=1.188085
[Loss] pg_loss=-0.133694, entropy_loss=0.000159, value_loss=0.050723
[EpochKL] epoch=0 mean_kl=0.00316 max_kl=0.00582
[EpochKL] epoch=1 mean_kl=0.00608 max_kl=0.01015
[EpochKL] epoch=2 mean_kl=0.00397 max_kl=0.00639
[Time] Env Create Time: 2.8545s |Rollout Collect Time: 3.5170s |Loss & Update :1.8788
[PPODiag] kl_mean=0.0044, kl_p90=0.0065, kl_max=0.0101 | clipfrac_mean=0.035, logratio_std_mean=0.093, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.785, p10=0.780, min=0.779 | pg_loss_mean=0.0019, v_loss_mean=0.2261, ent_mean=0.1562 | gn_bb_mean=1.523, gn_bb_max=2.431 | gn_v_mean=0.599, gn_v_max=1.867

  2%|▏         | 115/5000 [20:05<11:34:23,  8.53s/it]------------------ Training Record ------------------
Epoch: 115/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=48, valid_ratio=0.360, reward_valid_mean=0.3016, reward_valid_std=2.2718
[BatchDiag] adv_mean=-0.0861, adv_std=1.0576, adv_abs_mean=0.8041 | ret_mean=6.6321, ret_std=1.7805 | val_mean=6.7182, val_std=1.5062 | explained_var=0.647180
[GradSplit pre-clip] backbone=0.783170, critic=1.006181
[Loss] pg_loss=-0.147836, entropy_loss=0.000072, value_loss=0.050018
[EpochKL] epoch=0 mean_kl=0.00162 max_kl=0.00234
[EpochKL] epoch=1 mean_kl=0.00300 max_kl=0.00431
[EpochKL] epoch=2 mean_kl=0.00509 max_kl=0.00675
[Time] Env Create Time: 2.8514s |Rollout Collect Time: 7.4318s |Loss & Update :3.8037
[PPODiag] kl_mean=0.0032, kl_p90=0.0058, kl_max=0.0068 | clipfrac_mean=0.028, logratio_std_mean=0.079, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.360, p10=0.359, min=0.356 | pg_loss_mean=0.0011, v_loss_mean=0.2225, ent_mean=0.0713 | gn_bb_mean=1.380, gn_bb_max=2.611 | gn_v_mean=1.080, gn_v_max=2.612
[AttnScore] scale=1.0250, C=10.0

  2%|▏         | 116/5000 [20:19<13:49:59, 10.20s/it]------------------ Training Record ------------------
Epoch: 116/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3010, reward_valid_std=2.2752
[BatchDiag] adv_mean=-0.1180, adv_std=1.0669, adv_abs_mean=0.8227 | ret_mean=6.6161, ret_std=1.7740 | val_mean=6.7341, val_std=1.4578 | explained_var=0.638316
[GradSplit pre-clip] backbone=0.676091, critic=0.474723
[Loss] pg_loss=-0.110478, entropy_loss=0.000164, value_loss=0.053040
[EpochKL] epoch=0 mean_kl=0.00265 max_kl=0.00410
[EpochKL] epoch=1 mean_kl=0.00338 max_kl=0.00535
[EpochKL] epoch=2 mean_kl=0.00670 max_kl=0.01031
[Time] Env Create Time: 2.8357s |Rollout Collect Time: 3.3614s |Loss & Update :1.7982
[PPODiag] kl_mean=0.0042, kl_p90=0.0080, kl_max=0.0103 | clipfrac_mean=0.034, logratio_std_mean=0.090, ratio_p95_mean=1.059 | valid_ratio_mb_mean=0.823, p10=0.819, min=0.813 | pg_loss_mean=0.0017, v_loss_mean=0.2288, ent_mean=0.1641 | gn_bb_mean=1.452, gn_bb_max=2.227 | gn_v_mean=1.237, gn_v_max=2.567

  2%|▏         | 117/5000 [20:27<12:56:05,  9.54s/it]------------------ Training Record ------------------
Epoch: 117/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.821, reward_valid_mean=0.2999, reward_valid_std=2.2730
[BatchDiag] adv_mean=-0.2080, adv_std=1.0432, adv_abs_mean=0.8063 | ret_mean=6.6480, ret_std=1.7546 | val_mean=6.8560, val_std=1.4735 | explained_var=0.646486
[GradSplit pre-clip] backbone=0.573546, critic=0.513517
[Loss] pg_loss=-0.113053, entropy_loss=0.000170, value_loss=0.048968
[EpochKL] epoch=0 mean_kl=0.00330 max_kl=0.00497
[EpochKL] epoch=1 mean_kl=0.00342 max_kl=0.00498
[EpochKL] epoch=2 mean_kl=0.00361 max_kl=0.00535
[Time] Env Create Time: 2.6827s |Rollout Collect Time: 3.3601s |Loss & Update :1.7984
[PPODiag] kl_mean=0.0034, kl_p90=0.0049, kl_max=0.0054 | clipfrac_mean=0.030, logratio_std_mean=0.082, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.821, p10=0.816, min=0.815 | pg_loss_mean=0.0013, v_loss_mean=0.2218, ent_mean=0.1647 | gn_bb_mean=1.441, gn_bb_max=2.508 | gn_v_mean=1.468, gn_v_max=3.007

  2%|▏         | 118/5000 [20:35<12:14:33,  9.03s/it]------------------ Training Record ------------------
Epoch: 118/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3000, reward_valid_std=2.2718
[BatchDiag] adv_mean=-0.1538, adv_std=1.0509, adv_abs_mean=0.8122 | ret_mean=6.6197, ret_std=1.7694 | val_mean=6.7735, val_std=1.4159 | explained_var=0.647204
[GradSplit pre-clip] backbone=0.482792, critic=0.247810
[Loss] pg_loss=-0.122700, entropy_loss=0.000153, value_loss=0.051161
[EpochKL] epoch=0 mean_kl=0.00248 max_kl=0.00578
[EpochKL] epoch=1 mean_kl=0.00452 max_kl=0.00663
[EpochKL] epoch=2 mean_kl=0.00369 max_kl=0.00560
[Time] Env Create Time: 2.8451s |Rollout Collect Time: 3.5399s |Loss & Update :1.8562
[PPODiag] kl_mean=0.0036, kl_p90=0.0056, kl_max=0.0066 | clipfrac_mean=0.031, logratio_std_mean=0.082, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.786, p10=0.780, min=0.779 | pg_loss_mean=0.0014, v_loss_mean=0.2233, ent_mean=0.1588 | gn_bb_mean=1.435, gn_bb_max=2.565 | gn_v_mean=1.142, gn_v_max=3.151

  2%|▏         | 119/5000 [20:43<11:55:13,  8.79s/it]------------------ Training Record ------------------
Epoch: 119/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=28, valid_ratio=0.617, reward_valid_mean=0.3022, reward_valid_std=2.2718
[BatchDiag] adv_mean=-0.2256, adv_std=1.0558, adv_abs_mean=0.8136 | ret_mean=6.6641, ret_std=1.7528 | val_mean=6.8897, val_std=1.4615 | explained_var=0.637218
[GradSplit pre-clip] backbone=0.469665, critic=0.383907
[Loss] pg_loss=-0.137072, entropy_loss=0.000118, value_loss=0.050225
[EpochKL] epoch=0 mean_kl=0.00298 max_kl=0.00552
[EpochKL] epoch=1 mean_kl=0.00636 max_kl=0.00961
[EpochKL] epoch=2 mean_kl=0.00576 max_kl=0.00902
[Time] Env Create Time: 2.8525s |Rollout Collect Time: 4.4340s |Loss & Update :2.3034
[PPODiag] kl_mean=0.0050, kl_p90=0.0077, kl_max=0.0096 | clipfrac_mean=0.038, logratio_std_mean=0.099, ratio_p95_mean=1.064 | valid_ratio_mb_mean=0.617, p10=0.614, min=0.609 | pg_loss_mean=0.0022, v_loss_mean=0.2272, ent_mean=0.1230 | gn_bb_mean=1.519, gn_bb_max=2.245 | gn_v_mean=1.491, gn_v_max=2.841

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -6.021, Step: 21, Avg Done Step: 18.29, #CS visited: 0.51
D->C12->C1->C15->C14->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->C3->D
Eval cost : 4.0183s
-----------------------------
  2%|▏         | 120/5000 [20:57<13:54:03, 10.25s/it]------------------ Training Record ------------------
Epoch: 120/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.750, reward_valid_mean=0.3012, reward_valid_std=2.2734
[BatchDiag] adv_mean=-0.1259, adv_std=1.0646, adv_abs_mean=0.8174 | ret_mean=6.6215, ret_std=1.7816 | val_mean=6.7475, val_std=1.4617 | explained_var=0.642921
[GradSplit pre-clip] backbone=0.552575, critic=0.344164
[Loss] pg_loss=-0.075850, entropy_loss=0.000154, value_loss=0.052407
[EpochKL] epoch=0 mean_kl=0.00240 max_kl=0.00343
[EpochKL] epoch=1 mean_kl=0.00543 max_kl=0.00956
[EpochKL] epoch=2 mean_kl=0.00427 max_kl=0.00623
[Time] Env Create Time: 2.6852s |Rollout Collect Time: 3.6806s |Loss & Update :1.9396
[PPODiag] kl_mean=0.0040, kl_p90=0.0063, kl_max=0.0096 | clipfrac_mean=0.033, logratio_std_mean=0.089, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.750, p10=0.744, min=0.742 | pg_loss_mean=0.0015, v_loss_mean=0.2260, ent_mean=0.1495 | gn_bb_mean=1.429, gn_bb_max=2.438 | gn_v_mean=0.814, gn_v_max=2.120
[AttnScore] scale=1.0267, C=10.0

  2%|▏         | 121/5000 [21:05<13:06:20,  9.67s/it]------------------ Training Record ------------------
Epoch: 121/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=34, valid_ratio=0.507, reward_valid_mean=0.3015, reward_valid_std=2.2759
[BatchDiag] adv_mean=-0.0643, adv_std=1.0637, adv_abs_mean=0.8180 | ret_mean=6.5911, ret_std=1.7867 | val_mean=6.6554, val_std=1.4351 | explained_var=0.645595
[GradSplit pre-clip] backbone=0.460227, critic=0.623638
[Loss] pg_loss=-0.093799, entropy_loss=0.000102, value_loss=0.055596
[EpochKL] epoch=0 mean_kl=0.00205 max_kl=0.00299
[EpochKL] epoch=1 mean_kl=0.00350 max_kl=0.00616
[EpochKL] epoch=2 mean_kl=0.00605 max_kl=0.00817
[Time] Env Create Time: 2.8495s |Rollout Collect Time: 5.3501s |Loss & Update :2.7377
[PPODiag] kl_mean=0.0039, kl_p90=0.0069, kl_max=0.0082 | clipfrac_mean=0.031, logratio_std_mean=0.087, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.507, p10=0.504, min=0.502 | pg_loss_mean=0.0014, v_loss_mean=0.2237, ent_mean=0.1003 | gn_bb_mean=1.439, gn_bb_max=2.365 | gn_v_mean=0.622, gn_v_max=1.346

  2%|▏         | 122/5000 [21:16<13:37:06, 10.05s/it]------------------ Training Record ------------------
Epoch: 122/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.752, reward_valid_mean=0.3024, reward_valid_std=2.2718
[BatchDiag] adv_mean=-0.0482, adv_std=1.0400, adv_abs_mean=0.7988 | ret_mean=6.6063, ret_std=1.7862 | val_mean=6.6546, val_std=1.4603 | explained_var=0.661010
[GradSplit pre-clip] backbone=0.737123, critic=1.022711
[Loss] pg_loss=-0.156041, entropy_loss=0.000148, value_loss=0.052703
[EpochKL] epoch=0 mean_kl=0.00228 max_kl=0.00381
[EpochKL] epoch=1 mean_kl=0.00335 max_kl=0.00589
[EpochKL] epoch=2 mean_kl=0.00505 max_kl=0.00749
[Time] Env Create Time: 2.8543s |Rollout Collect Time: 3.6630s |Loss & Update :1.9406
[PPODiag] kl_mean=0.0036, kl_p90=0.0057, kl_max=0.0075 | clipfrac_mean=0.030, logratio_std_mean=0.085, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.752, p10=0.745, min=0.745 | pg_loss_mean=0.0011, v_loss_mean=0.2161, ent_mean=0.1485 | gn_bb_mean=1.351, gn_bb_max=2.145 | gn_v_mean=0.766, gn_v_max=1.881

  2%|▏         | 123/5000 [21:25<12:58:06,  9.57s/it]------------------ Training Record ------------------
Epoch: 123/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3033, reward_valid_std=2.2733
[BatchDiag] adv_mean=-0.0709, adv_std=1.0456, adv_abs_mean=0.8027 | ret_mean=6.6244, ret_std=1.7829 | val_mean=6.6953, val_std=1.4648 | explained_var=0.656095
[GradSplit pre-clip] backbone=0.638024, critic=0.786831
[Loss] pg_loss=-0.131539, entropy_loss=0.000151, value_loss=0.052732
[EpochKL] epoch=0 mean_kl=0.00245 max_kl=0.00387
[EpochKL] epoch=1 mean_kl=0.00514 max_kl=0.00939
[EarlyStop] epoch=2 mean_kl=0.01070 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01070 max_kl=0.01662
[Time] Env Create Time: 2.8596s |Rollout Collect Time: 3.5217s |Loss & Update :1.8745
[PPODiag] kl_mean=0.0061, kl_p90=0.0112, kl_max=0.0166 | clipfrac_mean=0.038, logratio_std_mean=0.108, ratio_p95_mean=1.066 | valid_ratio_mb_mean=0.786, p10=0.781, min=0.779 | pg_loss_mean=0.0026, v_loss_mean=0.2202, ent_mean=0.1554 | gn_bb_mean=1.677, gn_bb_max=2.631 | gn_v_mean=0.935, gn_v_max=2.523

  2%|▏         | 124/5000 [21:33<12:25:51,  9.18s/it]------------------ Training Record ------------------
Epoch: 124/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.2998, reward_valid_std=2.2702
[BatchDiag] adv_mean=-0.1072, adv_std=1.0438, adv_abs_mean=0.8106 | ret_mean=6.5971, ret_std=1.7868 | val_mean=6.7043, val_std=1.4392 | explained_var=0.658754
[GradSplit pre-clip] backbone=0.459728, critic=0.422769
[Loss] pg_loss=-0.131716, entropy_loss=0.000151, value_loss=0.047500
[EpochKL] epoch=0 mean_kl=0.00575 max_kl=0.00908
[EpochKL] epoch=1 mean_kl=0.00639 max_kl=0.00968
[EpochKL] epoch=2 mean_kl=0.00918 max_kl=0.01614
[Time] Env Create Time: 2.6764s |Rollout Collect Time: 3.5190s |Loss & Update :1.8806
[PPODiag] kl_mean=0.0071, kl_p90=0.0106, kl_max=0.0161 | clipfrac_mean=0.046, logratio_std_mean=0.119, ratio_p95_mean=1.074 | valid_ratio_mb_mean=0.788, p10=0.782, min=0.780 | pg_loss_mean=0.0032, v_loss_mean=0.2238, ent_mean=0.1561 | gn_bb_mean=1.852, gn_bb_max=3.043 | gn_v_mean=1.531, gn_v_max=3.313

  2%|▎         | 125/5000 [21:41<11:58:51,  8.85s/it]------------------ Training Record ------------------
Epoch: 125/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3023, reward_valid_std=2.2710
[BatchDiag] adv_mean=-0.1541, adv_std=1.0352, adv_abs_mean=0.7954 | ret_mean=6.6322, ret_std=1.7689 | val_mean=6.7863, val_std=1.4448 | explained_var=0.657531
[GradSplit pre-clip] backbone=0.490162, critic=0.464400
[Loss] pg_loss=-0.162050, entropy_loss=0.000154, value_loss=0.049263
[EpochKL] epoch=0 mean_kl=0.00578 max_kl=0.00875
[EpochKL] epoch=1 mean_kl=0.00716 max_kl=0.00923
[EpochKL] epoch=2 mean_kl=0.00664 max_kl=0.01074
[Time] Env Create Time: 2.8249s |Rollout Collect Time: 3.5229s |Loss & Update :1.8649
[PPODiag] kl_mean=0.0065, kl_p90=0.0089, kl_max=0.0107 | clipfrac_mean=0.045, logratio_std_mean=0.115, ratio_p95_mean=1.072 | valid_ratio_mb_mean=0.786, p10=0.780, min=0.776 | pg_loss_mean=0.0030, v_loss_mean=0.2183, ent_mean=0.1565 | gn_bb_mean=1.616, gn_bb_max=2.329 | gn_v_mean=1.192, gn_v_max=3.163
[AttnScore] scale=1.0283, C=10.0

  3%|▎         | 126/5000 [21:49<11:43:14,  8.66s/it]------------------ Training Record ------------------
Epoch: 126/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3060, reward_valid_std=2.2714
[BatchDiag] adv_mean=-0.1590, adv_std=1.0044, adv_abs_mean=0.7763 | ret_mean=6.6765, ret_std=1.7526 | val_mean=6.8354, val_std=1.4008 | explained_var=0.671584
[GradSplit pre-clip] backbone=0.515779, critic=0.387932
[Loss] pg_loss=-0.110572, entropy_loss=0.000168, value_loss=0.048276
[EpochKL] epoch=0 mean_kl=0.00613 max_kl=0.01147
[EpochKL] epoch=1 mean_kl=0.00799 max_kl=0.01612
[EpochKL] epoch=2 mean_kl=0.00565 max_kl=0.00942
[Time] Env Create Time: 2.8435s |Rollout Collect Time: 3.3601s |Loss & Update :1.8107
[PPODiag] kl_mean=0.0066, kl_p90=0.0098, kl_max=0.0161 | clipfrac_mean=0.043, logratio_std_mean=0.115, ratio_p95_mean=1.071 | valid_ratio_mb_mean=0.823, p10=0.815, min=0.815 | pg_loss_mean=0.0029, v_loss_mean=0.2089, ent_mean=0.1632 | gn_bb_mean=1.722, gn_bb_max=2.876 | gn_v_mean=1.403, gn_v_max=3.099

  3%|▎         | 127/5000 [21:57<11:27:27,  8.46s/it]------------------ Training Record ------------------
Epoch: 127/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3015, reward_valid_std=2.2691
[BatchDiag] adv_mean=-0.2664, adv_std=1.0224, adv_abs_mean=0.8002 | ret_mean=6.6718, ret_std=1.7362 | val_mean=6.9381, val_std=1.4056 | explained_var=0.653182
[GradSplit pre-clip] backbone=0.479342, critic=0.803307
[Loss] pg_loss=-0.138654, entropy_loss=0.000166, value_loss=0.052818
[EpochKL] epoch=0 mean_kl=0.00387 max_kl=0.00671
[EpochKL] epoch=1 mean_kl=0.00463 max_kl=0.00647
[EpochKL] epoch=2 mean_kl=0.00446 max_kl=0.00716
[Time] Env Create Time: 2.8541s |Rollout Collect Time: 3.3811s |Loss & Update :1.7920
[PPODiag] kl_mean=0.0043, kl_p90=0.0066, kl_max=0.0072 | clipfrac_mean=0.034, logratio_std_mean=0.092, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.824, p10=0.820, min=0.814 | pg_loss_mean=0.0014, v_loss_mean=0.2179, ent_mean=0.1626 | gn_bb_mean=1.419, gn_bb_max=2.089 | gn_v_mean=1.605, gn_v_max=3.390

  3%|▎         | 128/5000 [22:05<11:16:40,  8.33s/it]------------------ Training Record ------------------
Epoch: 128/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3016, reward_valid_std=2.2722
[BatchDiag] adv_mean=-0.2183, adv_std=1.0575, adv_abs_mean=0.8194 | ret_mean=6.6579, ret_std=1.7676 | val_mean=6.8761, val_std=1.4090 | explained_var=0.642027
[GradSplit pre-clip] backbone=0.669062, critic=0.778350
[Loss] pg_loss=-0.098111, entropy_loss=0.000158, value_loss=0.055252
[EpochKL] epoch=0 mean_kl=0.00284 max_kl=0.00546
[EpochKL] epoch=1 mean_kl=0.00365 max_kl=0.00805
[EpochKL] epoch=2 mean_kl=0.00381 max_kl=0.00524
[Time] Env Create Time: 2.6916s |Rollout Collect Time: 3.5328s |Loss & Update :1.8669
[PPODiag] kl_mean=0.0034, kl_p90=0.0050, kl_max=0.0081 | clipfrac_mean=0.030, logratio_std_mean=0.081, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.782 | pg_loss_mean=0.0014, v_loss_mean=0.2250, ent_mean=0.1544 | gn_bb_mean=1.370, gn_bb_max=2.152 | gn_v_mean=1.058, gn_v_max=2.257

  3%|▎         | 129/5000 [22:13<11:10:38,  8.26s/it]------------------ Training Record ------------------
Epoch: 129/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=46, valid_ratio=0.376, reward_valid_mean=0.3023, reward_valid_std=2.2699
[BatchDiag] adv_mean=-0.2177, adv_std=1.0658, adv_abs_mean=0.8123 | ret_mean=6.6705, ret_std=1.7587 | val_mean=6.8882, val_std=1.4391 | explained_var=0.632726
[GradSplit pre-clip] backbone=0.393142, critic=0.401824
[Loss] pg_loss=-0.184152, entropy_loss=0.000074, value_loss=0.047790
[EpochKL] epoch=0 mean_kl=0.00291 max_kl=0.00461
[EpochKL] epoch=1 mean_kl=0.00343 max_kl=0.00521
[EpochKL] epoch=2 mean_kl=0.00403 max_kl=0.00609
[Time] Env Create Time: 2.8580s |Rollout Collect Time: 7.1729s |Loss & Update :3.6160
[PPODiag] kl_mean=0.0035, kl_p90=0.0048, kl_max=0.0061 | clipfrac_mean=0.030, logratio_std_mean=0.082, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.376, p10=0.373, min=0.370 | pg_loss_mean=0.0011, v_loss_mean=0.2231, ent_mean=0.0740 | gn_bb_mean=1.376, gn_bb_max=2.150 | gn_v_mean=1.139, gn_v_max=2.946

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.989, Step: 21, Avg Done Step: 18.30, #CS visited: 0.48
D->C12->C1->C15->C14->C3->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->D
Eval cost : 4.0024s
-----------------------------
  3%|▎         | 130/5000 [22:31<15:00:34, 11.10s/it]------------------ Training Record ------------------
Epoch: 130/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3046, reward_valid_std=2.2761
[BatchDiag] adv_mean=-0.2399, adv_std=1.0390, adv_abs_mean=0.7995 | ret_mean=6.7035, ret_std=1.7341 | val_mean=6.9434, val_std=1.4620 | explained_var=0.640982
[GradSplit pre-clip] backbone=0.396759, critic=0.671459
[Loss] pg_loss=-0.131269, entropy_loss=0.000162, value_loss=0.046580
[EpochKL] epoch=0 mean_kl=0.00203 max_kl=0.00358
[EpochKL] epoch=1 mean_kl=0.00222 max_kl=0.00365
[EpochKL] epoch=2 mean_kl=0.00316 max_kl=0.00481
[Time] Env Create Time: 2.8569s |Rollout Collect Time: 3.3827s |Loss & Update :1.7996
[PPODiag] kl_mean=0.0025, kl_p90=0.0036, kl_max=0.0048 | clipfrac_mean=0.023, logratio_std_mean=0.069, ratio_p95_mean=1.043 | valid_ratio_mb_mean=0.822, p10=0.817, min=0.812 | pg_loss_mean=0.0008, v_loss_mean=0.2188, ent_mean=0.1558 | gn_bb_mean=1.239, gn_bb_max=1.873 | gn_v_mean=1.413, gn_v_max=2.875
[AttnScore] scale=1.0299, C=10.0

  3%|▎         | 131/5000 [22:39<13:45:59, 10.18s/it]------------------ Training Record ------------------
Epoch: 131/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.783, reward_valid_mean=0.3043, reward_valid_std=2.2764
[BatchDiag] adv_mean=-0.2411, adv_std=1.0531, adv_abs_mean=0.8149 | ret_mean=6.6678, ret_std=1.7517 | val_mean=6.9089, val_std=1.4109 | explained_var=0.638613
[GradSplit pre-clip] backbone=0.424280, critic=0.544172
[Loss] pg_loss=-0.146089, entropy_loss=0.000152, value_loss=0.050047
[EpochKL] epoch=0 mean_kl=0.00259 max_kl=0.00486
[EpochKL] epoch=1 mean_kl=0.00681 max_kl=0.00852
[EpochKL] epoch=2 mean_kl=0.00970 max_kl=0.01425
[Time] Env Create Time: 2.8671s |Rollout Collect Time: 3.5120s |Loss & Update :1.8702
[PPODiag] kl_mean=0.0064, kl_p90=0.0106, kl_max=0.0142 | clipfrac_mean=0.042, logratio_std_mean=0.110, ratio_p95_mean=1.066 | valid_ratio_mb_mean=0.783, p10=0.778, min=0.776 | pg_loss_mean=0.0030, v_loss_mean=0.2239, ent_mean=0.1477 | gn_bb_mean=1.684, gn_bb_max=2.572 | gn_v_mean=1.306, gn_v_max=2.778

  3%|▎         | 132/5000 [22:47<12:58:52,  9.60s/it]------------------ Training Record ------------------
Epoch: 132/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3040, reward_valid_std=2.2725
[BatchDiag] adv_mean=-0.2400, adv_std=1.0462, adv_abs_mean=0.8158 | ret_mean=6.6719, ret_std=1.7404 | val_mean=6.9118, val_std=1.3666 | explained_var=0.638649
[GradSplit pre-clip] backbone=0.668377, critic=0.685872
[Loss] pg_loss=-0.129161, entropy_loss=0.000151, value_loss=0.052406
[EpochKL] epoch=0 mean_kl=0.00468 max_kl=0.00856
[EpochKL] epoch=1 mean_kl=0.00414 max_kl=0.00685
[EpochKL] epoch=2 mean_kl=0.00417 max_kl=0.00670
[Time] Env Create Time: 2.6877s |Rollout Collect Time: 3.5296s |Loss & Update :1.8687
[PPODiag] kl_mean=0.0043, kl_p90=0.0068, kl_max=0.0086 | clipfrac_mean=0.034, logratio_std_mean=0.092, ratio_p95_mean=1.059 | valid_ratio_mb_mean=0.786, p10=0.780, min=0.778 | pg_loss_mean=0.0016, v_loss_mean=0.2207, ent_mean=0.1556 | gn_bb_mean=1.327, gn_bb_max=2.695 | gn_v_mean=0.936, gn_v_max=2.101

  3%|▎         | 133/5000 [22:55<12:21:53,  9.15s/it]------------------ Training Record ------------------
Epoch: 133/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.784, reward_valid_mean=0.3059, reward_valid_std=2.2750
[BatchDiag] adv_mean=-0.1512, adv_std=1.0418, adv_abs_mean=0.8021 | ret_mean=6.6650, ret_std=1.7514 | val_mean=6.8162, val_std=1.4097 | explained_var=0.646212
[GradSplit pre-clip] backbone=0.346499, critic=0.389024
[Loss] pg_loss=-0.085654, entropy_loss=0.000152, value_loss=0.050677
[EpochKL] epoch=0 mean_kl=0.00216 max_kl=0.00315
[EpochKL] epoch=1 mean_kl=0.00315 max_kl=0.00422
[EpochKL] epoch=2 mean_kl=0.00274 max_kl=0.00376
[Time] Env Create Time: 2.8450s |Rollout Collect Time: 3.5211s |Loss & Update :1.8742
[PPODiag] kl_mean=0.0027, kl_p90=0.0037, kl_max=0.0042 | clipfrac_mean=0.025, logratio_std_mean=0.073, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.784, p10=0.778, min=0.775 | pg_loss_mean=0.0006, v_loss_mean=0.2182, ent_mean=0.1515 | gn_bb_mean=1.171, gn_bb_max=1.509 | gn_v_mean=0.952, gn_v_max=2.112

  3%|▎         | 134/5000 [23:04<11:59:42,  8.87s/it]------------------ Training Record ------------------
Epoch: 134/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=28, valid_ratio=0.617, reward_valid_mean=0.3037, reward_valid_std=2.2728
[BatchDiag] adv_mean=-0.1651, adv_std=1.0724, adv_abs_mean=0.8186 | ret_mean=6.6563, ret_std=1.7680 | val_mean=6.8214, val_std=1.4404 | explained_var=0.632102
[GradSplit pre-clip] backbone=0.341653, critic=0.406144
[Loss] pg_loss=-0.069706, entropy_loss=0.000116, value_loss=0.055522
[EpochKL] epoch=0 mean_kl=0.00211 max_kl=0.00360
[EpochKL] epoch=1 mean_kl=0.00445 max_kl=0.00638
[EpochKL] epoch=2 mean_kl=0.00414 max_kl=0.00619
[Time] Env Create Time: 2.8543s |Rollout Collect Time: 4.4460s |Loss & Update :2.3036
[PPODiag] kl_mean=0.0036, kl_p90=0.0061, kl_max=0.0064 | clipfrac_mean=0.029, logratio_std_mean=0.084, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.617, p10=0.612, min=0.611 | pg_loss_mean=0.0014, v_loss_mean=0.2265, ent_mean=0.1204 | gn_bb_mean=1.275, gn_bb_max=1.777 | gn_v_mean=1.107, gn_v_max=3.001

  3%|▎         | 135/5000 [23:13<12:17:19,  9.09s/it]------------------ Training Record ------------------
Epoch: 135/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.750, reward_valid_mean=0.3053, reward_valid_std=2.2732
[BatchDiag] adv_mean=-0.1244, adv_std=1.0250, adv_abs_mean=0.7850 | ret_mean=6.6534, ret_std=1.7469 | val_mean=6.7778, val_std=1.4747 | explained_var=0.655759
[GradSplit pre-clip] backbone=0.521875, critic=0.391690
[Loss] pg_loss=-0.093302, entropy_loss=0.000150, value_loss=0.054434
[EpochKL] epoch=0 mean_kl=0.00458 max_kl=0.01067
[EpochKL] epoch=1 mean_kl=0.00602 max_kl=0.01075
[EpochKL] epoch=2 mean_kl=0.00478 max_kl=0.00664
[Time] Env Create Time: 2.7049s |Rollout Collect Time: 3.6829s |Loss & Update :1.9449
[PPODiag] kl_mean=0.0051, kl_p90=0.0081, kl_max=0.0108 | clipfrac_mean=0.038, logratio_std_mean=0.100, ratio_p95_mean=1.063 | valid_ratio_mb_mean=0.750, p10=0.746, min=0.744 | pg_loss_mean=0.0023, v_loss_mean=0.2133, ent_mean=0.1460 | gn_bb_mean=1.744, gn_bb_max=3.089 | gn_v_mean=1.053, gn_v_max=1.976
[AttnScore] scale=1.0316, C=10.0

  3%|▎         | 136/5000 [23:22<11:58:41,  8.87s/it]------------------ Training Record ------------------
Epoch: 136/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3028, reward_valid_std=2.2722
[BatchDiag] adv_mean=-0.1024, adv_std=1.0511, adv_abs_mean=0.8030 | ret_mean=6.6160, ret_std=1.7733 | val_mean=6.7183, val_std=1.4680 | explained_var=0.648655
[GradSplit pre-clip] backbone=0.510359, critic=0.385201
[Loss] pg_loss=-0.099190, entropy_loss=0.000154, value_loss=0.050175
[EpochKL] epoch=0 mean_kl=0.00168 max_kl=0.00272
[EpochKL] epoch=1 mean_kl=0.00285 max_kl=0.00346
[EpochKL] epoch=2 mean_kl=0.00363 max_kl=0.00444
[Time] Env Create Time: 2.8456s |Rollout Collect Time: 3.5176s |Loss & Update :1.8872
[PPODiag] kl_mean=0.0027, kl_p90=0.0037, kl_max=0.0044 | clipfrac_mean=0.025, logratio_std_mean=0.073, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.785, p10=0.780, min=0.776 | pg_loss_mean=0.0006, v_loss_mean=0.2199, ent_mean=0.1516 | gn_bb_mean=1.100, gn_bb_max=1.701 | gn_v_mean=0.995, gn_v_max=2.656

  3%|▎         | 137/5000 [23:30<11:43:35,  8.68s/it]------------------ Training Record ------------------
Epoch: 137/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.784, reward_valid_mean=0.3049, reward_valid_std=2.2740
[BatchDiag] adv_mean=-0.1034, adv_std=1.0467, adv_abs_mean=0.7973 | ret_mean=6.6391, ret_std=1.7624 | val_mean=6.7424, val_std=1.4565 | explained_var=0.647311
[GradSplit pre-clip] backbone=0.746767, critic=0.981987
[Loss] pg_loss=-0.193770, entropy_loss=0.000155, value_loss=0.047805
[EpochKL] epoch=0 mean_kl=0.00265 max_kl=0.00512
[EpochKL] epoch=1 mean_kl=0.00381 max_kl=0.00574
[EpochKL] epoch=2 mean_kl=0.00468 max_kl=0.00726
[Time] Env Create Time: 2.8605s |Rollout Collect Time: 3.5179s |Loss & Update :1.8860
[PPODiag] kl_mean=0.0037, kl_p90=0.0055, kl_max=0.0073 | clipfrac_mean=0.030, logratio_std_mean=0.087, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.784, p10=0.778, min=0.774 | pg_loss_mean=0.0012, v_loss_mean=0.2217, ent_mean=0.1506 | gn_bb_mean=1.304, gn_bb_max=1.932 | gn_v_mean=1.492, gn_v_max=2.851

  3%|▎         | 138/5000 [23:38<11:33:19,  8.56s/it]------------------ Training Record ------------------
Epoch: 138/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3036, reward_valid_std=2.2723
[BatchDiag] adv_mean=-0.1428, adv_std=1.0303, adv_abs_mean=0.7948 | ret_mean=6.6294, ret_std=1.7571 | val_mean=6.7722, val_std=1.4360 | explained_var=0.656178
[GradSplit pre-clip] backbone=0.373364, critic=0.379731
[Loss] pg_loss=-0.078793, entropy_loss=0.000158, value_loss=0.054859
[EpochKL] epoch=0 mean_kl=0.00194 max_kl=0.00376
[EpochKL] epoch=1 mean_kl=0.00269 max_kl=0.00391
[EpochKL] epoch=2 mean_kl=0.00364 max_kl=0.00444
[Time] Env Create Time: 2.8659s |Rollout Collect Time: 3.5295s |Loss & Update :1.8769
[PPODiag] kl_mean=0.0028, kl_p90=0.0040, kl_max=0.0044 | clipfrac_mean=0.026, logratio_std_mean=0.074, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.785, p10=0.780, min=0.780 | pg_loss_mean=0.0009, v_loss_mean=0.2164, ent_mean=0.1510 | gn_bb_mean=1.176, gn_bb_max=1.816 | gn_v_mean=1.230, gn_v_max=3.296

  3%|▎         | 139/5000 [23:46<11:26:18,  8.47s/it]------------------ Training Record ------------------
Epoch: 139/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=29, valid_ratio=0.595, reward_valid_mean=0.3053, reward_valid_std=2.2750
[BatchDiag] adv_mean=-0.0656, adv_std=1.0401, adv_abs_mean=0.7926 | ret_mean=6.6265, ret_std=1.7749 | val_mean=6.6921, val_std=1.4639 | explained_var=0.656590
[GradSplit pre-clip] backbone=0.454763, critic=0.833538
[Loss] pg_loss=-0.147754, entropy_loss=0.000117, value_loss=0.049812
[EpochKL] epoch=0 mean_kl=0.00165 max_kl=0.00224
[EpochKL] epoch=1 mean_kl=0.00361 max_kl=0.00709
[EpochKL] epoch=2 mean_kl=0.00399 max_kl=0.00650
[Time] Env Create Time: 2.6964s |Rollout Collect Time: 4.5790s |Loss & Update :2.3836
[PPODiag] kl_mean=0.0031, kl_p90=0.0050, kl_max=0.0071 | clipfrac_mean=0.027, logratio_std_mean=0.077, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.595, p10=0.591, min=0.590 | pg_loss_mean=0.0012, v_loss_mean=0.2162, ent_mean=0.1117 | gn_bb_mean=1.303, gn_bb_max=2.147 | gn_v_mean=1.005, gn_v_max=2.268

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.959, Step: 21, Avg Done Step: 18.30, #CS visited: 0.47
D->C12->C1->C15->C14->C3->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->D
Eval cost : 4.0641s
-----------------------------
  3%|▎         | 140/5000 [24:00<13:38:47, 10.11s/it]------------------ Training Record ------------------
Epoch: 140/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3063, reward_valid_std=2.2737
[BatchDiag] adv_mean=0.0088, adv_std=1.0473, adv_abs_mean=0.8006 | ret_mean=6.6167, ret_std=1.7782 | val_mean=6.6080, val_std=1.4960 | explained_var=0.653125
[GradSplit pre-clip] backbone=0.551722, critic=1.142022
[Loss] pg_loss=-0.109828, entropy_loss=0.000157, value_loss=0.053903
[EpochKL] epoch=0 mean_kl=0.00342 max_kl=0.00841
[EpochKL] epoch=1 mean_kl=0.00622 max_kl=0.00820
[EpochKL] epoch=2 mean_kl=0.00381 max_kl=0.00673
[Time] Env Create Time: 2.6620s |Rollout Collect Time: 3.5324s |Loss & Update :1.8785
[PPODiag] kl_mean=0.0045, kl_p90=0.0079, kl_max=0.0084 | clipfrac_mean=0.035, logratio_std_mean=0.092, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.785, p10=0.780, min=0.779 | pg_loss_mean=0.0018, v_loss_mean=0.2198, ent_mean=0.1523 | gn_bb_mean=1.623, gn_bb_max=2.899 | gn_v_mean=1.314, gn_v_max=2.408
[AttnScore] scale=1.0337, C=10.0

  3%|▎         | 141/5000 [24:08<12:49:10,  9.50s/it]------------------ Training Record ------------------
Epoch: 141/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3076, reward_valid_std=2.2724
[BatchDiag] adv_mean=-0.1060, adv_std=1.0166, adv_abs_mean=0.7833 | ret_mean=6.6557, ret_std=1.7593 | val_mean=6.7617, val_std=1.4266 | explained_var=0.666068
[GradSplit pre-clip] backbone=0.452058, critic=0.663491
[Loss] pg_loss=-0.160447, entropy_loss=0.000148, value_loss=0.049429
[EpochKL] epoch=0 mean_kl=0.00197 max_kl=0.00311
[EpochKL] epoch=1 mean_kl=0.00273 max_kl=0.00410
[EpochKL] epoch=2 mean_kl=0.00417 max_kl=0.00652
[Time] Env Create Time: 2.8375s |Rollout Collect Time: 3.3598s |Loss & Update :1.8063
[PPODiag] kl_mean=0.0030, kl_p90=0.0052, kl_max=0.0065 | clipfrac_mean=0.025, logratio_std_mean=0.076, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.822, p10=0.817, min=0.812 | pg_loss_mean=0.0008, v_loss_mean=0.2109, ent_mean=0.1555 | gn_bb_mean=1.089, gn_bb_max=1.797 | gn_v_mean=1.118, gn_v_max=2.747

  3%|▎         | 142/5000 [24:16<12:12:43,  9.05s/it]------------------ Training Record ------------------
Epoch: 142/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3046, reward_valid_std=2.2717
[BatchDiag] adv_mean=-0.1464, adv_std=1.0318, adv_abs_mean=0.8007 | ret_mean=6.6392, ret_std=1.7666 | val_mean=6.7856, val_std=1.4039 | explained_var=0.658863
[GradSplit pre-clip] backbone=0.537577, critic=0.495757
[Loss] pg_loss=-0.126776, entropy_loss=0.000151, value_loss=0.052867
[EpochKL] epoch=0 mean_kl=0.00311 max_kl=0.00487
[EpochKL] epoch=1 mean_kl=0.00410 max_kl=0.00486
[EpochKL] epoch=2 mean_kl=0.00474 max_kl=0.00671
[Time] Env Create Time: 2.8391s |Rollout Collect Time: 3.4997s |Loss & Update :1.8776
[PPODiag] kl_mean=0.0040, kl_p90=0.0053, kl_max=0.0067 | clipfrac_mean=0.032, logratio_std_mean=0.089, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.786, p10=0.780, min=0.778 | pg_loss_mean=0.0017, v_loss_mean=0.2151, ent_mean=0.1476 | gn_bb_mean=1.502, gn_bb_max=2.419 | gn_v_mean=0.831, gn_v_max=1.803

  3%|▎         | 143/5000 [24:25<11:52:21,  8.80s/it]------------------ Training Record ------------------
Epoch: 143/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3066, reward_valid_std=2.2751
[BatchDiag] adv_mean=-0.1314, adv_std=1.0261, adv_abs_mean=0.7939 | ret_mean=6.6495, ret_std=1.7633 | val_mean=6.7809, val_std=1.3777 | explained_var=0.661400
[GradSplit pre-clip] backbone=0.705844, critic=0.483480
[Loss] pg_loss=-0.145991, entropy_loss=0.000153, value_loss=0.047408
[EpochKL] epoch=0 mean_kl=0.00505 max_kl=0.00747
[EpochKL] epoch=1 mean_kl=0.00519 max_kl=0.00644
[EpochKL] epoch=2 mean_kl=0.00531 max_kl=0.00720
[Time] Env Create Time: 2.6849s |Rollout Collect Time: 3.5291s |Loss & Update :1.8887
[PPODiag] kl_mean=0.0052, kl_p90=0.0068, kl_max=0.0075 | clipfrac_mean=0.039, logratio_std_mean=0.103, ratio_p95_mean=1.065 | valid_ratio_mb_mean=0.785, p10=0.781, min=0.773 | pg_loss_mean=0.0021, v_loss_mean=0.2153, ent_mean=0.1517 | gn_bb_mean=1.610, gn_bb_max=2.672 | gn_v_mean=1.283, gn_v_max=2.714

  3%|▎         | 144/5000 [24:33<11:35:17,  8.59s/it]------------------ Training Record ------------------
Epoch: 144/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.752, reward_valid_mean=0.3028, reward_valid_std=2.2717
[BatchDiag] adv_mean=-0.0795, adv_std=1.0482, adv_abs_mean=0.7981 | ret_mean=6.6044, ret_std=1.7985 | val_mean=6.6839, val_std=1.4340 | explained_var=0.660319
[GradSplit pre-clip] backbone=0.771948, critic=0.425919
[Loss] pg_loss=-0.072942, entropy_loss=0.000146, value_loss=0.051849
[EpochKL] epoch=0 mean_kl=0.00247 max_kl=0.00393
[EpochKL] epoch=1 mean_kl=0.00432 max_kl=0.00663
[EpochKL] epoch=2 mean_kl=0.00455 max_kl=0.00809
[Time] Env Create Time: 2.8372s |Rollout Collect Time: 3.6779s |Loss & Update :1.9360
[PPODiag] kl_mean=0.0038, kl_p90=0.0059, kl_max=0.0081 | clipfrac_mean=0.032, logratio_std_mean=0.086, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.752, p10=0.748, min=0.744 | pg_loss_mean=0.0014, v_loss_mean=0.2185, ent_mean=0.1433 | gn_bb_mean=1.245, gn_bb_max=1.885 | gn_v_mean=1.221, gn_v_max=3.942

  3%|▎         | 145/5000 [24:41<11:31:45,  8.55s/it]------------------ Training Record ------------------
Epoch: 145/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3039, reward_valid_std=2.2722
[BatchDiag] adv_mean=-0.1935, adv_std=1.0088, adv_abs_mean=0.7857 | ret_mean=6.6590, ret_std=1.7593 | val_mean=6.8525, val_std=1.3963 | explained_var=0.671215
[GradSplit pre-clip] backbone=0.506862, critic=1.120006
[Loss] pg_loss=-0.081593, entropy_loss=0.000152, value_loss=0.051530
[EpochKL] epoch=0 mean_kl=0.00413 max_kl=0.00704
[EpochKL] epoch=1 mean_kl=0.00681 max_kl=0.01050
[EpochKL] epoch=2 mean_kl=0.00858 max_kl=0.01277
[Time] Env Create Time: 2.8505s |Rollout Collect Time: 3.5369s |Loss & Update :1.8823
[PPODiag] kl_mean=0.0065, kl_p90=0.0105, kl_max=0.0128 | clipfrac_mean=0.043, logratio_std_mean=0.114, ratio_p95_mean=1.069 | valid_ratio_mb_mean=0.786, p10=0.782, min=0.782 | pg_loss_mean=0.0030, v_loss_mean=0.2134, ent_mean=0.1495 | gn_bb_mean=1.802, gn_bb_max=2.673 | gn_v_mean=1.671, gn_v_max=3.143
[AttnScore] scale=1.0356, C=10.0

  3%|▎         | 146/5000 [24:50<11:24:51,  8.47s/it]------------------ Training Record ------------------
Epoch: 146/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3044, reward_valid_std=2.2700
[BatchDiag] adv_mean=-0.2107, adv_std=1.0252, adv_abs_mean=0.7903 | ret_mean=6.6636, ret_std=1.7559 | val_mean=6.8743, val_std=1.3789 | explained_var=0.659125
[GradSplit pre-clip] backbone=0.566558, critic=0.792262
[Loss] pg_loss=-0.092903, entropy_loss=0.000160, value_loss=0.050880
[EpochKL] epoch=0 mean_kl=0.00244 max_kl=0.00377
[EpochKL] epoch=1 mean_kl=0.00393 max_kl=0.00515
[EpochKL] epoch=2 mean_kl=0.00386 max_kl=0.00574
[Time] Env Create Time: 2.8558s |Rollout Collect Time: 3.3580s |Loss & Update :1.8107
[PPODiag] kl_mean=0.0034, kl_p90=0.0050, kl_max=0.0057 | clipfrac_mean=0.029, logratio_std_mean=0.082, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.824, p10=0.819, min=0.818 | pg_loss_mean=0.0010, v_loss_mean=0.2152, ent_mean=0.1556 | gn_bb_mean=1.300, gn_bb_max=2.187 | gn_v_mean=1.451, gn_v_max=2.821

  3%|▎         | 147/5000 [24:58<11:14:01,  8.33s/it]------------------ Training Record ------------------
Epoch: 147/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3090, reward_valid_std=2.2737
[BatchDiag] adv_mean=-0.2475, adv_std=0.9948, adv_abs_mean=0.7796 | ret_mean=6.7234, ret_std=1.7224 | val_mean=6.9709, val_std=1.3499 | explained_var=0.666440
[GradSplit pre-clip] backbone=0.445840, critic=0.489689
[Loss] pg_loss=-0.198371, entropy_loss=0.000151, value_loss=0.045646
[EpochKL] epoch=0 mean_kl=0.00239 max_kl=0.00453
[EpochKL] epoch=1 mean_kl=0.00362 max_kl=0.00489
[EpochKL] epoch=2 mean_kl=0.00428 max_kl=0.00542
[Time] Env Create Time: 2.6840s |Rollout Collect Time: 3.5082s |Loss & Update :1.8772
[PPODiag] kl_mean=0.0034, kl_p90=0.0049, kl_max=0.0054 | clipfrac_mean=0.031, logratio_std_mean=0.082, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.785, p10=0.778, min=0.771 | pg_loss_mean=0.0009, v_loss_mean=0.2090, ent_mean=0.1476 | gn_bb_mean=1.300, gn_bb_max=1.611 | gn_v_mean=1.756, gn_v_max=3.151

  3%|▎         | 148/5000 [25:06<11:07:29,  8.25s/it]------------------ Training Record ------------------
Epoch: 148/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3064, reward_valid_std=2.2716
[BatchDiag] adv_mean=-0.2554, adv_std=1.0111, adv_abs_mean=0.7950 | ret_mean=6.6887, ret_std=1.7357 | val_mean=6.9441, val_std=1.3501 | explained_var=0.660673
[GradSplit pre-clip] backbone=0.466688, critic=1.433695
[Loss] pg_loss=-0.107340, entropy_loss=0.000158, value_loss=0.049392
[EpochKL] epoch=0 mean_kl=0.00192 max_kl=0.00379
[EpochKL] epoch=1 mean_kl=0.00350 max_kl=0.00563
[EpochKL] epoch=2 mean_kl=0.00431 max_kl=0.00506
[Time] Env Create Time: 2.8217s |Rollout Collect Time: 3.5038s |Loss & Update :1.8757
[PPODiag] kl_mean=0.0032, kl_p90=0.0048, kl_max=0.0056 | clipfrac_mean=0.029, logratio_std_mean=0.079, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.785, p10=0.779, min=0.778 | pg_loss_mean=0.0010, v_loss_mean=0.2123, ent_mean=0.1479 | gn_bb_mean=1.209, gn_bb_max=1.829 | gn_v_mean=1.594, gn_v_max=2.498

  3%|▎         | 149/5000 [25:14<11:06:04,  8.24s/it]------------------ Training Record ------------------
Epoch: 149/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3064, reward_valid_std=2.2726
[BatchDiag] adv_mean=-0.2679, adv_std=1.0111, adv_abs_mean=0.7896 | ret_mean=6.6961, ret_std=1.7383 | val_mean=6.9639, val_std=1.3584 | explained_var=0.661624
[GradSplit pre-clip] backbone=0.552689, critic=1.298229
[Loss] pg_loss=-0.108131, entropy_loss=0.000148, value_loss=0.047206
[EpochKL] epoch=0 mean_kl=0.00380 max_kl=0.00641
[EpochKL] epoch=1 mean_kl=0.00576 max_kl=0.00788
[EpochKL] epoch=2 mean_kl=0.00756 max_kl=0.01045
[Time] Env Create Time: 2.8354s |Rollout Collect Time: 3.5121s |Loss & Update :1.8796
[PPODiag] kl_mean=0.0057, kl_p90=0.0086, kl_max=0.0105 | clipfrac_mean=0.041, logratio_std_mean=0.106, ratio_p95_mean=1.066 | valid_ratio_mb_mean=0.785, p10=0.779, min=0.778 | pg_loss_mean=0.0024, v_loss_mean=0.2152, ent_mean=0.1523 | gn_bb_mean=1.704, gn_bb_max=2.619 | gn_v_mean=1.845, gn_v_max=3.782

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.954, Step: 20, Avg Done Step: 18.31, #CS visited: 0.46
D->C13->C12->C1->C15->C14->C5->C2->D->C6->C4->C7->C11->C10->C9->C8->D->C3->D
Eval cost : 3.8537s
-----------------------------
  3%|▎         | 150/5000 [25:26<12:40:21,  9.41s/it]------------------ Training Record ------------------
Epoch: 150/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=43, valid_ratio=0.402, reward_valid_mean=0.3045, reward_valid_std=2.2721
[BatchDiag] adv_mean=-0.2582, adv_std=1.0407, adv_abs_mean=0.8000 | ret_mean=6.6869, ret_std=1.7563 | val_mean=6.9451, val_std=1.3861 | explained_var=0.648854
[GradSplit pre-clip] backbone=0.659988, critic=0.791498
[Loss] pg_loss=-0.178327, entropy_loss=0.000077, value_loss=0.048389
[EpochKL] epoch=0 mean_kl=0.00428 max_kl=0.00710
[EpochKL] epoch=1 mean_kl=0.00791 max_kl=0.01372
[EarlyStop] epoch=2 mean_kl=0.01047 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01047 max_kl=0.01546
[Time] Env Create Time: 2.8460s |Rollout Collect Time: 6.6488s |Loss & Update :3.4038
[PPODiag] kl_mean=0.0076, kl_p90=0.0135, kl_max=0.0155 | clipfrac_mean=0.046, logratio_std_mean=0.123, ratio_p95_mean=1.074 | valid_ratio_mb_mean=0.402, p10=0.399, min=0.396 | pg_loss_mean=0.0031, v_loss_mean=0.2202, ent_mean=0.0745 | gn_bb_mean=1.813, gn_bb_max=2.892 | gn_v_mean=1.420, gn_v_max=3.073
[AttnScore] scale=1.0373, C=10.0

  3%|▎         | 151/5000 [25:39<14:04:52, 10.45s/it]------------------ Training Record ------------------
Epoch: 151/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3028, reward_valid_std=2.2687
[BatchDiag] adv_mean=-0.2733, adv_std=0.9871, adv_abs_mean=0.7764 | ret_mean=6.6890, ret_std=1.7320 | val_mean=6.9624, val_std=1.4018 | explained_var=0.675190
[GradSplit pre-clip] backbone=0.548269, critic=1.418454
[Loss] pg_loss=-0.096535, entropy_loss=0.000143, value_loss=0.047921
[EpochKL] epoch=0 mean_kl=0.00453 max_kl=0.00690
[EpochKL] epoch=1 mean_kl=0.00645 max_kl=0.01263
[EpochKL] epoch=2 mean_kl=0.00537 max_kl=0.00836
[Time] Env Create Time: 2.6798s |Rollout Collect Time: 3.5144s |Loss & Update :1.8683
[PPODiag] kl_mean=0.0054, kl_p90=0.0079, kl_max=0.0126 | clipfrac_mean=0.040, logratio_std_mean=0.103, ratio_p95_mean=1.066 | valid_ratio_mb_mean=0.788, p10=0.782, min=0.778 | pg_loss_mean=0.0024, v_loss_mean=0.2117, ent_mean=0.1492 | gn_bb_mean=1.763, gn_bb_max=2.652 | gn_v_mean=2.222, gn_v_max=3.498

  3%|▎         | 152/5000 [25:47<13:06:44,  9.74s/it]------------------ Training Record ------------------
Epoch: 152/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3046, reward_valid_std=2.2716
[BatchDiag] adv_mean=-0.1996, adv_std=0.9994, adv_abs_mean=0.7712 | ret_mean=6.6861, ret_std=1.7569 | val_mean=6.8858, val_std=1.4091 | explained_var=0.676415
[GradSplit pre-clip] backbone=0.582839, critic=1.086815
[Loss] pg_loss=-0.056047, entropy_loss=0.000148, value_loss=0.046957
[EpochKL] epoch=0 mean_kl=0.00264 max_kl=0.00450
[EpochKL] epoch=1 mean_kl=0.00413 max_kl=0.00569
[EpochKL] epoch=2 mean_kl=0.00363 max_kl=0.00518
[Time] Env Create Time: 2.8300s |Rollout Collect Time: 3.5063s |Loss & Update :1.8705
[PPODiag] kl_mean=0.0035, kl_p90=0.0050, kl_max=0.0057 | clipfrac_mean=0.030, logratio_std_mean=0.083, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.786, p10=0.781, min=0.778 | pg_loss_mean=0.0012, v_loss_mean=0.2080, ent_mean=0.1471 | gn_bb_mean=1.300, gn_bb_max=2.281 | gn_v_mean=1.633, gn_v_max=3.555

  3%|▎         | 153/5000 [25:55<12:29:30,  9.28s/it]------------------ Training Record ------------------
Epoch: 153/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3049, reward_valid_std=2.2730
[BatchDiag] adv_mean=-0.2009, adv_std=1.0062, adv_abs_mean=0.7735 | ret_mean=6.6765, ret_std=1.7535 | val_mean=6.8773, val_std=1.4208 | explained_var=0.670693
[GradSplit pre-clip] backbone=0.694700, critic=0.663580
[Loss] pg_loss=-0.131941, entropy_loss=0.000160, value_loss=0.051971
[EpochKL] epoch=0 mean_kl=0.00173 max_kl=0.00383
[EpochKL] epoch=1 mean_kl=0.00378 max_kl=0.00588
[EpochKL] epoch=2 mean_kl=0.00528 max_kl=0.00714
[Time] Env Create Time: 2.8354s |Rollout Collect Time: 3.3553s |Loss & Update :1.8034
[PPODiag] kl_mean=0.0036, kl_p90=0.0061, kl_max=0.0071 | clipfrac_mean=0.030, logratio_std_mean=0.083, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.822, p10=0.817, min=0.816 | pg_loss_mean=0.0011, v_loss_mean=0.2093, ent_mean=0.1527 | gn_bb_mean=1.373, gn_bb_max=2.300 | gn_v_mean=1.559, gn_v_max=3.821

  3%|▎         | 154/5000 [26:03<11:58:15,  8.89s/it]------------------ Training Record ------------------
Epoch: 154/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=28, valid_ratio=0.617, reward_valid_mean=0.3054, reward_valid_std=2.2738
[BatchDiag] adv_mean=-0.2144, adv_std=0.9925, adv_abs_mean=0.7656 | ret_mean=6.6916, ret_std=1.7515 | val_mean=6.9060, val_std=1.3962 | explained_var=0.678922
[GradSplit pre-clip] backbone=0.622382, critic=0.860079
[Loss] pg_loss=-0.104604, entropy_loss=0.000116, value_loss=0.049331
[EpochKL] epoch=0 mean_kl=0.00282 max_kl=0.00516
[EpochKL] epoch=1 mean_kl=0.00394 max_kl=0.00568
[EpochKL] epoch=2 mean_kl=0.00531 max_kl=0.00817
[Time] Env Create Time: 2.6788s |Rollout Collect Time: 4.4395s |Loss & Update :2.3125
[PPODiag] kl_mean=0.0040, kl_p90=0.0069, kl_max=0.0082 | clipfrac_mean=0.032, logratio_std_mean=0.089, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.617, p10=0.613, min=0.610 | pg_loss_mean=0.0015, v_loss_mean=0.2079, ent_mean=0.1129 | gn_bb_mean=1.318, gn_bb_max=1.889 | gn_v_mean=1.896, gn_v_max=3.924

  3%|▎         | 155/5000 [26:13<12:11:08,  9.05s/it]------------------ Training Record ------------------
Epoch: 155/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3051, reward_valid_std=2.2734
[BatchDiag] adv_mean=-0.2041, adv_std=0.9908, adv_abs_mean=0.7730 | ret_mean=6.6875, ret_std=1.7578 | val_mean=6.8916, val_std=1.3999 | explained_var=0.682257
[GradSplit pre-clip] backbone=0.522505, critic=0.803732
[Loss] pg_loss=-0.099741, entropy_loss=0.000153, value_loss=0.054144
[EpochKL] epoch=0 mean_kl=0.00266 max_kl=0.00391
[EpochKL] epoch=1 mean_kl=0.00382 max_kl=0.00559
[EpochKL] epoch=2 mean_kl=0.00488 max_kl=0.00734
[Time] Env Create Time: 2.8390s |Rollout Collect Time: 3.3552s |Loss & Update :1.8072
[PPODiag] kl_mean=0.0038, kl_p90=0.0055, kl_max=0.0073 | clipfrac_mean=0.032, logratio_std_mean=0.087, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.823, p10=0.817, min=0.815 | pg_loss_mean=0.0014, v_loss_mean=0.2083, ent_mean=0.1531 | gn_bb_mean=1.344, gn_bb_max=2.100 | gn_v_mean=1.763, gn_v_max=3.640
[AttnScore] scale=1.0393, C=10.0

  3%|▎         | 156/5000 [26:21<11:45:30,  8.74s/it]------------------ Training Record ------------------
Epoch: 156/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=26, valid_ratio=0.664, reward_valid_mean=0.3081, reward_valid_std=2.2736
[BatchDiag] adv_mean=-0.2097, adv_std=0.9830, adv_abs_mean=0.7619 | ret_mean=6.7087, ret_std=1.7413 | val_mean=6.9184, val_std=1.3957 | explained_var=0.681333
[GradSplit pre-clip] backbone=0.387524, critic=1.241915
[Loss] pg_loss=-0.043609, entropy_loss=0.000122, value_loss=0.048402
[EpochKL] epoch=0 mean_kl=0.00313 max_kl=0.00525
[EpochKL] epoch=1 mean_kl=0.00490 max_kl=0.00696
[EpochKL] epoch=2 mean_kl=0.00409 max_kl=0.00523
[Time] Env Create Time: 2.8351s |Rollout Collect Time: 4.0906s |Loss & Update :2.1620
[PPODiag] kl_mean=0.0040, kl_p90=0.0059, kl_max=0.0070 | clipfrac_mean=0.033, logratio_std_mean=0.089, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.664, p10=0.660, min=0.657 | pg_loss_mean=0.0017, v_loss_mean=0.2039, ent_mean=0.1224 | gn_bb_mean=1.425, gn_bb_max=2.075 | gn_v_mean=1.785, gn_v_max=3.296

  3%|▎         | 157/5000 [26:30<11:53:49,  8.84s/it]------------------ Training Record ------------------
Epoch: 157/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3039, reward_valid_std=2.2705
[BatchDiag] adv_mean=-0.2827, adv_std=0.9832, adv_abs_mean=0.7698 | ret_mean=6.6997, ret_std=1.7403 | val_mean=6.9824, val_std=1.3821 | explained_var=0.680807
[GradSplit pre-clip] backbone=0.583386, critic=1.096680
[Loss] pg_loss=-0.144105, entropy_loss=0.000146, value_loss=0.047380
[EpochKL] epoch=0 mean_kl=0.00284 max_kl=0.00448
[EpochKL] epoch=1 mean_kl=0.00436 max_kl=0.00653
[EpochKL] epoch=2 mean_kl=0.00706 max_kl=0.01021
[Time] Env Create Time: 2.8651s |Rollout Collect Time: 3.5139s |Loss & Update :1.8627
[PPODiag] kl_mean=0.0048, kl_p90=0.0081, kl_max=0.0102 | clipfrac_mean=0.037, logratio_std_mean=0.096, ratio_p95_mean=1.060 | valid_ratio_mb_mean=0.787, p10=0.781, min=0.778 | pg_loss_mean=0.0019, v_loss_mean=0.2056, ent_mean=0.1411 | gn_bb_mean=1.467, gn_bb_max=2.209 | gn_v_mean=1.751, gn_v_max=2.921

  3%|▎         | 158/5000 [26:38<11:39:06,  8.66s/it]------------------ Training Record ------------------
Epoch: 158/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.821, reward_valid_mean=0.3077, reward_valid_std=2.2737
[BatchDiag] adv_mean=-0.1945, adv_std=0.9869, adv_abs_mean=0.7572 | ret_mean=6.7097, ret_std=1.7481 | val_mean=6.9042, val_std=1.4060 | explained_var=0.681257
[GradSplit pre-clip] backbone=0.467610, critic=0.297663
[Loss] pg_loss=-0.175398, entropy_loss=0.000147, value_loss=0.043756
[EpochKL] epoch=0 mean_kl=0.00492 max_kl=0.00747
[EpochKL] epoch=1 mean_kl=0.00654 max_kl=0.00856
[EpochKL] epoch=2 mean_kl=0.00944 max_kl=0.01274
[Time] Env Create Time: 2.6757s |Rollout Collect Time: 3.3527s |Loss & Update :1.8157
[PPODiag] kl_mean=0.0070, kl_p90=0.0099, kl_max=0.0127 | clipfrac_mean=0.044, logratio_std_mean=0.121, ratio_p95_mean=1.071 | valid_ratio_mb_mean=0.821, p10=0.814, min=0.811 | pg_loss_mean=0.0028, v_loss_mean=0.2020, ent_mean=0.1474 | gn_bb_mean=1.621, gn_bb_max=2.548 | gn_v_mean=1.323, gn_v_max=3.287

  3%|▎         | 159/5000 [26:46<11:19:09,  8.42s/it]------------------ Training Record ------------------
Epoch: 159/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3076, reward_valid_std=2.2728
[BatchDiag] adv_mean=-0.1714, adv_std=0.9600, adv_abs_mean=0.7361 | ret_mean=6.7098, ret_std=1.7456 | val_mean=6.8812, val_std=1.4436 | explained_var=0.697548
[GradSplit pre-clip] backbone=0.645720, critic=0.723810
[Loss] pg_loss=-0.093290, entropy_loss=0.000153, value_loss=0.041686
[EpochKL] epoch=0 mean_kl=0.00531 max_kl=0.00749
[EpochKL] epoch=1 mean_kl=0.00690 max_kl=0.00985
[EpochKL] epoch=2 mean_kl=0.00693 max_kl=0.01079
[Time] Env Create Time: 2.8322s |Rollout Collect Time: 3.3702s |Loss & Update :1.7951
[PPODiag] kl_mean=0.0064, kl_p90=0.0098, kl_max=0.0108 | clipfrac_mean=0.043, logratio_std_mean=0.115, ratio_p95_mean=1.065 | valid_ratio_mb_mean=0.822, p10=0.817, min=0.817 | pg_loss_mean=0.0028, v_loss_mean=0.1918, ent_mean=0.1451 | gn_bb_mean=1.677, gn_bb_max=2.723 | gn_v_mean=1.346, gn_v_max=2.617

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.951, Step: 21, Avg Done Step: 18.31, #CS visited: 0.46
D->C12->C1->C15->C14->C5->C2->D->C13->C4->C7->C11->C10->C9->C8->D->C6->C3->D
Eval cost : 4.0448s
-----------------------------
  3%|▎         | 160/5000 [26:58<12:47:56,  9.52s/it]------------------ Training Record ------------------
Epoch: 160/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3058, reward_valid_std=2.2740
[BatchDiag] adv_mean=-0.2144, adv_std=0.9801, adv_abs_mean=0.7565 | ret_mean=6.7038, ret_std=1.7419 | val_mean=6.9182, val_std=1.4361 | explained_var=0.683419
[GradSplit pre-clip] backbone=0.640164, critic=0.739349
[Loss] pg_loss=-0.106916, entropy_loss=0.000152, value_loss=0.046288
[EpochKL] epoch=0 mean_kl=0.00182 max_kl=0.00314
[EpochKL] epoch=1 mean_kl=0.00364 max_kl=0.00474
[EpochKL] epoch=2 mean_kl=0.00511 max_kl=0.00619
[Time] Env Create Time: 2.8516s |Rollout Collect Time: 3.3593s |Loss & Update :1.8019
[PPODiag] kl_mean=0.0035, kl_p90=0.0054, kl_max=0.0062 | clipfrac_mean=0.030, logratio_std_mean=0.083, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.822, p10=0.816, min=0.812 | pg_loss_mean=0.0011, v_loss_mean=0.1996, ent_mean=0.1499 | gn_bb_mean=1.460, gn_bb_max=2.539 | gn_v_mean=1.295, gn_v_max=2.901
[AttnScore] scale=1.0410, C=10.0

  3%|▎         | 161/5000 [27:06<12:11:20,  9.07s/it]------------------ Training Record ------------------
Epoch: 161/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3061, reward_valid_std=2.2738
[BatchDiag] adv_mean=-0.2086, adv_std=0.9779, adv_abs_mean=0.7568 | ret_mean=6.7108, ret_std=1.7486 | val_mean=6.9194, val_std=1.4280 | explained_var=0.687291
[GradSplit pre-clip] backbone=0.550495, critic=1.013023
[Loss] pg_loss=-0.078993, entropy_loss=0.000152, value_loss=0.045732
[EpochKL] epoch=0 mean_kl=0.00381 max_kl=0.00598
[EpochKL] epoch=1 mean_kl=0.00420 max_kl=0.00585
[EpochKL] epoch=2 mean_kl=0.00538 max_kl=0.00773
[Time] Env Create Time: 2.8642s |Rollout Collect Time: 3.3621s |Loss & Update :1.8027
[PPODiag] kl_mean=0.0045, kl_p90=0.0059, kl_max=0.0077 | clipfrac_mean=0.035, logratio_std_mean=0.095, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.823, p10=0.819, min=0.814 | pg_loss_mean=0.0019, v_loss_mean=0.2002, ent_mean=0.1516 | gn_bb_mean=1.608, gn_bb_max=2.669 | gn_v_mean=1.353, gn_v_max=2.974

  3%|▎         | 162/5000 [27:14<11:46:03,  8.76s/it]------------------ Training Record ------------------
Epoch: 162/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3051, reward_valid_std=2.2727
[BatchDiag] adv_mean=-0.1707, adv_std=0.9794, adv_abs_mean=0.7549 | ret_mean=6.6896, ret_std=1.7574 | val_mean=6.8603, val_std=1.4248 | explained_var=0.689392
[GradSplit pre-clip] backbone=0.456861, critic=0.744316
[Loss] pg_loss=-0.108397, entropy_loss=0.000147, value_loss=0.049138
[EpochKL] epoch=0 mean_kl=0.00309 max_kl=0.00501
[EpochKL] epoch=1 mean_kl=0.00479 max_kl=0.00725
[EpochKL] epoch=2 mean_kl=0.00428 max_kl=0.00630
[Time] Env Create Time: 2.6975s |Rollout Collect Time: 3.3685s |Loss & Update :1.7988
[PPODiag] kl_mean=0.0041, kl_p90=0.0060, kl_max=0.0073 | clipfrac_mean=0.031, logratio_std_mean=0.090, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.822, p10=0.816, min=0.814 | pg_loss_mean=0.0016, v_loss_mean=0.1983, ent_mean=0.1456 | gn_bb_mean=1.330, gn_bb_max=1.945 | gn_v_mean=1.152, gn_v_max=2.096

  3%|▎         | 163/5000 [27:22<11:24:21,  8.49s/it]------------------ Training Record ------------------
Epoch: 163/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3054, reward_valid_std=2.2718
[BatchDiag] adv_mean=0.0043, adv_std=0.9998, adv_abs_mean=0.7620 | ret_mean=6.6216, ret_std=1.8001 | val_mean=6.6173, val_std=1.5147 | explained_var=0.691515
[GradSplit pre-clip] backbone=0.566545, critic=1.426338
[Loss] pg_loss=-0.123567, entropy_loss=0.000146, value_loss=0.044798
[EpochKL] epoch=0 mean_kl=0.00311 max_kl=0.00590
[EpochKL] epoch=1 mean_kl=0.00475 max_kl=0.00701
[EpochKL] epoch=2 mean_kl=0.00574 max_kl=0.01006
[Time] Env Create Time: 2.8383s |Rollout Collect Time: 3.3711s |Loss & Update :1.8106
[PPODiag] kl_mean=0.0045, kl_p90=0.0066, kl_max=0.0101 | clipfrac_mean=0.035, logratio_std_mean=0.095, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.823, p10=0.817, min=0.811 | pg_loss_mean=0.0019, v_loss_mean=0.2014, ent_mean=0.1478 | gn_bb_mean=1.445, gn_bb_max=2.131 | gn_v_mean=0.981, gn_v_max=2.492

  3%|▎         | 164/5000 [27:30<11:12:53,  8.35s/it]------------------ Training Record ------------------
Epoch: 164/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3066, reward_valid_std=2.2736
[BatchDiag] adv_mean=-0.0380, adv_std=1.0082, adv_abs_mean=0.7725 | ret_mean=6.6455, ret_std=1.7814 | val_mean=6.6835, val_std=1.4705 | explained_var=0.679710
[GradSplit pre-clip] backbone=0.528001, critic=0.918834
[Loss] pg_loss=-0.128349, entropy_loss=0.000142, value_loss=0.047398
[EpochKL] epoch=0 mean_kl=0.00271 max_kl=0.00489
[EpochKL] epoch=1 mean_kl=0.00380 max_kl=0.00692
[EpochKL] epoch=2 mean_kl=0.00434 max_kl=0.00713
[Time] Env Create Time: 2.8437s |Rollout Collect Time: 3.5074s |Loss & Update :1.8561
[PPODiag] kl_mean=0.0036, kl_p90=0.0056, kl_max=0.0071 | clipfrac_mean=0.029, logratio_std_mean=0.084, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.785, p10=0.778, min=0.776 | pg_loss_mean=0.0013, v_loss_mean=0.2054, ent_mean=0.1392 | gn_bb_mean=1.294, gn_bb_max=1.672 | gn_v_mean=0.877, gn_v_max=2.380

  3%|▎         | 165/5000 [27:38<11:09:20,  8.31s/it]------------------ Training Record ------------------
Epoch: 165/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3063, reward_valid_std=2.2749
[BatchDiag] adv_mean=-0.0941, adv_std=0.9920, adv_abs_mean=0.7534 | ret_mean=6.6784, ret_std=1.7648 | val_mean=6.7725, val_std=1.4818 | explained_var=0.684033
[GradSplit pre-clip] backbone=0.699653, critic=0.995646
[Loss] pg_loss=-0.162640, entropy_loss=0.000152, value_loss=0.049840
[EpochKL] epoch=0 mean_kl=0.00252 max_kl=0.00406
[EpochKL] epoch=1 mean_kl=0.00438 max_kl=0.00554
[EpochKL] epoch=2 mean_kl=0.00532 max_kl=0.00643
[Time] Env Create Time: 2.8469s |Rollout Collect Time: 3.3666s |Loss & Update :1.7931
[PPODiag] kl_mean=0.0041, kl_p90=0.0056, kl_max=0.0064 | clipfrac_mean=0.031, logratio_std_mean=0.090, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.822, p10=0.816, min=0.812 | pg_loss_mean=0.0013, v_loss_mean=0.1996, ent_mean=0.1446 | gn_bb_mean=1.304, gn_bb_max=2.389 | gn_v_mean=0.960, gn_v_max=2.281
[AttnScore] scale=1.0429, C=10.0

  3%|▎         | 166/5000 [27:46<11:01:58,  8.22s/it]------------------ Training Record ------------------
Epoch: 166/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.820, reward_valid_mean=0.3080, reward_valid_std=2.2760
[BatchDiag] adv_mean=-0.0637, adv_std=0.9956, adv_abs_mean=0.7578 | ret_mean=6.6701, ret_std=1.7710 | val_mean=6.7338, val_std=1.4851 | explained_var=0.683948
[GradSplit pre-clip] backbone=0.601437, critic=0.704575
[Loss] pg_loss=-0.118553, entropy_loss=0.000147, value_loss=0.047946
[EpochKL] epoch=0 mean_kl=0.00364 max_kl=0.00609
[EpochKL] epoch=1 mean_kl=0.00488 max_kl=0.00773
[EpochKL] epoch=2 mean_kl=0.00492 max_kl=0.00655
[Time] Env Create Time: 2.6805s |Rollout Collect Time: 3.3585s |Loss & Update :1.7907
[PPODiag] kl_mean=0.0045, kl_p90=0.0064, kl_max=0.0077 | clipfrac_mean=0.034, logratio_std_mean=0.094, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.820, p10=0.816, min=0.810 | pg_loss_mean=0.0017, v_loss_mean=0.2005, ent_mean=0.1451 | gn_bb_mean=1.459, gn_bb_max=2.361 | gn_v_mean=0.803, gn_v_max=2.350

  3%|▎         | 167/5000 [27:54<10:52:30,  8.10s/it]------------------ Training Record ------------------
Epoch: 167/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.819, reward_valid_mean=0.3088, reward_valid_std=2.2795
[BatchDiag] adv_mean=-0.0261, adv_std=1.0066, adv_abs_mean=0.7669 | ret_mean=6.6605, ret_std=1.7790 | val_mean=6.6865, val_std=1.5088 | explained_var=0.679839
[GradSplit pre-clip] backbone=0.491993, critic=0.832625
[Loss] pg_loss=-0.083540, entropy_loss=0.000141, value_loss=0.049969
[EpochKL] epoch=0 mean_kl=0.00273 max_kl=0.00456
[EpochKL] epoch=1 mean_kl=0.00310 max_kl=0.00477
[EpochKL] epoch=2 mean_kl=0.00422 max_kl=0.00558
[Time] Env Create Time: 2.8511s |Rollout Collect Time: 3.3560s |Loss & Update :1.7981
[PPODiag] kl_mean=0.0033, kl_p90=0.0045, kl_max=0.0056 | clipfrac_mean=0.028, logratio_std_mean=0.081, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.819, p10=0.813, min=0.811 | pg_loss_mean=0.0013, v_loss_mean=0.2053, ent_mean=0.1428 | gn_bb_mean=1.244, gn_bb_max=1.680 | gn_v_mean=0.998, gn_v_max=2.780

  3%|▎         | 168/5000 [28:02<10:50:04,  8.07s/it]------------------ Training Record ------------------
Epoch: 168/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.782, reward_valid_mean=0.3094, reward_valid_std=2.2803
[BatchDiag] adv_mean=-0.0960, adv_std=0.9964, adv_abs_mean=0.7537 | ret_mean=6.7039, ret_std=1.7601 | val_mean=6.7999, val_std=1.4891 | explained_var=0.679549
[GradSplit pre-clip] backbone=0.642528, critic=0.352457
[Loss] pg_loss=-0.077524, entropy_loss=0.000134, value_loss=0.048038
[EpochKL] epoch=0 mean_kl=0.00267 max_kl=0.00497
[EpochKL] epoch=1 mean_kl=0.00742 max_kl=0.01213
[EpochKL] epoch=2 mean_kl=0.00820 max_kl=0.01094
[Time] Env Create Time: 2.8457s |Rollout Collect Time: 3.5068s |Loss & Update :1.8626
[PPODiag] kl_mean=0.0061, kl_p90=0.0098, kl_max=0.0121 | clipfrac_mean=0.040, logratio_std_mean=0.109, ratio_p95_mean=1.063 | valid_ratio_mb_mean=0.782, p10=0.778, min=0.776 | pg_loss_mean=0.0027, v_loss_mean=0.2010, ent_mean=0.1381 | gn_bb_mean=1.568, gn_bb_max=2.062 | gn_v_mean=0.963, gn_v_max=1.878

  3%|▎         | 169/5000 [28:10<10:53:24,  8.12s/it]------------------ Training Record ------------------
Epoch: 169/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.819, reward_valid_mean=0.3064, reward_valid_std=2.2765
[BatchDiag] adv_mean=-0.0879, adv_std=1.0091, adv_abs_mean=0.7647 | ret_mean=6.6528, ret_std=1.7618 | val_mean=6.7407, val_std=1.5235 | explained_var=0.671932
[GradSplit pre-clip] backbone=0.587318, critic=0.394274
[Loss] pg_loss=-0.072337, entropy_loss=0.000151, value_loss=0.053426
[EpochKL] epoch=0 mean_kl=0.00253 max_kl=0.00469
[EpochKL] epoch=1 mean_kl=0.00473 max_kl=0.00599
[EpochKL] epoch=2 mean_kl=0.00654 max_kl=0.00825
[Time] Env Create Time: 2.7024s |Rollout Collect Time: 3.3517s |Loss & Update :1.8048
[PPODiag] kl_mean=0.0046, kl_p90=0.0070, kl_max=0.0083 | clipfrac_mean=0.033, logratio_std_mean=0.094, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.819, p10=0.816, min=0.814 | pg_loss_mean=0.0018, v_loss_mean=0.2046, ent_mean=0.1415 | gn_bb_mean=1.300, gn_bb_max=2.236 | gn_v_mean=0.981, gn_v_max=2.606

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.959, Step: 20, Avg Done Step: 18.27, #CS visited: 0.46
D->C13->C12->C1->C15->C14->C3->C5->C2->D->C6->C4->C7->C11->C10->C9->C8->D
Eval cost : 3.8730s
-----------------------------
  3%|▎         | 170/5000 [28:22<12:21:25,  9.21s/it]------------------ Training Record ------------------
Epoch: 170/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.782, reward_valid_mean=0.3104, reward_valid_std=2.2783
[BatchDiag] adv_mean=-0.0604, adv_std=1.0081, adv_abs_mean=0.7671 | ret_mean=6.6792, ret_std=1.7606 | val_mean=6.7396, val_std=1.4790 | explained_var=0.672148
[GradSplit pre-clip] backbone=0.568641, critic=0.434908
[Loss] pg_loss=-0.044090, entropy_loss=0.000140, value_loss=0.054162
[EpochKL] epoch=0 mean_kl=0.00253 max_kl=0.00429
[EpochKL] epoch=1 mean_kl=0.00286 max_kl=0.00394
[EpochKL] epoch=2 mean_kl=0.00359 max_kl=0.00580
[Time] Env Create Time: 2.8529s |Rollout Collect Time: 3.5193s |Loss & Update :1.8776
[PPODiag] kl_mean=0.0030, kl_p90=0.0043, kl_max=0.0058 | clipfrac_mean=0.026, logratio_std_mean=0.077, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.782, p10=0.778, min=0.774 | pg_loss_mean=0.0006, v_loss_mean=0.2063, ent_mean=0.1382 | gn_bb_mean=1.075, gn_bb_max=1.938 | gn_v_mean=1.442, gn_v_max=3.378
[AttnScore] scale=1.0447, C=10.0

  3%|▎         | 171/5000 [28:30<11:58:05,  8.92s/it]------------------ Training Record ------------------
Epoch: 171/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.781, reward_valid_mean=0.3100, reward_valid_std=2.2793
[BatchDiag] adv_mean=-0.0876, adv_std=0.9937, adv_abs_mean=0.7561 | ret_mean=6.6742, ret_std=1.7559 | val_mean=6.7618, val_std=1.4701 | explained_var=0.679734
[GradSplit pre-clip] backbone=0.712185, critic=0.583189
[Loss] pg_loss=-0.137370, entropy_loss=0.000144, value_loss=0.048048
[EpochKL] epoch=0 mean_kl=0.00332 max_kl=0.00484
[EpochKL] epoch=1 mean_kl=0.00520 max_kl=0.00743
[EpochKL] epoch=2 mean_kl=0.00616 max_kl=0.01007
[Time] Env Create Time: 2.8584s |Rollout Collect Time: 3.5354s |Loss & Update :1.8798
[PPODiag] kl_mean=0.0049, kl_p90=0.0074, kl_max=0.0101 | clipfrac_mean=0.035, logratio_std_mean=0.099, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.781, p10=0.777, min=0.771 | pg_loss_mean=0.0018, v_loss_mean=0.2057, ent_mean=0.1365 | gn_bb_mean=1.443, gn_bb_max=2.063 | gn_v_mean=1.869, gn_v_max=3.715

  3%|▎         | 172/5000 [28:38<11:42:17,  8.73s/it]------------------ Training Record ------------------
Epoch: 172/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.821, reward_valid_mean=0.3075, reward_valid_std=2.2750
[BatchDiag] adv_mean=-0.1732, adv_std=0.9951, adv_abs_mean=0.7641 | ret_mean=6.6884, ret_std=1.7566 | val_mean=6.8617, val_std=1.4028 | explained_var=0.679048
[GradSplit pre-clip] backbone=0.402945, critic=1.107448
[Loss] pg_loss=-0.044082, entropy_loss=0.000146, value_loss=0.051555
[EpochKL] epoch=0 mean_kl=0.00252 max_kl=0.00419
[EpochKL] epoch=1 mean_kl=0.00298 max_kl=0.00420
[EpochKL] epoch=2 mean_kl=0.00485 max_kl=0.00943
[Time] Env Create Time: 2.8377s |Rollout Collect Time: 3.3425s |Loss & Update :1.8067
[PPODiag] kl_mean=0.0035, kl_p90=0.0044, kl_max=0.0094 | clipfrac_mean=0.028, logratio_std_mean=0.081, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.821, p10=0.816, min=0.811 | pg_loss_mean=0.0011, v_loss_mean=0.2065, ent_mean=0.1418 | gn_bb_mean=1.189, gn_bb_max=2.275 | gn_v_mean=1.923, gn_v_max=3.896

  3%|▎         | 173/5000 [28:46<11:24:17,  8.51s/it]------------------ Training Record ------------------
Epoch: 173/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.821, reward_valid_mean=0.3075, reward_valid_std=2.2740
[BatchDiag] adv_mean=-0.2090, adv_std=0.9899, adv_abs_mean=0.7702 | ret_mean=6.7074, ret_std=1.7419 | val_mean=6.9164, val_std=1.4058 | explained_var=0.677049
[GradSplit pre-clip] backbone=0.560477, critic=1.008013
[Loss] pg_loss=-0.096008, entropy_loss=0.000146, value_loss=0.048683
[EpochKL] epoch=0 mean_kl=0.00328 max_kl=0.00686
[EpochKL] epoch=1 mean_kl=0.00729 max_kl=0.01293
[EpochKL] epoch=2 mean_kl=0.00689 max_kl=0.01174
[Time] Env Create Time: 2.6705s |Rollout Collect Time: 3.3547s |Loss & Update :1.8037
[PPODiag] kl_mean=0.0058, kl_p90=0.0096, kl_max=0.0129 | clipfrac_mean=0.037, logratio_std_mean=0.108, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.821, p10=0.815, min=0.812 | pg_loss_mean=0.0021, v_loss_mean=0.2060, ent_mean=0.1410 | gn_bb_mean=1.553, gn_bb_max=2.499 | gn_v_mean=1.703, gn_v_max=3.271

  3%|▎         | 174/5000 [28:54<11:07:49,  8.30s/it]------------------ Training Record ------------------
Epoch: 174/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=24, valid_ratio=0.720, reward_valid_mean=0.3081, reward_valid_std=2.2741
[BatchDiag] adv_mean=-0.2478, adv_std=0.9741, adv_abs_mean=0.7661 | ret_mean=6.7372, ret_std=1.7307 | val_mean=6.9851, val_std=1.3658 | explained_var=0.683216
[GradSplit pre-clip] backbone=0.622317, critic=1.571335
[Loss] pg_loss=-0.090793, entropy_loss=0.000132, value_loss=0.048422
[EpochKL] epoch=0 mean_kl=0.00229 max_kl=0.00458
[EpochKL] epoch=1 mean_kl=0.00499 max_kl=0.00654
[EpochKL] epoch=2 mean_kl=0.00616 max_kl=0.00908
[Time] Env Create Time: 2.8282s |Rollout Collect Time: 3.8116s |Loss & Update :2.0203
[PPODiag] kl_mean=0.0045, kl_p90=0.0069, kl_max=0.0091 | clipfrac_mean=0.033, logratio_std_mean=0.094, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.720, p10=0.715, min=0.713 | pg_loss_mean=0.0015, v_loss_mean=0.2072, ent_mean=0.1272 | gn_bb_mean=1.343, gn_bb_max=2.183 | gn_v_mean=2.294, gn_v_max=4.415

  4%|▎         | 175/5000 [29:03<11:16:18,  8.41s/it]------------------ Training Record ------------------
Epoch: 175/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3059, reward_valid_std=2.2716
[BatchDiag] adv_mean=-0.1902, adv_std=0.9799, adv_abs_mean=0.7549 | ret_mean=6.6880, ret_std=1.7413 | val_mean=6.8782, val_std=1.4323 | explained_var=0.683280
[GradSplit pre-clip] backbone=0.493895, critic=0.658844
[Loss] pg_loss=-0.104928, entropy_loss=0.000150, value_loss=0.048181
[EpochKL] epoch=0 mean_kl=0.00327 max_kl=0.00534
[EpochKL] epoch=1 mean_kl=0.00397 max_kl=0.00640
[EpochKL] epoch=2 mean_kl=0.00532 max_kl=0.00845
[Time] Env Create Time: 2.8481s |Rollout Collect Time: 3.3518s |Loss & Update :1.7960
[PPODiag] kl_mean=0.0042, kl_p90=0.0057, kl_max=0.0084 | clipfrac_mean=0.032, logratio_std_mean=0.091, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.823, p10=0.818, min=0.816 | pg_loss_mean=0.0018, v_loss_mean=0.2007, ent_mean=0.1444 | gn_bb_mean=1.371, gn_bb_max=1.972 | gn_v_mean=1.432, gn_v_max=3.495
[AttnScore] scale=1.0466, C=10.0

  4%|▎         | 176/5000 [29:11<11:06:11,  8.29s/it]------------------ Training Record ------------------
Epoch: 176/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.783, reward_valid_mean=0.3100, reward_valid_std=2.2755
[BatchDiag] adv_mean=-0.0799, adv_std=0.9645, adv_abs_mean=0.7403 | ret_mean=6.6820, ret_std=1.7681 | val_mean=6.7618, val_std=1.4137 | explained_var=0.702445
[GradSplit pre-clip] backbone=0.792944, critic=0.555077
[Loss] pg_loss=-0.032818, entropy_loss=0.000139, value_loss=0.045741
[EpochKL] epoch=0 mean_kl=0.00361 max_kl=0.00671
[EpochKL] epoch=1 mean_kl=0.00504 max_kl=0.00808
[EpochKL] epoch=2 mean_kl=0.00551 max_kl=0.00711
[Time] Env Create Time: 2.8552s |Rollout Collect Time: 3.5009s |Loss & Update :1.8713
[PPODiag] kl_mean=0.0047, kl_p90=0.0066, kl_max=0.0081 | clipfrac_mean=0.036, logratio_std_mean=0.097, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.783, p10=0.779, min=0.777 | pg_loss_mean=0.0018, v_loss_mean=0.1922, ent_mean=0.1354 | gn_bb_mean=1.414, gn_bb_max=1.837 | gn_v_mean=1.138, gn_v_max=3.118

  4%|▎         | 177/5000 [29:19<11:04:39,  8.27s/it]------------------ Training Record ------------------
Epoch: 177/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3055, reward_valid_std=2.2734
[BatchDiag] adv_mean=-0.1363, adv_std=0.9698, adv_abs_mean=0.7421 | ret_mean=6.6824, ret_std=1.7644 | val_mean=6.8187, val_std=1.4581 | explained_var=0.697863
[GradSplit pre-clip] backbone=0.660561, critic=0.782439
[Loss] pg_loss=-0.037181, entropy_loss=0.000144, value_loss=0.048653
[EpochKL] epoch=0 mean_kl=0.00322 max_kl=0.00657
[EpochKL] epoch=1 mean_kl=0.00508 max_kl=0.00590
[EpochKL] epoch=2 mean_kl=0.00532 max_kl=0.00691
[Time] Env Create Time: 2.6769s |Rollout Collect Time: 3.3609s |Loss & Update :1.7997
[PPODiag] kl_mean=0.0045, kl_p90=0.0061, kl_max=0.0069 | clipfrac_mean=0.035, logratio_std_mean=0.095, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.823, p10=0.817, min=0.814 | pg_loss_mean=0.0016, v_loss_mean=0.1955, ent_mean=0.1439 | gn_bb_mean=1.379, gn_bb_max=2.095 | gn_v_mean=1.242, gn_v_max=3.439

  4%|▎         | 178/5000 [29:27<10:54:08,  8.14s/it]------------------ Training Record ------------------
Epoch: 178/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.782, reward_valid_mean=0.3138, reward_valid_std=2.2775
[BatchDiag] adv_mean=-0.1075, adv_std=0.9434, adv_abs_mean=0.7171 | ret_mean=6.7366, ret_std=1.7397 | val_mean=6.8442, val_std=1.4603 | explained_var=0.705907
[GradSplit pre-clip] backbone=0.519035, critic=0.305946
[Loss] pg_loss=-0.097450, entropy_loss=0.000139, value_loss=0.045504
[EpochKL] epoch=0 mean_kl=0.00309 max_kl=0.00449
[EpochKL] epoch=1 mean_kl=0.00434 max_kl=0.00810
[EpochKL] epoch=2 mean_kl=0.00501 max_kl=0.00658
[Time] Env Create Time: 2.8458s |Rollout Collect Time: 3.5032s |Loss & Update :1.8781
[PPODiag] kl_mean=0.0041, kl_p90=0.0059, kl_max=0.0081 | clipfrac_mean=0.032, logratio_std_mean=0.091, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.782, p10=0.777, min=0.776 | pg_loss_mean=0.0016, v_loss_mean=0.1855, ent_mean=0.1372 | gn_bb_mean=1.321, gn_bb_max=2.338 | gn_v_mean=1.072, gn_v_max=3.187

  4%|▎         | 179/5000 [29:35<10:56:07,  8.17s/it]------------------ Training Record ------------------
Epoch: 179/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.821, reward_valid_mean=0.3052, reward_valid_std=2.2763
[BatchDiag] adv_mean=-0.1883, adv_std=0.9927, adv_abs_mean=0.7613 | ret_mean=6.6864, ret_std=1.7609 | val_mean=6.8746, val_std=1.4643 | explained_var=0.682172
[GradSplit pre-clip] backbone=0.477887, critic=0.798026
[Loss] pg_loss=-0.066767, entropy_loss=0.000147, value_loss=0.051373
[EpochKL] epoch=0 mean_kl=0.00347 max_kl=0.00658
[EpochKL] epoch=1 mean_kl=0.00603 max_kl=0.00993
[EpochKL] epoch=2 mean_kl=0.00929 max_kl=0.01676
[Time] Env Create Time: 2.8407s |Rollout Collect Time: 3.3536s |Loss & Update :1.8035
[PPODiag] kl_mean=0.0063, kl_p90=0.0097, kl_max=0.0168 | clipfrac_mean=0.042, logratio_std_mean=0.110, ratio_p95_mean=1.063 | valid_ratio_mb_mean=0.821, p10=0.814, min=0.813 | pg_loss_mean=0.0026, v_loss_mean=0.2044, ent_mean=0.1455 | gn_bb_mean=1.704, gn_bb_max=2.668 | gn_v_mean=1.521, gn_v_max=3.110

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.899, Step: 20, Avg Done Step: 18.30, #CS visited: 0.43
D->C13->C12->C1->C15->C14->C3->C5->C2->D->C6->C4->C7->C11->C10->C9->C8->D
Eval cost : 3.8640s
-----------------------------
  4%|▎         | 180/5000 [29:47<12:26:21,  9.29s/it]------------------ Training Record ------------------
Epoch: 180/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3077, reward_valid_std=2.2733
[BatchDiag] adv_mean=-0.1247, adv_std=0.9566, adv_abs_mean=0.7317 | ret_mean=6.6928, ret_std=1.7564 | val_mean=6.8175, val_std=1.4729 | explained_var=0.703396
[GradSplit pre-clip] backbone=0.644800, critic=0.650642
[Loss] pg_loss=-0.022507, entropy_loss=0.000159, value_loss=0.051865
[EpochKL] epoch=0 mean_kl=0.00709 max_kl=0.01120
[EpochKL] epoch=1 mean_kl=0.00654 max_kl=0.01008
[EpochKL] epoch=2 mean_kl=0.00669 max_kl=0.00803
[Time] Env Create Time: 2.8528s |Rollout Collect Time: 3.3585s |Loss & Update :1.7990
[PPODiag] kl_mean=0.0068, kl_p90=0.0103, kl_max=0.0112 | clipfrac_mean=0.043, logratio_std_mean=0.117, ratio_p95_mean=1.066 | valid_ratio_mb_mean=0.823, p10=0.818, min=0.816 | pg_loss_mean=0.0030, v_loss_mean=0.1895, ent_mean=0.1451 | gn_bb_mean=1.597, gn_bb_max=2.624 | gn_v_mean=0.990, gn_v_max=1.834
[AttnScore] scale=1.0482, C=10.0

  4%|▎         | 181/5000 [29:55<11:55:21,  8.91s/it]------------------ Training Record ------------------
Epoch: 181/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3094, reward_valid_std=2.2748
[BatchDiag] adv_mean=-0.0503, adv_std=0.9690, adv_abs_mean=0.7354 | ret_mean=6.6897, ret_std=1.7634 | val_mean=6.7400, val_std=1.5068 | explained_var=0.698059
[GradSplit pre-clip] backbone=0.479988, critic=0.284279
[Loss] pg_loss=-0.057516, entropy_loss=0.000142, value_loss=0.048190
[EpochKL] epoch=0 mean_kl=0.00324 max_kl=0.00749
[EpochKL] epoch=1 mean_kl=0.00433 max_kl=0.00566
[EpochKL] epoch=2 mean_kl=0.00612 max_kl=0.00874
[Time] Env Create Time: 2.6898s |Rollout Collect Time: 3.5230s |Loss & Update :1.8715
[PPODiag] kl_mean=0.0046, kl_p90=0.0071, kl_max=0.0087 | clipfrac_mean=0.033, logratio_std_mean=0.095, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.785, p10=0.780, min=0.777 | pg_loss_mean=0.0016, v_loss_mean=0.1925, ent_mean=0.1346 | gn_bb_mean=1.399, gn_bb_max=2.084 | gn_v_mean=0.997, gn_v_max=2.473

  4%|▎         | 182/5000 [30:03<11:35:24,  8.66s/it]------------------ Training Record ------------------
Epoch: 182/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3082, reward_valid_std=2.2747
[BatchDiag] adv_mean=-0.1660, adv_std=0.9688, adv_abs_mean=0.7445 | ret_mean=6.7076, ret_std=1.7405 | val_mean=6.8736, val_std=1.4411 | explained_var=0.690143
[GradSplit pre-clip] backbone=0.662925, critic=0.760586
[Loss] pg_loss=-0.138248, entropy_loss=0.000155, value_loss=0.047361
[EpochKL] epoch=0 mean_kl=0.00422 max_kl=0.00753
[EpochKL] epoch=1 mean_kl=0.00922 max_kl=0.01360
[EpochKL] epoch=2 mean_kl=0.00824 max_kl=0.01401
[Time] Env Create Time: 2.8281s |Rollout Collect Time: 3.3557s |Loss & Update :1.8081
[PPODiag] kl_mean=0.0072, kl_p90=0.0111, kl_max=0.0140 | clipfrac_mean=0.045, logratio_std_mean=0.122, ratio_p95_mean=1.069 | valid_ratio_mb_mean=0.822, p10=0.815, min=0.814 | pg_loss_mean=0.0030, v_loss_mean=0.1970, ent_mean=0.1471 | gn_bb_mean=1.829, gn_bb_max=2.659 | gn_v_mean=1.704, gn_v_max=3.541

  4%|▎         | 183/5000 [30:11<11:19:11,  8.46s/it]------------------ Training Record ------------------
Epoch: 183/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.784, reward_valid_mean=0.3090, reward_valid_std=2.2764
[BatchDiag] adv_mean=-0.2142, adv_std=0.9657, adv_abs_mean=0.7498 | ret_mean=6.7334, ret_std=1.7424 | val_mean=6.9475, val_std=1.4264 | explained_var=0.692779
[GradSplit pre-clip] backbone=0.550842, critic=1.293771
[Loss] pg_loss=-0.051163, entropy_loss=0.000143, value_loss=0.051584
[EpochKL] epoch=0 mean_kl=0.00299 max_kl=0.00413
[EpochKL] epoch=1 mean_kl=0.00396 max_kl=0.00520
[EpochKL] epoch=2 mean_kl=0.00423 max_kl=0.00636
[Time] Env Create Time: 2.8293s |Rollout Collect Time: 3.5123s |Loss & Update :1.8672
[PPODiag] kl_mean=0.0037, kl_p90=0.0052, kl_max=0.0064 | clipfrac_mean=0.031, logratio_std_mean=0.086, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.784, p10=0.781, min=0.777 | pg_loss_mean=0.0014, v_loss_mean=0.1935, ent_mean=0.1377 | gn_bb_mean=1.368, gn_bb_max=1.802 | gn_v_mean=1.113, gn_v_max=2.199

  4%|▎         | 184/5000 [30:19<11:13:00,  8.38s/it]------------------ Training Record ------------------
Epoch: 184/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3065, reward_valid_std=2.2721
[BatchDiag] adv_mean=-0.2082, adv_std=0.9744, adv_abs_mean=0.7549 | ret_mean=6.7094, ret_std=1.7484 | val_mean=6.9175, val_std=1.4145 | explained_var=0.689382
[GradSplit pre-clip] backbone=0.615741, critic=1.104110
[Loss] pg_loss=-0.105210, entropy_loss=0.000155, value_loss=0.048416
[EpochKL] epoch=0 mean_kl=0.00387 max_kl=0.00644
[EpochKL] epoch=1 mean_kl=0.00487 max_kl=0.00759
[EpochKL] epoch=2 mean_kl=0.00532 max_kl=0.00677
[Time] Env Create Time: 2.8555s |Rollout Collect Time: 3.3580s |Loss & Update :1.7985
[PPODiag] kl_mean=0.0047, kl_p90=0.0069, kl_max=0.0076 | clipfrac_mean=0.036, logratio_std_mean=0.097, ratio_p95_mean=1.059 | valid_ratio_mb_mean=0.824, p10=0.818, min=0.817 | pg_loss_mean=0.0020, v_loss_mean=0.1987, ent_mean=0.1472 | gn_bb_mean=1.379, gn_bb_max=1.852 | gn_v_mean=1.560, gn_v_max=3.340

  4%|▎         | 185/5000 [30:27<11:03:54,  8.27s/it]------------------ Training Record ------------------
Epoch: 185/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3047, reward_valid_std=2.2724
[BatchDiag] adv_mean=-0.3027, adv_std=0.9660, adv_abs_mean=0.7640 | ret_mean=6.7263, ret_std=1.7298 | val_mean=7.0290, val_std=1.3994 | explained_var=0.688181
[GradSplit pre-clip] backbone=0.487607, critic=1.553446
[Loss] pg_loss=-0.095754, entropy_loss=0.000150, value_loss=0.050437
[EpochKL] epoch=0 mean_kl=0.00424 max_kl=0.00718
[EpochKL] epoch=1 mean_kl=0.00570 max_kl=0.00727
[EpochKL] epoch=2 mean_kl=0.00554 max_kl=0.00661
[Time] Env Create Time: 2.6893s |Rollout Collect Time: 3.3549s |Loss & Update :1.8008
[PPODiag] kl_mean=0.0052, kl_p90=0.0069, kl_max=0.0073 | clipfrac_mean=0.038, logratio_std_mean=0.102, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.824, p10=0.817, min=0.813 | pg_loss_mean=0.0023, v_loss_mean=0.2025, ent_mean=0.1455 | gn_bb_mean=1.351, gn_bb_max=1.844 | gn_v_mean=1.883, gn_v_max=3.257
[AttnScore] scale=1.0499, C=10.0

  4%|▎         | 186/5000 [30:35<10:53:28,  8.14s/it]------------------ Training Record ------------------
Epoch: 186/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3090, reward_valid_std=2.2726
[BatchDiag] adv_mean=-0.1445, adv_std=0.9638, adv_abs_mean=0.7389 | ret_mean=6.7030, ret_std=1.7356 | val_mean=6.8476, val_std=1.4425 | explained_var=0.691629
[GradSplit pre-clip] backbone=0.591172, critic=0.510125
[Loss] pg_loss=-0.079236, entropy_loss=0.000150, value_loss=0.046586
[EpochKL] epoch=0 mean_kl=0.00255 max_kl=0.00418
[EpochKL] epoch=1 mean_kl=0.00374 max_kl=0.00508
[EpochKL] epoch=2 mean_kl=0.00369 max_kl=0.00501
[Time] Env Create Time: 2.8486s |Rollout Collect Time: 3.3677s |Loss & Update :1.8057
[PPODiag] kl_mean=0.0033, kl_p90=0.0047, kl_max=0.0051 | clipfrac_mean=0.029, logratio_std_mean=0.081, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.823, p10=0.820, min=0.817 | pg_loss_mean=0.0013, v_loss_mean=0.1927, ent_mean=0.1410 | gn_bb_mean=1.154, gn_bb_max=1.849 | gn_v_mean=1.148, gn_v_max=2.332

  4%|▎         | 187/5000 [30:43<10:50:24,  8.11s/it]------------------ Training Record ------------------
Epoch: 187/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3092, reward_valid_std=2.2744
[BatchDiag] adv_mean=-0.1714, adv_std=0.9686, adv_abs_mean=0.7411 | ret_mean=6.7169, ret_std=1.7444 | val_mean=6.8883, val_std=1.4339 | explained_var=0.691659
[GradSplit pre-clip] backbone=0.526044, critic=0.507875
[Loss] pg_loss=-0.123023, entropy_loss=0.000140, value_loss=0.046012
[EpochKL] epoch=0 mean_kl=0.00362 max_kl=0.00520
[EpochKL] epoch=1 mean_kl=0.00561 max_kl=0.00924
[EpochKL] epoch=2 mean_kl=0.00503 max_kl=0.00841
[Time] Env Create Time: 2.8422s |Rollout Collect Time: 3.5208s |Loss & Update :1.8607
[PPODiag] kl_mean=0.0048, kl_p90=0.0070, kl_max=0.0092 | clipfrac_mean=0.035, logratio_std_mean=0.098, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.785, p10=0.781, min=0.779 | pg_loss_mean=0.0017, v_loss_mean=0.1945, ent_mean=0.1341 | gn_bb_mean=1.363, gn_bb_max=2.083 | gn_v_mean=1.355, gn_v_max=2.953

  4%|▍         | 188/5000 [30:51<10:53:03,  8.14s/it]------------------ Training Record ------------------
Epoch: 188/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3087, reward_valid_std=2.2728
[BatchDiag] adv_mean=-0.2144, adv_std=0.9536, adv_abs_mean=0.7386 | ret_mean=6.7262, ret_std=1.7354 | val_mean=6.9406, val_std=1.4065 | explained_var=0.698041
[GradSplit pre-clip] backbone=0.664148, critic=1.592865
[Loss] pg_loss=-0.033019, entropy_loss=0.000146, value_loss=0.046001
[EpochKL] epoch=0 mean_kl=0.00188 max_kl=0.00279
[EpochKL] epoch=1 mean_kl=0.00517 max_kl=0.00841
[EpochKL] epoch=2 mean_kl=0.00725 max_kl=0.01235
[Time] Env Create Time: 2.6734s |Rollout Collect Time: 3.3527s |Loss & Update :1.8055
[PPODiag] kl_mean=0.0048, kl_p90=0.0084, kl_max=0.0124 | clipfrac_mean=0.034, logratio_std_mean=0.096, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.823, p10=0.818, min=0.818 | pg_loss_mean=0.0018, v_loss_mean=0.1911, ent_mean=0.1415 | gn_bb_mean=1.377, gn_bb_max=2.037 | gn_v_mean=1.307, gn_v_max=2.462

  4%|▍         | 189/5000 [30:59<10:45:26,  8.05s/it]------------------ Training Record ------------------
Epoch: 189/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.750, reward_valid_mean=0.3092, reward_valid_std=2.2740
[BatchDiag] adv_mean=-0.1184, adv_std=0.9720, adv_abs_mean=0.7402 | ret_mean=6.6828, ret_std=1.7580 | val_mean=6.8012, val_std=1.4395 | explained_var=0.694341
[GradSplit pre-clip] backbone=0.625649, critic=0.380009
[Loss] pg_loss=-0.073558, entropy_loss=0.000136, value_loss=0.047950
[EpochKL] epoch=0 mean_kl=0.00448 max_kl=0.00921
[EpochKL] epoch=1 mean_kl=0.00796 max_kl=0.01064
[EpochKL] epoch=2 mean_kl=0.00627 max_kl=0.00975
[Time] Env Create Time: 2.8359s |Rollout Collect Time: 3.6724s |Loss & Update :1.9454
[PPODiag] kl_mean=0.0062, kl_p90=0.0097, kl_max=0.0106 | clipfrac_mean=0.040, logratio_std_mean=0.112, ratio_p95_mean=1.059 | valid_ratio_mb_mean=0.750, p10=0.746, min=0.744 | pg_loss_mean=0.0027, v_loss_mean=0.1935, ent_mean=0.1295 | gn_bb_mean=1.572, gn_bb_max=2.149 | gn_v_mean=0.875, gn_v_max=2.129

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.895, Step: 21, Avg Done Step: 18.33, #CS visited: 0.41
D->C12->C1->C15->C14->C3->C5->C2->D->C13->C4->C7->C11->C10->C9->C8->D->C6->D
Eval cost : 4.0327s
-----------------------------
  4%|▍         | 190/5000 [31:12<12:33:10,  9.40s/it]------------------ Training Record ------------------
Epoch: 190/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.751, reward_valid_mean=0.3074, reward_valid_std=2.2721
[BatchDiag] adv_mean=-0.1476, adv_std=0.9527, adv_abs_mean=0.7231 | ret_mean=6.7008, ret_std=1.7495 | val_mean=6.8484, val_std=1.4797 | explained_var=0.703431
[GradSplit pre-clip] backbone=0.452934, critic=0.264350
[Loss] pg_loss=-0.132280, entropy_loss=0.000130, value_loss=0.042675
[EpochKL] epoch=0 mean_kl=0.00197 max_kl=0.00315
[EpochKL] epoch=1 mean_kl=0.00408 max_kl=0.00619
[EpochKL] epoch=2 mean_kl=0.00620 max_kl=0.01063
[Time] Env Create Time: 2.8139s |Rollout Collect Time: 3.6553s |Loss & Update :1.9452
[PPODiag] kl_mean=0.0041, kl_p90=0.0064, kl_max=0.0106 | clipfrac_mean=0.032, logratio_std_mean=0.089, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.751, p10=0.747, min=0.741 | pg_loss_mean=0.0013, v_loss_mean=0.1892, ent_mean=0.1276 | gn_bb_mean=1.272, gn_bb_max=1.934 | gn_v_mean=1.449, gn_v_max=3.255
[AttnScore] scale=1.0517, C=10.0

  4%|▍         | 191/5000 [31:20<12:09:27,  9.10s/it]------------------ Training Record ------------------
Epoch: 191/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3069, reward_valid_std=2.2701
[BatchDiag] adv_mean=-0.1792, adv_std=0.9666, adv_abs_mean=0.7271 | ret_mean=6.7303, ret_std=1.7519 | val_mean=6.9095, val_std=1.4990 | explained_var=0.695553
[GradSplit pre-clip] backbone=0.469619, critic=0.805463
[Loss] pg_loss=-0.052337, entropy_loss=0.000138, value_loss=0.044560
[EpochKL] epoch=0 mean_kl=0.00303 max_kl=0.00514
[EpochKL] epoch=1 mean_kl=0.00465 max_kl=0.00659
[EpochKL] epoch=2 mean_kl=0.00551 max_kl=0.00967
[Time] Env Create Time: 2.8575s |Rollout Collect Time: 3.5173s |Loss & Update :1.8655
[PPODiag] kl_mean=0.0044, kl_p90=0.0059, kl_max=0.0097 | clipfrac_mean=0.034, logratio_std_mean=0.094, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.788, p10=0.782, min=0.781 | pg_loss_mean=0.0015, v_loss_mean=0.1905, ent_mean=0.1349 | gn_bb_mean=1.391, gn_bb_max=2.279 | gn_v_mean=1.263, gn_v_max=2.779

  4%|▍         | 192/5000 [31:28<11:48:37,  8.84s/it]------------------ Training Record ------------------
Epoch: 192/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3051, reward_valid_std=2.2716
[BatchDiag] adv_mean=-0.1956, adv_std=0.9567, adv_abs_mean=0.7344 | ret_mean=6.7007, ret_std=1.7474 | val_mean=6.8963, val_std=1.4567 | explained_var=0.700220
[GradSplit pre-clip] backbone=0.493194, critic=0.833148
[Loss] pg_loss=-0.083662, entropy_loss=0.000143, value_loss=0.043679
[EpochKL] epoch=0 mean_kl=0.00204 max_kl=0.00384
[EpochKL] epoch=1 mean_kl=0.00367 max_kl=0.00473
[EpochKL] epoch=2 mean_kl=0.00468 max_kl=0.00674
[Time] Env Create Time: 2.6824s |Rollout Collect Time: 3.3600s |Loss & Update :1.8007
[PPODiag] kl_mean=0.0035, kl_p90=0.0048, kl_max=0.0067 | clipfrac_mean=0.028, logratio_std_mean=0.082, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.824, p10=0.818, min=0.818 | pg_loss_mean=0.0011, v_loss_mean=0.1908, ent_mean=0.1416 | gn_bb_mean=1.280, gn_bb_max=1.937 | gn_v_mean=1.268, gn_v_max=2.832

  4%|▍         | 193/5000 [31:36<11:24:27,  8.54s/it]------------------ Training Record ------------------
Epoch: 193/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3067, reward_valid_std=2.2723
[BatchDiag] adv_mean=-0.1521, adv_std=0.9745, adv_abs_mean=0.7403 | ret_mean=6.6839, ret_std=1.7729 | val_mean=6.8360, val_std=1.4794 | explained_var=0.697878
[GradSplit pre-clip] backbone=0.497169, critic=0.400593
[Loss] pg_loss=-0.146017, entropy_loss=0.000142, value_loss=0.044520
[EpochKL] epoch=0 mean_kl=0.00355 max_kl=0.00665
[EpochKL] epoch=1 mean_kl=0.00480 max_kl=0.00594
[EarlyStop] epoch=2 mean_kl=0.01028 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01028 max_kl=0.01514
[Time] Env Create Time: 2.8328s |Rollout Collect Time: 3.5059s |Loss & Update :1.8789
[PPODiag] kl_mean=0.0062, kl_p90=0.0122, kl_max=0.0151 | clipfrac_mean=0.039, logratio_std_mean=0.111, ratio_p95_mean=1.059 | valid_ratio_mb_mean=0.785, p10=0.780, min=0.776 | pg_loss_mean=0.0025, v_loss_mean=0.1941, ent_mean=0.1344 | gn_bb_mean=1.574, gn_bb_max=2.103 | gn_v_mean=0.966, gn_v_max=2.891

  4%|▍         | 194/5000 [31:44<11:16:29,  8.45s/it]------------------ Training Record ------------------
Epoch: 194/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3065, reward_valid_std=2.2704
[BatchDiag] adv_mean=-0.1221, adv_std=0.9933, adv_abs_mean=0.7508 | ret_mean=6.6572, ret_std=1.7674 | val_mean=6.7793, val_std=1.5006 | explained_var=0.684123
[GradSplit pre-clip] backbone=0.728307, critic=0.630615
[Loss] pg_loss=-0.115294, entropy_loss=0.000139, value_loss=0.047500
[EpochKL] epoch=0 mean_kl=0.00389 max_kl=0.00778
[EpochKL] epoch=1 mean_kl=0.00579 max_kl=0.01008
[EpochKL] epoch=2 mean_kl=0.00559 max_kl=0.00680
[Time] Env Create Time: 2.8519s |Rollout Collect Time: 3.4967s |Loss & Update :1.8812
[PPODiag] kl_mean=0.0051, kl_p90=0.0075, kl_max=0.0101 | clipfrac_mean=0.036, logratio_std_mean=0.102, ratio_p95_mean=1.059 | valid_ratio_mb_mean=0.786, p10=0.781, min=0.779 | pg_loss_mean=0.0021, v_loss_mean=0.1988, ent_mean=0.1351 | gn_bb_mean=1.395, gn_bb_max=2.069 | gn_v_mean=1.006, gn_v_max=2.290

  4%|▍         | 195/5000 [31:53<11:11:10,  8.38s/it]------------------ Training Record ------------------
Epoch: 195/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3076, reward_valid_std=2.2703
[BatchDiag] adv_mean=-0.0195, adv_std=0.9964, adv_abs_mean=0.7546 | ret_mean=6.6474, ret_std=1.7873 | val_mean=6.6670, val_std=1.5091 | explained_var=0.689236
[GradSplit pre-clip] backbone=0.536664, critic=1.186608
[Loss] pg_loss=-0.135346, entropy_loss=0.000141, value_loss=0.047810
[EpochKL] epoch=0 mean_kl=0.00354 max_kl=0.00723
[EpochKL] epoch=1 mean_kl=0.00443 max_kl=0.00565
[EpochKL] epoch=2 mean_kl=0.00389 max_kl=0.00678
[Time] Env Create Time: 2.8415s |Rollout Collect Time: 3.5137s |Loss & Update :1.8728
[PPODiag] kl_mean=0.0040, kl_p90=0.0061, kl_max=0.0072 | clipfrac_mean=0.030, logratio_std_mean=0.088, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.786, p10=0.781, min=0.776 | pg_loss_mean=0.0013, v_loss_mean=0.1993, ent_mean=0.1376 | gn_bb_mean=1.165, gn_bb_max=1.720 | gn_v_mean=0.765, gn_v_max=2.176
[AttnScore] scale=1.0539, C=10.0

  4%|▍         | 196/5000 [32:01<11:07:22,  8.34s/it]------------------ Training Record ------------------
Epoch: 196/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3074, reward_valid_std=2.2695
[BatchDiag] adv_mean=-0.0387, adv_std=0.9756, adv_abs_mean=0.7366 | ret_mean=6.6666, ret_std=1.7891 | val_mean=6.7053, val_std=1.5450 | explained_var=0.702640
[GradSplit pre-clip] backbone=0.439683, critic=0.930837
[Loss] pg_loss=-0.121734, entropy_loss=0.000139, value_loss=0.042313
[EpochKL] epoch=0 mean_kl=0.00177 max_kl=0.00299
[EpochKL] epoch=1 mean_kl=0.00388 max_kl=0.00586
[EpochKL] epoch=2 mean_kl=0.00383 max_kl=0.00507
[Time] Env Create Time: 2.6812s |Rollout Collect Time: 3.5042s |Loss & Update :1.8738
[PPODiag] kl_mean=0.0032, kl_p90=0.0050, kl_max=0.0059 | clipfrac_mean=0.027, logratio_std_mean=0.079, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.777 | pg_loss_mean=0.0011, v_loss_mean=0.1921, ent_mean=0.1341 | gn_bb_mean=1.284, gn_bb_max=2.037 | gn_v_mean=0.720, gn_v_max=2.338

  4%|▍         | 197/5000 [32:09<11:00:37,  8.25s/it]------------------ Training Record ------------------
Epoch: 197/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3076, reward_valid_std=2.2699
[BatchDiag] adv_mean=-0.0778, adv_std=0.9609, adv_abs_mean=0.7279 | ret_mean=6.6849, ret_std=1.7770 | val_mean=6.7627, val_std=1.5005 | explained_var=0.707611
[GradSplit pre-clip] backbone=0.511402, critic=0.235541
[Loss] pg_loss=-0.059364, entropy_loss=0.000136, value_loss=0.041172
[EpochKL] epoch=0 mean_kl=0.00198 max_kl=0.00289
[EpochKL] epoch=1 mean_kl=0.00397 max_kl=0.00569
[EpochKL] epoch=2 mean_kl=0.00397 max_kl=0.00550
[Time] Env Create Time: 2.8372s |Rollout Collect Time: 3.5152s |Loss & Update :1.8670
[PPODiag] kl_mean=0.0033, kl_p90=0.0052, kl_max=0.0057 | clipfrac_mean=0.027, logratio_std_mean=0.081, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.779 | pg_loss_mean=0.0010, v_loss_mean=0.1897, ent_mean=0.1349 | gn_bb_mean=1.157, gn_bb_max=1.742 | gn_v_mean=1.129, gn_v_max=2.525

  4%|▍         | 198/5000 [32:17<10:59:41,  8.24s/it]------------------ Training Record ------------------
Epoch: 198/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3093, reward_valid_std=2.2731
[BatchDiag] adv_mean=-0.1202, adv_std=0.9664, adv_abs_mean=0.7370 | ret_mean=6.7088, ret_std=1.7568 | val_mean=6.8290, val_std=1.4984 | explained_var=0.697405
[GradSplit pre-clip] backbone=0.473077, critic=0.397295
[Loss] pg_loss=-0.066097, entropy_loss=0.000139, value_loss=0.049507
[EpochKL] epoch=0 mean_kl=0.00201 max_kl=0.00310
[EpochKL] epoch=1 mean_kl=0.00255 max_kl=0.00333
[EpochKL] epoch=2 mean_kl=0.00404 max_kl=0.00595
[Time] Env Create Time: 2.8376s |Rollout Collect Time: 3.3474s |Loss & Update :1.7943
[PPODiag] kl_mean=0.0029, kl_p90=0.0047, kl_max=0.0060 | clipfrac_mean=0.024, logratio_std_mean=0.075, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.823, p10=0.817, min=0.816 | pg_loss_mean=0.0008, v_loss_mean=0.1924, ent_mean=0.1367 | gn_bb_mean=1.124, gn_bb_max=1.572 | gn_v_mean=1.184, gn_v_max=3.480

  4%|▍         | 199/5000 [32:25<10:53:14,  8.16s/it]------------------ Training Record ------------------
Epoch: 199/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3039, reward_valid_std=2.2687
[BatchDiag] adv_mean=-0.1628, adv_std=0.9789, adv_abs_mean=0.7371 | ret_mean=6.6759, ret_std=1.7758 | val_mean=6.8387, val_std=1.4836 | explained_var=0.696126
[GradSplit pre-clip] backbone=0.451638, critic=0.651732
[Loss] pg_loss=-0.080606, entropy_loss=0.000130, value_loss=0.044581
[EpochKL] epoch=0 mean_kl=0.00257 max_kl=0.00363
[EpochKL] epoch=1 mean_kl=0.00548 max_kl=0.00792
[EpochKL] epoch=2 mean_kl=0.00474 max_kl=0.00541
[Time] Env Create Time: 2.8458s |Rollout Collect Time: 3.5103s |Loss & Update :1.8764
[PPODiag] kl_mean=0.0043, kl_p90=0.0060, kl_max=0.0079 | clipfrac_mean=0.032, logratio_std_mean=0.092, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.779 | pg_loss_mean=0.0017, v_loss_mean=0.1929, ent_mean=0.1323 | gn_bb_mean=1.424, gn_bb_max=2.117 | gn_v_mean=0.992, gn_v_max=2.548

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.919, Step: 21, Avg Done Step: 18.30, #CS visited: 0.43
D->C12->C1->C15->C14->C3->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->D
Eval cost : 4.0055s
-----------------------------
  4%|▍         | 200/5000 [32:37<12:31:16,  9.39s/it]------------------ Training Record ------------------
Epoch: 200/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3069, reward_valid_std=2.2671
[BatchDiag] adv_mean=-0.1240, adv_std=0.9697, adv_abs_mean=0.7378 | ret_mean=6.6737, ret_std=1.7555 | val_mean=6.7977, val_std=1.5008 | explained_var=0.694924
[GradSplit pre-clip] backbone=0.571602, critic=0.425338
[Loss] pg_loss=-0.094506, entropy_loss=0.000135, value_loss=0.046207
[EpochKL] epoch=0 mean_kl=0.00239 max_kl=0.00421
[EpochKL] epoch=1 mean_kl=0.00335 max_kl=0.00503
[EpochKL] epoch=2 mean_kl=0.00435 max_kl=0.00730
[Time] Env Create Time: 2.6815s |Rollout Collect Time: 3.3643s |Loss & Update :1.7916
[PPODiag] kl_mean=0.0034, kl_p90=0.0048, kl_max=0.0073 | clipfrac_mean=0.028, logratio_std_mean=0.082, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.824, p10=0.819, min=0.816 | pg_loss_mean=0.0008, v_loss_mean=0.1933, ent_mean=0.1373 | gn_bb_mean=1.084, gn_bb_max=1.556 | gn_v_mean=1.210, gn_v_max=2.722
[AttnScore] scale=1.0564, C=10.0

  4%|▍         | 201/5000 [32:45<11:53:51,  8.93s/it]------------------ Training Record ------------------
Epoch: 201/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3066, reward_valid_std=2.2700
[BatchDiag] adv_mean=-0.1369, adv_std=0.9597, adv_abs_mean=0.7277 | ret_mean=6.6866, ret_std=1.7670 | val_mean=6.8235, val_std=1.4802 | explained_var=0.704996
[GradSplit pre-clip] backbone=0.499504, critic=0.366508
[Loss] pg_loss=-0.125214, entropy_loss=0.000135, value_loss=0.040384
[EpochKL] epoch=0 mean_kl=0.00188 max_kl=0.00273
[EpochKL] epoch=1 mean_kl=0.00346 max_kl=0.00397
[EpochKL] epoch=2 mean_kl=0.00457 max_kl=0.00642
[Time] Env Create Time: 2.8323s |Rollout Collect Time: 3.3498s |Loss & Update :1.7979
[PPODiag] kl_mean=0.0033, kl_p90=0.0052, kl_max=0.0064 | clipfrac_mean=0.028, logratio_std_mean=0.080, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.824, p10=0.818, min=0.816 | pg_loss_mean=0.0011, v_loss_mean=0.1879, ent_mean=0.1390 | gn_bb_mean=1.170, gn_bb_max=2.012 | gn_v_mean=0.932, gn_v_max=2.034

  4%|▍         | 202/5000 [32:53<11:31:02,  8.64s/it]------------------ Training Record ------------------
Epoch: 202/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3063, reward_valid_std=2.2690
[BatchDiag] adv_mean=-0.1054, adv_std=0.9793, adv_abs_mean=0.7405 | ret_mean=6.6745, ret_std=1.7792 | val_mean=6.7799, val_std=1.4883 | explained_var=0.697054
[GradSplit pre-clip] backbone=0.468029, critic=0.702707
[Loss] pg_loss=-0.151341, entropy_loss=0.000132, value_loss=0.042089
[EpochKL] epoch=0 mean_kl=0.00293 max_kl=0.00425
[EpochKL] epoch=1 mean_kl=0.00640 max_kl=0.01052
[EpochKL] epoch=2 mean_kl=0.00481 max_kl=0.00648
[Time] Env Create Time: 2.8348s |Rollout Collect Time: 3.5036s |Loss & Update :1.8632
[PPODiag] kl_mean=0.0047, kl_p90=0.0075, kl_max=0.0105 | clipfrac_mean=0.035, logratio_std_mean=0.097, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.787, p10=0.781, min=0.777 | pg_loss_mean=0.0013, v_loss_mean=0.1946, ent_mean=0.1300 | gn_bb_mean=1.309, gn_bb_max=2.075 | gn_v_mean=1.200, gn_v_max=2.273

  4%|▍         | 203/5000 [33:01<11:20:21,  8.51s/it]------------------ Training Record ------------------
Epoch: 203/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3110, reward_valid_std=2.2767
[BatchDiag] adv_mean=-0.1212, adv_std=0.9443, adv_abs_mean=0.7218 | ret_mean=6.7257, ret_std=1.7558 | val_mean=6.8468, val_std=1.4480 | explained_var=0.710735
[GradSplit pre-clip] backbone=0.736419, critic=0.666223
[Loss] pg_loss=-0.135531, entropy_loss=0.000136, value_loss=0.040672
[EpochKL] epoch=0 mean_kl=0.00404 max_kl=0.00622
[EpochKL] epoch=1 mean_kl=0.00563 max_kl=0.00779
[EpochKL] epoch=2 mean_kl=0.00758 max_kl=0.01186
[Time] Env Create Time: 2.8579s |Rollout Collect Time: 3.5002s |Loss & Update :1.8677
[PPODiag] kl_mean=0.0058, kl_p90=0.0080, kl_max=0.0119 | clipfrac_mean=0.039, logratio_std_mean=0.108, ratio_p95_mean=1.059 | valid_ratio_mb_mean=0.785, p10=0.779, min=0.773 | pg_loss_mean=0.0023, v_loss_mean=0.1866, ent_mean=0.1298 | gn_bb_mean=1.553, gn_bb_max=2.249 | gn_v_mean=1.516, gn_v_max=3.411

  4%|▍         | 204/5000 [33:10<11:13:25,  8.42s/it]------------------ Training Record ------------------
Epoch: 204/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3109, reward_valid_std=2.2738
[BatchDiag] adv_mean=-0.1251, adv_std=0.9563, adv_abs_mean=0.7289 | ret_mean=6.7200, ret_std=1.7471 | val_mean=6.8451, val_std=1.4576 | explained_var=0.700404
[GradSplit pre-clip] backbone=0.518053, critic=0.700826
[Loss] pg_loss=-0.064424, entropy_loss=0.000131, value_loss=0.046206
[EpochKL] epoch=0 mean_kl=0.00495 max_kl=0.00735
[EpochKL] epoch=1 mean_kl=0.00525 max_kl=0.00773
[EpochKL] epoch=2 mean_kl=0.00487 max_kl=0.00661
[Time] Env Create Time: 2.6780s |Rollout Collect Time: 3.5014s |Loss & Update :1.8713
[PPODiag] kl_mean=0.0050, kl_p90=0.0069, kl_max=0.0077 | clipfrac_mean=0.035, logratio_std_mean=0.101, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.785, p10=0.779, min=0.773 | pg_loss_mean=0.0017, v_loss_mean=0.1898, ent_mean=0.1264 | gn_bb_mean=1.433, gn_bb_max=2.364 | gn_v_mean=1.262, gn_v_max=3.440

  4%|▍         | 205/5000 [33:18<11:04:19,  8.31s/it]------------------ Training Record ------------------
Epoch: 205/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3099, reward_valid_std=2.2726
[BatchDiag] adv_mean=-0.1536, adv_std=0.9614, adv_abs_mean=0.7304 | ret_mean=6.7261, ret_std=1.7447 | val_mean=6.8797, val_std=1.4815 | explained_var=0.696320
[GradSplit pre-clip] backbone=0.534966, critic=0.331046
[Loss] pg_loss=-0.090083, entropy_loss=0.000136, value_loss=0.042921
[EpochKL] epoch=0 mean_kl=0.00488 max_kl=0.00794
[EpochKL] epoch=1 mean_kl=0.00646 max_kl=0.01069
[EpochKL] epoch=2 mean_kl=0.00855 max_kl=0.01599
[Time] Env Create Time: 2.8263s |Rollout Collect Time: 3.4910s |Loss & Update :1.8685
[PPODiag] kl_mean=0.0066, kl_p90=0.0103, kl_max=0.0160 | clipfrac_mean=0.041, logratio_std_mean=0.116, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.786, p10=0.780, min=0.778 | pg_loss_mean=0.0025, v_loss_mean=0.1940, ent_mean=0.1307 | gn_bb_mean=1.504, gn_bb_max=2.141 | gn_v_mean=1.781, gn_v_max=4.476
[AttnScore] scale=1.0585, C=10.0

  4%|▍         | 206/5000 [33:26<11:01:09,  8.27s/it]------------------ Training Record ------------------
Epoch: 206/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3064, reward_valid_std=2.2718
[BatchDiag] adv_mean=-0.3396, adv_std=0.9520, adv_abs_mean=0.7588 | ret_mean=6.7581, ret_std=1.7284 | val_mean=7.0977, val_std=1.4209 | explained_var=0.696629
[GradSplit pre-clip] backbone=0.572254, critic=2.372632
[Loss] pg_loss=-0.050278, entropy_loss=0.000132, value_loss=0.050991
[EpochKL] epoch=0 mean_kl=0.00381 max_kl=0.00660
[EpochKL] epoch=1 mean_kl=0.00657 max_kl=0.01040
[EpochKL] epoch=2 mean_kl=0.00772 max_kl=0.01031
[Time] Env Create Time: 2.8389s |Rollout Collect Time: 3.4924s |Loss & Update :1.8744
[PPODiag] kl_mean=0.0060, kl_p90=0.0092, kl_max=0.0104 | clipfrac_mean=0.038, logratio_std_mean=0.111, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.786, p10=0.779, min=0.777 | pg_loss_mean=0.0028, v_loss_mean=0.2021, ent_mean=0.1273 | gn_bb_mean=1.495, gn_bb_max=1.930 | gn_v_mean=2.257, gn_v_max=4.235

  4%|▍         | 207/5000 [33:34<10:59:22,  8.25s/it]------------------ Training Record ------------------
Epoch: 207/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3104, reward_valid_std=2.2742
[BatchDiag] adv_mean=-0.3764, adv_std=0.9392, adv_abs_mean=0.7605 | ret_mean=6.8053, ret_std=1.6965 | val_mean=7.1817, val_std=1.3902 | explained_var=0.693545
[GradSplit pre-clip] backbone=0.388208, critic=2.438886
[Loss] pg_loss=-0.101923, entropy_loss=0.000134, value_loss=0.048113
[EpochKL] epoch=0 mean_kl=0.00451 max_kl=0.00976
[EpochKL] epoch=1 mean_kl=0.00551 max_kl=0.00874
[EpochKL] epoch=2 mean_kl=0.00786 max_kl=0.01030
[Time] Env Create Time: 2.8597s |Rollout Collect Time: 3.5016s |Loss & Update :1.8622
[PPODiag] kl_mean=0.0060, kl_p90=0.0090, kl_max=0.0103 | clipfrac_mean=0.039, logratio_std_mean=0.109, ratio_p95_mean=1.060 | valid_ratio_mb_mean=0.785, p10=0.780, min=0.777 | pg_loss_mean=0.0027, v_loss_mean=0.1963, ent_mean=0.1326 | gn_bb_mean=1.522, gn_bb_max=2.619 | gn_v_mean=1.833, gn_v_max=3.567

  4%|▍         | 208/5000 [33:42<10:58:30,  8.25s/it]------------------ Training Record ------------------
Epoch: 208/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.784, reward_valid_mean=0.3140, reward_valid_std=2.2759
[BatchDiag] adv_mean=-0.2351, adv_std=0.9416, adv_abs_mean=0.7229 | ret_mean=6.7868, ret_std=1.7172 | val_mean=7.0219, val_std=1.4179 | explained_var=0.699333
[GradSplit pre-clip] backbone=0.575027, critic=1.316302
[Loss] pg_loss=-0.078835, entropy_loss=0.000128, value_loss=0.044182
[EpochKL] epoch=0 mean_kl=0.00256 max_kl=0.00339
[EpochKL] epoch=1 mean_kl=0.00405 max_kl=0.00590
[EpochKL] epoch=2 mean_kl=0.00629 max_kl=0.00860
[Time] Env Create Time: 2.6887s |Rollout Collect Time: 3.4895s |Loss & Update :1.8695
[PPODiag] kl_mean=0.0043, kl_p90=0.0074, kl_max=0.0086 | clipfrac_mean=0.032, logratio_std_mean=0.092, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.784, p10=0.778, min=0.777 | pg_loss_mean=0.0018, v_loss_mean=0.1843, ent_mean=0.1309 | gn_bb_mean=1.294, gn_bb_max=1.952 | gn_v_mean=1.214, gn_v_max=1.895

  4%|▍         | 209/5000 [33:50<10:53:39,  8.19s/it]------------------ Training Record ------------------
Epoch: 209/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3043, reward_valid_std=2.2682
[BatchDiag] adv_mean=-0.2746, adv_std=0.9521, adv_abs_mean=0.7459 | ret_mean=6.7298, ret_std=1.7297 | val_mean=7.0044, val_std=1.4246 | explained_var=0.696984
[GradSplit pre-clip] backbone=0.671845, critic=1.656433
[Loss] pg_loss=-0.057063, entropy_loss=0.000147, value_loss=0.047938
[EpochKL] epoch=0 mean_kl=0.00395 max_kl=0.00736
[EpochKL] epoch=1 mean_kl=0.00418 max_kl=0.00677
[EpochKL] epoch=2 mean_kl=0.00545 max_kl=0.00912
[Time] Env Create Time: 2.8394s |Rollout Collect Time: 3.3525s |Loss & Update :1.7974
[PPODiag] kl_mean=0.0045, kl_p90=0.0073, kl_max=0.0091 | clipfrac_mean=0.034, logratio_std_mean=0.095, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.825, p10=0.819, min=0.817 | pg_loss_mean=0.0018, v_loss_mean=0.1982, ent_mean=0.1393 | gn_bb_mean=1.448, gn_bb_max=1.949 | gn_v_mean=2.154, gn_v_max=3.230

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.934, Step: 21, Avg Done Step: 18.36, #CS visited: 0.44
D->C12->C1->C15->C14->C3->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->D
Eval cost : 4.0053s
-----------------------------
  4%|▍         | 210/5000 [34:02<12:25:33,  9.34s/it]------------------ Training Record ------------------
Epoch: 210/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3033, reward_valid_std=2.2662
[BatchDiag] adv_mean=-0.3665, adv_std=0.9454, adv_abs_mean=0.7563 | ret_mean=6.7520, ret_std=1.7153 | val_mean=7.1185, val_std=1.4211 | explained_var=0.696222
[GradSplit pre-clip] backbone=0.621861, critic=2.239124
[Loss] pg_loss=-0.064129, entropy_loss=0.000139, value_loss=0.046114
[EpochKL] epoch=0 mean_kl=0.00203 max_kl=0.00541
[EpochKL] epoch=1 mean_kl=0.00424 max_kl=0.00712
[EpochKL] epoch=2 mean_kl=0.00616 max_kl=0.01070
[Time] Env Create Time: 2.8577s |Rollout Collect Time: 3.3525s |Loss & Update :1.8018
[PPODiag] kl_mean=0.0041, kl_p90=0.0070, kl_max=0.0107 | clipfrac_mean=0.032, logratio_std_mean=0.088, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.827, p10=0.822, min=0.820 | pg_loss_mean=0.0014, v_loss_mean=0.1972, ent_mean=0.1394 | gn_bb_mean=1.376, gn_bb_max=2.469 | gn_v_mean=1.998, gn_v_max=2.865
[AttnScore] scale=1.0603, C=10.0

  4%|▍         | 211/5000 [34:10<11:53:38,  8.94s/it]------------------ Training Record ------------------
Epoch: 211/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=52, valid_ratio=0.333, reward_valid_mean=0.3080, reward_valid_std=2.2664
[BatchDiag] adv_mean=-0.3416, adv_std=0.9556, adv_abs_mean=0.7649 | ret_mean=6.7661, ret_std=1.6986 | val_mean=7.1077, val_std=1.3676 | explained_var=0.683475
[GradSplit pre-clip] backbone=0.566426, critic=2.120419
[Loss] pg_loss=-0.092205, entropy_loss=0.000061, value_loss=0.045466
[EpochKL] epoch=0 mean_kl=0.00360 max_kl=0.00711
[EpochKL] epoch=1 mean_kl=0.00531 max_kl=0.00840
[EpochKL] epoch=2 mean_kl=0.00529 max_kl=0.00833
[Time] Env Create Time: 2.8473s |Rollout Collect Time: 8.0203s |Loss & Update :4.0651
[PPODiag] kl_mean=0.0047, kl_p90=0.0068, kl_max=0.0084 | clipfrac_mean=0.034, logratio_std_mean=0.098, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.333, p10=0.330, min=0.329 | pg_loss_mean=0.0016, v_loss_mean=0.1964, ent_mean=0.0577 | gn_bb_mean=1.317, gn_bb_max=1.852 | gn_v_mean=1.576, gn_v_max=2.403

  4%|▍         | 212/5000 [34:25<14:16:56, 10.74s/it]------------------ Training Record ------------------
Epoch: 212/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3055, reward_valid_std=2.2686
[BatchDiag] adv_mean=-0.3475, adv_std=0.9620, adv_abs_mean=0.7783 | ret_mean=6.7433, ret_std=1.7277 | val_mean=7.0908, val_std=1.3670 | explained_var=0.689957
[GradSplit pre-clip] backbone=0.722822, critic=2.423064
[Loss] pg_loss=-0.048623, entropy_loss=0.000150, value_loss=0.051484
[EpochKL] epoch=0 mean_kl=0.00470 max_kl=0.00823
[EpochKL] epoch=1 mean_kl=0.00883 max_kl=0.01515
[EpochKL] epoch=2 mean_kl=0.00571 max_kl=0.01042
[Time] Env Create Time: 2.6824s |Rollout Collect Time: 3.5104s |Loss & Update :1.8732
[PPODiag] kl_mean=0.0064, kl_p90=0.0102, kl_max=0.0152 | clipfrac_mean=0.042, logratio_std_mean=0.114, ratio_p95_mean=1.066 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.780 | pg_loss_mean=0.0023, v_loss_mean=0.2049, ent_mean=0.1393 | gn_bb_mean=1.545, gn_bb_max=2.560 | gn_v_mean=2.008, gn_v_max=3.329

  4%|▍         | 213/5000 [34:33<13:12:48,  9.94s/it]------------------ Training Record ------------------
Epoch: 213/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3054, reward_valid_std=2.2678
[BatchDiag] adv_mean=-0.3147, adv_std=0.9778, adv_abs_mean=0.7662 | ret_mean=6.7362, ret_std=1.7281 | val_mean=7.0509, val_std=1.3938 | explained_var=0.679893
[GradSplit pre-clip] backbone=0.643080, critic=1.977305
[Loss] pg_loss=-0.029614, entropy_loss=0.000135, value_loss=0.052500
[EpochKL] epoch=0 mean_kl=0.00321 max_kl=0.00548
[EpochKL] epoch=1 mean_kl=0.00719 max_kl=0.01123
[EpochKL] epoch=2 mean_kl=0.00738 max_kl=0.00997
[Time] Env Create Time: 2.8449s |Rollout Collect Time: 3.3769s |Loss & Update :1.8012
[PPODiag] kl_mean=0.0059, kl_p90=0.0096, kl_max=0.0112 | clipfrac_mean=0.040, logratio_std_mean=0.109, ratio_p95_mean=1.063 | valid_ratio_mb_mean=0.824, p10=0.819, min=0.817 | pg_loss_mean=0.0023, v_loss_mean=0.2029, ent_mean=0.1413 | gn_bb_mean=1.565, gn_bb_max=2.497 | gn_v_mean=1.698, gn_v_max=3.450

  4%|▍         | 214/5000 [34:41<12:26:50,  9.36s/it]------------------ Training Record ------------------
Epoch: 214/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3048, reward_valid_std=2.2679
[BatchDiag] adv_mean=-0.3799, adv_std=0.9661, adv_abs_mean=0.7781 | ret_mean=6.7517, ret_std=1.7192 | val_mean=7.1316, val_std=1.3744 | explained_var=0.684229
[GradSplit pre-clip] backbone=0.357586, critic=2.333458
[Loss] pg_loss=-0.071091, entropy_loss=0.000142, value_loss=0.052354
[EpochKL] epoch=0 mean_kl=0.00396 max_kl=0.00750
[EpochKL] epoch=1 mean_kl=0.00416 max_kl=0.00888
[EpochKL] epoch=2 mean_kl=0.00572 max_kl=0.00850
[Time] Env Create Time: 2.8537s |Rollout Collect Time: 3.4907s |Loss & Update :1.8638
[PPODiag] kl_mean=0.0046, kl_p90=0.0078, kl_max=0.0089 | clipfrac_mean=0.036, logratio_std_mean=0.095, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.780 | pg_loss_mean=0.0018, v_loss_mean=0.2024, ent_mean=0.1392 | gn_bb_mean=1.339, gn_bb_max=2.061 | gn_v_mean=1.719, gn_v_max=2.864

  4%|▍         | 215/5000 [34:50<11:59:04,  9.02s/it]------------------ Training Record ------------------
Epoch: 215/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3048, reward_valid_std=2.2658
[BatchDiag] adv_mean=-0.3106, adv_std=0.9556, adv_abs_mean=0.7567 | ret_mean=6.7346, ret_std=1.7231 | val_mean=7.0453, val_std=1.3826 | explained_var=0.692447
[GradSplit pre-clip] backbone=0.609305, critic=1.995937
[Loss] pg_loss=-0.066385, entropy_loss=0.000144, value_loss=0.047052
[EpochKL] epoch=0 mean_kl=0.00353 max_kl=0.00685
[EpochKL] epoch=1 mean_kl=0.00743 max_kl=0.00966
[EpochKL] epoch=2 mean_kl=0.00850 max_kl=0.01299
[Time] Env Create Time: 2.6765s |Rollout Collect Time: 3.5205s |Loss & Update :1.8624
[PPODiag] kl_mean=0.0065, kl_p90=0.0095, kl_max=0.0130 | clipfrac_mean=0.042, logratio_std_mean=0.113, ratio_p95_mean=1.064 | valid_ratio_mb_mean=0.789, p10=0.783, min=0.782 | pg_loss_mean=0.0027, v_loss_mean=0.1947, ent_mean=0.1423 | gn_bb_mean=1.569, gn_bb_max=2.235 | gn_v_mean=1.464, gn_v_max=2.519
[AttnScore] scale=1.0617, C=10.0

  4%|▍         | 216/5000 [34:58<11:36:02,  8.73s/it]------------------ Training Record ------------------
Epoch: 216/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51199/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.290, reward_valid_mean=0.3032, reward_valid_std=2.2663
[BatchDiag] adv_mean=-0.2141, adv_std=0.9614, adv_abs_mean=0.7371 | ret_mean=6.6964, ret_std=1.7588 | val_mean=6.9105, val_std=1.4157 | explained_var=0.701226
[GradSplit pre-clip] backbone=0.514010, critic=0.574993
[Loss] pg_loss=-0.133544, entropy_loss=0.000053, value_loss=0.041474
[EpochKL] epoch=0 mean_kl=0.00464 max_kl=0.00696
[EpochKL] epoch=1 mean_kl=0.00823 max_kl=0.01727
[EpochKL] epoch=2 mean_kl=0.00793 max_kl=0.01074
[Time] Env Create Time: 2.8456s |Rollout Collect Time: 9.2131s |Loss & Update :4.6344
[PPODiag] kl_mean=0.0069, kl_p90=0.0103, kl_max=0.0173 | clipfrac_mean=0.040, logratio_std_mean=0.121, ratio_p95_mean=1.067 | valid_ratio_mb_mean=0.290, p10=0.288, min=0.286 | pg_loss_mean=0.0026, v_loss_mean=0.1905, ent_mean=0.0505 | gn_bb_mean=1.390, gn_bb_max=2.197 | gn_v_mean=1.163, gn_v_max=2.572

  4%|▍         | 217/5000 [35:14<14:46:21, 11.12s/it]------------------ Training Record ------------------
Epoch: 217/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.756, reward_valid_mean=0.3035, reward_valid_std=2.2635
[BatchDiag] adv_mean=-0.1724, adv_std=0.9708, adv_abs_mean=0.7406 | ret_mean=6.6809, ret_std=1.7621 | val_mean=6.8533, val_std=1.4645 | explained_var=0.696480
[GradSplit pre-clip] backbone=0.684840, critic=0.379954
[Loss] pg_loss=-0.131272, entropy_loss=0.000136, value_loss=0.044657
[EpochKL] epoch=0 mean_kl=0.00233 max_kl=0.00331
[EpochKL] epoch=1 mean_kl=0.00262 max_kl=0.00357
[EpochKL] epoch=2 mean_kl=0.00369 max_kl=0.00697
[Time] Env Create Time: 2.8421s |Rollout Collect Time: 3.6696s |Loss & Update :1.9440
[PPODiag] kl_mean=0.0029, kl_p90=0.0036, kl_max=0.0070 | clipfrac_mean=0.025, logratio_std_mean=0.075, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.756, p10=0.750, min=0.748 | pg_loss_mean=0.0007, v_loss_mean=0.1920, ent_mean=0.1300 | gn_bb_mean=1.073, gn_bb_max=1.680 | gn_v_mean=0.920, gn_v_max=2.972

  4%|▍         | 218/5000 [35:23<13:42:30, 10.32s/it]------------------ Training Record ------------------
Epoch: 218/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3081, reward_valid_std=2.2658
[BatchDiag] adv_mean=-0.1452, adv_std=0.9523, adv_abs_mean=0.7271 | ret_mean=6.7056, ret_std=1.7431 | val_mean=6.8508, val_std=1.4622 | explained_var=0.701566
[GradSplit pre-clip] backbone=0.474101, critic=0.525893
[Loss] pg_loss=-0.073800, entropy_loss=0.000144, value_loss=0.046845
[EpochKL] epoch=0 mean_kl=0.00251 max_kl=0.00531
[EpochKL] epoch=1 mean_kl=0.00642 max_kl=0.01036
[EpochKL] epoch=2 mean_kl=0.00970 max_kl=0.01510
[Time] Env Create Time: 2.8504s |Rollout Collect Time: 3.5118s |Loss & Update :1.8695
[PPODiag] kl_mean=0.0062, kl_p90=0.0109, kl_max=0.0151 | clipfrac_mean=0.039, logratio_std_mean=0.109, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.789, p10=0.785, min=0.781 | pg_loss_mean=0.0024, v_loss_mean=0.1881, ent_mean=0.1379 | gn_bb_mean=1.588, gn_bb_max=2.388 | gn_v_mean=1.005, gn_v_max=1.953

  4%|▍         | 219/5000 [35:31<12:52:25,  9.69s/it]------------------ Training Record ------------------
Epoch: 219/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3049, reward_valid_std=2.2650
[BatchDiag] adv_mean=-0.1773, adv_std=0.9542, adv_abs_mean=0.7374 | ret_mean=6.6855, ret_std=1.7538 | val_mean=6.8627, val_std=1.4684 | explained_var=0.704006
[GradSplit pre-clip] backbone=0.473943, critic=0.472516
[Loss] pg_loss=-0.121906, entropy_loss=0.000140, value_loss=0.041939
[EpochKL] epoch=0 mean_kl=0.00358 max_kl=0.00483
[EpochKL] epoch=1 mean_kl=0.00450 max_kl=0.00675
[EpochKL] epoch=2 mean_kl=0.00366 max_kl=0.00532
[Time] Env Create Time: 2.7032s |Rollout Collect Time: 3.5107s |Loss & Update :1.8717
[PPODiag] kl_mean=0.0039, kl_p90=0.0054, kl_max=0.0068 | clipfrac_mean=0.031, logratio_std_mean=0.089, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.781 | pg_loss_mean=0.0012, v_loss_mean=0.1906, ent_mean=0.1386 | gn_bb_mean=1.126, gn_bb_max=1.644 | gn_v_mean=1.090, gn_v_max=2.657

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.918, Step: 21, Avg Done Step: 18.38, #CS visited: 0.44
D->C12->C1->C15->C14->C3->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->D
Eval cost : 4.0430s
-----------------------------
  4%|▍         | 220/5000 [35:43<13:54:41, 10.48s/it]------------------ Training Record ------------------
Epoch: 220/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3028, reward_valid_std=2.2655
[BatchDiag] adv_mean=-0.2050, adv_std=0.9857, adv_abs_mean=0.7541 | ret_mean=6.6700, ret_std=1.7600 | val_mean=6.8751, val_std=1.4634 | explained_var=0.686297
[GradSplit pre-clip] backbone=0.656064, critic=0.728193
[Loss] pg_loss=-0.097074, entropy_loss=0.000146, value_loss=0.047089
[EpochKL] epoch=0 mean_kl=0.00236 max_kl=0.00366
[EpochKL] epoch=1 mean_kl=0.00499 max_kl=0.00655
[EpochKL] epoch=2 mean_kl=0.00562 max_kl=0.00653
[Time] Env Create Time: 2.6737s |Rollout Collect Time: 3.5171s |Loss & Update :1.8691
[PPODiag] kl_mean=0.0043, kl_p90=0.0062, kl_max=0.0066 | clipfrac_mean=0.033, logratio_std_mean=0.093, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.789, p10=0.782, min=0.779 | pg_loss_mean=0.0014, v_loss_mean=0.2007, ent_mean=0.1415 | gn_bb_mean=1.268, gn_bb_max=1.953 | gn_v_mean=1.375, gn_v_max=3.031
[AttnScore] scale=1.0637, C=10.0

  4%|▍         | 221/5000 [35:51<12:56:45,  9.75s/it]------------------ Training Record ------------------
Epoch: 221/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3050, reward_valid_std=2.2672
[BatchDiag] adv_mean=-0.1705, adv_std=0.9683, adv_abs_mean=0.7341 | ret_mean=6.6844, ret_std=1.7534 | val_mean=6.8549, val_std=1.5080 | explained_var=0.695029
[GradSplit pre-clip] backbone=0.414527, critic=0.533768
[Loss] pg_loss=-0.069117, entropy_loss=0.000141, value_loss=0.044179
[EpochKL] epoch=0 mean_kl=0.00320 max_kl=0.00566
[EpochKL] epoch=1 mean_kl=0.00513 max_kl=0.01105
[EpochKL] epoch=2 mean_kl=0.00589 max_kl=0.00905
[Time] Env Create Time: 2.8454s |Rollout Collect Time: 3.5100s |Loss & Update :1.8765
[PPODiag] kl_mean=0.0047, kl_p90=0.0067, kl_max=0.0111 | clipfrac_mean=0.036, logratio_std_mean=0.097, ratio_p95_mean=1.060 | valid_ratio_mb_mean=0.788, p10=0.784, min=0.782 | pg_loss_mean=0.0019, v_loss_mean=0.1912, ent_mean=0.1374 | gn_bb_mean=1.352, gn_bb_max=2.258 | gn_v_mean=1.013, gn_v_max=2.253

  4%|▍         | 222/5000 [36:00<12:20:17,  9.30s/it]------------------ Training Record ------------------
Epoch: 222/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51192/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.289, reward_valid_mean=0.3049, reward_valid_std=2.2657
[BatchDiag] adv_mean=-0.1660, adv_std=0.9851, adv_abs_mean=0.7401 | ret_mean=6.6614, ret_std=1.7625 | val_mean=6.8274, val_std=1.5005 | explained_var=0.687606
[GradSplit pre-clip] backbone=0.466152, critic=0.547092
[Loss] pg_loss=-0.169173, entropy_loss=0.000050, value_loss=0.043430
[EpochKL] epoch=0 mean_kl=0.00510 max_kl=0.00937
[EpochKL] epoch=1 mean_kl=0.00934 max_kl=0.02418
[EpochKL] epoch=2 mean_kl=0.00979 max_kl=0.01783
[Time] Env Create Time: 2.8506s |Rollout Collect Time: 9.1881s |Loss & Update :4.6534
[PPODiag] kl_mean=0.0081, kl_p90=0.0116, kl_max=0.0242 | clipfrac_mean=0.044, logratio_std_mean=0.130, ratio_p95_mean=1.068 | valid_ratio_mb_mean=0.289, p10=0.287, min=0.285 | pg_loss_mean=0.0029, v_loss_mean=0.1965, ent_mean=0.0505 | gn_bb_mean=1.692, gn_bb_max=2.471 | gn_v_mean=1.349, gn_v_max=3.886

  4%|▍         | 223/5000 [36:16<15:16:47, 11.52s/it]------------------ Training Record ------------------
Epoch: 223/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3091, reward_valid_std=2.2662
[BatchDiag] adv_mean=-0.1658, adv_std=0.9627, adv_abs_mean=0.7326 | ret_mean=6.7133, ret_std=1.7358 | val_mean=6.8791, val_std=1.4610 | explained_var=0.692423
[GradSplit pre-clip] backbone=0.602942, critic=0.539806
[Loss] pg_loss=-0.095381, entropy_loss=0.000139, value_loss=0.046600
[EpochKL] epoch=0 mean_kl=0.00323 max_kl=0.00570
[EpochKL] epoch=1 mean_kl=0.00632 max_kl=0.00823
[EpochKL] epoch=2 mean_kl=0.00594 max_kl=0.00839
[Time] Env Create Time: 2.6942s |Rollout Collect Time: 3.5053s |Loss & Update :1.8603
[PPODiag] kl_mean=0.0052, kl_p90=0.0078, kl_max=0.0084 | clipfrac_mean=0.036, logratio_std_mean=0.101, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.778 | pg_loss_mean=0.0022, v_loss_mean=0.1930, ent_mean=0.1384 | gn_bb_mean=1.387, gn_bb_max=2.011 | gn_v_mean=1.747, gn_v_max=3.926

  4%|▍         | 224/5000 [36:24<13:54:06, 10.48s/it]------------------ Training Record ------------------
Epoch: 224/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3091, reward_valid_std=2.2647
[BatchDiag] adv_mean=-0.1054, adv_std=0.9886, adv_abs_mean=0.7456 | ret_mean=6.6789, ret_std=1.7603 | val_mean=6.7843, val_std=1.4707 | explained_var=0.684613
[GradSplit pre-clip] backbone=0.651770, critic=0.383049
[Loss] pg_loss=-0.052025, entropy_loss=0.000148, value_loss=0.046305
[EpochKL] epoch=0 mean_kl=0.00409 max_kl=0.00633
[EpochKL] epoch=1 mean_kl=0.00499 max_kl=0.00685
[EpochKL] epoch=2 mean_kl=0.00540 max_kl=0.00785
[Time] Env Create Time: 2.8157s |Rollout Collect Time: 3.5063s |Loss & Update :1.8621
[PPODiag] kl_mean=0.0048, kl_p90=0.0069, kl_max=0.0079 | clipfrac_mean=0.037, logratio_std_mean=0.099, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.781 | pg_loss_mean=0.0018, v_loss_mean=0.1976, ent_mean=0.1368 | gn_bb_mean=1.268, gn_bb_max=1.887 | gn_v_mean=1.128, gn_v_max=2.180

  4%|▍         | 225/5000 [36:33<12:59:09,  9.79s/it]------------------ Training Record ------------------
Epoch: 225/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3101, reward_valid_std=2.2706
[BatchDiag] adv_mean=-0.0859, adv_std=0.9819, adv_abs_mean=0.7431 | ret_mean=6.6852, ret_std=1.7555 | val_mean=6.7711, val_std=1.4693 | explained_var=0.687143
[GradSplit pre-clip] backbone=0.613605, critic=0.451269
[Loss] pg_loss=-0.089600, entropy_loss=0.000145, value_loss=0.046825
[EpochKL] epoch=0 mean_kl=0.00340 max_kl=0.00642
[EpochKL] epoch=1 mean_kl=0.00567 max_kl=0.00768
[EpochKL] epoch=2 mean_kl=0.00755 max_kl=0.01257
[Time] Env Create Time: 2.8461s |Rollout Collect Time: 3.5039s |Loss & Update :1.8699
[PPODiag] kl_mean=0.0055, kl_p90=0.0092, kl_max=0.0126 | clipfrac_mean=0.038, logratio_std_mean=0.104, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.786, p10=0.783, min=0.780 | pg_loss_mean=0.0023, v_loss_mean=0.1951, ent_mean=0.1348 | gn_bb_mean=1.617, gn_bb_max=2.773 | gn_v_mean=0.837, gn_v_max=1.718
[AttnScore] scale=1.0659, C=10.0

  5%|▍         | 226/5000 [36:41<12:21:30,  9.32s/it]------------------ Training Record ------------------
Epoch: 226/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3071, reward_valid_std=2.2648
[BatchDiag] adv_mean=-0.0658, adv_std=0.9972, adv_abs_mean=0.7559 | ret_mean=6.6386, ret_std=1.7571 | val_mean=6.7044, val_std=1.4932 | explained_var=0.677882
[GradSplit pre-clip] backbone=0.585198, critic=0.371459
[Loss] pg_loss=-0.021127, entropy_loss=0.000147, value_loss=0.048044
[EpochKL] epoch=0 mean_kl=0.00288 max_kl=0.00530
[EpochKL] epoch=1 mean_kl=0.00413 max_kl=0.00559
[EpochKL] epoch=2 mean_kl=0.00635 max_kl=0.00879
[Time] Env Create Time: 2.8471s |Rollout Collect Time: 3.4992s |Loss & Update :1.8773
[PPODiag] kl_mean=0.0045, kl_p90=0.0073, kl_max=0.0088 | clipfrac_mean=0.033, logratio_std_mean=0.095, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.788, p10=0.784, min=0.782 | pg_loss_mean=0.0015, v_loss_mean=0.1990, ent_mean=0.1378 | gn_bb_mean=1.217, gn_bb_max=1.837 | gn_v_mean=0.737, gn_v_max=1.927

  5%|▍         | 227/5000 [36:49<11:55:13,  8.99s/it]------------------ Training Record ------------------
Epoch: 227/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3110, reward_valid_std=2.2693
[BatchDiag] adv_mean=-0.0635, adv_std=0.9828, adv_abs_mean=0.7423 | ret_mean=6.6856, ret_std=1.7653 | val_mean=6.7491, val_std=1.4984 | explained_var=0.690058
[GradSplit pre-clip] backbone=0.606925, critic=0.505780
[Loss] pg_loss=-0.076316, entropy_loss=0.000142, value_loss=0.043896
[EpochKL] epoch=0 mean_kl=0.00225 max_kl=0.00321
[EpochKL] epoch=1 mean_kl=0.00338 max_kl=0.00441
[EpochKL] epoch=2 mean_kl=0.00694 max_kl=0.01181
[Time] Env Create Time: 2.6851s |Rollout Collect Time: 3.5071s |Loss & Update :1.8770
[PPODiag] kl_mean=0.0042, kl_p90=0.0066, kl_max=0.0118 | clipfrac_mean=0.032, logratio_std_mean=0.090, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.786, p10=0.781, min=0.777 | pg_loss_mean=0.0014, v_loss_mean=0.1957, ent_mean=0.1352 | gn_bb_mean=1.330, gn_bb_max=2.077 | gn_v_mean=1.157, gn_v_max=2.845

  5%|▍         | 228/5000 [36:57<11:33:05,  8.71s/it]------------------ Training Record ------------------
Epoch: 228/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3100, reward_valid_std=2.2655
[BatchDiag] adv_mean=-0.1040, adv_std=0.9743, adv_abs_mean=0.7394 | ret_mean=6.6838, ret_std=1.7464 | val_mean=6.7877, val_std=1.4884 | explained_var=0.688739
[GradSplit pre-clip] backbone=0.558541, critic=0.573701
[Loss] pg_loss=-0.030027, entropy_loss=0.000156, value_loss=0.051231
[EpochKL] epoch=0 mean_kl=0.00254 max_kl=0.00381
[EpochKL] epoch=1 mean_kl=0.00561 max_kl=0.00891
[EpochKL] epoch=2 mean_kl=0.00811 max_kl=0.01010
[Time] Env Create Time: 2.8444s |Rollout Collect Time: 3.3561s |Loss & Update :1.8070
[PPODiag] kl_mean=0.0054, kl_p90=0.0088, kl_max=0.0101 | clipfrac_mean=0.035, logratio_std_mean=0.104, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.824, p10=0.818, min=0.813 | pg_loss_mean=0.0016, v_loss_mean=0.1939, ent_mean=0.1466 | gn_bb_mean=1.257, gn_bb_max=1.795 | gn_v_mean=0.957, gn_v_max=1.790

  5%|▍         | 229/5000 [37:05<11:16:05,  8.50s/it]------------------ Training Record ------------------
Epoch: 229/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=45, valid_ratio=0.385, reward_valid_mean=0.3086, reward_valid_std=2.2672
[BatchDiag] adv_mean=-0.0451, adv_std=0.9980, adv_abs_mean=0.7591 | ret_mean=6.6448, ret_std=1.7796 | val_mean=6.6899, val_std=1.4776 | explained_var=0.685465
[GradSplit pre-clip] backbone=0.453857, critic=0.471827
[Loss] pg_loss=-0.016312, entropy_loss=0.000071, value_loss=0.052574
[EpochKL] epoch=0 mean_kl=0.00338 max_kl=0.00563
[EpochKL] epoch=1 mean_kl=0.00445 max_kl=0.00757
[EpochKL] epoch=2 mean_kl=0.00473 max_kl=0.00687
[Time] Env Create Time: 2.8532s |Rollout Collect Time: 6.9454s |Loss & Update :3.5617
[PPODiag] kl_mean=0.0042, kl_p90=0.0058, kl_max=0.0076 | clipfrac_mean=0.032, logratio_std_mean=0.091, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.385, p10=0.383, min=0.383 | pg_loss_mean=0.0018, v_loss_mean=0.1997, ent_mean=0.0676 | gn_bb_mean=1.320, gn_bb_max=1.990 | gn_v_mean=0.799, gn_v_max=1.461

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.853, Step: 22, Avg Done Step: 18.36, #CS visited: 0.43
D->C12->C1->C15->C14->C3->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->D
Eval cost : 4.1968s
-----------------------------
  5%|▍         | 230/5000 [37:23<14:53:17, 11.24s/it]------------------ Training Record ------------------
Epoch: 230/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3105, reward_valid_std=2.2657
[BatchDiag] adv_mean=-0.0736, adv_std=0.9757, adv_abs_mean=0.7409 | ret_mean=6.6709, ret_std=1.7426 | val_mean=6.7445, val_std=1.4800 | explained_var=0.686496
[GradSplit pre-clip] backbone=0.395413, critic=0.399959
[Loss] pg_loss=-0.070651, entropy_loss=0.000141, value_loss=0.045343
[EpochKL] epoch=0 mean_kl=0.00330 max_kl=0.00684
[EpochKL] epoch=1 mean_kl=0.00438 max_kl=0.00564
[EpochKL] epoch=2 mean_kl=0.00498 max_kl=0.00737
[Time] Env Create Time: 2.9098s |Rollout Collect Time: 3.5466s |Loss & Update :1.8754
[PPODiag] kl_mean=0.0042, kl_p90=0.0058, kl_max=0.0074 | clipfrac_mean=0.032, logratio_std_mean=0.091, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.779 | pg_loss_mean=0.0015, v_loss_mean=0.1950, ent_mean=0.1369 | gn_bb_mean=1.096, gn_bb_max=1.772 | gn_v_mean=1.111, gn_v_max=2.063
[AttnScore] scale=1.0684, C=10.0

  5%|▍         | 231/5000 [37:31<13:43:51, 10.37s/it]------------------ Training Record ------------------
Epoch: 231/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.751, reward_valid_mean=0.3127, reward_valid_std=2.2724
[BatchDiag] adv_mean=-0.0065, adv_std=0.9818, adv_abs_mean=0.7423 | ret_mean=6.6794, ret_std=1.7605 | val_mean=6.6859, val_std=1.5309 | explained_var=0.689037
[GradSplit pre-clip] backbone=0.646249, critic=1.177136
[Loss] pg_loss=-0.066408, entropy_loss=0.000135, value_loss=0.045583
[EpochKL] epoch=0 mean_kl=0.00300 max_kl=0.00710
[EpochKL] epoch=1 mean_kl=0.00528 max_kl=0.00817
[EpochKL] epoch=2 mean_kl=0.00767 max_kl=0.01073
[Time] Env Create Time: 2.7005s |Rollout Collect Time: 3.6655s |Loss & Update :1.9482
[PPODiag] kl_mean=0.0053, kl_p90=0.0082, kl_max=0.0107 | clipfrac_mean=0.036, logratio_std_mean=0.103, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.751, p10=0.747, min=0.742 | pg_loss_mean=0.0024, v_loss_mean=0.1974, ent_mean=0.1318 | gn_bb_mean=1.542, gn_bb_max=2.385 | gn_v_mean=1.660, gn_v_max=3.046

  5%|▍         | 232/5000 [37:39<12:54:48,  9.75s/it]------------------ Training Record ------------------
Epoch: 232/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3093, reward_valid_std=2.2651
[BatchDiag] adv_mean=-0.0258, adv_std=0.9897, adv_abs_mean=0.7445 | ret_mean=6.6515, ret_std=1.7750 | val_mean=6.6773, val_std=1.5538 | explained_var=0.689097
[GradSplit pre-clip] backbone=0.389556, critic=1.545611
[Loss] pg_loss=-0.108892, entropy_loss=0.000145, value_loss=0.045754
[EpochKL] epoch=0 mean_kl=0.00332 max_kl=0.00564
[EpochKL] epoch=1 mean_kl=0.00440 max_kl=0.00926
[EpochKL] epoch=2 mean_kl=0.00650 max_kl=0.01048
[Time] Env Create Time: 2.8469s |Rollout Collect Time: 3.5215s |Loss & Update :1.8713
[PPODiag] kl_mean=0.0047, kl_p90=0.0080, kl_max=0.0105 | clipfrac_mean=0.036, logratio_std_mean=0.097, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.787, p10=0.781, min=0.775 | pg_loss_mean=0.0016, v_loss_mean=0.1960, ent_mean=0.1375 | gn_bb_mean=1.376, gn_bb_max=2.145 | gn_v_mean=1.065, gn_v_max=2.239

  5%|▍         | 233/5000 [37:48<12:18:39,  9.30s/it]------------------ Training Record ------------------
Epoch: 233/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3097, reward_valid_std=2.2665
[BatchDiag] adv_mean=-0.0609, adv_std=1.0039, adv_abs_mean=0.7512 | ret_mean=6.6624, ret_std=1.7875 | val_mean=6.7233, val_std=1.4970 | explained_var=0.684605
[GradSplit pre-clip] backbone=0.503377, critic=0.565396
[Loss] pg_loss=-0.087145, entropy_loss=0.000142, value_loss=0.040283
[EpochKL] epoch=0 mean_kl=0.00509 max_kl=0.01095
[EpochKL] epoch=1 mean_kl=0.00663 max_kl=0.01149
[EpochKL] epoch=2 mean_kl=0.00487 max_kl=0.00828
[Time] Env Create Time: 2.8637s |Rollout Collect Time: 3.5228s |Loss & Update :1.8697
[PPODiag] kl_mean=0.0055, kl_p90=0.0082, kl_max=0.0115 | clipfrac_mean=0.038, logratio_std_mean=0.105, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.780 | pg_loss_mean=0.0024, v_loss_mean=0.2000, ent_mean=0.1362 | gn_bb_mean=1.614, gn_bb_max=2.665 | gn_v_mean=0.961, gn_v_max=2.358

  5%|▍         | 234/5000 [37:56<11:53:42,  8.98s/it]------------------ Training Record ------------------
Epoch: 234/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3110, reward_valid_std=2.2673
[BatchDiag] adv_mean=-0.0322, adv_std=1.0017, adv_abs_mean=0.7544 | ret_mean=6.6552, ret_std=1.7694 | val_mean=6.6874, val_std=1.5358 | explained_var=0.679511
[GradSplit pre-clip] backbone=0.404619, critic=1.039951
[Loss] pg_loss=-0.088986, entropy_loss=0.000140, value_loss=0.046263
[EpochKL] epoch=0 mean_kl=0.00201 max_kl=0.00315
[EpochKL] epoch=1 mean_kl=0.00352 max_kl=0.00465
[EpochKL] epoch=2 mean_kl=0.00482 max_kl=0.00626
[Time] Env Create Time: 2.7009s |Rollout Collect Time: 3.5129s |Loss & Update :1.8716
[PPODiag] kl_mean=0.0034, kl_p90=0.0051, kl_max=0.0063 | clipfrac_mean=0.028, logratio_std_mean=0.082, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.786, p10=0.781, min=0.778 | pg_loss_mean=0.0012, v_loss_mean=0.2007, ent_mean=0.1320 | gn_bb_mean=1.107, gn_bb_max=1.592 | gn_v_mean=1.116, gn_v_max=2.532

  5%|▍         | 235/5000 [38:04<11:32:08,  8.72s/it]------------------ Training Record ------------------
Epoch: 235/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.784, reward_valid_mean=0.3127, reward_valid_std=2.2722
[BatchDiag] adv_mean=-0.1016, adv_std=0.9893, adv_abs_mean=0.7529 | ret_mean=6.6953, ret_std=1.7514 | val_mean=6.7969, val_std=1.4631 | explained_var=0.680937
[GradSplit pre-clip] backbone=0.398903, critic=0.553295
[Loss] pg_loss=-0.033828, entropy_loss=0.000144, value_loss=0.047821
[EpochKL] epoch=0 mean_kl=0.00260 max_kl=0.00370
[EpochKL] epoch=1 mean_kl=0.00323 max_kl=0.00490
[EpochKL] epoch=2 mean_kl=0.00342 max_kl=0.00481
[Time] Env Create Time: 2.8523s |Rollout Collect Time: 3.5219s |Loss & Update :1.8768
[PPODiag] kl_mean=0.0031, kl_p90=0.0040, kl_max=0.0049 | clipfrac_mean=0.027, logratio_std_mean=0.078, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.784, p10=0.780, min=0.778 | pg_loss_mean=0.0011, v_loss_mean=0.1986, ent_mean=0.1352 | gn_bb_mean=1.134, gn_bb_max=1.648 | gn_v_mean=0.772, gn_v_max=1.186
[AttnScore] scale=1.0711, C=10.0

  5%|▍         | 236/5000 [38:12<11:20:56,  8.58s/it]------------------ Training Record ------------------
Epoch: 236/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3115, reward_valid_std=2.2693
[BatchDiag] adv_mean=-0.0413, adv_std=0.9921, adv_abs_mean=0.7471 | ret_mean=6.6708, ret_std=1.7772 | val_mean=6.7121, val_std=1.4902 | explained_var=0.688410
[GradSplit pre-clip] backbone=0.637085, critic=0.933485
[Loss] pg_loss=-0.101074, entropy_loss=0.000135, value_loss=0.046199
[EpochKL] epoch=0 mean_kl=0.00206 max_kl=0.00419
[EpochKL] epoch=1 mean_kl=0.00641 max_kl=0.00829
[EpochKL] epoch=2 mean_kl=0.00665 max_kl=0.00926
[Time] Env Create Time: 2.8566s |Rollout Collect Time: 3.5162s |Loss & Update :1.8782
[PPODiag] kl_mean=0.0050, kl_p90=0.0082, kl_max=0.0093 | clipfrac_mean=0.034, logratio_std_mean=0.099, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.786, p10=0.782, min=0.781 | pg_loss_mean=0.0020, v_loss_mean=0.1980, ent_mean=0.1328 | gn_bb_mean=1.397, gn_bb_max=2.369 | gn_v_mean=0.964, gn_v_max=1.791

  5%|▍         | 237/5000 [38:21<11:13:04,  8.48s/it]------------------ Training Record ------------------
Epoch: 237/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51196/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.288, reward_valid_mean=0.3096, reward_valid_std=2.2694
[BatchDiag] adv_mean=-0.0855, adv_std=1.0166, adv_abs_mean=0.7598 | ret_mean=6.6501, ret_std=1.7877 | val_mean=6.7356, val_std=1.4776 | explained_var=0.676628
[GradSplit pre-clip] backbone=0.749102, critic=0.684861
[Loss] pg_loss=-0.105784, entropy_loss=0.000053, value_loss=0.043944
[EpochKL] epoch=0 mean_kl=0.00392 max_kl=0.00612
[EpochKL] epoch=1 mean_kl=0.00541 max_kl=0.00658
[EpochKL] epoch=2 mean_kl=0.00592 max_kl=0.00816
[Time] Env Create Time: 2.8686s |Rollout Collect Time: 9.2639s |Loss & Update :4.6825
[PPODiag] kl_mean=0.0051, kl_p90=0.0064, kl_max=0.0082 | clipfrac_mean=0.037, logratio_std_mean=0.101, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.288, p10=0.286, min=0.284 | pg_loss_mean=0.0018, v_loss_mean=0.2022, ent_mean=0.0487 | gn_bb_mean=1.385, gn_bb_max=2.386 | gn_v_mean=0.864, gn_v_max=1.875

  5%|▍         | 238/5000 [38:37<14:31:25, 10.98s/it]------------------ Training Record ------------------
Epoch: 238/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3117, reward_valid_std=2.2694
[BatchDiag] adv_mean=-0.0729, adv_std=0.9863, adv_abs_mean=0.7464 | ret_mean=6.6594, ret_std=1.7574 | val_mean=6.7323, val_std=1.4880 | explained_var=0.684999
[GradSplit pre-clip] backbone=0.480120, critic=0.376972
[Loss] pg_loss=-0.024082, entropy_loss=0.000138, value_loss=0.048514
[EpochKL] epoch=0 mean_kl=0.00216 max_kl=0.00363
[EpochKL] epoch=1 mean_kl=0.00360 max_kl=0.00464
[EpochKL] epoch=2 mean_kl=0.00430 max_kl=0.00512
[Time] Env Create Time: 2.7045s |Rollout Collect Time: 3.5145s |Loss & Update :1.8949
[PPODiag] kl_mean=0.0034, kl_p90=0.0046, kl_max=0.0051 | clipfrac_mean=0.029, logratio_std_mean=0.082, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.785, p10=0.781, min=0.778 | pg_loss_mean=0.0012, v_loss_mean=0.1980, ent_mean=0.1318 | gn_bb_mean=1.086, gn_bb_max=1.481 | gn_v_mean=1.273, gn_v_max=2.931

  5%|▍         | 239/5000 [38:45<13:23:02, 10.12s/it]------------------ Training Record ------------------
Epoch: 239/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3114, reward_valid_std=2.2696
[BatchDiag] adv_mean=-0.1905, adv_std=0.9723, adv_abs_mean=0.7499 | ret_mean=6.7016, ret_std=1.7365 | val_mean=6.8921, val_std=1.4123 | explained_var=0.686522
[GradSplit pre-clip] backbone=0.529545, critic=1.476760
[Loss] pg_loss=-0.038718, entropy_loss=0.000144, value_loss=0.044463
[EpochKL] epoch=0 mean_kl=0.00354 max_kl=0.00862
[EpochKL] epoch=1 mean_kl=0.00552 max_kl=0.00737
[EpochKL] epoch=2 mean_kl=0.00622 max_kl=0.00934
[Time] Env Create Time: 2.8385s |Rollout Collect Time: 3.5159s |Loss & Update :1.8690
[PPODiag] kl_mean=0.0051, kl_p90=0.0073, kl_max=0.0093 | clipfrac_mean=0.036, logratio_std_mean=0.101, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.785, p10=0.780, min=0.776 | pg_loss_mean=0.0019, v_loss_mean=0.1959, ent_mean=0.1333 | gn_bb_mean=1.475, gn_bb_max=2.136 | gn_v_mean=1.389, gn_v_max=2.990

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.798, Step: 20, Avg Done Step: 18.33, #CS visited: 0.42
D->C12->C1->C15->C14->C3->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->D
Eval cost : 3.9265s
-----------------------------
  5%|▍         | 240/5000 [38:58<14:12:37, 10.75s/it]------------------ Training Record ------------------
Epoch: 240/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3144, reward_valid_std=2.2730
[BatchDiag] adv_mean=-0.0874, adv_std=0.9612, adv_abs_mean=0.7283 | ret_mean=6.7038, ret_std=1.7430 | val_mean=6.7912, val_std=1.4607 | explained_var=0.695857
[GradSplit pre-clip] backbone=0.540075, critic=0.709304
[Loss] pg_loss=-0.005583, entropy_loss=0.000147, value_loss=0.043395
[EpochKL] epoch=0 mean_kl=0.00305 max_kl=0.00447
[EpochKL] epoch=1 mean_kl=0.00564 max_kl=0.00668
[EpochKL] epoch=2 mean_kl=0.00584 max_kl=0.00942
[Time] Env Create Time: 2.8605s |Rollout Collect Time: 3.3618s |Loss & Update :1.7989
[PPODiag] kl_mean=0.0048, kl_p90=0.0063, kl_max=0.0094 | clipfrac_mean=0.035, logratio_std_mean=0.099, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.822, p10=0.817, min=0.815 | pg_loss_mean=0.0021, v_loss_mean=0.1887, ent_mean=0.1357 | gn_bb_mean=1.382, gn_bb_max=2.072 | gn_v_mean=1.009, gn_v_max=1.982
[AttnScore] scale=1.0734, C=10.0

  5%|▍         | 241/5000 [39:06<13:07:35,  9.93s/it]------------------ Training Record ------------------
Epoch: 241/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3129, reward_valid_std=2.2699
[BatchDiag] adv_mean=-0.1145, adv_std=0.9460, adv_abs_mean=0.7142 | ret_mean=6.7033, ret_std=1.7344 | val_mean=6.8178, val_std=1.4706 | explained_var=0.702487
[GradSplit pre-clip] backbone=0.462866, critic=0.526794
[Loss] pg_loss=-0.048472, entropy_loss=0.000147, value_loss=0.046741
[EpochKL] epoch=0 mean_kl=0.00249 max_kl=0.00580
[EpochKL] epoch=1 mean_kl=0.00542 max_kl=0.00748
[EpochKL] epoch=2 mean_kl=0.00658 max_kl=0.00833
[Time] Env Create Time: 2.8713s |Rollout Collect Time: 3.3757s |Loss & Update :1.7913
[PPODiag] kl_mean=0.0048, kl_p90=0.0080, kl_max=0.0083 | clipfrac_mean=0.033, logratio_std_mean=0.097, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.822, p10=0.816, min=0.810 | pg_loss_mean=0.0017, v_loss_mean=0.1865, ent_mean=0.1357 | gn_bb_mean=1.360, gn_bb_max=2.310 | gn_v_mean=1.425, gn_v_max=2.817

  5%|▍         | 242/5000 [39:14<12:22:26,  9.36s/it]------------------ Training Record ------------------
Epoch: 242/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.783, reward_valid_mean=0.3156, reward_valid_std=2.2732
[BatchDiag] adv_mean=-0.0861, adv_std=0.9555, adv_abs_mean=0.7202 | ret_mean=6.7209, ret_std=1.7317 | val_mean=6.8070, val_std=1.4954 | explained_var=0.695551
[GradSplit pre-clip] backbone=0.493724, critic=0.513308
[Loss] pg_loss=-0.098379, entropy_loss=0.000144, value_loss=0.042948
[EpochKL] epoch=0 mean_kl=0.00323 max_kl=0.00595
[EpochKL] epoch=1 mean_kl=0.00328 max_kl=0.00416
[EpochKL] epoch=2 mean_kl=0.00289 max_kl=0.00390
[Time] Env Create Time: 2.6928s |Rollout Collect Time: 3.5086s |Loss & Update :1.8753
[PPODiag] kl_mean=0.0031, kl_p90=0.0040, kl_max=0.0059 | clipfrac_mean=0.026, logratio_std_mean=0.079, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.783, p10=0.777, min=0.775 | pg_loss_mean=0.0007, v_loss_mean=0.1895, ent_mean=0.1305 | gn_bb_mean=1.044, gn_bb_max=1.607 | gn_v_mean=1.648, gn_v_max=3.426

  5%|▍         | 243/5000 [39:22<11:51:42,  8.98s/it]------------------ Training Record ------------------
Epoch: 243/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.783, reward_valid_mean=0.3156, reward_valid_std=2.2736
[BatchDiag] adv_mean=-0.1952, adv_std=0.9721, adv_abs_mean=0.7372 | ret_mean=6.7566, ret_std=1.7169 | val_mean=6.9517, val_std=1.4545 | explained_var=0.679428
[GradSplit pre-clip] backbone=0.593814, critic=0.740963
[Loss] pg_loss=-0.094512, entropy_loss=0.000138, value_loss=0.045054
[EpochKL] epoch=0 mean_kl=0.00170 max_kl=0.00335
[EpochKL] epoch=1 mean_kl=0.00279 max_kl=0.00381
[EpochKL] epoch=2 mean_kl=0.00614 max_kl=0.00901
[Time] Env Create Time: 2.8459s |Rollout Collect Time: 3.5192s |Loss & Update :1.8757
[PPODiag] kl_mean=0.0035, kl_p90=0.0072, kl_max=0.0090 | clipfrac_mean=0.027, logratio_std_mean=0.082, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.783, p10=0.777, min=0.773 | pg_loss_mean=0.0013, v_loss_mean=0.1940, ent_mean=0.1283 | gn_bb_mean=1.105, gn_bb_max=1.775 | gn_v_mean=1.614, gn_v_max=3.031

  5%|▍         | 244/5000 [39:30<11:34:04,  8.76s/it]------------------ Training Record ------------------
Epoch: 244/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3110, reward_valid_std=2.2702
[BatchDiag] adv_mean=-0.1588, adv_std=0.9663, adv_abs_mean=0.7309 | ret_mean=6.7075, ret_std=1.7388 | val_mean=6.8664, val_std=1.4493 | explained_var=0.691138
[GradSplit pre-clip] backbone=0.529837, critic=0.617968
[Loss] pg_loss=-0.077236, entropy_loss=0.000138, value_loss=0.044839
[EpochKL] epoch=0 mean_kl=0.00286 max_kl=0.00471
[EpochKL] epoch=1 mean_kl=0.00444 max_kl=0.00642
[EpochKL] epoch=2 mean_kl=0.00579 max_kl=0.01009
[Time] Env Create Time: 2.8656s |Rollout Collect Time: 3.3725s |Loss & Update :1.8041
[PPODiag] kl_mean=0.0044, kl_p90=0.0063, kl_max=0.0101 | clipfrac_mean=0.031, logratio_std_mean=0.093, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.823, p10=0.817, min=0.812 | pg_loss_mean=0.0015, v_loss_mean=0.1953, ent_mean=0.1335 | gn_bb_mean=1.234, gn_bb_max=2.079 | gn_v_mean=1.922, gn_v_max=4.536

  5%|▍         | 245/5000 [39:38<11:16:57,  8.54s/it]------------------ Training Record ------------------
Epoch: 245/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3125, reward_valid_std=2.2714
[BatchDiag] adv_mean=-0.2986, adv_std=0.9453, adv_abs_mean=0.7398 | ret_mean=6.7745, ret_std=1.7002 | val_mean=7.0731, val_std=1.4172 | explained_var=0.690877
[GradSplit pre-clip] backbone=0.550730, critic=1.700316
[Loss] pg_loss=-0.086765, entropy_loss=0.000145, value_loss=0.047125
[EpochKL] epoch=0 mean_kl=0.00356 max_kl=0.00562
[EpochKL] epoch=1 mean_kl=0.00485 max_kl=0.00712
[EpochKL] epoch=2 mean_kl=0.00745 max_kl=0.00844
[Time] Env Create Time: 2.8736s |Rollout Collect Time: 3.3630s |Loss & Update :1.8046
[PPODiag] kl_mean=0.0053, kl_p90=0.0078, kl_max=0.0084 | clipfrac_mean=0.037, logratio_std_mean=0.103, ratio_p95_mean=1.059 | valid_ratio_mb_mean=0.822, p10=0.814, min=0.814 | pg_loss_mean=0.0022, v_loss_mean=0.1915, ent_mean=0.1342 | gn_bb_mean=1.506, gn_bb_max=2.331 | gn_v_mean=1.889, gn_v_max=3.295
[AttnScore] scale=1.0758, C=10.0

  5%|▍         | 246/5000 [39:46<11:04:55,  8.39s/it]------------------ Training Record ------------------
Epoch: 246/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3096, reward_valid_std=2.2714
[BatchDiag] adv_mean=-0.3163, adv_std=0.9756, adv_abs_mean=0.7688 | ret_mean=6.7461, ret_std=1.7162 | val_mean=7.0624, val_std=1.3838 | explained_var=0.676840
[GradSplit pre-clip] backbone=0.813215, critic=2.210046
[Loss] pg_loss=-0.036671, entropy_loss=0.000130, value_loss=0.049127
[EpochKL] epoch=0 mean_kl=0.00584 max_kl=0.01017
[EpochKL] epoch=1 mean_kl=0.00841 max_kl=0.01362
[EpochKL] epoch=2 mean_kl=0.00887 max_kl=0.01622
[Time] Env Create Time: 2.6979s |Rollout Collect Time: 3.5123s |Loss & Update :1.8739
[PPODiag] kl_mean=0.0077, kl_p90=0.0110, kl_max=0.0162 | clipfrac_mean=0.045, logratio_std_mean=0.126, ratio_p95_mean=1.064 | valid_ratio_mb_mean=0.786, p10=0.781, min=0.774 | pg_loss_mean=0.0032, v_loss_mean=0.2008, ent_mean=0.1269 | gn_bb_mean=1.742, gn_bb_max=2.300 | gn_v_mean=1.483, gn_v_max=2.641

  5%|▍         | 247/5000 [39:54<10:57:32,  8.30s/it]------------------ Training Record ------------------
Epoch: 247/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3133, reward_valid_std=2.2714
[BatchDiag] adv_mean=-0.1902, adv_std=0.9659, adv_abs_mean=0.7344 | ret_mean=6.7572, ret_std=1.7204 | val_mean=6.9473, val_std=1.4441 | explained_var=0.684789
[GradSplit pre-clip] backbone=0.482563, critic=1.023442
[Loss] pg_loss=-0.043479, entropy_loss=0.000133, value_loss=0.046414
[EpochKL] epoch=0 mean_kl=0.00333 max_kl=0.00905
[EpochKL] epoch=1 mean_kl=0.00522 max_kl=0.00717
[EpochKL] epoch=2 mean_kl=0.00627 max_kl=0.00785
[Time] Env Create Time: 2.8567s |Rollout Collect Time: 3.5051s |Loss & Update :1.8771
[PPODiag] kl_mean=0.0049, kl_p90=0.0072, kl_max=0.0090 | clipfrac_mean=0.035, logratio_std_mean=0.099, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.785, p10=0.780, min=0.779 | pg_loss_mean=0.0018, v_loss_mean=0.1929, ent_mean=0.1278 | gn_bb_mean=1.314, gn_bb_max=2.161 | gn_v_mean=1.576, gn_v_max=2.818

  5%|▍         | 248/5000 [40:02<10:55:57,  8.28s/it]------------------ Training Record ------------------
Epoch: 248/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3106, reward_valid_std=2.2673
[BatchDiag] adv_mean=-0.2201, adv_std=0.9544, adv_abs_mean=0.7285 | ret_mean=6.7398, ret_std=1.7158 | val_mean=6.9599, val_std=1.4532 | explained_var=0.690585
[GradSplit pre-clip] backbone=0.398381, critic=1.035735
[Loss] pg_loss=-0.098233, entropy_loss=0.000123, value_loss=0.036701
[EpochKL] epoch=0 mean_kl=0.00416 max_kl=0.00813
[EpochKL] epoch=1 mean_kl=0.00705 max_kl=0.01203
[EpochKL] epoch=2 mean_kl=0.00652 max_kl=0.00979
[Time] Env Create Time: 2.8486s |Rollout Collect Time: 3.5027s |Loss & Update :1.8792
[PPODiag] kl_mean=0.0059, kl_p90=0.0093, kl_max=0.0120 | clipfrac_mean=0.039, logratio_std_mean=0.110, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.787, p10=0.783, min=0.779 | pg_loss_mean=0.0024, v_loss_mean=0.1918, ent_mean=0.1265 | gn_bb_mean=1.358, gn_bb_max=2.155 | gn_v_mean=1.955, gn_v_max=3.514

  5%|▍         | 249/5000 [40:11<10:54:35,  8.27s/it]------------------ Training Record ------------------
Epoch: 249/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.821, reward_valid_mean=0.3137, reward_valid_std=2.2746
[BatchDiag] adv_mean=-0.1888, adv_std=0.9504, adv_abs_mean=0.7271 | ret_mean=6.7500, ret_std=1.7160 | val_mean=6.9388, val_std=1.4199 | explained_var=0.693238
[GradSplit pre-clip] backbone=0.612451, critic=1.175442
[Loss] pg_loss=-0.034912, entropy_loss=0.000147, value_loss=0.049604
[EpochKL] epoch=0 mean_kl=0.00275 max_kl=0.00510
[EpochKL] epoch=1 mean_kl=0.00442 max_kl=0.00635
[EpochKL] epoch=2 mean_kl=0.00432 max_kl=0.00625
[Time] Env Create Time: 2.6904s |Rollout Collect Time: 3.3502s |Loss & Update :1.8096
[PPODiag] kl_mean=0.0038, kl_p90=0.0059, kl_max=0.0063 | clipfrac_mean=0.029, logratio_std_mean=0.088, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.821, p10=0.815, min=0.810 | pg_loss_mean=0.0010, v_loss_mean=0.1889, ent_mean=0.1338 | gn_bb_mean=1.117, gn_bb_max=1.629 | gn_v_mean=1.558, gn_v_max=2.955

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.809, Step: 21, Avg Done Step: 18.34, #CS visited: 0.43
D->C12->C1->C15->C14->C3->C5->C2->D->C13->C4->C7->C11->C10->C9->C8->D->C6->D
Eval cost : 4.2025s
-----------------------------
  5%|▌         | 250/5000 [40:23<12:25:12,  9.41s/it]------------------ Training Record ------------------
Epoch: 250/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3140, reward_valid_std=2.2725
[BatchDiag] adv_mean=-0.2372, adv_std=0.9478, adv_abs_mean=0.7291 | ret_mean=6.7866, ret_std=1.7013 | val_mean=7.0238, val_std=1.4057 | explained_var=0.689646
[GradSplit pre-clip] backbone=0.593432, critic=1.215870
[Loss] pg_loss=-0.070451, entropy_loss=0.000146, value_loss=0.044330
[EpochKL] epoch=0 mean_kl=0.00286 max_kl=0.00478
[EpochKL] epoch=1 mean_kl=0.00481 max_kl=0.00547
[EpochKL] epoch=2 mean_kl=0.00536 max_kl=0.00665
[Time] Env Create Time: 2.6933s |Rollout Collect Time: 3.3503s |Loss & Update :1.8112
[PPODiag] kl_mean=0.0043, kl_p90=0.0060, kl_max=0.0066 | clipfrac_mean=0.033, logratio_std_mean=0.093, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.822, p10=0.816, min=0.815 | pg_loss_mean=0.0017, v_loss_mean=0.1881, ent_mean=0.1331 | gn_bb_mean=1.414, gn_bb_max=2.083 | gn_v_mean=1.447, gn_v_max=2.802
[AttnScore] scale=1.0777, C=10.0

  5%|▌         | 251/5000 [40:31<11:48:03,  8.95s/it]------------------ Training Record ------------------
Epoch: 251/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3107, reward_valid_std=2.2740
[BatchDiag] adv_mean=-0.2468, adv_std=0.9516, adv_abs_mean=0.7412 | ret_mean=6.7279, ret_std=1.7165 | val_mean=6.9747, val_std=1.3789 | explained_var=0.692658
[GradSplit pre-clip] backbone=0.525479, critic=1.652841
[Loss] pg_loss=-0.028518, entropy_loss=0.000128, value_loss=0.049621
[EpochKL] epoch=0 mean_kl=0.00273 max_kl=0.00416
[EpochKL] epoch=1 mean_kl=0.00631 max_kl=0.01179
[EpochKL] epoch=2 mean_kl=0.00663 max_kl=0.00875
[Time] Env Create Time: 2.8573s |Rollout Collect Time: 3.5100s |Loss & Update :1.8756
[PPODiag] kl_mean=0.0052, kl_p90=0.0081, kl_max=0.0118 | clipfrac_mean=0.036, logratio_std_mean=0.101, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.785, p10=0.781, min=0.776 | pg_loss_mean=0.0019, v_loss_mean=0.1908, ent_mean=0.1263 | gn_bb_mean=1.431, gn_bb_max=2.778 | gn_v_mean=1.551, gn_v_max=2.568

  5%|▌         | 252/5000 [40:39<11:31:14,  8.74s/it]------------------ Training Record ------------------
Epoch: 252/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.820, reward_valid_mean=0.3170, reward_valid_std=2.2789
[BatchDiag] adv_mean=-0.1030, adv_std=0.9534, adv_abs_mean=0.7238 | ret_mean=6.7486, ret_std=1.7348 | val_mean=6.8516, val_std=1.4076 | explained_var=0.698002
[GradSplit pre-clip] backbone=0.498133, critic=0.670958
[Loss] pg_loss=-0.046458, entropy_loss=0.000143, value_loss=0.045346
[EpochKL] epoch=0 mean_kl=0.00177 max_kl=0.00272
[EpochKL] epoch=1 mean_kl=0.00375 max_kl=0.00586
[EpochKL] epoch=2 mean_kl=0.00548 max_kl=0.00728
[Time] Env Create Time: 2.8499s |Rollout Collect Time: 3.3548s |Loss & Update :1.8027
[PPODiag] kl_mean=0.0037, kl_p90=0.0058, kl_max=0.0073 | clipfrac_mean=0.029, logratio_std_mean=0.084, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.820, p10=0.813, min=0.811 | pg_loss_mean=0.0011, v_loss_mean=0.1862, ent_mean=0.1320 | gn_bb_mean=1.159, gn_bb_max=1.562 | gn_v_mean=1.232, gn_v_max=2.996

  5%|▌         | 253/5000 [40:47<11:13:49,  8.52s/it]------------------ Training Record ------------------
Epoch: 253/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3127, reward_valid_std=2.2762
[BatchDiag] adv_mean=-0.1458, adv_std=0.9474, adv_abs_mean=0.7267 | ret_mean=6.7375, ret_std=1.7385 | val_mean=6.8834, val_std=1.4251 | explained_var=0.703031
[GradSplit pre-clip] backbone=0.486175, critic=0.803743
[Loss] pg_loss=-0.060796, entropy_loss=0.000138, value_loss=0.046703
[EpochKL] epoch=0 mean_kl=0.00369 max_kl=0.00723
[EpochKL] epoch=1 mean_kl=0.00510 max_kl=0.00779
[EpochKL] epoch=2 mean_kl=0.00719 max_kl=0.01147
[Time] Env Create Time: 2.6916s |Rollout Collect Time: 3.3703s |Loss & Update :1.8038
[PPODiag] kl_mean=0.0053, kl_p90=0.0080, kl_max=0.0115 | clipfrac_mean=0.035, logratio_std_mean=0.105, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.823, p10=0.818, min=0.814 | pg_loss_mean=0.0021, v_loss_mean=0.1850, ent_mean=0.1308 | gn_bb_mean=1.494, gn_bb_max=2.087 | gn_v_mean=1.054, gn_v_max=2.746

  5%|▌         | 254/5000 [40:55<10:58:14,  8.32s/it]------------------ Training Record ------------------
Epoch: 254/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.821, reward_valid_mean=0.3165, reward_valid_std=2.2753
[BatchDiag] adv_mean=-0.1524, adv_std=0.9471, adv_abs_mean=0.7183 | ret_mean=6.7639, ret_std=1.7136 | val_mean=6.9163, val_std=1.4394 | explained_var=0.694515
[GradSplit pre-clip] backbone=0.699777, critic=1.174883
[Loss] pg_loss=-0.004839, entropy_loss=0.000137, value_loss=0.045235
[EpochKL] epoch=0 mean_kl=0.00186 max_kl=0.00277
[EpochKL] epoch=1 mean_kl=0.00344 max_kl=0.00692
[EpochKL] epoch=2 mean_kl=0.00759 max_kl=0.01066
[Time] Env Create Time: 2.8320s |Rollout Collect Time: 3.3485s |Loss & Update :1.7955
[PPODiag] kl_mean=0.0043, kl_p90=0.0090, kl_max=0.0107 | clipfrac_mean=0.030, logratio_std_mean=0.090, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.821, p10=0.815, min=0.812 | pg_loss_mean=0.0016, v_loss_mean=0.1847, ent_mean=0.1325 | gn_bb_mean=1.348, gn_bb_max=2.226 | gn_v_mean=1.223, gn_v_max=3.117

  5%|▌         | 255/5000 [41:03<10:49:54,  8.22s/it]------------------ Training Record ------------------
Epoch: 255/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.751, reward_valid_mean=0.3159, reward_valid_std=2.2721
[BatchDiag] adv_mean=-0.2175, adv_std=0.9393, adv_abs_mean=0.7198 | ret_mean=6.7877, ret_std=1.7053 | val_mean=7.0053, val_std=1.4214 | explained_var=0.696613
[GradSplit pre-clip] backbone=0.586883, critic=1.337812
[Loss] pg_loss=-0.069192, entropy_loss=0.000133, value_loss=0.042680
[EpochKL] epoch=0 mean_kl=0.00432 max_kl=0.00673
[EpochKL] epoch=1 mean_kl=0.00654 max_kl=0.01007
[EpochKL] epoch=2 mean_kl=0.00650 max_kl=0.00857
[Time] Env Create Time: 2.8626s |Rollout Collect Time: 3.6609s |Loss & Update :1.9418
[PPODiag] kl_mean=0.0058, kl_p90=0.0084, kl_max=0.0101 | clipfrac_mean=0.038, logratio_std_mean=0.110, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.751, p10=0.746, min=0.741 | pg_loss_mean=0.0024, v_loss_mean=0.1878, ent_mean=0.1200 | gn_bb_mean=1.545, gn_bb_max=2.352 | gn_v_mean=1.904, gn_v_max=3.075
[AttnScore] scale=1.0799, C=10.0

  5%|▌         | 256/5000 [41:11<10:55:39,  8.29s/it]------------------ Training Record ------------------
Epoch: 256/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.784, reward_valid_mean=0.3167, reward_valid_std=2.2741
[BatchDiag] adv_mean=-0.3052, adv_std=0.9367, adv_abs_mean=0.7396 | ret_mean=6.8349, ret_std=1.6763 | val_mean=7.1401, val_std=1.3735 | explained_var=0.687716
[GradSplit pre-clip] backbone=0.502505, critic=1.917913
[Loss] pg_loss=-0.120639, entropy_loss=0.000132, value_loss=0.041630
[EpochKL] epoch=0 mean_kl=0.00591 max_kl=0.01199
[EarlyStop] epoch=1 mean_kl=0.01023 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01023 max_kl=0.01383
[Time] Env Create Time: 2.8777s |Rollout Collect Time: 3.5040s |Loss & Update :1.2671
[PPODiag] kl_mean=0.0081, kl_p90=0.0121, kl_max=0.0138 | clipfrac_mean=0.044, logratio_std_mean=0.127, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.784, p10=0.778, min=0.776 | pg_loss_mean=0.0035, v_loss_mean=0.1902, ent_mean=0.1237 | gn_bb_mean=1.703, gn_bb_max=2.563 | gn_v_mean=1.851, gn_v_max=3.399

  5%|▌         | 257/5000 [41:19<10:40:15,  8.10s/it]------------------ Training Record ------------------
Epoch: 257/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=39, valid_ratio=0.444, reward_valid_mean=0.3128, reward_valid_std=2.2686
[BatchDiag] adv_mean=-0.2064, adv_std=0.9548, adv_abs_mean=0.7303 | ret_mean=6.7507, ret_std=1.7267 | val_mean=6.9571, val_std=1.3835 | explained_var=0.694245
[GradSplit pre-clip] backbone=0.713010, critic=0.793377
[Loss] pg_loss=-0.167392, entropy_loss=0.000078, value_loss=0.039688
[EpochKL] epoch=0 mean_kl=0.00454 max_kl=0.00834
[EpochKL] epoch=1 mean_kl=0.00559 max_kl=0.00840
[EpochKL] epoch=2 mean_kl=0.00676 max_kl=0.00914
[Time] Env Create Time: 2.7044s |Rollout Collect Time: 6.0619s |Loss & Update :3.1332
[PPODiag] kl_mean=0.0056, kl_p90=0.0084, kl_max=0.0091 | clipfrac_mean=0.038, logratio_std_mean=0.108, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.444, p10=0.440, min=0.439 | pg_loss_mean=0.0023, v_loss_mean=0.1906, ent_mean=0.0725 | gn_bb_mean=1.487, gn_bb_max=2.025 | gn_v_mean=1.767, gn_v_max=3.683

  5%|▌         | 258/5000 [41:31<12:10:14,  9.24s/it]------------------ Training Record ------------------
Epoch: 258/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3160, reward_valid_std=2.2703
[BatchDiag] adv_mean=-0.2269, adv_std=0.9298, adv_abs_mean=0.7177 | ret_mean=6.7894, ret_std=1.7031 | val_mean=7.0164, val_std=1.3935 | explained_var=0.701965
[GradSplit pre-clip] backbone=0.467170, critic=1.351816
[Loss] pg_loss=-0.076342, entropy_loss=0.000146, value_loss=0.039677
[EpochKL] epoch=0 mean_kl=0.00341 max_kl=0.00736
[EpochKL] epoch=1 mean_kl=0.00615 max_kl=0.00810
[EpochKL] epoch=2 mean_kl=0.00666 max_kl=0.01030
[Time] Env Create Time: 2.8449s |Rollout Collect Time: 3.3686s |Loss & Update :1.8166
[PPODiag] kl_mean=0.0054, kl_p90=0.0077, kl_max=0.0103 | clipfrac_mean=0.037, logratio_std_mean=0.104, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.822, p10=0.818, min=0.816 | pg_loss_mean=0.0021, v_loss_mean=0.1833, ent_mean=0.1321 | gn_bb_mean=1.442, gn_bb_max=2.085 | gn_v_mean=1.469, gn_v_max=3.439

  5%|▌         | 259/5000 [41:39<11:41:25,  8.88s/it]------------------ Training Record ------------------
Epoch: 259/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3151, reward_valid_std=2.2702
[BatchDiag] adv_mean=-0.2127, adv_std=0.9271, adv_abs_mean=0.7117 | ret_mean=6.7930, ret_std=1.6978 | val_mean=7.0057, val_std=1.4317 | explained_var=0.701802
[GradSplit pre-clip] backbone=0.452040, critic=0.621620
[Loss] pg_loss=-0.175584, entropy_loss=0.000138, value_loss=0.041067
[EpochKL] epoch=0 mean_kl=0.00327 max_kl=0.00440
[EpochKL] epoch=1 mean_kl=0.00577 max_kl=0.00768
[EpochKL] epoch=2 mean_kl=0.00695 max_kl=0.00892
[Time] Env Create Time: 2.8646s |Rollout Collect Time: 3.3560s |Loss & Update :1.7998
[PPODiag] kl_mean=0.0053, kl_p90=0.0075, kl_max=0.0089 | clipfrac_mean=0.036, logratio_std_mean=0.104, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.823, p10=0.820, min=0.812 | pg_loss_mean=0.0018, v_loss_mean=0.1828, ent_mean=0.1315 | gn_bb_mean=1.318, gn_bb_max=2.217 | gn_v_mean=1.617, gn_v_max=3.017

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.848, Step: 21, Avg Done Step: 18.40, #CS visited: 0.40
D->C12->C1->C15->C14->C3->C5->C2->D->C13->C4->C7->C11->C10->C9->C8->D->C6->D
Eval cost : 4.0431s
-----------------------------
  5%|▌         | 260/5000 [41:51<12:57:38,  9.84s/it]------------------ Training Record ------------------
Epoch: 260/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3126, reward_valid_std=2.2692
[BatchDiag] adv_mean=-0.1486, adv_std=0.9489, adv_abs_mean=0.7210 | ret_mean=6.7584, ret_std=1.7163 | val_mean=6.9070, val_std=1.4831 | explained_var=0.694318
[GradSplit pre-clip] backbone=0.656608, critic=0.621398
[Loss] pg_loss=-0.090794, entropy_loss=0.000124, value_loss=0.042009
[EpochKL] epoch=0 mean_kl=0.00264 max_kl=0.00446
[EpochKL] epoch=1 mean_kl=0.00430 max_kl=0.00543
[EpochKL] epoch=2 mean_kl=0.00511 max_kl=0.00754
[Time] Env Create Time: 2.8650s |Rollout Collect Time: 3.5130s |Loss & Update :1.8732
[PPODiag] kl_mean=0.0040, kl_p90=0.0060, kl_max=0.0075 | clipfrac_mean=0.031, logratio_std_mean=0.089, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.788, p10=0.781, min=0.780 | pg_loss_mean=0.0011, v_loss_mean=0.1833, ent_mean=0.1212 | gn_bb_mean=1.324, gn_bb_max=2.137 | gn_v_mean=0.901, gn_v_max=1.465
[AttnScore] scale=1.0817, C=10.0

  5%|▌         | 261/5000 [41:59<12:19:45,  9.37s/it]------------------ Training Record ------------------
Epoch: 261/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.784, reward_valid_mean=0.3167, reward_valid_std=2.2757
[BatchDiag] adv_mean=-0.1017, adv_std=0.9440, adv_abs_mean=0.7094 | ret_mean=6.7693, ret_std=1.7225 | val_mean=6.8711, val_std=1.4856 | explained_var=0.699624
[GradSplit pre-clip] backbone=0.634748, critic=0.351964
[Loss] pg_loss=-0.049252, entropy_loss=0.000120, value_loss=0.043548
[EpochKL] epoch=0 mean_kl=0.00290 max_kl=0.00619
[EpochKL] epoch=1 mean_kl=0.00929 max_kl=0.01267
[EpochKL] epoch=2 mean_kl=0.00809 max_kl=0.01169
[Time] Env Create Time: 2.7025s |Rollout Collect Time: 3.5142s |Loss & Update :1.8732
[PPODiag] kl_mean=0.0068, kl_p90=0.0113, kl_max=0.0127 | clipfrac_mean=0.038, logratio_std_mean=0.116, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.784, p10=0.778, min=0.775 | pg_loss_mean=0.0026, v_loss_mean=0.1812, ent_mean=0.1169 | gn_bb_mean=1.586, gn_bb_max=2.780 | gn_v_mean=0.808, gn_v_max=1.744

  5%|▌         | 262/5000 [42:07<11:49:22,  8.98s/it]------------------ Training Record ------------------
Epoch: 262/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3120, reward_valid_std=2.2718
[BatchDiag] adv_mean=-0.1304, adv_std=0.9291, adv_abs_mean=0.7021 | ret_mean=6.7529, ret_std=1.7361 | val_mean=6.8833, val_std=1.4909 | explained_var=0.713629
[GradSplit pre-clip] backbone=0.585348, critic=0.311822
[Loss] pg_loss=-0.103205, entropy_loss=0.000134, value_loss=0.044123
[EpochKL] epoch=0 mean_kl=0.00203 max_kl=0.00272
[EpochKL] epoch=1 mean_kl=0.00503 max_kl=0.00619
[EpochKL] epoch=2 mean_kl=0.00701 max_kl=0.00955
[Time] Env Create Time: 2.8390s |Rollout Collect Time: 3.3554s |Loss & Update :1.8024
[PPODiag] kl_mean=0.0047, kl_p90=0.0079, kl_max=0.0095 | clipfrac_mean=0.032, logratio_std_mean=0.096, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.825, p10=0.821, min=0.816 | pg_loss_mean=0.0018, v_loss_mean=0.1815, ent_mean=0.1250 | gn_bb_mean=1.323, gn_bb_max=1.938 | gn_v_mean=1.450, gn_v_max=3.913

  5%|▌         | 263/5000 [42:15<11:25:52,  8.69s/it]------------------ Training Record ------------------
Epoch: 263/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.751, reward_valid_mean=0.3146, reward_valid_std=2.2760
[BatchDiag] adv_mean=-0.1286, adv_std=0.9456, adv_abs_mean=0.7105 | ret_mean=6.7753, ret_std=1.7260 | val_mean=6.9039, val_std=1.4959 | explained_var=0.699837
[GradSplit pre-clip] backbone=0.453431, critic=0.739262
[Loss] pg_loss=-0.166400, entropy_loss=0.000115, value_loss=0.039294
[EpochKL] epoch=0 mean_kl=0.00414 max_kl=0.00971
[EpochKL] epoch=1 mean_kl=0.00578 max_kl=0.00888
[EarlyStop] epoch=2 mean_kl=0.01104 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01104 max_kl=0.01469
[Time] Env Create Time: 2.8630s |Rollout Collect Time: 3.6494s |Loss & Update :1.9446
[PPODiag] kl_mean=0.0070, kl_p90=0.0133, kl_max=0.0147 | clipfrac_mean=0.038, logratio_std_mean=0.118, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.751, p10=0.745, min=0.742 | pg_loss_mean=0.0027, v_loss_mean=0.1869, ent_mean=0.1149 | gn_bb_mean=1.372, gn_bb_max=2.026 | gn_v_mean=1.838, gn_v_max=4.344

  5%|▌         | 264/5000 [42:24<11:20:16,  8.62s/it]------------------ Training Record ------------------
Epoch: 264/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3143, reward_valid_std=2.2729
[BatchDiag] adv_mean=-0.1712, adv_std=0.9179, adv_abs_mean=0.7017 | ret_mean=6.7787, ret_std=1.7075 | val_mean=6.9499, val_std=1.4638 | explained_var=0.710989
[GradSplit pre-clip] backbone=0.467701, critic=1.413113
[Loss] pg_loss=-0.015195, entropy_loss=0.000129, value_loss=0.044193
[EpochKL] epoch=0 mean_kl=0.00634 max_kl=0.00903
[EpochKL] epoch=1 mean_kl=0.00948 max_kl=0.01229
[EarlyStop] epoch=2 mean_kl=0.01061 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01061 max_kl=0.01454
[Time] Env Create Time: 2.7000s |Rollout Collect Time: 3.3504s |Loss & Update :1.8053
[PPODiag] kl_mean=0.0088, kl_p90=0.0131, kl_max=0.0145 | clipfrac_mean=0.045, logratio_std_mean=0.139, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.822, p10=0.817, min=0.813 | pg_loss_mean=0.0034, v_loss_mean=0.1814, ent_mean=0.1222 | gn_bb_mean=1.599, gn_bb_max=2.181 | gn_v_mean=1.897, gn_v_max=3.287

  5%|▌         | 265/5000 [42:32<11:02:05,  8.39s/it]------------------ Training Record ------------------
Epoch: 265/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3078, reward_valid_std=2.2682
[BatchDiag] adv_mean=-0.0853, adv_std=0.9534, adv_abs_mean=0.7203 | ret_mean=6.7012, ret_std=1.7607 | val_mean=6.7865, val_std=1.4934 | explained_var=0.706772
[GradSplit pre-clip] backbone=0.523652, critic=0.439708
[Loss] pg_loss=-0.055476, entropy_loss=0.000128, value_loss=0.043095
[EpochKL] epoch=0 mean_kl=0.00410 max_kl=0.00839
[EpochKL] epoch=1 mean_kl=0.00752 max_kl=0.01191
[EpochKL] epoch=2 mean_kl=0.00964 max_kl=0.01237
[Time] Env Create Time: 2.8576s |Rollout Collect Time: 3.5172s |Loss & Update :1.8751
[PPODiag] kl_mean=0.0071, kl_p90=0.0105, kl_max=0.0124 | clipfrac_mean=0.041, logratio_std_mean=0.122, ratio_p95_mean=1.060 | valid_ratio_mb_mean=0.789, p10=0.784, min=0.780 | pg_loss_mean=0.0025, v_loss_mean=0.1877, ent_mean=0.1230 | gn_bb_mean=1.515, gn_bb_max=2.112 | gn_v_mean=1.011, gn_v_max=2.615
[AttnScore] scale=1.0836, C=10.0

  5%|▌         | 266/5000 [42:40<10:58:39,  8.35s/it]------------------ Training Record ------------------
Epoch: 266/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3090, reward_valid_std=2.2673
[BatchDiag] adv_mean=-0.1777, adv_std=0.9441, adv_abs_mean=0.7250 | ret_mean=6.7328, ret_std=1.7337 | val_mean=6.9105, val_std=1.4364 | explained_var=0.703431
[GradSplit pre-clip] backbone=0.499078, critic=0.548925
[Loss] pg_loss=-0.091550, entropy_loss=0.000124, value_loss=0.043899
[EpochKL] epoch=0 mean_kl=0.00363 max_kl=0.00711
[EpochKL] epoch=1 mean_kl=0.00701 max_kl=0.01044
[EpochKL] epoch=2 mean_kl=0.00745 max_kl=0.01071
[Time] Env Create Time: 2.8387s |Rollout Collect Time: 3.5001s |Loss & Update :1.8730
[PPODiag] kl_mean=0.0060, kl_p90=0.0094, kl_max=0.0107 | clipfrac_mean=0.037, logratio_std_mean=0.112, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.782 | pg_loss_mean=0.0023, v_loss_mean=0.1853, ent_mean=0.1233 | gn_bb_mean=1.464, gn_bb_max=2.121 | gn_v_mean=1.051, gn_v_max=2.280

  5%|▌         | 267/5000 [42:48<10:55:18,  8.31s/it]------------------ Training Record ------------------
Epoch: 267/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3104, reward_valid_std=2.2681
[BatchDiag] adv_mean=-0.2123, adv_std=0.9411, adv_abs_mean=0.7293 | ret_mean=6.7333, ret_std=1.7253 | val_mean=6.9456, val_std=1.4017 | explained_var=0.702453
[GradSplit pre-clip] backbone=0.436398, critic=0.908281
[Loss] pg_loss=-0.155511, entropy_loss=0.000130, value_loss=0.040228
[EpochKL] epoch=0 mean_kl=0.00391 max_kl=0.00810
[EpochKL] epoch=1 mean_kl=0.00615 max_kl=0.00927
[EpochKL] epoch=2 mean_kl=0.00741 max_kl=0.01070
[Time] Env Create Time: 2.8510s |Rollout Collect Time: 3.3517s |Loss & Update :1.8030
[PPODiag] kl_mean=0.0058, kl_p90=0.0091, kl_max=0.0107 | clipfrac_mean=0.037, logratio_std_mean=0.108, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.825, p10=0.819, min=0.812 | pg_loss_mean=0.0022, v_loss_mean=0.1874, ent_mean=0.1262 | gn_bb_mean=1.511, gn_bb_max=2.619 | gn_v_mean=1.631, gn_v_max=3.215

  5%|▌         | 268/5000 [42:56<10:48:02,  8.22s/it]------------------ Training Record ------------------
Epoch: 268/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3127, reward_valid_std=2.2701
[BatchDiag] adv_mean=-0.1819, adv_std=0.9626, adv_abs_mean=0.7287 | ret_mean=6.7645, ret_std=1.7343 | val_mean=6.9463, val_std=1.4254 | explained_var=0.691933
[GradSplit pre-clip] backbone=0.564667, critic=0.880399
[Loss] pg_loss=-0.056993, entropy_loss=0.000129, value_loss=0.044215
[EpochKL] epoch=0 mean_kl=0.00297 max_kl=0.00367
[EpochKL] epoch=1 mean_kl=0.00483 max_kl=0.00572
[EpochKL] epoch=2 mean_kl=0.00596 max_kl=0.00750
[Time] Env Create Time: 2.6955s |Rollout Collect Time: 3.5008s |Loss & Update :1.8732
[PPODiag] kl_mean=0.0046, kl_p90=0.0064, kl_max=0.0075 | clipfrac_mean=0.032, logratio_std_mean=0.097, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.788, p10=0.784, min=0.781 | pg_loss_mean=0.0017, v_loss_mean=0.1901, ent_mean=0.1229 | gn_bb_mean=1.173, gn_bb_max=1.646 | gn_v_mean=1.353, gn_v_max=2.679

  5%|▌         | 269/5000 [43:04<10:44:25,  8.17s/it]------------------ Training Record ------------------
Epoch: 269/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3143, reward_valid_std=2.2685
[BatchDiag] adv_mean=-0.0927, adv_std=0.9340, adv_abs_mean=0.7063 | ret_mean=6.7396, ret_std=1.7378 | val_mean=6.8322, val_std=1.4652 | explained_var=0.711158
[GradSplit pre-clip] backbone=0.518631, critic=0.493623
[Loss] pg_loss=-0.028991, entropy_loss=0.000122, value_loss=0.043608
[EpochKL] epoch=0 mean_kl=0.00331 max_kl=0.00513
[EpochKL] epoch=1 mean_kl=0.00465 max_kl=0.00649
[EpochKL] epoch=2 mean_kl=0.00602 max_kl=0.00777
[Time] Env Create Time: 2.8456s |Rollout Collect Time: 3.5196s |Loss & Update :1.8794
[PPODiag] kl_mean=0.0047, kl_p90=0.0067, kl_max=0.0078 | clipfrac_mean=0.033, logratio_std_mean=0.097, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.786, p10=0.782, min=0.778 | pg_loss_mean=0.0017, v_loss_mean=0.1806, ent_mean=0.1214 | gn_bb_mean=1.208, gn_bb_max=1.813 | gn_v_mean=1.116, gn_v_max=2.716

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.825, Step: 20, Avg Done Step: 18.34, #CS visited: 0.42
D->C12->C1->C15->C14->C3->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->D
Eval cost : 3.9266s
-----------------------------
  5%|▌         | 270/5000 [43:16<12:19:35,  9.38s/it]------------------ Training Record ------------------
Epoch: 270/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3099, reward_valid_std=2.2675
[BatchDiag] adv_mean=-0.1458, adv_std=0.9489, adv_abs_mean=0.7214 | ret_mean=6.7240, ret_std=1.7501 | val_mean=6.8698, val_std=1.4705 | explained_var=0.706035
[GradSplit pre-clip] backbone=0.670225, critic=0.447236
[Loss] pg_loss=-0.092816, entropy_loss=0.000130, value_loss=0.043147
[EpochKL] epoch=0 mean_kl=0.00382 max_kl=0.00684
[EpochKL] epoch=1 mean_kl=0.00636 max_kl=0.00763
[EpochKL] epoch=2 mean_kl=0.00802 max_kl=0.01238
[Time] Env Create Time: 2.8440s |Rollout Collect Time: 3.3439s |Loss & Update :1.7946
[PPODiag] kl_mean=0.0061, kl_p90=0.0083, kl_max=0.0124 | clipfrac_mean=0.037, logratio_std_mean=0.110, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.825, p10=0.821, min=0.815 | pg_loss_mean=0.0026, v_loss_mean=0.1875, ent_mean=0.1260 | gn_bb_mean=1.508, gn_bb_max=2.018 | gn_v_mean=1.352, gn_v_max=2.596
[AttnScore] scale=1.0853, C=10.0

  5%|▌         | 271/5000 [43:24<11:46:22,  8.96s/it]------------------ Training Record ------------------
Epoch: 271/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3094, reward_valid_std=2.2667
[BatchDiag] adv_mean=-0.1904, adv_std=0.9323, adv_abs_mean=0.7056 | ret_mean=6.7424, ret_std=1.7378 | val_mean=6.9328, val_std=1.4849 | explained_var=0.712186
[GradSplit pre-clip] backbone=0.430557, critic=1.216770
[Loss] pg_loss=-0.014230, entropy_loss=0.000124, value_loss=0.045275
[EpochKL] epoch=0 mean_kl=0.00330 max_kl=0.00458
[EpochKL] epoch=1 mean_kl=0.00503 max_kl=0.00850
[EpochKL] epoch=2 mean_kl=0.00658 max_kl=0.00797
[Time] Env Create Time: 2.8475s |Rollout Collect Time: 3.3699s |Loss & Update :1.7981
[PPODiag] kl_mean=0.0050, kl_p90=0.0074, kl_max=0.0085 | clipfrac_mean=0.033, logratio_std_mean=0.100, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.826, p10=0.824, min=0.820 | pg_loss_mean=0.0022, v_loss_mean=0.1823, ent_mean=0.1256 | gn_bb_mean=1.315, gn_bb_max=2.165 | gn_v_mean=1.552, gn_v_max=3.733

  5%|▌         | 272/5000 [43:32<11:23:51,  8.68s/it]------------------ Training Record ------------------
Epoch: 272/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3148, reward_valid_std=2.2706
[BatchDiag] adv_mean=-0.2363, adv_std=0.9289, adv_abs_mean=0.7142 | ret_mean=6.7974, ret_std=1.7058 | val_mean=7.0338, val_std=1.4526 | explained_var=0.703447
[GradSplit pre-clip] backbone=0.474413, critic=1.291394
[Loss] pg_loss=-0.097684, entropy_loss=0.000128, value_loss=0.041120
[EpochKL] epoch=0 mean_kl=0.00339 max_kl=0.00498
[EpochKL] epoch=1 mean_kl=0.00736 max_kl=0.01125
[EpochKL] epoch=2 mean_kl=0.00975 max_kl=0.01275
[Time] Env Create Time: 2.8680s |Rollout Collect Time: 3.5078s |Loss & Update :1.8852
[PPODiag] kl_mean=0.0068, kl_p90=0.0112, kl_max=0.0127 | clipfrac_mean=0.038, logratio_std_mean=0.118, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.785, p10=0.781, min=0.777 | pg_loss_mean=0.0029, v_loss_mean=0.1869, ent_mean=0.1193 | gn_bb_mean=1.554, gn_bb_max=2.308 | gn_v_mean=2.248, gn_v_max=4.300

  5%|▌         | 273/5000 [43:41<11:13:51,  8.55s/it]------------------ Training Record ------------------
Epoch: 273/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.753, reward_valid_mean=0.3114, reward_valid_std=2.2691
[BatchDiag] adv_mean=-0.2463, adv_std=0.9383, adv_abs_mean=0.7192 | ret_mean=6.7791, ret_std=1.7081 | val_mean=7.0253, val_std=1.4448 | explained_var=0.698242
[GradSplit pre-clip] backbone=0.496791, critic=1.053384
[Loss] pg_loss=-0.109083, entropy_loss=0.000126, value_loss=0.041522
[EpochKL] epoch=0 mean_kl=0.00422 max_kl=0.00724
[EpochKL] epoch=1 mean_kl=0.00444 max_kl=0.00719
[EpochKL] epoch=2 mean_kl=0.00490 max_kl=0.00639
[Time] Env Create Time: 2.7008s |Rollout Collect Time: 3.6745s |Loss & Update :1.9692
[PPODiag] kl_mean=0.0045, kl_p90=0.0066, kl_max=0.0072 | clipfrac_mean=0.032, logratio_std_mean=0.095, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.753, p10=0.749, min=0.747 | pg_loss_mean=0.0015, v_loss_mean=0.1885, ent_mean=0.1159 | gn_bb_mean=1.166, gn_bb_max=1.706 | gn_v_mean=2.071, gn_v_max=4.608

  5%|▌         | 274/5000 [43:49<11:08:47,  8.49s/it]------------------ Training Record ------------------
Epoch: 274/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3111, reward_valid_std=2.2699
[BatchDiag] adv_mean=-0.3100, adv_std=0.9228, adv_abs_mean=0.7218 | ret_mean=6.7939, ret_std=1.6953 | val_mean=7.1039, val_std=1.4216 | explained_var=0.703700
[GradSplit pre-clip] backbone=0.577172, critic=1.692122
[Loss] pg_loss=-0.103149, entropy_loss=0.000131, value_loss=0.040964
[EpochKL] epoch=0 mean_kl=0.00237 max_kl=0.00439
[EpochKL] epoch=1 mean_kl=0.00458 max_kl=0.00578
[EpochKL] epoch=2 mean_kl=0.00550 max_kl=0.00665
[Time] Env Create Time: 2.8544s |Rollout Collect Time: 3.3549s |Loss & Update :1.7983
[PPODiag] kl_mean=0.0042, kl_p90=0.0058, kl_max=0.0067 | clipfrac_mean=0.030, logratio_std_mean=0.091, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.824, p10=0.820, min=0.817 | pg_loss_mean=0.0014, v_loss_mean=0.1898, ent_mean=0.1272 | gn_bb_mean=1.242, gn_bb_max=1.826 | gn_v_mean=2.343, gn_v_max=4.171

  6%|▌         | 275/5000 [43:57<10:57:14,  8.35s/it]------------------ Training Record ------------------
Epoch: 275/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.784, reward_valid_mean=0.3138, reward_valid_std=2.2710
[BatchDiag] adv_mean=-0.3078, adv_std=0.9264, adv_abs_mean=0.7178 | ret_mean=6.8140, ret_std=1.6809 | val_mean=7.1217, val_std=1.4462 | explained_var=0.696260
[GradSplit pre-clip] backbone=0.663109, critic=1.884634
[Loss] pg_loss=-0.077853, entropy_loss=0.000130, value_loss=0.043403
[EpochKL] epoch=0 mean_kl=0.00308 max_kl=0.00488
[EpochKL] epoch=1 mean_kl=0.00667 max_kl=0.01339
[EpochKL] epoch=2 mean_kl=0.00942 max_kl=0.01305
[Time] Env Create Time: 2.8623s |Rollout Collect Time: 3.5169s |Loss & Update :1.8777
[PPODiag] kl_mean=0.0064, kl_p90=0.0126, kl_max=0.0134 | clipfrac_mean=0.037, logratio_std_mean=0.114, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.784, p10=0.778, min=0.774 | pg_loss_mean=0.0023, v_loss_mean=0.1849, ent_mean=0.1230 | gn_bb_mean=1.493, gn_bb_max=2.553 | gn_v_mean=1.960, gn_v_max=3.447
[AttnScore] scale=1.0878, C=10.0

  6%|▌         | 276/5000 [44:05<10:55:00,  8.32s/it]------------------ Training Record ------------------
Epoch: 276/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3075, reward_valid_std=2.2644
[BatchDiag] adv_mean=-0.3298, adv_std=0.9535, adv_abs_mean=0.7377 | ret_mean=6.7521, ret_std=1.7059 | val_mean=7.0818, val_std=1.4369 | explained_var=0.687585
[GradSplit pre-clip] backbone=0.642893, critic=1.361632
[Loss] pg_loss=-0.161909, entropy_loss=0.000128, value_loss=0.042593
[EpochKL] epoch=0 mean_kl=0.00668 max_kl=0.01328
[EpochKL] epoch=1 mean_kl=0.00497 max_kl=0.00812
[EpochKL] epoch=2 mean_kl=0.00663 max_kl=0.00889
[Time] Env Create Time: 2.7007s |Rollout Collect Time: 3.5044s |Loss & Update :1.8756
[PPODiag] kl_mean=0.0061, kl_p90=0.0091, kl_max=0.0133 | clipfrac_mean=0.039, logratio_std_mean=0.111, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.789, p10=0.783, min=0.778 | pg_loss_mean=0.0024, v_loss_mean=0.1979, ent_mean=0.1269 | gn_bb_mean=1.378, gn_bb_max=2.770 | gn_v_mean=2.429, gn_v_max=4.093

  6%|▌         | 277/5000 [44:13<10:49:14,  8.25s/it]------------------ Training Record ------------------
Epoch: 277/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3142, reward_valid_std=2.2697
[BatchDiag] adv_mean=-0.3312, adv_std=0.9324, adv_abs_mean=0.7321 | ret_mean=6.8256, ret_std=1.6801 | val_mean=7.1567, val_std=1.4370 | explained_var=0.691972
[GradSplit pre-clip] backbone=0.720324, critic=1.845395
[Loss] pg_loss=-0.084987, entropy_loss=0.000136, value_loss=0.044159
[EpochKL] epoch=0 mean_kl=0.00394 max_kl=0.00875
[EpochKL] epoch=1 mean_kl=0.00779 max_kl=0.01758
[EpochKL] epoch=2 mean_kl=0.00511 max_kl=0.00651
[Time] Env Create Time: 2.8425s |Rollout Collect Time: 3.5389s |Loss & Update :1.8872
[PPODiag] kl_mean=0.0056, kl_p90=0.0087, kl_max=0.0176 | clipfrac_mean=0.035, logratio_std_mean=0.107, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.786, p10=0.780, min=0.777 | pg_loss_mean=0.0019, v_loss_mean=0.1906, ent_mean=0.1240 | gn_bb_mean=1.305, gn_bb_max=2.040 | gn_v_mean=2.156, gn_v_max=3.909

  6%|▌         | 278/5000 [44:21<10:49:36,  8.25s/it]------------------ Training Record ------------------
Epoch: 278/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3150, reward_valid_std=2.2716
[BatchDiag] adv_mean=-0.3197, adv_std=0.9221, adv_abs_mean=0.7237 | ret_mean=6.8240, ret_std=1.6888 | val_mean=7.1437, val_std=1.4063 | explained_var=0.701850
[GradSplit pre-clip] backbone=0.570284, critic=1.990777
[Loss] pg_loss=-0.054248, entropy_loss=0.000137, value_loss=0.046351
[EpochKL] epoch=0 mean_kl=0.00229 max_kl=0.00487
[EpochKL] epoch=1 mean_kl=0.00507 max_kl=0.00796
[EpochKL] epoch=2 mean_kl=0.00508 max_kl=0.00633
[Time] Env Create Time: 2.8496s |Rollout Collect Time: 3.5021s |Loss & Update :1.8844
[PPODiag] kl_mean=0.0041, kl_p90=0.0061, kl_max=0.0080 | clipfrac_mean=0.030, logratio_std_mean=0.091, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.786, p10=0.783, min=0.780 | pg_loss_mean=0.0016, v_loss_mean=0.1863, ent_mean=0.1238 | gn_bb_mean=1.182, gn_bb_max=1.819 | gn_v_mean=2.092, gn_v_max=3.303

  6%|▌         | 279/5000 [44:30<10:49:03,  8.25s/it]------------------ Training Record ------------------
Epoch: 279/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3150, reward_valid_std=2.2717
[BatchDiag] adv_mean=-0.3018, adv_std=0.9312, adv_abs_mean=0.7283 | ret_mean=6.8146, ret_std=1.6803 | val_mean=7.1165, val_std=1.4009 | explained_var=0.692910
[GradSplit pre-clip] backbone=0.488670, critic=1.873634
[Loss] pg_loss=-0.040960, entropy_loss=0.000140, value_loss=0.047138
[EpochKL] epoch=0 mean_kl=0.00283 max_kl=0.00459
[EpochKL] epoch=1 mean_kl=0.00668 max_kl=0.01013
[EpochKL] epoch=2 mean_kl=0.00738 max_kl=0.01002
[Time] Env Create Time: 2.8648s |Rollout Collect Time: 3.3589s |Loss & Update :1.8103
[PPODiag] kl_mean=0.0056, kl_p90=0.0087, kl_max=0.0101 | clipfrac_mean=0.036, logratio_std_mean=0.107, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.823, p10=0.818, min=0.817 | pg_loss_mean=0.0023, v_loss_mean=0.1891, ent_mean=0.1305 | gn_bb_mean=1.322, gn_bb_max=1.922 | gn_v_mean=2.063, gn_v_max=3.576

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.804, Step: 21, Avg Done Step: 18.37, #CS visited: 0.39
D->C12->C1->C15->C14->C3->C5->C2->C8->D->C13->C4->C7->C11->C10->C9->D->C6->D
Eval cost : 4.0479s
-----------------------------
  6%|▌         | 280/5000 [44:42<12:20:05,  9.41s/it]------------------ Training Record ------------------
Epoch: 280/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51145/51200 = 0.999
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.289, reward_valid_mean=0.3135, reward_valid_std=2.2668
[BatchDiag] adv_mean=-0.2862, adv_std=0.9933, adv_abs_mean=0.7325 | ret_mean=6.7775, ret_std=1.7353 | val_mean=7.0636, val_std=1.3875 | explained_var=0.672348
[GradSplit pre-clip] backbone=0.595298, critic=1.628644
[Loss] pg_loss=-0.077480, entropy_loss=0.000049, value_loss=0.038950
[EpochKL] epoch=0 mean_kl=0.00356 max_kl=0.00622
[EpochKL] epoch=1 mean_kl=0.00654 max_kl=0.02223
[EpochKL] epoch=2 mean_kl=0.00734 max_kl=0.02371
[Time] Env Create Time: 2.6942s |Rollout Collect Time: 9.2059s |Loss & Update :4.6832
[PPODiag] kl_mean=0.0058, kl_p90=0.0081, kl_max=0.0237 | clipfrac_mean=0.032, logratio_std_mean=0.109, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.289, p10=0.286, min=0.285 | pg_loss_mean=0.0006, v_loss_mean=0.1906, ent_mean=0.0458 | gn_bb_mean=1.008, gn_bb_max=1.466 | gn_v_mean=1.643, gn_v_max=3.019
[AttnScore] scale=1.0901, C=10.0

  6%|▌         | 281/5000 [44:58<15:09:15, 11.56s/it]------------------ Training Record ------------------
Epoch: 281/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3180, reward_valid_std=2.2745
[BatchDiag] adv_mean=-0.2589, adv_std=0.9306, adv_abs_mean=0.7205 | ret_mean=6.8255, ret_std=1.6899 | val_mean=7.0844, val_std=1.3945 | explained_var=0.696726
[GradSplit pre-clip] backbone=0.850342, critic=1.480559
[Loss] pg_loss=-0.078030, entropy_loss=0.000134, value_loss=0.039966
[EpochKL] epoch=0 mean_kl=0.00291 max_kl=0.00491
[EpochKL] epoch=1 mean_kl=0.00412 max_kl=0.00606
[EpochKL] epoch=2 mean_kl=0.00415 max_kl=0.00445
[Time] Env Create Time: 2.8558s |Rollout Collect Time: 3.3680s |Loss & Update :1.8017
[PPODiag] kl_mean=0.0037, kl_p90=0.0051, kl_max=0.0061 | clipfrac_mean=0.030, logratio_std_mean=0.086, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.822, p10=0.817, min=0.812 | pg_loss_mean=0.0013, v_loss_mean=0.1844, ent_mean=0.1310 | gn_bb_mean=1.263, gn_bb_max=1.654 | gn_v_mean=1.703, gn_v_max=3.045

  6%|▌         | 282/5000 [45:06<13:45:40, 10.50s/it]------------------ Training Record ------------------
Epoch: 282/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3154, reward_valid_std=2.2714
[BatchDiag] adv_mean=-0.2129, adv_std=0.9214, adv_abs_mean=0.7058 | ret_mean=6.7980, ret_std=1.7037 | val_mean=7.0109, val_std=1.4243 | explained_var=0.707510
[GradSplit pre-clip] backbone=0.613766, critic=0.754280
[Loss] pg_loss=-0.139708, entropy_loss=0.000134, value_loss=0.035415
[EpochKL] epoch=0 mean_kl=0.00196 max_kl=0.00272
[EpochKL] epoch=1 mean_kl=0.00433 max_kl=0.00711
[EpochKL] epoch=2 mean_kl=0.00652 max_kl=0.00809
[Time] Env Create Time: 2.8532s |Rollout Collect Time: 3.3472s |Loss & Update :1.7986
[PPODiag] kl_mean=0.0043, kl_p90=0.0074, kl_max=0.0081 | clipfrac_mean=0.030, logratio_std_mean=0.091, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.825, p10=0.821, min=0.813 | pg_loss_mean=0.0016, v_loss_mean=0.1788, ent_mean=0.1277 | gn_bb_mean=1.285, gn_bb_max=1.784 | gn_v_mean=1.236, gn_v_max=2.521

  6%|▌         | 283/5000 [45:14<12:46:30,  9.75s/it]------------------ Training Record ------------------
Epoch: 283/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3130, reward_valid_std=2.2672
[BatchDiag] adv_mean=-0.1357, adv_std=0.9450, adv_abs_mean=0.7163 | ret_mean=6.7412, ret_std=1.7324 | val_mean=6.8769, val_std=1.4466 | explained_var=0.702415
[GradSplit pre-clip] backbone=0.696271, critic=0.529589
[Loss] pg_loss=-0.126904, entropy_loss=0.000141, value_loss=0.040700
[EpochKL] epoch=0 mean_kl=0.00351 max_kl=0.00515
[EpochKL] epoch=1 mean_kl=0.00592 max_kl=0.00855
[EpochKL] epoch=2 mean_kl=0.00440 max_kl=0.00616
[Time] Env Create Time: 2.8655s |Rollout Collect Time: 3.5063s |Loss & Update :1.8803
[PPODiag] kl_mean=0.0046, kl_p90=0.0067, kl_max=0.0085 | clipfrac_mean=0.033, logratio_std_mean=0.096, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.789, p10=0.784, min=0.780 | pg_loss_mean=0.0016, v_loss_mean=0.1837, ent_mean=0.1261 | gn_bb_mean=1.308, gn_bb_max=1.881 | gn_v_mean=0.916, gn_v_max=1.987

  6%|▌         | 284/5000 [45:23<12:11:02,  9.30s/it]------------------ Training Record ------------------
Epoch: 284/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3163, reward_valid_std=2.2666
[BatchDiag] adv_mean=-0.1338, adv_std=0.9336, adv_abs_mean=0.7109 | ret_mean=6.7471, ret_std=1.7159 | val_mean=6.8809, val_std=1.4210 | explained_var=0.703984
[GradSplit pre-clip] backbone=0.626990, critic=0.484590
[Loss] pg_loss=-0.115757, entropy_loss=0.000133, value_loss=0.041520
[EpochKL] epoch=0 mean_kl=0.00238 max_kl=0.00315
[EpochKL] epoch=1 mean_kl=0.00646 max_kl=0.01023
[EpochKL] epoch=2 mean_kl=0.00637 max_kl=0.00996
[Time] Env Create Time: 2.6988s |Rollout Collect Time: 3.4961s |Loss & Update :1.8694
[PPODiag] kl_mean=0.0051, kl_p90=0.0076, kl_max=0.0102 | clipfrac_mean=0.034, logratio_std_mean=0.101, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.774 | pg_loss_mean=0.0021, v_loss_mean=0.1818, ent_mean=0.1272 | gn_bb_mean=1.516, gn_bb_max=2.447 | gn_v_mean=1.130, gn_v_max=2.760

  6%|▌         | 285/5000 [45:31<11:41:44,  8.93s/it]------------------ Training Record ------------------
Epoch: 285/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3135, reward_valid_std=2.2681
[BatchDiag] adv_mean=-0.1903, adv_std=0.9256, adv_abs_mean=0.7120 | ret_mean=6.7674, ret_std=1.7266 | val_mean=6.9576, val_std=1.4244 | explained_var=0.712591
[GradSplit pre-clip] backbone=0.720206, critic=1.154895
[Loss] pg_loss=-0.067105, entropy_loss=0.000148, value_loss=0.045064
[EpochKL] epoch=0 mean_kl=0.00481 max_kl=0.00982
[EpochKL] epoch=1 mean_kl=0.00766 max_kl=0.01385
[EpochKL] epoch=2 mean_kl=0.00912 max_kl=0.01441
[Time] Env Create Time: 2.8419s |Rollout Collect Time: 3.3383s |Loss & Update :1.8023
[PPODiag] kl_mean=0.0072, kl_p90=0.0126, kl_max=0.0144 | clipfrac_mean=0.043, logratio_std_mean=0.121, ratio_p95_mean=1.066 | valid_ratio_mb_mean=0.826, p10=0.822, min=0.815 | pg_loss_mean=0.0029, v_loss_mean=0.1821, ent_mean=0.1339 | gn_bb_mean=1.613, gn_bb_max=2.330 | gn_v_mean=1.458, gn_v_max=3.753
[AttnScore] scale=1.0925, C=10.0

  6%|▌         | 286/5000 [45:39<11:19:16,  8.65s/it]------------------ Training Record ------------------
Epoch: 286/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3151, reward_valid_std=2.2687
[BatchDiag] adv_mean=-0.1564, adv_std=0.9267, adv_abs_mean=0.7041 | ret_mean=6.7873, ret_std=1.7260 | val_mean=6.9437, val_std=1.4704 | explained_var=0.711753
[GradSplit pre-clip] backbone=0.620332, critic=0.612908
[Loss] pg_loss=-0.069185, entropy_loss=0.000141, value_loss=0.042818
[EpochKL] epoch=0 mean_kl=0.00863 max_kl=0.01589
[EarlyStop] epoch=1 mean_kl=0.01493 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01493 max_kl=0.01969
[Time] Env Create Time: 2.8704s |Rollout Collect Time: 3.3488s |Loss & Update :1.2227
[PPODiag] kl_mean=0.0118, kl_p90=0.0178, kl_max=0.0197 | clipfrac_mean=0.055, logratio_std_mean=0.160, ratio_p95_mean=1.080 | valid_ratio_mb_mean=0.826, p10=0.818, min=0.814 | pg_loss_mean=0.0047, v_loss_mean=0.1800, ent_mean=0.1327 | gn_bb_mean=1.895, gn_bb_max=2.373 | gn_v_mean=1.221, gn_v_max=2.675

  6%|▌         | 287/5000 [45:46<10:50:46,  8.28s/it]------------------ Training Record ------------------
Epoch: 287/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3136, reward_valid_std=2.2658
[BatchDiag] adv_mean=-0.0997, adv_std=0.9275, adv_abs_mean=0.6989 | ret_mean=6.7342, ret_std=1.7355 | val_mean=6.8339, val_std=1.4738 | explained_var=0.714395
[GradSplit pre-clip] backbone=0.756726, critic=0.551239
[Loss] pg_loss=-0.132668, entropy_loss=0.000132, value_loss=0.037651
[EpochKL] epoch=0 mean_kl=0.00342 max_kl=0.00606
[EpochKL] epoch=1 mean_kl=0.00657 max_kl=0.00952
[EpochKL] epoch=2 mean_kl=0.00497 max_kl=0.00596
[Time] Env Create Time: 2.6838s |Rollout Collect Time: 3.5066s |Loss & Update :1.8633
[PPODiag] kl_mean=0.0050, kl_p90=0.0075, kl_max=0.0095 | clipfrac_mean=0.034, logratio_std_mean=0.102, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.789, p10=0.784, min=0.778 | pg_loss_mean=0.0018, v_loss_mean=0.1773, ent_mean=0.1271 | gn_bb_mean=1.273, gn_bb_max=1.780 | gn_v_mean=0.817, gn_v_max=1.903

  6%|▌         | 288/5000 [45:54<10:45:11,  8.22s/it]------------------ Training Record ------------------
Epoch: 288/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=24, valid_ratio=0.725, reward_valid_mean=0.3111, reward_valid_std=2.2621
[BatchDiag] adv_mean=-0.0826, adv_std=0.9340, adv_abs_mean=0.7026 | ret_mean=6.7198, ret_std=1.7503 | val_mean=6.8025, val_std=1.5056 | explained_var=0.715232
[GradSplit pre-clip] backbone=0.483716, critic=0.432875
[Loss] pg_loss=-0.062703, entropy_loss=0.000121, value_loss=0.043047
[EpochKL] epoch=0 mean_kl=0.00327 max_kl=0.00529
[EpochKL] epoch=1 mean_kl=0.00551 max_kl=0.00719
[EpochKL] epoch=2 mean_kl=0.00624 max_kl=0.00787
[Time] Env Create Time: 2.8324s |Rollout Collect Time: 3.7844s |Loss & Update :2.0083
[PPODiag] kl_mean=0.0050, kl_p90=0.0069, kl_max=0.0079 | clipfrac_mean=0.034, logratio_std_mean=0.102, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.725, p10=0.720, min=0.714 | pg_loss_mean=0.0018, v_loss_mean=0.1793, ent_mean=0.1158 | gn_bb_mean=1.290, gn_bb_max=2.158 | gn_v_mean=0.848, gn_v_max=1.918

  6%|▌         | 289/5000 [46:03<10:54:47,  8.34s/it]------------------ Training Record ------------------
Epoch: 289/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.3092, reward_valid_std=2.2630
[BatchDiag] adv_mean=-0.0997, adv_std=0.9376, adv_abs_mean=0.7059 | ret_mean=6.7120, ret_std=1.7647 | val_mean=6.8116, val_std=1.4976 | explained_var=0.717725
[GradSplit pre-clip] backbone=0.496556, critic=0.432155
[Loss] pg_loss=-0.093131, entropy_loss=0.000137, value_loss=0.042507
[EpochKL] epoch=0 mean_kl=0.00313 max_kl=0.00600
[EpochKL] epoch=1 mean_kl=0.00404 max_kl=0.00744
[EpochKL] epoch=2 mean_kl=0.00604 max_kl=0.01136
[Time] Env Create Time: 2.8575s |Rollout Collect Time: 3.5074s |Loss & Update :1.8744
[PPODiag] kl_mean=0.0044, kl_p90=0.0066, kl_max=0.0114 | clipfrac_mean=0.032, logratio_std_mean=0.094, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.791, p10=0.787, min=0.785 | pg_loss_mean=0.0017, v_loss_mean=0.1810, ent_mean=0.1274 | gn_bb_mean=1.370, gn_bb_max=2.264 | gn_v_mean=1.219, gn_v_max=2.665

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.818, Step: 21, Avg Done Step: 18.48, #CS visited: 0.36
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->C8->D->C6->C7->C11->C10->C9->D
Eval cost : 4.0418s
-----------------------------
  6%|▌         | 290/5000 [46:15<12:28:04,  9.53s/it]------------------ Training Record ------------------
Epoch: 290/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.792, reward_valid_mean=0.3094, reward_valid_std=2.2608
[BatchDiag] adv_mean=-0.0712, adv_std=0.9275, adv_abs_mean=0.7028 | ret_mean=6.7026, ret_std=1.7707 | val_mean=6.7739, val_std=1.5227 | explained_var=0.725650
[GradSplit pre-clip] backbone=0.687811, critic=0.423790
[Loss] pg_loss=-0.066105, entropy_loss=0.000142, value_loss=0.042747
[EpochKL] epoch=0 mean_kl=0.00306 max_kl=0.00471
[EpochKL] epoch=1 mean_kl=0.00686 max_kl=0.01278
[EpochKL] epoch=2 mean_kl=0.00788 max_kl=0.01136
[Time] Env Create Time: 2.8599s |Rollout Collect Time: 3.5021s |Loss & Update :1.8720
[PPODiag] kl_mean=0.0059, kl_p90=0.0106, kl_max=0.0128 | clipfrac_mean=0.037, logratio_std_mean=0.109, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.792, p10=0.789, min=0.787 | pg_loss_mean=0.0022, v_loss_mean=0.1788, ent_mean=0.1268 | gn_bb_mean=1.477, gn_bb_max=2.053 | gn_v_mean=0.758, gn_v_max=1.844
[AttnScore] scale=1.0941, C=10.0

  6%|▌         | 291/5000 [46:23<11:57:25,  9.14s/it]------------------ Training Record ------------------
Epoch: 291/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.830, reward_valid_mean=0.3114, reward_valid_std=2.2631
[BatchDiag] adv_mean=0.0064, adv_std=0.9144, adv_abs_mean=0.6935 | ret_mean=6.7021, ret_std=1.7695 | val_mean=6.6957, val_std=1.5272 | explained_var=0.732979
[GradSplit pre-clip] backbone=0.561183, critic=0.792497
[Loss] pg_loss=-0.057670, entropy_loss=0.000140, value_loss=0.039756
[EpochKL] epoch=0 mean_kl=0.00418 max_kl=0.00724
[EpochKL] epoch=1 mean_kl=0.00873 max_kl=0.01315
[EarlyStop] epoch=2 mean_kl=0.01114 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01114 max_kl=0.01578
[Time] Env Create Time: 2.8714s |Rollout Collect Time: 3.3577s |Loss & Update :1.7973
[PPODiag] kl_mean=0.0080, kl_p90=0.0125, kl_max=0.0158 | clipfrac_mean=0.045, logratio_std_mean=0.128, ratio_p95_mean=1.067 | valid_ratio_mb_mean=0.830, p10=0.824, min=0.822 | pg_loss_mean=0.0031, v_loss_mean=0.1751, ent_mean=0.1330 | gn_bb_mean=1.665, gn_bb_max=2.877 | gn_v_mean=0.994, gn_v_max=2.466

  6%|▌         | 292/5000 [46:31<11:31:02,  8.81s/it]------------------ Training Record ------------------
Epoch: 292/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=41, valid_ratio=0.425, reward_valid_mean=0.3135, reward_valid_std=2.2629
[BatchDiag] adv_mean=0.1194, adv_std=0.9129, adv_abs_mean=0.7061 | ret_mean=6.6851, ret_std=1.7953 | val_mean=6.5658, val_std=1.5870 | explained_var=0.741412
[GradSplit pre-clip] backbone=0.631381, critic=1.734599
[Loss] pg_loss=-0.034381, entropy_loss=0.000070, value_loss=0.042474
[EpochKL] epoch=0 mean_kl=0.00843 max_kl=0.01451
[EpochKL] epoch=1 mean_kl=0.00768 max_kl=0.01232
[EpochKL] epoch=2 mean_kl=0.00890 max_kl=0.01382
[Time] Env Create Time: 2.6883s |Rollout Collect Time: 6.3446s |Loss & Update :3.2708
[PPODiag] kl_mean=0.0083, kl_p90=0.0132, kl_max=0.0145 | clipfrac_mean=0.045, logratio_std_mean=0.135, ratio_p95_mean=1.065 | valid_ratio_mb_mean=0.425, p10=0.422, min=0.421 | pg_loss_mean=0.0034, v_loss_mean=0.1762, ent_mean=0.0665 | gn_bb_mean=1.685, gn_bb_max=3.294 | gn_v_mean=1.330, gn_v_max=3.071

  6%|▌         | 293/5000 [46:44<12:53:12,  9.86s/it]------------------ Training Record ------------------
Epoch: 293/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.792, reward_valid_mean=0.3091, reward_valid_std=2.2612
[BatchDiag] adv_mean=0.0157, adv_std=0.9343, adv_abs_mean=0.7067 | ret_mean=6.6833, ret_std=1.7833 | val_mean=6.6676, val_std=1.5957 | explained_var=0.725523
[GradSplit pre-clip] backbone=0.870021, critic=1.126803
[Loss] pg_loss=-0.022909, entropy_loss=0.000126, value_loss=0.043446
[EpochKL] epoch=0 mean_kl=0.00871 max_kl=0.01532
[EpochKL] epoch=1 mean_kl=0.00690 max_kl=0.00986
[EpochKL] epoch=2 mean_kl=0.00651 max_kl=0.00982
[Time] Env Create Time: 2.8453s |Rollout Collect Time: 3.4939s |Loss & Update :1.8795
[PPODiag] kl_mean=0.0074, kl_p90=0.0099, kl_max=0.0153 | clipfrac_mean=0.042, logratio_std_mean=0.125, ratio_p95_mean=1.060 | valid_ratio_mb_mean=0.792, p10=0.787, min=0.784 | pg_loss_mean=0.0028, v_loss_mean=0.1799, ent_mean=0.1225 | gn_bb_mean=1.511, gn_bb_max=2.438 | gn_v_mean=0.982, gn_v_max=2.344

  6%|▌         | 294/5000 [46:52<12:14:31,  9.36s/it]------------------ Training Record ------------------
Epoch: 294/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.830, reward_valid_mean=0.3105, reward_valid_std=2.2603
[BatchDiag] adv_mean=-0.0744, adv_std=0.9159, adv_abs_mean=0.6909 | ret_mean=6.7176, ret_std=1.7715 | val_mean=6.7920, val_std=1.5268 | explained_var=0.732667
[GradSplit pre-clip] backbone=0.545082, critic=0.640662
[Loss] pg_loss=-0.098217, entropy_loss=0.000139, value_loss=0.039792
[EpochKL] epoch=0 mean_kl=0.00381 max_kl=0.00571
[EpochKL] epoch=1 mean_kl=0.00613 max_kl=0.00893
[EpochKL] epoch=2 mean_kl=0.00681 max_kl=0.00856
[Time] Env Create Time: 2.8723s |Rollout Collect Time: 3.3383s |Loss & Update :1.7942
[PPODiag] kl_mean=0.0056, kl_p90=0.0085, kl_max=0.0089 | clipfrac_mean=0.037, logratio_std_mean=0.107, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.830, p10=0.825, min=0.823 | pg_loss_mean=0.0021, v_loss_mean=0.1757, ent_mean=0.1323 | gn_bb_mean=1.389, gn_bb_max=1.929 | gn_v_mean=1.177, gn_v_max=2.645

  6%|▌         | 295/5000 [47:00<11:42:22,  8.96s/it]------------------ Training Record ------------------
Epoch: 295/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.832, reward_valid_mean=0.3093, reward_valid_std=2.2606
[BatchDiag] adv_mean=-0.0643, adv_std=0.9189, adv_abs_mean=0.6948 | ret_mean=6.7142, ret_std=1.7688 | val_mean=6.7785, val_std=1.5278 | explained_var=0.730126
[GradSplit pre-clip] backbone=0.599858, critic=0.472472
[Loss] pg_loss=-0.076686, entropy_loss=0.000135, value_loss=0.039541
[EpochKL] epoch=0 mean_kl=0.00354 max_kl=0.00644
[EpochKL] epoch=1 mean_kl=0.00533 max_kl=0.00817
[EpochKL] epoch=2 mean_kl=0.00720 max_kl=0.00997
[Time] Env Create Time: 2.6931s |Rollout Collect Time: 3.3546s |Loss & Update :1.7957
[PPODiag] kl_mean=0.0054, kl_p90=0.0084, kl_max=0.0100 | clipfrac_mean=0.037, logratio_std_mean=0.104, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.832, p10=0.824, min=0.822 | pg_loss_mean=0.0018, v_loss_mean=0.1789, ent_mean=0.1327 | gn_bb_mean=1.393, gn_bb_max=1.980 | gn_v_mean=1.559, gn_v_max=4.828
[AttnScore] scale=1.0959, C=10.0

  6%|▌         | 296/5000 [47:08<11:16:03,  8.62s/it]------------------ Training Record ------------------
Epoch: 296/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.758, reward_valid_mean=0.3091, reward_valid_std=2.2651
[BatchDiag] adv_mean=-0.2846, adv_std=0.9182, adv_abs_mean=0.7119 | ret_mean=6.7850, ret_std=1.7284 | val_mean=7.0696, val_std=1.4566 | explained_var=0.717777
[GradSplit pre-clip] backbone=0.434423, critic=1.850071
[Loss] pg_loss=-0.046139, entropy_loss=0.000130, value_loss=0.043034
[EpochKL] epoch=0 mean_kl=0.00341 max_kl=0.00610
[EpochKL] epoch=1 mean_kl=0.00576 max_kl=0.00746
[EpochKL] epoch=2 mean_kl=0.00658 max_kl=0.00894
[Time] Env Create Time: 2.8529s |Rollout Collect Time: 3.6489s |Loss & Update :1.9394
[PPODiag] kl_mean=0.0053, kl_p90=0.0075, kl_max=0.0089 | clipfrac_mean=0.035, logratio_std_mean=0.104, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.758, p10=0.754, min=0.753 | pg_loss_mean=0.0020, v_loss_mean=0.1826, ent_mean=0.1207 | gn_bb_mean=1.298, gn_bb_max=1.850 | gn_v_mean=2.015, gn_v_max=3.089

  6%|▌         | 297/5000 [47:16<11:11:38,  8.57s/it]------------------ Training Record ------------------
Epoch: 297/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.831, reward_valid_mean=0.3090, reward_valid_std=2.2605
[BatchDiag] adv_mean=-0.2498, adv_std=0.9002, adv_abs_mean=0.7006 | ret_mean=6.7710, ret_std=1.7270 | val_mean=7.0208, val_std=1.4556 | explained_var=0.728310
[GradSplit pre-clip] backbone=0.519780, critic=1.396903
[Loss] pg_loss=-0.081294, entropy_loss=0.000138, value_loss=0.041513
[EpochKL] epoch=0 mean_kl=0.00510 max_kl=0.01107
[EpochKL] epoch=1 mean_kl=0.00773 max_kl=0.01033
[EpochKL] epoch=2 mean_kl=0.00827 max_kl=0.01305
[Time] Env Create Time: 2.8394s |Rollout Collect Time: 3.3396s |Loss & Update :1.7889
[PPODiag] kl_mean=0.0070, kl_p90=0.0109, kl_max=0.0130 | clipfrac_mean=0.040, logratio_std_mean=0.121, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.831, p10=0.826, min=0.824 | pg_loss_mean=0.0026, v_loss_mean=0.1777, ent_mean=0.1319 | gn_bb_mean=1.379, gn_bb_max=2.148 | gn_v_mean=1.807, gn_v_max=3.442

  6%|▌         | 298/5000 [47:24<10:57:23,  8.39s/it]------------------ Training Record ------------------
Epoch: 298/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.829, reward_valid_mean=0.3126, reward_valid_std=2.2650
[BatchDiag] adv_mean=-0.2365, adv_std=0.8720, adv_abs_mean=0.6807 | ret_mean=6.7946, ret_std=1.7155 | val_mean=7.0311, val_std=1.4252 | explained_var=0.741645
[GradSplit pre-clip] backbone=0.577811, critic=1.608903
[Loss] pg_loss=-0.075175, entropy_loss=0.000131, value_loss=0.039892
[EpochKL] epoch=0 mean_kl=0.00412 max_kl=0.00653
[EpochKL] epoch=1 mean_kl=0.00522 max_kl=0.00723
[EpochKL] epoch=2 mean_kl=0.00453 max_kl=0.00612
[Time] Env Create Time: 2.8546s |Rollout Collect Time: 3.3371s |Loss & Update :1.7987
[PPODiag] kl_mean=0.0046, kl_p90=0.0061, kl_max=0.0072 | clipfrac_mean=0.033, logratio_std_mean=0.097, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.829, p10=0.823, min=0.820 | pg_loss_mean=0.0017, v_loss_mean=0.1660, ent_mean=0.1330 | gn_bb_mean=1.336, gn_bb_max=1.957 | gn_v_mean=1.389, gn_v_max=2.299

  6%|▌         | 299/5000 [47:32<10:47:53,  8.27s/it]------------------ Training Record ------------------
Epoch: 299/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.3118, reward_valid_std=2.2616
[BatchDiag] adv_mean=-0.1705, adv_std=0.8846, adv_abs_mean=0.6783 | ret_mean=6.7594, ret_std=1.7269 | val_mean=6.9299, val_std=1.4393 | explained_var=0.737602
[GradSplit pre-clip] backbone=0.564447, critic=1.399690
[Loss] pg_loss=-0.023646, entropy_loss=0.000134, value_loss=0.039071
[EpochKL] epoch=0 mean_kl=0.00219 max_kl=0.00408
[EpochKL] epoch=1 mean_kl=0.00457 max_kl=0.00712
[EpochKL] epoch=2 mean_kl=0.00750 max_kl=0.01007
[Time] Env Create Time: 2.6883s |Rollout Collect Time: 3.4875s |Loss & Update :1.8570
[PPODiag] kl_mean=0.0048, kl_p90=0.0083, kl_max=0.0101 | clipfrac_mean=0.033, logratio_std_mean=0.097, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.791, p10=0.787, min=0.783 | pg_loss_mean=0.0016, v_loss_mean=0.1661, ent_mean=0.1241 | gn_bb_mean=1.317, gn_bb_max=2.110 | gn_v_mean=1.090, gn_v_max=2.327

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 999 episodes: -5.819, Step: 59, Avg Done Step: 18.44, #CS visited: 0.40
D->C12->C1->C15->C14->C3->C5->C2->D->C13->C4->C7->C11->C10->C9->C8->D->C6->D
Eval cost : 9.7537s
-----------------------------
  6%|▌         | 300/5000 [47:50<14:32:06, 11.13s/it]------------------ Training Record ------------------
Epoch: 300/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.794, reward_valid_mean=0.3083, reward_valid_std=2.2591
[BatchDiag] adv_mean=-0.1401, adv_std=0.9070, adv_abs_mean=0.6906 | ret_mean=6.7206, ret_std=1.7542 | val_mean=6.8607, val_std=1.4618 | explained_var=0.732630
[GradSplit pre-clip] backbone=0.512356, critic=0.437449
[Loss] pg_loss=-0.120959, entropy_loss=0.000132, value_loss=0.037803
[EpochKL] epoch=0 mean_kl=0.00651 max_kl=0.01112
[EpochKL] epoch=1 mean_kl=0.00595 max_kl=0.00937
[EpochKL] epoch=2 mean_kl=0.00895 max_kl=0.01285
[Time] Env Create Time: 2.7036s |Rollout Collect Time: 3.4941s |Loss & Update :1.8750
[PPODiag] kl_mean=0.0071, kl_p90=0.0110, kl_max=0.0129 | clipfrac_mean=0.042, logratio_std_mean=0.122, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.794, p10=0.788, min=0.785 | pg_loss_mean=0.0027, v_loss_mean=0.1720, ent_mean=0.1260 | gn_bb_mean=1.630, gn_bb_max=2.657 | gn_v_mean=0.818, gn_v_max=2.260
[AttnScore] scale=1.0981, C=10.0

  6%|▌         | 301/5000 [47:58<13:20:01, 10.22s/it]------------------ Training Record ------------------
Epoch: 301/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.792, reward_valid_mean=0.3115, reward_valid_std=2.2633
[BatchDiag] adv_mean=-0.1060, adv_std=0.9088, adv_abs_mean=0.6868 | ret_mean=6.7290, ret_std=1.7581 | val_mean=6.8350, val_std=1.4820 | explained_var=0.732766
[GradSplit pre-clip] backbone=0.589532, critic=0.437924
[Loss] pg_loss=-0.095542, entropy_loss=0.000128, value_loss=0.037534
[EpochKL] epoch=0 mean_kl=0.00377 max_kl=0.00603
[EpochKL] epoch=1 mean_kl=0.00542 max_kl=0.00676
[EpochKL] epoch=2 mean_kl=0.00754 max_kl=0.01030
[Time] Env Create Time: 2.8473s |Rollout Collect Time: 3.5016s |Loss & Update :1.8708
[PPODiag] kl_mean=0.0056, kl_p90=0.0084, kl_max=0.0103 | clipfrac_mean=0.036, logratio_std_mean=0.107, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.792, p10=0.787, min=0.783 | pg_loss_mean=0.0021, v_loss_mean=0.1727, ent_mean=0.1214 | gn_bb_mean=1.410, gn_bb_max=1.986 | gn_v_mean=1.198, gn_v_max=2.727

  6%|▌         | 302/5000 [48:06<12:32:59,  9.62s/it]------------------ Training Record ------------------
Epoch: 302/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.793, reward_valid_mean=0.3072, reward_valid_std=2.2576
[BatchDiag] adv_mean=-0.1214, adv_std=0.9191, adv_abs_mean=0.6928 | ret_mean=6.6850, ret_std=1.7677 | val_mean=6.8064, val_std=1.5065 | explained_var=0.729683
[GradSplit pre-clip] backbone=0.715931, critic=0.402847
[Loss] pg_loss=-0.106560, entropy_loss=0.000130, value_loss=0.041360
[EpochKL] epoch=0 mean_kl=0.00446 max_kl=0.00670
[EpochKL] epoch=1 mean_kl=0.00605 max_kl=0.00874
[EpochKL] epoch=2 mean_kl=0.00766 max_kl=0.01278
[Time] Env Create Time: 2.8516s |Rollout Collect Time: 3.5085s |Loss & Update :1.8620
[PPODiag] kl_mean=0.0061, kl_p90=0.0079, kl_max=0.0128 | clipfrac_mean=0.037, logratio_std_mean=0.112, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.793, p10=0.788, min=0.784 | pg_loss_mean=0.0021, v_loss_mean=0.1767, ent_mean=0.1226 | gn_bb_mean=1.398, gn_bb_max=2.025 | gn_v_mean=1.290, gn_v_max=2.605

  6%|▌         | 303/5000 [48:15<12:00:05,  9.20s/it]------------------ Training Record ------------------
Epoch: 303/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.759, reward_valid_mean=0.3099, reward_valid_std=2.2620
[BatchDiag] adv_mean=-0.0996, adv_std=0.9155, adv_abs_mean=0.6952 | ret_mean=6.7062, ret_std=1.7652 | val_mean=6.8058, val_std=1.4470 | explained_var=0.730998
[GradSplit pre-clip] backbone=0.755960, critic=0.583839
[Loss] pg_loss=-0.070214, entropy_loss=0.000126, value_loss=0.041275
[EpochKL] epoch=0 mean_kl=0.00359 max_kl=0.00703
[EpochKL] epoch=1 mean_kl=0.00449 max_kl=0.00539
[EpochKL] epoch=2 mean_kl=0.00605 max_kl=0.00924
[Time] Env Create Time: 2.6867s |Rollout Collect Time: 3.6519s |Loss & Update :1.9496
[PPODiag] kl_mean=0.0047, kl_p90=0.0067, kl_max=0.0092 | clipfrac_mean=0.034, logratio_std_mean=0.097, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.759, p10=0.754, min=0.748 | pg_loss_mean=0.0018, v_loss_mean=0.1750, ent_mean=0.1197 | gn_bb_mean=1.438, gn_bb_max=2.075 | gn_v_mean=1.300, gn_v_max=2.564

  6%|▌         | 304/5000 [48:23<11:38:34,  8.93s/it]------------------ Training Record ------------------
Epoch: 304/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.792, reward_valid_mean=0.3118, reward_valid_std=2.2628
[BatchDiag] adv_mean=-0.1090, adv_std=0.9003, adv_abs_mean=0.6798 | ret_mean=6.7460, ret_std=1.7492 | val_mean=6.8550, val_std=1.4778 | explained_var=0.735083
[GradSplit pre-clip] backbone=0.637062, critic=0.367233
[Loss] pg_loss=-0.093871, entropy_loss=0.000130, value_loss=0.042023
[EpochKL] epoch=0 mean_kl=0.00271 max_kl=0.00417
[EpochKL] epoch=1 mean_kl=0.00365 max_kl=0.00479
[EpochKL] epoch=2 mean_kl=0.00571 max_kl=0.00861
[Time] Env Create Time: 2.8486s |Rollout Collect Time: 3.4935s |Loss & Update :1.8529
[PPODiag] kl_mean=0.0040, kl_p90=0.0062, kl_max=0.0086 | clipfrac_mean=0.030, logratio_std_mean=0.090, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.792, p10=0.786, min=0.785 | pg_loss_mean=0.0012, v_loss_mean=0.1687, ent_mean=0.1239 | gn_bb_mean=1.208, gn_bb_max=1.642 | gn_v_mean=0.841, gn_v_max=1.825

  6%|▌         | 305/5000 [48:31<11:21:17,  8.71s/it]------------------ Training Record ------------------
Epoch: 305/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.829, reward_valid_mean=0.3149, reward_valid_std=2.2642
[BatchDiag] adv_mean=-0.0946, adv_std=0.8844, adv_abs_mean=0.6657 | ret_mean=6.7703, ret_std=1.7347 | val_mean=6.8648, val_std=1.4978 | explained_var=0.740085
[GradSplit pre-clip] backbone=0.474867, critic=0.558575
[Loss] pg_loss=-0.020820, entropy_loss=0.000137, value_loss=0.038604
[EpochKL] epoch=0 mean_kl=0.00262 max_kl=0.00472
[EpochKL] epoch=1 mean_kl=0.00496 max_kl=0.01188
[EpochKL] epoch=2 mean_kl=0.00589 max_kl=0.00873
[Time] Env Create Time: 2.8474s |Rollout Collect Time: 3.3557s |Loss & Update :1.7844
[PPODiag] kl_mean=0.0045, kl_p90=0.0080, kl_max=0.0119 | clipfrac_mean=0.032, logratio_std_mean=0.094, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.829, p10=0.824, min=0.823 | pg_loss_mean=0.0018, v_loss_mean=0.1664, ent_mean=0.1288 | gn_bb_mean=1.437, gn_bb_max=2.453 | gn_v_mean=1.307, gn_v_max=4.062
[AttnScore] scale=1.1003, C=10.0

  6%|▌         | 306/5000 [48:39<11:04:16,  8.49s/it]------------------ Training Record ------------------
Epoch: 306/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51181/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.291, reward_valid_mean=0.3122, reward_valid_std=2.2577
[BatchDiag] adv_mean=-0.1277, adv_std=0.9683, adv_abs_mean=0.6818 | ret_mean=6.7349, ret_std=1.7747 | val_mean=6.8625, val_std=1.5050 | explained_var=0.702268
[GradSplit pre-clip] backbone=0.425926, critic=0.415861
[Loss] pg_loss=-0.060069, entropy_loss=0.000048, value_loss=0.040794
[EpochKL] epoch=0 mean_kl=0.00576 max_kl=0.01105
[EpochKL] epoch=1 mean_kl=0.00836 max_kl=0.01087
[EpochKL] epoch=2 mean_kl=0.00953 max_kl=0.01603
[Time] Env Create Time: 2.8724s |Rollout Collect Time: 9.2044s |Loss & Update :4.6332
[PPODiag] kl_mean=0.0079, kl_p90=0.0110, kl_max=0.0160 | clipfrac_mean=0.044, logratio_std_mean=0.128, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.291, p10=0.288, min=0.287 | pg_loss_mean=0.0026, v_loss_mean=0.1783, ent_mean=0.0452 | gn_bb_mean=1.532, gn_bb_max=2.399 | gn_v_mean=1.797, gn_v_max=3.648

  6%|▌         | 307/5000 [48:56<14:17:00, 10.96s/it]------------------ Training Record ------------------
Epoch: 307/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.829, reward_valid_mean=0.3127, reward_valid_std=2.2608
[BatchDiag] adv_mean=0.0184, adv_std=0.9132, adv_abs_mean=0.6864 | ret_mean=6.7030, ret_std=1.7673 | val_mean=6.6846, val_std=1.5537 | explained_var=0.733018
[GradSplit pre-clip] backbone=0.511957, critic=1.364112
[Loss] pg_loss=-0.087803, entropy_loss=0.000128, value_loss=0.039213
[EpochKL] epoch=0 mean_kl=0.00455 max_kl=0.00788
[EpochKL] epoch=1 mean_kl=0.00911 max_kl=0.01449
[EarlyStop] epoch=2 mean_kl=0.01084 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01084 max_kl=0.01783
[Time] Env Create Time: 2.6918s |Rollout Collect Time: 3.3521s |Loss & Update :1.7932
[PPODiag] kl_mean=0.0082, kl_p90=0.0141, kl_max=0.0178 | clipfrac_mean=0.043, logratio_std_mean=0.130, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.829, p10=0.822, min=0.819 | pg_loss_mean=0.0031, v_loss_mean=0.1742, ent_mean=0.1266 | gn_bb_mean=1.493, gn_bb_max=2.092 | gn_v_mean=1.231, gn_v_max=3.493

  6%|▌         | 308/5000 [49:04<13:03:38, 10.02s/it]------------------ Training Record ------------------
Epoch: 308/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3119, reward_valid_std=2.2646
[BatchDiag] adv_mean=-0.0375, adv_std=0.8895, adv_abs_mean=0.6715 | ret_mean=6.7193, ret_std=1.7698 | val_mean=6.7568, val_std=1.5356 | explained_var=0.747370
[GradSplit pre-clip] backbone=0.607441, critic=0.390634
[Loss] pg_loss=-0.013298, entropy_loss=0.000128, value_loss=0.040993
[EpochKL] epoch=0 mean_kl=0.00616 max_kl=0.01128
[EpochKL] epoch=1 mean_kl=0.00832 max_kl=0.01101
[EpochKL] epoch=2 mean_kl=0.00745 max_kl=0.01407
[Time] Env Create Time: 2.8326s |Rollout Collect Time: 3.4832s |Loss & Update :1.8541
[PPODiag] kl_mean=0.0073, kl_p90=0.0108, kl_max=0.0141 | clipfrac_mean=0.041, logratio_std_mean=0.123, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.790, p10=0.784, min=0.783 | pg_loss_mean=0.0027, v_loss_mean=0.1683, ent_mean=0.1196 | gn_bb_mean=1.388, gn_bb_max=1.936 | gn_v_mean=1.222, gn_v_max=3.246

  6%|▌         | 309/5000 [49:12<12:20:04,  9.47s/it]------------------ Training Record ------------------
Epoch: 309/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.794, reward_valid_mean=0.3110, reward_valid_std=2.2604
[BatchDiag] adv_mean=-0.0087, adv_std=0.8996, adv_abs_mean=0.6746 | ret_mean=6.7133, ret_std=1.7756 | val_mean=6.7220, val_std=1.5540 | explained_var=0.743310
[GradSplit pre-clip] backbone=0.551100, critic=0.679262
[Loss] pg_loss=-0.032511, entropy_loss=0.000128, value_loss=0.039166
[EpochKL] epoch=0 mean_kl=0.00318 max_kl=0.00528
[EpochKL] epoch=1 mean_kl=0.00519 max_kl=0.00652
[EpochKL] epoch=2 mean_kl=0.00622 max_kl=0.01056
[Time] Env Create Time: 2.8553s |Rollout Collect Time: 3.4809s |Loss & Update :1.8642
[PPODiag] kl_mean=0.0049, kl_p90=0.0070, kl_max=0.0106 | clipfrac_mean=0.034, logratio_std_mean=0.099, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.794, p10=0.788, min=0.786 | pg_loss_mean=0.0017, v_loss_mean=0.1688, ent_mean=0.1223 | gn_bb_mean=1.391, gn_bb_max=2.313 | gn_v_mean=0.969, gn_v_max=1.986

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.802, Step: 20, Avg Done Step: 18.56, #CS visited: 0.32
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->D->C6->C7->D->C11->C10->C9->C8->D
Eval cost : 3.8739s
-----------------------------
  6%|▌         | 310/5000 [49:24<13:22:04, 10.26s/it]------------------ Training Record ------------------
Epoch: 310/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=26, valid_ratio=0.671, reward_valid_mean=0.3118, reward_valid_std=2.2619
[BatchDiag] adv_mean=-0.0467, adv_std=0.9003, adv_abs_mean=0.6719 | ret_mean=6.7260, ret_std=1.7708 | val_mean=6.7728, val_std=1.5479 | explained_var=0.741513
[GradSplit pre-clip] backbone=0.798090, critic=0.409774
[Loss] pg_loss=-0.043311, entropy_loss=0.000109, value_loss=0.037874
[EpochKL] epoch=0 mean_kl=0.00739 max_kl=0.01367
[EpochKL] epoch=1 mean_kl=0.00890 max_kl=0.01452
[EpochKL] epoch=2 mean_kl=0.00739 max_kl=0.00950
[Time] Env Create Time: 2.8363s |Rollout Collect Time: 4.0814s |Loss & Update :2.1497
[PPODiag] kl_mean=0.0079, kl_p90=0.0123, kl_max=0.0145 | clipfrac_mean=0.042, logratio_std_mean=0.129, ratio_p95_mean=1.060 | valid_ratio_mb_mean=0.671, p10=0.666, min=0.664 | pg_loss_mean=0.0022, v_loss_mean=0.1695, ent_mean=0.1030 | gn_bb_mean=1.389, gn_bb_max=2.706 | gn_v_mean=1.350, gn_v_max=2.772
[AttnScore] scale=1.1021, C=10.0

  6%|▌         | 311/5000 [49:33<12:53:56,  9.90s/it]------------------ Training Record ------------------
Epoch: 311/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.3148, reward_valid_std=2.2638
[BatchDiag] adv_mean=0.0439, adv_std=0.9137, adv_abs_mean=0.6863 | ret_mean=6.7163, ret_std=1.7825 | val_mean=6.6724, val_std=1.5771 | explained_var=0.737227
[GradSplit pre-clip] backbone=0.667848, critic=1.403443
[Loss] pg_loss=-0.076057, entropy_loss=0.000120, value_loss=0.037552
[EpochKL] epoch=0 mean_kl=0.00459 max_kl=0.01057
[EpochKL] epoch=1 mean_kl=0.00781 max_kl=0.01126
[EpochKL] epoch=2 mean_kl=0.00857 max_kl=0.01069
[Time] Env Create Time: 2.6738s |Rollout Collect Time: 3.4823s |Loss & Update :1.8705
[PPODiag] kl_mean=0.0070, kl_p90=0.0101, kl_max=0.0113 | clipfrac_mean=0.040, logratio_std_mean=0.120, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.791, p10=0.787, min=0.782 | pg_loss_mean=0.0028, v_loss_mean=0.1716, ent_mean=0.1222 | gn_bb_mean=1.507, gn_bb_max=2.199 | gn_v_mean=1.093, gn_v_max=2.469

  6%|▌         | 312/5000 [49:41<12:09:47,  9.34s/it]------------------ Training Record ------------------
Epoch: 312/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.829, reward_valid_mean=0.3137, reward_valid_std=2.2626
[BatchDiag] adv_mean=0.0558, adv_std=0.8970, adv_abs_mean=0.6807 | ret_mean=6.7179, ret_std=1.7838 | val_mean=6.6621, val_std=1.5891 | explained_var=0.747108
[GradSplit pre-clip] backbone=0.650238, critic=1.808247
[Loss] pg_loss=-0.111682, entropy_loss=0.000135, value_loss=0.037320
[EpochKL] epoch=0 mean_kl=0.00304 max_kl=0.00526
[EpochKL] epoch=1 mean_kl=0.00493 max_kl=0.00659
[EpochKL] epoch=2 mean_kl=0.00674 max_kl=0.00824
[Time] Env Create Time: 2.8525s |Rollout Collect Time: 3.3479s |Loss & Update :1.8023
[PPODiag] kl_mean=0.0049, kl_p90=0.0069, kl_max=0.0082 | clipfrac_mean=0.033, logratio_std_mean=0.100, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.829, p10=0.823, min=0.816 | pg_loss_mean=0.0017, v_loss_mean=0.1697, ent_mean=0.1282 | gn_bb_mean=1.388, gn_bb_max=1.952 | gn_v_mean=1.221, gn_v_max=2.639

  6%|▋         | 313/5000 [49:49<11:38:18,  8.94s/it]------------------ Training Record ------------------
Epoch: 313/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.792, reward_valid_mean=0.3112, reward_valid_std=2.2612
[BatchDiag] adv_mean=-0.0767, adv_std=0.9008, adv_abs_mean=0.6782 | ret_mean=6.7354, ret_std=1.7647 | val_mean=6.8121, val_std=1.5514 | explained_var=0.739421
[GradSplit pre-clip] backbone=0.578564, critic=0.320037
[Loss] pg_loss=-0.063467, entropy_loss=0.000123, value_loss=0.038545
[EpochKL] epoch=0 mean_kl=0.00422 max_kl=0.00629
[EpochKL] epoch=1 mean_kl=0.00828 max_kl=0.01266
[EpochKL] epoch=2 mean_kl=0.00992 max_kl=0.01415
[Time] Env Create Time: 2.8578s |Rollout Collect Time: 3.4964s |Loss & Update :1.8824
[PPODiag] kl_mean=0.0075, kl_p90=0.0124, kl_max=0.0141 | clipfrac_mean=0.042, logratio_std_mean=0.125, ratio_p95_mean=1.060 | valid_ratio_mb_mean=0.792, p10=0.785, min=0.784 | pg_loss_mean=0.0029, v_loss_mean=0.1725, ent_mean=0.1192 | gn_bb_mean=1.506, gn_bb_max=2.246 | gn_v_mean=1.356, gn_v_max=4.169

  6%|▋         | 314/5000 [49:57<11:21:41,  8.73s/it]------------------ Training Record ------------------
Epoch: 314/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51168/51200 = 0.999
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.291, reward_valid_mean=0.3085, reward_valid_std=2.2586
[BatchDiag] adv_mean=-0.1293, adv_std=0.9183, adv_abs_mean=0.6838 | ret_mean=6.7045, ret_std=1.7578 | val_mean=6.8338, val_std=1.5182 | explained_var=0.727077
[GradSplit pre-clip] backbone=0.467397, critic=0.817760
[Loss] pg_loss=-0.034801, entropy_loss=0.000047, value_loss=0.041313
[EpochKL] epoch=0 mean_kl=0.00206 max_kl=0.00348
[EpochKL] epoch=1 mean_kl=0.00801 max_kl=0.01296
[EarlyStop] epoch=2 mean_kl=0.01126 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01126 max_kl=0.01422
[Time] Env Create Time: 2.6839s |Rollout Collect Time: 9.1514s |Loss & Update :4.6903
[PPODiag] kl_mean=0.0071, kl_p90=0.0129, kl_max=0.0142 | clipfrac_mean=0.037, logratio_std_mean=0.118, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.291, p10=0.289, min=0.289 | pg_loss_mean=0.0025, v_loss_mean=0.1744, ent_mean=0.0457 | gn_bb_mean=1.422, gn_bb_max=2.251 | gn_v_mean=1.328, gn_v_max=3.068

  6%|▋         | 315/5000 [50:14<14:24:12, 11.07s/it]------------------ Training Record ------------------
Epoch: 315/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.831, reward_valid_mean=0.3128, reward_valid_std=2.2616
[BatchDiag] adv_mean=0.0260, adv_std=0.9022, adv_abs_mean=0.6797 | ret_mean=6.7168, ret_std=1.7691 | val_mean=6.6909, val_std=1.5424 | explained_var=0.739913
[GradSplit pre-clip] backbone=0.591282, critic=0.934502
[Loss] pg_loss=-0.038484, entropy_loss=0.000138, value_loss=0.040928
[EpochKL] epoch=0 mean_kl=0.00349 max_kl=0.00726
[EpochKL] epoch=1 mean_kl=0.00482 max_kl=0.00682
[EpochKL] epoch=2 mean_kl=0.00610 max_kl=0.00913
[Time] Env Create Time: 2.8291s |Rollout Collect Time: 3.3324s |Loss & Update :1.7994
[PPODiag] kl_mean=0.0048, kl_p90=0.0072, kl_max=0.0091 | clipfrac_mean=0.034, logratio_std_mean=0.099, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.831, p10=0.826, min=0.825 | pg_loss_mean=0.0013, v_loss_mean=0.1688, ent_mean=0.1277 | gn_bb_mean=1.330, gn_bb_max=2.229 | gn_v_mean=0.736, gn_v_max=1.059
[AttnScore] scale=1.1045, C=10.0

  6%|▋         | 316/5000 [50:22<13:11:16, 10.14s/it]------------------ Training Record ------------------
Epoch: 316/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.792, reward_valid_mean=0.3130, reward_valid_std=2.2634
[BatchDiag] adv_mean=0.0076, adv_std=0.8881, adv_abs_mean=0.6728 | ret_mean=6.7268, ret_std=1.7677 | val_mean=6.7192, val_std=1.5346 | explained_var=0.747598
[GradSplit pre-clip] backbone=0.793740, critic=0.758963
[Loss] pg_loss=-0.060624, entropy_loss=0.000133, value_loss=0.036499
[EpochKL] epoch=0 mean_kl=0.00477 max_kl=0.00830
[EpochKL] epoch=1 mean_kl=0.00590 max_kl=0.00651
[EpochKL] epoch=2 mean_kl=0.00665 max_kl=0.00834
[Time] Env Create Time: 2.8523s |Rollout Collect Time: 3.4935s |Loss & Update :1.8733
[PPODiag] kl_mean=0.0058, kl_p90=0.0082, kl_max=0.0083 | clipfrac_mean=0.037, logratio_std_mean=0.109, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.792, p10=0.788, min=0.786 | pg_loss_mean=0.0022, v_loss_mean=0.1671, ent_mean=0.1237 | gn_bb_mean=1.497, gn_bb_max=2.552 | gn_v_mean=0.917, gn_v_max=1.848

  6%|▋         | 317/5000 [50:30<12:26:14,  9.56s/it]------------------ Training Record ------------------
Epoch: 317/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.829, reward_valid_mean=0.3148, reward_valid_std=2.2654
[BatchDiag] adv_mean=-0.0308, adv_std=0.8926, adv_abs_mean=0.6739 | ret_mean=6.7661, ret_std=1.7551 | val_mean=6.7969, val_std=1.5860 | explained_var=0.741342
[GradSplit pre-clip] backbone=0.549771, critic=0.634998
[Loss] pg_loss=-0.070622, entropy_loss=0.000134, value_loss=0.039230
[EpochKL] epoch=0 mean_kl=0.00257 max_kl=0.00391
[EpochKL] epoch=1 mean_kl=0.00456 max_kl=0.00608
[EpochKL] epoch=2 mean_kl=0.00672 max_kl=0.01189
[Time] Env Create Time: 2.8547s |Rollout Collect Time: 3.3434s |Loss & Update :1.8079
[PPODiag] kl_mean=0.0046, kl_p90=0.0064, kl_max=0.0119 | clipfrac_mean=0.031, logratio_std_mean=0.096, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.829, p10=0.824, min=0.823 | pg_loss_mean=0.0018, v_loss_mean=0.1694, ent_mean=0.1245 | gn_bb_mean=1.312, gn_bb_max=2.170 | gn_v_mean=1.385, gn_v_max=3.035

  6%|▋         | 318/5000 [50:38<11:49:41,  9.09s/it]------------------ Training Record ------------------
Epoch: 318/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3152, reward_valid_std=2.2657
[BatchDiag] adv_mean=-0.0145, adv_std=0.8938, adv_abs_mean=0.6687 | ret_mean=6.7537, ret_std=1.7486 | val_mean=6.7681, val_std=1.5635 | explained_var=0.738737
[GradSplit pre-clip] backbone=0.467650, critic=0.479495
[Loss] pg_loss=-0.027216, entropy_loss=0.000135, value_loss=0.039225
[EpochKL] epoch=0 mean_kl=0.00450 max_kl=0.00963
[EpochKL] epoch=1 mean_kl=0.00630 max_kl=0.00849
[EpochKL] epoch=2 mean_kl=0.00664 max_kl=0.00992
[Time] Env Create Time: 2.6802s |Rollout Collect Time: 3.3450s |Loss & Update :1.8086
[PPODiag] kl_mean=0.0058, kl_p90=0.0092, kl_max=0.0099 | clipfrac_mean=0.036, logratio_std_mean=0.108, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.827, p10=0.822, min=0.815 | pg_loss_mean=0.0023, v_loss_mean=0.1685, ent_mean=0.1253 | gn_bb_mean=1.408, gn_bb_max=2.431 | gn_v_mean=1.482, gn_v_max=2.809

  6%|▋         | 319/5000 [50:46<11:20:01,  8.72s/it]------------------ Training Record ------------------
Epoch: 319/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.757, reward_valid_mean=0.3147, reward_valid_std=2.2653
[BatchDiag] adv_mean=-0.0988, adv_std=0.8962, adv_abs_mean=0.6701 | ret_mean=6.7809, ret_std=1.7448 | val_mean=6.8797, val_std=1.5248 | explained_var=0.736174
[GradSplit pre-clip] backbone=0.578986, critic=0.490154
[Loss] pg_loss=-0.045646, entropy_loss=0.000114, value_loss=0.036241
[EpochKL] epoch=0 mean_kl=0.00293 max_kl=0.00405
[EpochKL] epoch=1 mean_kl=0.00807 max_kl=0.01043
[EarlyStop] epoch=2 mean_kl=0.01485 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01485 max_kl=0.01920
[Time] Env Create Time: 2.8299s |Rollout Collect Time: 3.6456s |Loss & Update :1.9512
[PPODiag] kl_mean=0.0086, kl_p90=0.0161, kl_max=0.0192 | clipfrac_mean=0.042, logratio_std_mean=0.134, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.757, p10=0.750, min=0.748 | pg_loss_mean=0.0033, v_loss_mean=0.1673, ent_mean=0.1132 | gn_bb_mean=1.592, gn_bb_max=2.672 | gn_v_mean=1.039, gn_v_max=2.062

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.793, Step: 20, Avg Done Step: 18.55, #CS visited: 0.33
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->C8->D->C6->C7->C11->C10->C9->D
Eval cost : 3.8934s
-----------------------------
  6%|▋         | 320/5000 [50:58<12:45:39,  9.82s/it]------------------ Training Record ------------------
Epoch: 320/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.829, reward_valid_mean=0.3158, reward_valid_std=2.2655
[BatchDiag] adv_mean=-0.1185, adv_std=0.8866, adv_abs_mean=0.6682 | ret_mean=6.7820, ret_std=1.7261 | val_mean=6.9004, val_std=1.4826 | explained_var=0.736166
[GradSplit pre-clip] backbone=0.784273, critic=0.497376
[Loss] pg_loss=-0.087488, entropy_loss=0.000141, value_loss=0.038691
[EpochKL] epoch=0 mean_kl=0.00636 max_kl=0.01197
[EpochKL] epoch=1 mean_kl=0.00926 max_kl=0.01347
[EpochKL] epoch=2 mean_kl=0.00980 max_kl=0.01230
[Time] Env Create Time: 2.8348s |Rollout Collect Time: 3.3470s |Loss & Update :1.8132
[PPODiag] kl_mean=0.0085, kl_p90=0.0118, kl_max=0.0135 | clipfrac_mean=0.045, logratio_std_mean=0.135, ratio_p95_mean=1.064 | valid_ratio_mb_mean=0.829, p10=0.822, min=0.820 | pg_loss_mean=0.0034, v_loss_mean=0.1650, ent_mean=0.1279 | gn_bb_mean=1.635, gn_bb_max=2.228 | gn_v_mean=0.901, gn_v_max=1.510
[AttnScore] scale=1.1066, C=10.0

  6%|▋         | 321/5000 [51:06<12:02:54,  9.27s/it]------------------ Training Record ------------------
Epoch: 321/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.3163, reward_valid_std=2.2673
[BatchDiag] adv_mean=-0.1217, adv_std=0.8832, adv_abs_mean=0.6709 | ret_mean=6.8021, ret_std=1.7263 | val_mean=6.9238, val_std=1.4850 | explained_var=0.738250
[GradSplit pre-clip] backbone=0.674390, critic=1.229177
[Loss] pg_loss=0.022358, entropy_loss=0.000136, value_loss=0.041253
[EpochKL] epoch=0 mean_kl=0.00422 max_kl=0.00636
[EpochKL] epoch=1 mean_kl=0.00559 max_kl=0.00998
[EpochKL] epoch=2 mean_kl=0.00671 max_kl=0.00885
[Time] Env Create Time: 2.8491s |Rollout Collect Time: 3.4969s |Loss & Update :1.8659
[PPODiag] kl_mean=0.0055, kl_p90=0.0084, kl_max=0.0100 | clipfrac_mean=0.035, logratio_std_mean=0.106, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.791, p10=0.785, min=0.784 | pg_loss_mean=0.0021, v_loss_mean=0.1663, ent_mean=0.1223 | gn_bb_mean=1.363, gn_bb_max=2.264 | gn_v_mean=1.266, gn_v_max=2.683

  6%|▋         | 322/5000 [51:14<11:38:00,  8.95s/it]------------------ Training Record ------------------
Epoch: 322/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.3153, reward_valid_std=2.2649
[BatchDiag] adv_mean=-0.0950, adv_std=0.8916, adv_abs_mean=0.6706 | ret_mean=6.7812, ret_std=1.7382 | val_mean=6.8762, val_std=1.5099 | explained_var=0.736898
[GradSplit pre-clip] backbone=0.380606, critic=0.696989
[Loss] pg_loss=-0.135982, entropy_loss=0.000121, value_loss=0.037447
[EpochKL] epoch=0 mean_kl=0.00439 max_kl=0.00748
[EarlyStop] epoch=1 mean_kl=0.01099 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01099 max_kl=0.01584
[Time] Env Create Time: 2.6831s |Rollout Collect Time: 3.4972s |Loss & Update :1.2602
[PPODiag] kl_mean=0.0077, kl_p90=0.0136, kl_max=0.0158 | clipfrac_mean=0.040, logratio_std_mean=0.126, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.791, p10=0.782, min=0.777 | pg_loss_mean=0.0028, v_loss_mean=0.1728, ent_mean=0.1183 | gn_bb_mean=1.582, gn_bb_max=2.417 | gn_v_mean=2.002, gn_v_max=3.583

  6%|▋         | 323/5000 [51:22<11:02:30,  8.50s/it]------------------ Training Record ------------------
Epoch: 323/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3139, reward_valid_std=2.2661
[BatchDiag] adv_mean=-0.1637, adv_std=0.8887, adv_abs_mean=0.6738 | ret_mean=6.7896, ret_std=1.7303 | val_mean=6.9533, val_std=1.4997 | explained_var=0.736206
[GradSplit pre-clip] backbone=0.603098, critic=0.932172
[Loss] pg_loss=-0.085590, entropy_loss=0.000137, value_loss=0.037890
[EpochKL] epoch=0 mean_kl=0.00577 max_kl=0.00898
[EpochKL] epoch=1 mean_kl=0.00951 max_kl=0.01606
[EpochKL] epoch=2 mean_kl=0.00906 max_kl=0.01220
[Time] Env Create Time: 2.8363s |Rollout Collect Time: 3.3446s |Loss & Update :1.8036
[PPODiag] kl_mean=0.0081, kl_p90=0.0118, kl_max=0.0161 | clipfrac_mean=0.045, logratio_std_mean=0.131, ratio_p95_mean=1.063 | valid_ratio_mb_mean=0.827, p10=0.822, min=0.817 | pg_loss_mean=0.0034, v_loss_mean=0.1662, ent_mean=0.1252 | gn_bb_mean=1.668, gn_bb_max=2.501 | gn_v_mean=1.017, gn_v_max=2.405

  6%|▋         | 324/5000 [51:30<10:50:20,  8.34s/it]------------------ Training Record ------------------
Epoch: 324/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.828, reward_valid_mean=0.3152, reward_valid_std=2.2653
[BatchDiag] adv_mean=-0.1610, adv_std=0.8913, adv_abs_mean=0.6747 | ret_mean=6.8004, ret_std=1.7184 | val_mean=6.9614, val_std=1.4486 | explained_var=0.730968
[GradSplit pre-clip] backbone=0.606491, critic=0.560203
[Loss] pg_loss=-0.102427, entropy_loss=0.000127, value_loss=0.037989
[EpochKL] epoch=0 mean_kl=0.00442 max_kl=0.00753
[EpochKL] epoch=1 mean_kl=0.00538 max_kl=0.00835
[EpochKL] epoch=2 mean_kl=0.00807 max_kl=0.00998
[Time] Env Create Time: 2.8599s |Rollout Collect Time: 3.3519s |Loss & Update :1.8052
[PPODiag] kl_mean=0.0060, kl_p90=0.0086, kl_max=0.0100 | clipfrac_mean=0.037, logratio_std_mean=0.109, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.828, p10=0.822, min=0.817 | pg_loss_mean=0.0022, v_loss_mean=0.1722, ent_mean=0.1255 | gn_bb_mean=1.471, gn_bb_max=2.329 | gn_v_mean=1.903, gn_v_max=4.175

  6%|▋         | 325/5000 [51:38<10:42:33,  8.25s/it]------------------ Training Record ------------------
Epoch: 325/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3166, reward_valid_std=2.2676
[BatchDiag] adv_mean=-0.2564, adv_std=0.8667, adv_abs_mean=0.6821 | ret_mean=6.8316, ret_std=1.6820 | val_mean=7.0880, val_std=1.4507 | explained_var=0.734493
[GradSplit pre-clip] backbone=0.689764, critic=1.750628
[Loss] pg_loss=-0.076765, entropy_loss=0.000136, value_loss=0.039165
[EpochKL] epoch=0 mean_kl=0.00417 max_kl=0.00821
[EpochKL] epoch=1 mean_kl=0.00610 max_kl=0.00855
[EpochKL] epoch=2 mean_kl=0.00660 max_kl=0.00984
[Time] Env Create Time: 2.8667s |Rollout Collect Time: 3.3462s |Loss & Update :1.8099
[PPODiag] kl_mean=0.0056, kl_p90=0.0083, kl_max=0.0098 | clipfrac_mean=0.036, logratio_std_mean=0.108, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.826, p10=0.820, min=0.816 | pg_loss_mean=0.0023, v_loss_mean=0.1710, ent_mean=0.1234 | gn_bb_mean=1.386, gn_bb_max=1.883 | gn_v_mean=2.208, gn_v_max=3.942
[AttnScore] scale=1.1082, C=10.0

  7%|▋         | 326/5000 [51:46<10:37:11,  8.18s/it]------------------ Training Record ------------------
Epoch: 326/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=24, valid_ratio=0.724, reward_valid_mean=0.3129, reward_valid_std=2.2632
[BatchDiag] adv_mean=-0.2758, adv_std=0.8846, adv_abs_mean=0.6831 | ret_mean=6.8163, ret_std=1.6999 | val_mean=7.0921, val_std=1.4855 | explained_var=0.729179
[GradSplit pre-clip] backbone=0.375723, critic=1.649326
[Loss] pg_loss=-0.073791, entropy_loss=0.000105, value_loss=0.036490
[EpochKL] epoch=0 mean_kl=0.00345 max_kl=0.00720
[EpochKL] epoch=1 mean_kl=0.00536 max_kl=0.00829
[EpochKL] epoch=2 mean_kl=0.00432 max_kl=0.00688
[Time] Env Create Time: 2.7025s |Rollout Collect Time: 3.7993s |Loss & Update :2.0242
[PPODiag] kl_mean=0.0044, kl_p90=0.0064, kl_max=0.0083 | clipfrac_mean=0.031, logratio_std_mean=0.094, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.724, p10=0.721, min=0.717 | pg_loss_mean=0.0019, v_loss_mean=0.1701, ent_mean=0.1084 | gn_bb_mean=1.220, gn_bb_max=2.171 | gn_v_mean=1.702, gn_v_max=2.942

  7%|▋         | 327/5000 [51:54<10:45:09,  8.28s/it]------------------ Training Record ------------------
Epoch: 327/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3141, reward_valid_std=2.2669
[BatchDiag] adv_mean=-0.2422, adv_std=0.9050, adv_abs_mean=0.6932 | ret_mean=6.7992, ret_std=1.7068 | val_mean=7.0414, val_std=1.4660 | explained_var=0.718861
[GradSplit pre-clip] backbone=0.473914, critic=1.035629
[Loss] pg_loss=-0.123348, entropy_loss=0.000127, value_loss=0.038032
[EpochKL] epoch=0 mean_kl=0.00230 max_kl=0.00378
[EpochKL] epoch=1 mean_kl=0.00389 max_kl=0.00632
[EpochKL] epoch=2 mean_kl=0.00604 max_kl=0.00812
[Time] Env Create Time: 2.8457s |Rollout Collect Time: 3.3550s |Loss & Update :1.8207
[PPODiag] kl_mean=0.0041, kl_p90=0.0074, kl_max=0.0081 | clipfrac_mean=0.029, logratio_std_mean=0.091, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.826, p10=0.820, min=0.816 | pg_loss_mean=0.0011, v_loss_mean=0.1731, ent_mean=0.1251 | gn_bb_mean=1.210, gn_bb_max=2.007 | gn_v_mean=1.329, gn_v_max=2.672

  7%|▋         | 328/5000 [52:02<10:38:54,  8.21s/it]------------------ Training Record ------------------
Epoch: 328/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3157, reward_valid_std=2.2660
[BatchDiag] adv_mean=-0.1761, adv_std=0.8911, adv_abs_mean=0.6817 | ret_mean=6.7821, ret_std=1.7137 | val_mean=6.9582, val_std=1.4635 | explained_var=0.729599
[GradSplit pre-clip] backbone=0.473831, critic=1.144421
[Loss] pg_loss=-0.029727, entropy_loss=0.000134, value_loss=0.039385
[EpochKL] epoch=0 mean_kl=0.00244 max_kl=0.00420
[EpochKL] epoch=1 mean_kl=0.00492 max_kl=0.00856
[EpochKL] epoch=2 mean_kl=0.00502 max_kl=0.00645
[Time] Env Create Time: 2.8813s |Rollout Collect Time: 3.3505s |Loss & Update :1.8057
[PPODiag] kl_mean=0.0041, kl_p90=0.0064, kl_max=0.0086 | clipfrac_mean=0.030, logratio_std_mean=0.090, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.824, p10=0.820, min=0.817 | pg_loss_mean=0.0016, v_loss_mean=0.1683, ent_mean=0.1268 | gn_bb_mean=1.414, gn_bb_max=2.434 | gn_v_mean=1.077, gn_v_max=2.820

  7%|▋         | 329/5000 [52:10<10:34:52,  8.16s/it]------------------ Training Record ------------------
Epoch: 329/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3194, reward_valid_std=2.2690
[BatchDiag] adv_mean=-0.1039, adv_std=0.8782, adv_abs_mean=0.6620 | ret_mean=6.7801, ret_std=1.7094 | val_mean=6.8840, val_std=1.4871 | explained_var=0.736062
[GradSplit pre-clip] backbone=0.459386, critic=0.423230
[Loss] pg_loss=-0.058896, entropy_loss=0.000128, value_loss=0.037814
[EpochKL] epoch=0 mean_kl=0.00213 max_kl=0.00472
[EpochKL] epoch=1 mean_kl=0.00520 max_kl=0.00764
[EpochKL] epoch=2 mean_kl=0.00829 max_kl=0.01157
[Time] Env Create Time: 2.7032s |Rollout Collect Time: 3.3520s |Loss & Update :1.8065
[PPODiag] kl_mean=0.0052, kl_p90=0.0091, kl_max=0.0116 | clipfrac_mean=0.033, logratio_std_mean=0.100, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.824, p10=0.819, min=0.818 | pg_loss_mean=0.0022, v_loss_mean=0.1637, ent_mean=0.1247 | gn_bb_mean=1.383, gn_bb_max=2.148 | gn_v_mean=1.231, gn_v_max=2.424

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.803, Step: 20, Avg Done Step: 18.41, #CS visited: 0.38
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->C8->D->C6->C7->C11->C10->C9->D
Eval cost : 4.0747s
-----------------------------
  7%|▋         | 330/5000 [52:22<12:03:43,  9.30s/it]------------------ Training Record ------------------
Epoch: 330/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3157, reward_valid_std=2.2665
[BatchDiag] adv_mean=-0.1215, adv_std=0.8959, adv_abs_mean=0.6718 | ret_mean=6.7622, ret_std=1.7208 | val_mean=6.8837, val_std=1.5067 | explained_var=0.728932
[GradSplit pre-clip] backbone=0.601409, critic=0.359156
[Loss] pg_loss=-0.085746, entropy_loss=0.000133, value_loss=0.037043
[EpochKL] epoch=0 mean_kl=0.00329 max_kl=0.00578
[EpochKL] epoch=1 mean_kl=0.00558 max_kl=0.00683
[EpochKL] epoch=2 mean_kl=0.00688 max_kl=0.00851
[Time] Env Create Time: 2.6939s |Rollout Collect Time: 3.3559s |Loss & Update :1.7986
[PPODiag] kl_mean=0.0053, kl_p90=0.0072, kl_max=0.0085 | clipfrac_mean=0.035, logratio_std_mean=0.104, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.825, p10=0.819, min=0.817 | pg_loss_mean=0.0018, v_loss_mean=0.1693, ent_mean=0.1255 | gn_bb_mean=1.172, gn_bb_max=1.809 | gn_v_mean=1.330, gn_v_max=2.792
[AttnScore] scale=1.1106, C=10.0

  7%|▋         | 331/5000 [52:30<11:29:43,  8.86s/it]------------------ Training Record ------------------
Epoch: 331/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3173, reward_valid_std=2.2668
[BatchDiag] adv_mean=-0.1000, adv_std=0.8965, adv_abs_mean=0.6722 | ret_mean=6.7644, ret_std=1.7311 | val_mean=6.8644, val_std=1.5027 | explained_var=0.731824
[GradSplit pre-clip] backbone=0.575275, critic=0.354868
[Loss] pg_loss=-0.103818, entropy_loss=0.000127, value_loss=0.035473
[EpochKL] epoch=0 mean_kl=0.00311 max_kl=0.00466
[EpochKL] epoch=1 mean_kl=0.00397 max_kl=0.00640
[EpochKL] epoch=2 mean_kl=0.00527 max_kl=0.00668
[Time] Env Create Time: 2.8584s |Rollout Collect Time: 3.5130s |Loss & Update :1.8774
[PPODiag] kl_mean=0.0041, kl_p90=0.0058, kl_max=0.0067 | clipfrac_mean=0.030, logratio_std_mean=0.092, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.787, p10=0.780, min=0.778 | pg_loss_mean=0.0015, v_loss_mean=0.1680, ent_mean=0.1210 | gn_bb_mean=1.269, gn_bb_max=1.885 | gn_v_mean=1.109, gn_v_max=2.541

  7%|▋         | 332/5000 [52:38<11:15:14,  8.68s/it]------------------ Training Record ------------------
Epoch: 332/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3134, reward_valid_std=2.2667
[BatchDiag] adv_mean=-0.0851, adv_std=0.9018, adv_abs_mean=0.6798 | ret_mean=6.7172, ret_std=1.7437 | val_mean=6.8023, val_std=1.4897 | explained_var=0.732508
[GradSplit pre-clip] backbone=0.461438, critic=0.776769
[Loss] pg_loss=-0.157378, entropy_loss=0.000132, value_loss=0.037126
[EpochKL] epoch=0 mean_kl=0.00258 max_kl=0.00380
[EpochKL] epoch=1 mean_kl=0.00540 max_kl=0.01059
[EpochKL] epoch=2 mean_kl=0.00792 max_kl=0.01026
[Time] Env Create Time: 2.8606s |Rollout Collect Time: 3.3568s |Loss & Update :1.8119
[PPODiag] kl_mean=0.0053, kl_p90=0.0098, kl_max=0.0106 | clipfrac_mean=0.034, logratio_std_mean=0.102, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.826, p10=0.820, min=0.817 | pg_loss_mean=0.0019, v_loss_mean=0.1702, ent_mean=0.1292 | gn_bb_mean=1.294, gn_bb_max=1.974 | gn_v_mean=1.179, gn_v_max=2.359

  7%|▋         | 333/5000 [52:46<10:59:56,  8.48s/it]------------------ Training Record ------------------
Epoch: 333/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=37, valid_ratio=0.468, reward_valid_mean=0.3167, reward_valid_std=2.2653
[BatchDiag] adv_mean=-0.0715, adv_std=0.9085, adv_abs_mean=0.6811 | ret_mean=6.7322, ret_std=1.7336 | val_mean=6.8037, val_std=1.5096 | explained_var=0.725326
[GradSplit pre-clip] backbone=0.642773, critic=0.517482
[Loss] pg_loss=-0.087612, entropy_loss=0.000075, value_loss=0.037993
[EpochKL] epoch=0 mean_kl=0.00291 max_kl=0.00416
[EpochKL] epoch=1 mean_kl=0.00427 max_kl=0.00605
[EpochKL] epoch=2 mean_kl=0.00450 max_kl=0.00665
[Time] Env Create Time: 2.6991s |Rollout Collect Time: 5.7508s |Loss & Update :2.9888
[PPODiag] kl_mean=0.0039, kl_p90=0.0050, kl_max=0.0066 | clipfrac_mean=0.030, logratio_std_mean=0.089, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.468, p10=0.464, min=0.462 | pg_loss_mean=0.0013, v_loss_mean=0.1722, ent_mean=0.0728 | gn_bb_mean=1.289, gn_bb_max=2.199 | gn_v_mean=1.250, gn_v_max=2.250

  7%|▋         | 334/5000 [52:58<12:08:44,  9.37s/it]------------------ Training Record ------------------
Epoch: 334/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.752, reward_valid_mean=0.3158, reward_valid_std=2.2681
[BatchDiag] adv_mean=-0.1091, adv_std=0.9084, adv_abs_mean=0.6888 | ret_mean=6.7308, ret_std=1.7362 | val_mean=6.8399, val_std=1.4786 | explained_var=0.726211
[GradSplit pre-clip] backbone=0.543730, critic=0.471615
[Loss] pg_loss=-0.055697, entropy_loss=0.000126, value_loss=0.044227
[EpochKL] epoch=0 mean_kl=0.00280 max_kl=0.00456
[EpochKL] epoch=1 mean_kl=0.00414 max_kl=0.00741
[EpochKL] epoch=2 mean_kl=0.00607 max_kl=0.00797
[Time] Env Create Time: 2.8521s |Rollout Collect Time: 3.6500s |Loss & Update :1.9518
[PPODiag] kl_mean=0.0043, kl_p90=0.0072, kl_max=0.0080 | clipfrac_mean=0.030, logratio_std_mean=0.094, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.752, p10=0.748, min=0.747 | pg_loss_mean=0.0016, v_loss_mean=0.1741, ent_mean=0.1153 | gn_bb_mean=1.102, gn_bb_max=1.833 | gn_v_mean=1.413, gn_v_max=2.986

  7%|▋         | 335/5000 [53:06<11:47:12,  9.10s/it]------------------ Training Record ------------------
Epoch: 335/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3161, reward_valid_std=2.2671
[BatchDiag] adv_mean=-0.0425, adv_std=0.8930, adv_abs_mean=0.6741 | ret_mean=6.7362, ret_std=1.7422 | val_mean=6.7788, val_std=1.5113 | explained_var=0.737292
[GradSplit pre-clip] backbone=0.463731, critic=0.735762
[Loss] pg_loss=-0.103066, entropy_loss=0.000130, value_loss=0.038597
[EpochKL] epoch=0 mean_kl=0.00575 max_kl=0.01266
[EpochKL] epoch=1 mean_kl=0.00851 max_kl=0.01623
[EpochKL] epoch=2 mean_kl=0.00678 max_kl=0.00953
[Time] Env Create Time: 2.8675s |Rollout Collect Time: 3.5010s |Loss & Update :1.8705
[PPODiag] kl_mean=0.0070, kl_p90=0.0096, kl_max=0.0162 | clipfrac_mean=0.039, logratio_std_mean=0.121, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.787, p10=0.781, min=0.778 | pg_loss_mean=0.0028, v_loss_mean=0.1689, ent_mean=0.1199 | gn_bb_mean=1.532, gn_bb_max=2.685 | gn_v_mean=1.146, gn_v_max=2.774
[AttnScore] scale=1.1125, C=10.0

  7%|▋         | 336/5000 [53:15<11:27:04,  8.84s/it]------------------ Training Record ------------------
Epoch: 336/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3152, reward_valid_std=2.2635
[BatchDiag] adv_mean=-0.0394, adv_std=0.9038, adv_abs_mean=0.6777 | ret_mean=6.7277, ret_std=1.7441 | val_mean=6.7671, val_std=1.5011 | explained_var=0.731479
[GradSplit pre-clip] backbone=0.380998, critic=0.957221
[Loss] pg_loss=-0.103185, entropy_loss=0.000120, value_loss=0.037713
[EpochKL] epoch=0 mean_kl=0.00250 max_kl=0.00387
[EpochKL] epoch=1 mean_kl=0.00518 max_kl=0.00779
[EpochKL] epoch=2 mean_kl=0.00468 max_kl=0.00674
[Time] Env Create Time: 2.8720s |Rollout Collect Time: 3.3475s |Loss & Update :1.8019
[PPODiag] kl_mean=0.0041, kl_p90=0.0063, kl_max=0.0078 | clipfrac_mean=0.030, logratio_std_mean=0.090, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.827, p10=0.822, min=0.817 | pg_loss_mean=0.0014, v_loss_mean=0.1691, ent_mean=0.1239 | gn_bb_mean=1.151, gn_bb_max=1.679 | gn_v_mean=0.856, gn_v_max=2.200

  7%|▋         | 337/5000 [53:23<11:07:52,  8.59s/it]------------------ Training Record ------------------
Epoch: 337/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3144, reward_valid_std=2.2647
[BatchDiag] adv_mean=-0.1386, adv_std=0.8803, adv_abs_mean=0.6659 | ret_mean=6.7559, ret_std=1.7284 | val_mean=6.8945, val_std=1.5026 | explained_var=0.740624
[GradSplit pre-clip] backbone=0.487494, critic=0.921524
[Loss] pg_loss=-0.024469, entropy_loss=0.000136, value_loss=0.039067
[EpochKL] epoch=0 mean_kl=0.00237 max_kl=0.00329
[EpochKL] epoch=1 mean_kl=0.00488 max_kl=0.00661
[EpochKL] epoch=2 mean_kl=0.00616 max_kl=0.00909
[Time] Env Create Time: 2.7281s |Rollout Collect Time: 3.3628s |Loss & Update :1.7986
[PPODiag] kl_mean=0.0045, kl_p90=0.0074, kl_max=0.0091 | clipfrac_mean=0.031, logratio_std_mean=0.094, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.827, p10=0.822, min=0.820 | pg_loss_mean=0.0017, v_loss_mean=0.1652, ent_mean=0.1301 | gn_bb_mean=1.270, gn_bb_max=2.233 | gn_v_mean=1.374, gn_v_max=2.236

  7%|▋         | 338/5000 [53:30<10:51:19,  8.38s/it]------------------ Training Record ------------------
Epoch: 338/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.828, reward_valid_mean=0.3151, reward_valid_std=2.2623
[BatchDiag] adv_mean=-0.0990, adv_std=0.8929, adv_abs_mean=0.6699 | ret_mean=6.7481, ret_std=1.7367 | val_mean=6.8471, val_std=1.4813 | explained_var=0.735660
[GradSplit pre-clip] backbone=0.641826, critic=0.449354
[Loss] pg_loss=-0.050516, entropy_loss=0.000128, value_loss=0.039739
[EpochKL] epoch=0 mean_kl=0.00491 max_kl=0.00730
[EpochKL] epoch=1 mean_kl=0.00731 max_kl=0.00920
[EpochKL] epoch=2 mean_kl=0.00816 max_kl=0.00984
[Time] Env Create Time: 2.8751s |Rollout Collect Time: 3.3453s |Loss & Update :1.8035
[PPODiag] kl_mean=0.0068, kl_p90=0.0091, kl_max=0.0098 | clipfrac_mean=0.040, logratio_std_mean=0.120, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.828, p10=0.821, min=0.820 | pg_loss_mean=0.0026, v_loss_mean=0.1675, ent_mean=0.1287 | gn_bb_mean=1.385, gn_bb_max=1.960 | gn_v_mean=1.021, gn_v_max=2.539

  7%|▋         | 339/5000 [53:39<10:42:50,  8.28s/it]------------------ Training Record ------------------
Epoch: 339/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.828, reward_valid_mean=0.3161, reward_valid_std=2.2652
[BatchDiag] adv_mean=-0.0013, adv_std=0.8973, adv_abs_mean=0.6822 | ret_mean=6.7221, ret_std=1.7574 | val_mean=6.7235, val_std=1.5067 | explained_var=0.739289
[GradSplit pre-clip] backbone=0.593056, critic=0.596723
[Loss] pg_loss=-0.022731, entropy_loss=0.000143, value_loss=0.039036
[EpochKL] epoch=0 mean_kl=0.00509 max_kl=0.00763
[EpochKL] epoch=1 mean_kl=0.00533 max_kl=0.00699
[EpochKL] epoch=2 mean_kl=0.00411 max_kl=0.00615
[Time] Env Create Time: 2.8575s |Rollout Collect Time: 3.3542s |Loss & Update :1.8088
[PPODiag] kl_mean=0.0048, kl_p90=0.0067, kl_max=0.0076 | clipfrac_mean=0.033, logratio_std_mean=0.100, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.828, p10=0.824, min=0.821 | pg_loss_mean=0.0020, v_loss_mean=0.1708, ent_mean=0.1289 | gn_bb_mean=1.302, gn_bb_max=2.091 | gn_v_mean=1.150, gn_v_max=3.117

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.791, Step: 21, Avg Done Step: 18.46, #CS visited: 0.36
D->C12->C1->C15->C3->C5->C2->D->C4->C14->C8->D->C13->C6->C7->C11->C10->C9->D
Eval cost : 4.0442s
-----------------------------
  7%|▋         | 340/5000 [53:51<12:12:10,  9.43s/it]------------------ Training Record ------------------
Epoch: 340/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=28, valid_ratio=0.621, reward_valid_mean=0.3145, reward_valid_std=2.2638
[BatchDiag] adv_mean=-0.1608, adv_std=0.9301, adv_abs_mean=0.6875 | ret_mean=6.7693, ret_std=1.7478 | val_mean=6.9301, val_std=1.4961 | explained_var=0.716838
[GradSplit pre-clip] backbone=0.490374, critic=0.538510
[Loss] pg_loss=-0.087242, entropy_loss=0.000094, value_loss=0.038795
[EpochKL] epoch=0 mean_kl=0.00304 max_kl=0.00481
[EpochKL] epoch=1 mean_kl=0.00436 max_kl=0.00604
[EpochKL] epoch=2 mean_kl=0.00518 max_kl=0.00706
[Time] Env Create Time: 2.8785s |Rollout Collect Time: 4.4158s |Loss & Update :2.3067
[PPODiag] kl_mean=0.0042, kl_p90=0.0056, kl_max=0.0071 | clipfrac_mean=0.031, logratio_std_mean=0.093, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.621, p10=0.616, min=0.613 | pg_loss_mean=0.0016, v_loss_mean=0.1752, ent_mean=0.0952 | gn_bb_mean=1.228, gn_bb_max=2.140 | gn_v_mean=1.091, gn_v_max=2.168
[AttnScore] scale=1.1144, C=10.0

  7%|▋         | 341/5000 [54:00<12:16:05,  9.48s/it]------------------ Training Record ------------------
Epoch: 341/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.828, reward_valid_mean=0.3155, reward_valid_std=2.2629
[BatchDiag] adv_mean=-0.1225, adv_std=0.8907, adv_abs_mean=0.6644 | ret_mean=6.7823, ret_std=1.7304 | val_mean=6.9049, val_std=1.5269 | explained_var=0.735056
[GradSplit pre-clip] backbone=0.582915, critic=0.787578
[Loss] pg_loss=-0.012325, entropy_loss=0.000132, value_loss=0.039999
[EpochKL] epoch=0 mean_kl=0.00332 max_kl=0.00541
[EpochKL] epoch=1 mean_kl=0.00512 max_kl=0.00665
[EpochKL] epoch=2 mean_kl=0.00536 max_kl=0.00790
[Time] Env Create Time: 2.7070s |Rollout Collect Time: 3.3707s |Loss & Update :1.8094
[PPODiag] kl_mean=0.0046, kl_p90=0.0065, kl_max=0.0079 | clipfrac_mean=0.032, logratio_std_mean=0.097, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.828, p10=0.824, min=0.823 | pg_loss_mean=0.0016, v_loss_mean=0.1645, ent_mean=0.1270 | gn_bb_mean=1.230, gn_bb_max=1.970 | gn_v_mean=0.693, gn_v_max=1.387

  7%|▋         | 342/5000 [54:08<11:38:50,  9.00s/it]------------------ Training Record ------------------
Epoch: 342/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3162, reward_valid_std=2.2638
[BatchDiag] adv_mean=-0.0664, adv_std=0.8920, adv_abs_mean=0.6685 | ret_mean=6.7483, ret_std=1.7424 | val_mean=6.8147, val_std=1.5100 | explained_var=0.737897
[GradSplit pre-clip] backbone=0.456683, critic=0.463118
[Loss] pg_loss=-0.011260, entropy_loss=0.000131, value_loss=0.038399
[EpochKL] epoch=0 mean_kl=0.00449 max_kl=0.00831
[EpochKL] epoch=1 mean_kl=0.00683 max_kl=0.01028
[EpochKL] epoch=2 mean_kl=0.00612 max_kl=0.00846
[Time] Env Create Time: 2.8459s |Rollout Collect Time: 3.3620s |Loss & Update :1.8167
[PPODiag] kl_mean=0.0058, kl_p90=0.0084, kl_max=0.0103 | clipfrac_mean=0.038, logratio_std_mean=0.109, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.827, p10=0.821, min=0.818 | pg_loss_mean=0.0025, v_loss_mean=0.1665, ent_mean=0.1292 | gn_bb_mean=1.556, gn_bb_max=3.127 | gn_v_mean=0.886, gn_v_max=2.431

  7%|▋         | 343/5000 [54:16<11:15:57,  8.71s/it]------------------ Training Record ------------------
Epoch: 343/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3180, reward_valid_std=2.2654
[BatchDiag] adv_mean=-0.0627, adv_std=0.8802, adv_abs_mean=0.6597 | ret_mean=6.7803, ret_std=1.7222 | val_mean=6.8430, val_std=1.5049 | explained_var=0.738799
[GradSplit pre-clip] backbone=0.470294, critic=0.430149
[Loss] pg_loss=-0.041960, entropy_loss=0.000126, value_loss=0.038006
[EpochKL] epoch=0 mean_kl=0.00349 max_kl=0.00628
[EpochKL] epoch=1 mean_kl=0.00543 max_kl=0.00820
[EpochKL] epoch=2 mean_kl=0.00878 max_kl=0.02050
[Time] Env Create Time: 2.8771s |Rollout Collect Time: 3.5254s |Loss & Update :1.8791
[PPODiag] kl_mean=0.0059, kl_p90=0.0087, kl_max=0.0205 | clipfrac_mean=0.036, logratio_std_mean=0.109, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.790, p10=0.785, min=0.782 | pg_loss_mean=0.0022, v_loss_mean=0.1621, ent_mean=0.1179 | gn_bb_mean=1.337, gn_bb_max=1.949 | gn_v_mean=0.782, gn_v_max=1.419

  7%|▋         | 344/5000 [54:24<11:05:52,  8.58s/it]------------------ Training Record ------------------
Epoch: 344/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3161, reward_valid_std=2.2658
[BatchDiag] adv_mean=-0.0911, adv_std=0.8861, adv_abs_mean=0.6686 | ret_mean=6.7711, ret_std=1.7313 | val_mean=6.8621, val_std=1.4786 | explained_var=0.738036
[GradSplit pre-clip] backbone=0.586412, critic=0.485597
[Loss] pg_loss=-0.069648, entropy_loss=0.000124, value_loss=0.037734
[EpochKL] epoch=0 mean_kl=0.00392 max_kl=0.00585
[EpochKL] epoch=1 mean_kl=0.00755 max_kl=0.01149
[EarlyStop] epoch=2 mean_kl=0.01028 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01028 max_kl=0.01670
[Time] Env Create Time: 2.8650s |Rollout Collect Time: 3.5090s |Loss & Update :1.8683
[PPODiag] kl_mean=0.0073, kl_p90=0.0105, kl_max=0.0167 | clipfrac_mean=0.041, logratio_std_mean=0.123, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.790, p10=0.786, min=0.783 | pg_loss_mean=0.0028, v_loss_mean=0.1649, ent_mean=0.1191 | gn_bb_mean=1.484, gn_bb_max=2.132 | gn_v_mean=0.687, gn_v_max=1.488

  7%|▋         | 345/5000 [54:33<10:57:51,  8.48s/it]------------------ Training Record ------------------
Epoch: 345/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3155, reward_valid_std=2.2638
[BatchDiag] adv_mean=-0.0362, adv_std=0.9082, adv_abs_mean=0.6806 | ret_mean=6.7423, ret_std=1.7484 | val_mean=6.7786, val_std=1.5260 | explained_var=0.730184
[GradSplit pre-clip] backbone=0.475757, critic=0.299383
[Loss] pg_loss=-0.010519, entropy_loss=0.000116, value_loss=0.038609
[EpochKL] epoch=0 mean_kl=0.00313 max_kl=0.00554
[EpochKL] epoch=1 mean_kl=0.00669 max_kl=0.00965
[EpochKL] epoch=2 mean_kl=0.00827 max_kl=0.01034
[Time] Env Create Time: 2.7032s |Rollout Collect Time: 3.5017s |Loss & Update :1.8774
[PPODiag] kl_mean=0.0060, kl_p90=0.0096, kl_max=0.0103 | clipfrac_mean=0.037, logratio_std_mean=0.111, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.790, p10=0.786, min=0.784 | pg_loss_mean=0.0025, v_loss_mean=0.1721, ent_mean=0.1155 | gn_bb_mean=1.272, gn_bb_max=1.779 | gn_v_mean=1.286, gn_v_max=3.745
[AttnScore] scale=1.1169, C=10.0

  7%|▋         | 346/5000 [54:41<10:48:29,  8.36s/it]------------------ Training Record ------------------
Epoch: 346/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=26, valid_ratio=0.669, reward_valid_mean=0.3166, reward_valid_std=2.2663
[BatchDiag] adv_mean=-0.1545, adv_std=0.8852, adv_abs_mean=0.6686 | ret_mean=6.7990, ret_std=1.7238 | val_mean=6.9535, val_std=1.4855 | explained_var=0.736329
[GradSplit pre-clip] backbone=0.722683, critic=0.885780
[Loss] pg_loss=-0.044152, entropy_loss=0.000101, value_loss=0.037425
[EpochKL] epoch=0 mean_kl=0.00648 max_kl=0.01343
[EarlyStop] epoch=1 mean_kl=0.01484 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01484 max_kl=0.02350
[Time] Env Create Time: 2.8610s |Rollout Collect Time: 4.1055s |Loss & Update :1.4463
[PPODiag] kl_mean=0.0107, kl_p90=0.0181, kl_max=0.0235 | clipfrac_mean=0.047, logratio_std_mean=0.150, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.669, p10=0.665, min=0.661 | pg_loss_mean=0.0042, v_loss_mean=0.1662, ent_mean=0.0983 | gn_bb_mean=1.708, gn_bb_max=2.593 | gn_v_mean=1.280, gn_v_max=2.122

  7%|▋         | 347/5000 [54:49<10:49:34,  8.38s/it]------------------ Training Record ------------------
Epoch: 347/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.757, reward_valid_mean=0.3163, reward_valid_std=2.2646
[BatchDiag] adv_mean=-0.0864, adv_std=0.8901, adv_abs_mean=0.6608 | ret_mean=6.7773, ret_std=1.7404 | val_mean=6.8637, val_std=1.5243 | explained_var=0.738453
[GradSplit pre-clip] backbone=0.519643, critic=0.492393
[Loss] pg_loss=-0.040225, entropy_loss=0.000115, value_loss=0.040907
[EpochKL] epoch=0 mean_kl=0.00543 max_kl=0.00781
[EpochKL] epoch=1 mean_kl=0.00630 max_kl=0.00966
[EpochKL] epoch=2 mean_kl=0.00579 max_kl=0.00787
[Time] Env Create Time: 2.8862s |Rollout Collect Time: 3.6677s |Loss & Update :1.9462
[PPODiag] kl_mean=0.0058, kl_p90=0.0079, kl_max=0.0097 | clipfrac_mean=0.035, logratio_std_mean=0.111, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.757, p10=0.752, min=0.750 | pg_loss_mean=0.0025, v_loss_mean=0.1684, ent_mean=0.1107 | gn_bb_mean=1.342, gn_bb_max=2.062 | gn_v_mean=1.803, gn_v_max=3.623

  7%|▋         | 348/5000 [54:58<10:52:19,  8.41s/it]------------------ Training Record ------------------
Epoch: 348/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3152, reward_valid_std=2.2680
[BatchDiag] adv_mean=-0.2526, adv_std=0.8890, adv_abs_mean=0.6916 | ret_mean=6.8103, ret_std=1.7122 | val_mean=7.0629, val_std=1.4425 | explained_var=0.730414
[GradSplit pre-clip] backbone=0.489895, critic=2.001783
[Loss] pg_loss=-0.047135, entropy_loss=0.000134, value_loss=0.037559
[EpochKL] epoch=0 mean_kl=0.00235 max_kl=0.00622
[EpochKL] epoch=1 mean_kl=0.00422 max_kl=0.00843
[EpochKL] epoch=2 mean_kl=0.00410 max_kl=0.00558
[Time] Env Create Time: 2.7419s |Rollout Collect Time: 3.3575s |Loss & Update :1.8041
[PPODiag] kl_mean=0.0036, kl_p90=0.0055, kl_max=0.0084 | clipfrac_mean=0.027, logratio_std_mean=0.083, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.827, p10=0.822, min=0.818 | pg_loss_mean=0.0012, v_loss_mean=0.1688, ent_mean=0.1227 | gn_bb_mean=1.176, gn_bb_max=1.992 | gn_v_mean=1.288, gn_v_max=2.477

  7%|▋         | 349/5000 [55:06<10:40:20,  8.26s/it]------------------ Training Record ------------------
Epoch: 349/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3188, reward_valid_std=2.2674
[BatchDiag] adv_mean=-0.1906, adv_std=0.8961, adv_abs_mean=0.6825 | ret_mean=6.8122, ret_std=1.7006 | val_mean=7.0028, val_std=1.4391 | explained_var=0.722345
[GradSplit pre-clip] backbone=0.463355, critic=1.596251
[Loss] pg_loss=-0.023337, entropy_loss=0.000116, value_loss=0.039470
[EpochKL] epoch=0 mean_kl=0.00243 max_kl=0.00446
[EpochKL] epoch=1 mean_kl=0.00354 max_kl=0.00548
[EpochKL] epoch=2 mean_kl=0.00865 max_kl=0.01896
[Time] Env Create Time: 2.8500s |Rollout Collect Time: 3.4899s |Loss & Update :1.8801
[PPODiag] kl_mean=0.0049, kl_p90=0.0089, kl_max=0.0190 | clipfrac_mean=0.030, logratio_std_mean=0.095, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.780 | pg_loss_mean=0.0019, v_loss_mean=0.1671, ent_mean=0.1168 | gn_bb_mean=1.209, gn_bb_max=2.116 | gn_v_mean=0.993, gn_v_max=1.829

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.746, Step: 20, Avg Done Step: 18.45, #CS visited: 0.36
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->D->C6->C7->C11->C10->C9->C8->D
Eval cost : 3.9059s
-----------------------------
  7%|▋         | 350/5000 [55:18<12:11:25,  9.44s/it]------------------ Training Record ------------------
Epoch: 350/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3138, reward_valid_std=2.2662
[BatchDiag] adv_mean=-0.2049, adv_std=0.9180, adv_abs_mean=0.7012 | ret_mean=6.7640, ret_std=1.7295 | val_mean=6.9689, val_std=1.4243 | explained_var=0.718285
[GradSplit pre-clip] backbone=0.690213, critic=1.164059
[Loss] pg_loss=-0.069973, entropy_loss=0.000121, value_loss=0.038401
[EpochKL] epoch=0 mean_kl=0.00281 max_kl=0.00559
[EpochKL] epoch=1 mean_kl=0.00508 max_kl=0.00850
[EpochKL] epoch=2 mean_kl=0.00674 max_kl=0.00948
[Time] Env Create Time: 2.8629s |Rollout Collect Time: 3.5067s |Loss & Update :1.8730
[PPODiag] kl_mean=0.0049, kl_p90=0.0071, kl_max=0.0095 | clipfrac_mean=0.032, logratio_std_mean=0.099, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.789, p10=0.784, min=0.781 | pg_loss_mean=0.0018, v_loss_mean=0.1755, ent_mean=0.1164 | gn_bb_mean=1.317, gn_bb_max=2.071 | gn_v_mean=1.158, gn_v_max=2.541
[AttnScore] scale=1.1188, C=10.0

  7%|▋         | 351/5000 [55:26<11:43:30,  9.08s/it]------------------ Training Record ------------------
Epoch: 351/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3149, reward_valid_std=2.2683
[BatchDiag] adv_mean=-0.0642, adv_std=0.9206, adv_abs_mean=0.6937 | ret_mean=6.7316, ret_std=1.7381 | val_mean=6.7958, val_std=1.4705 | explained_var=0.719478
[GradSplit pre-clip] backbone=0.596377, critic=0.574439
[Loss] pg_loss=-0.026220, entropy_loss=0.000124, value_loss=0.043850
[EpochKL] epoch=0 mean_kl=0.00248 max_kl=0.00512
[EpochKL] epoch=1 mean_kl=0.00497 max_kl=0.00612
[EpochKL] epoch=2 mean_kl=0.00749 max_kl=0.01105
[Time] Env Create Time: 2.8671s |Rollout Collect Time: 3.5363s |Loss & Update :1.8742
[PPODiag] kl_mean=0.0050, kl_p90=0.0084, kl_max=0.0110 | clipfrac_mean=0.033, logratio_std_mean=0.099, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.789, p10=0.782, min=0.781 | pg_loss_mean=0.0020, v_loss_mean=0.1751, ent_mean=0.1152 | gn_bb_mean=1.374, gn_bb_max=2.131 | gn_v_mean=0.958, gn_v_max=2.250

  7%|▋         | 352/5000 [55:34<11:24:43,  8.84s/it]------------------ Training Record ------------------
Epoch: 352/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3196, reward_valid_std=2.2710
[BatchDiag] adv_mean=-0.0951, adv_std=0.8995, adv_abs_mean=0.6792 | ret_mean=6.7822, ret_std=1.7165 | val_mean=6.8772, val_std=1.4746 | explained_var=0.725421
[GradSplit pre-clip] backbone=0.644909, critic=0.513444
[Loss] pg_loss=-0.045996, entropy_loss=0.000123, value_loss=0.038705
[EpochKL] epoch=0 mean_kl=0.00558 max_kl=0.01386
[EarlyStop] epoch=1 mean_kl=0.01151 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01151 max_kl=0.01347
[Time] Env Create Time: 2.8758s |Rollout Collect Time: 3.3718s |Loss & Update :1.2189
[PPODiag] kl_mean=0.0085, kl_p90=0.0133, kl_max=0.0139 | clipfrac_mean=0.041, logratio_std_mean=0.131, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.824, p10=0.818, min=0.815 | pg_loss_mean=0.0036, v_loss_mean=0.1707, ent_mean=0.1169 | gn_bb_mean=1.704, gn_bb_max=2.549 | gn_v_mean=1.057, gn_v_max=2.914

  7%|▋         | 353/5000 [55:42<10:52:41,  8.43s/it]------------------ Training Record ------------------
Epoch: 353/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3203, reward_valid_std=2.2715
[BatchDiag] adv_mean=-0.0269, adv_std=0.8729, adv_abs_mean=0.6555 | ret_mean=6.7934, ret_std=1.7230 | val_mean=6.8203, val_std=1.5040 | explained_var=0.743320
[GradSplit pre-clip] backbone=0.692984, critic=0.852351
[Loss] pg_loss=-0.123086, entropy_loss=0.000121, value_loss=0.035249
[EpochKL] epoch=0 mean_kl=0.00600 max_kl=0.00824
[EpochKL] epoch=1 mean_kl=0.00477 max_kl=0.00687
[EpochKL] epoch=2 mean_kl=0.00581 max_kl=0.00790
[Time] Env Create Time: 2.7072s |Rollout Collect Time: 3.5134s |Loss & Update :1.8697
[PPODiag] kl_mean=0.0055, kl_p90=0.0078, kl_max=0.0082 | clipfrac_mean=0.034, logratio_std_mean=0.107, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.788, p10=0.784, min=0.780 | pg_loss_mean=0.0022, v_loss_mean=0.1609, ent_mean=0.1129 | gn_bb_mean=1.340, gn_bb_max=2.111 | gn_v_mean=0.964, gn_v_max=2.218

  7%|▋         | 354/5000 [55:50<10:44:44,  8.33s/it]------------------ Training Record ------------------
Epoch: 354/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.754, reward_valid_mean=0.3188, reward_valid_std=2.2683
[BatchDiag] adv_mean=-0.0448, adv_std=0.8829, adv_abs_mean=0.6631 | ret_mean=6.7740, ret_std=1.7309 | val_mean=6.8188, val_std=1.5083 | explained_var=0.739823
[GradSplit pre-clip] backbone=0.629147, critic=0.518345
[Loss] pg_loss=-0.042534, entropy_loss=0.000114, value_loss=0.039689
[EpochKL] epoch=0 mean_kl=0.00465 max_kl=0.00781
[EpochKL] epoch=1 mean_kl=0.00599 max_kl=0.00838
[EpochKL] epoch=2 mean_kl=0.00708 max_kl=0.00898
[Time] Env Create Time: 2.8530s |Rollout Collect Time: 3.6516s |Loss & Update :1.9456
[PPODiag] kl_mean=0.0059, kl_p90=0.0080, kl_max=0.0090 | clipfrac_mean=0.037, logratio_std_mean=0.110, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.754, p10=0.751, min=0.747 | pg_loss_mean=0.0025, v_loss_mean=0.1659, ent_mean=0.1082 | gn_bb_mean=1.381, gn_bb_max=1.927 | gn_v_mean=1.493, gn_v_max=3.220

  7%|▋         | 355/5000 [55:58<10:47:29,  8.36s/it]------------------ Training Record ------------------
Epoch: 355/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.3164, reward_valid_std=2.2649
[BatchDiag] adv_mean=-0.0667, adv_std=0.9075, adv_abs_mean=0.6757 | ret_mean=6.7782, ret_std=1.7380 | val_mean=6.8449, val_std=1.5243 | explained_var=0.727361
[GradSplit pre-clip] backbone=0.612408, critic=0.398620
[Loss] pg_loss=-0.071853, entropy_loss=0.000122, value_loss=0.037069
[EpochKL] epoch=0 mean_kl=0.00228 max_kl=0.00390
[EpochKL] epoch=1 mean_kl=0.00575 max_kl=0.00889
[EarlyStop] epoch=2 mean_kl=0.01087 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01087 max_kl=0.01531
[Time] Env Create Time: 2.8668s |Rollout Collect Time: 3.5014s |Loss & Update :1.8670
[PPODiag] kl_mean=0.0063, kl_p90=0.0128, kl_max=0.0153 | clipfrac_mean=0.036, logratio_std_mean=0.111, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.791, p10=0.787, min=0.784 | pg_loss_mean=0.0024, v_loss_mean=0.1701, ent_mean=0.1149 | gn_bb_mean=1.464, gn_bb_max=2.829 | gn_v_mean=1.071, gn_v_max=2.874
[AttnScore] scale=1.1206, C=10.0

  7%|▋         | 356/5000 [56:07<10:44:22,  8.33s/it]------------------ Training Record ------------------
Epoch: 356/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3173, reward_valid_std=2.2657
[BatchDiag] adv_mean=-0.0722, adv_std=0.8966, adv_abs_mean=0.6762 | ret_mean=6.7695, ret_std=1.7342 | val_mean=6.8417, val_std=1.4890 | explained_var=0.732700
[GradSplit pre-clip] backbone=0.523839, critic=0.687558
[Loss] pg_loss=-0.123467, entropy_loss=0.000122, value_loss=0.038272
[EpochKL] epoch=0 mean_kl=0.00531 max_kl=0.00757
[EpochKL] epoch=1 mean_kl=0.00610 max_kl=0.01173
[EpochKL] epoch=2 mean_kl=0.00538 max_kl=0.00866
[Time] Env Create Time: 2.7070s |Rollout Collect Time: 3.3494s |Loss & Update :1.8132
[PPODiag] kl_mean=0.0056, kl_p90=0.0074, kl_max=0.0117 | clipfrac_mean=0.036, logratio_std_mean=0.108, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.827, p10=0.823, min=0.816 | pg_loss_mean=0.0022, v_loss_mean=0.1702, ent_mean=0.1208 | gn_bb_mean=1.483, gn_bb_max=2.285 | gn_v_mean=1.348, gn_v_max=3.424

  7%|▋         | 357/5000 [56:14<10:33:40,  8.19s/it]------------------ Training Record ------------------
Epoch: 357/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3187, reward_valid_std=2.2695
[BatchDiag] adv_mean=-0.1357, adv_std=0.8932, adv_abs_mean=0.6755 | ret_mean=6.8028, ret_std=1.7126 | val_mean=6.9385, val_std=1.4784 | explained_var=0.727999
[GradSplit pre-clip] backbone=0.488211, critic=0.533846
[Loss] pg_loss=-0.073642, entropy_loss=0.000122, value_loss=0.039924
[EpochKL] epoch=0 mean_kl=0.00283 max_kl=0.00708
[EpochKL] epoch=1 mean_kl=0.00601 max_kl=0.00887
[EpochKL] epoch=2 mean_kl=0.00787 max_kl=0.01157
[Time] Env Create Time: 2.8491s |Rollout Collect Time: 3.3514s |Loss & Update :1.8078
[PPODiag] kl_mean=0.0056, kl_p90=0.0090, kl_max=0.0116 | clipfrac_mean=0.033, logratio_std_mean=0.107, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.825, p10=0.819, min=0.817 | pg_loss_mean=0.0024, v_loss_mean=0.1695, ent_mean=0.1184 | gn_bb_mean=1.410, gn_bb_max=2.432 | gn_v_mean=1.521, gn_v_max=2.607

  7%|▋         | 358/5000 [56:22<10:29:21,  8.13s/it]------------------ Training Record ------------------
Epoch: 358/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3183, reward_valid_std=2.2734
[BatchDiag] adv_mean=-0.1893, adv_std=0.9299, adv_abs_mean=0.7044 | ret_mean=6.8222, ret_std=1.7185 | val_mean=7.0114, val_std=1.4527 | explained_var=0.707226
[GradSplit pre-clip] backbone=0.652680, critic=1.180397
[Loss] pg_loss=-0.068061, entropy_loss=0.000119, value_loss=0.039130
[EpochKL] epoch=0 mean_kl=0.00243 max_kl=0.00352
[EpochKL] epoch=1 mean_kl=0.00808 max_kl=0.01313
[EpochKL] epoch=2 mean_kl=0.00794 max_kl=0.01054
[Time] Env Create Time: 2.8719s |Rollout Collect Time: 3.5172s |Loss & Update :1.8730
[PPODiag] kl_mean=0.0062, kl_p90=0.0099, kl_max=0.0131 | clipfrac_mean=0.036, logratio_std_mean=0.112, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.780 | pg_loss_mean=0.0025, v_loss_mean=0.1795, ent_mean=0.1139 | gn_bb_mean=1.294, gn_bb_max=1.876 | gn_v_mean=1.569, gn_v_max=3.632

  7%|▋         | 359/5000 [56:31<10:32:11,  8.17s/it]------------------ Training Record ------------------
Epoch: 359/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3163, reward_valid_std=2.2685
[BatchDiag] adv_mean=-0.3278, adv_std=0.9219, adv_abs_mean=0.7256 | ret_mean=6.8405, ret_std=1.6844 | val_mean=7.1683, val_std=1.4146 | explained_var=0.700419
[GradSplit pre-clip] backbone=0.588925, critic=2.441821
[Loss] pg_loss=-0.048411, entropy_loss=0.000119, value_loss=0.043613
[EpochKL] epoch=0 mean_kl=0.00266 max_kl=0.00438
[EpochKL] epoch=1 mean_kl=0.00683 max_kl=0.01059
[EarlyStop] epoch=2 mean_kl=0.01090 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01090 max_kl=0.01621
[Time] Env Create Time: 2.8789s |Rollout Collect Time: 3.5221s |Loss & Update :1.8693
[PPODiag] kl_mean=0.0068, kl_p90=0.0120, kl_max=0.0162 | clipfrac_mean=0.036, logratio_std_mean=0.119, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.778 | pg_loss_mean=0.0024, v_loss_mean=0.1872, ent_mean=0.1147 | gn_bb_mean=1.333, gn_bb_max=1.854 | gn_v_mean=2.109, gn_v_max=3.813

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.713, Step: 21, Avg Done Step: 18.39, #CS visited: 0.38
D->C4->C1->C15->C3->C5->C2->D->C12->C14->C8->D->C13->C6->C7->C11->C10->C9->D
Eval cost : 4.0707s
-----------------------------
  7%|▋         | 360/5000 [56:43<12:09:55,  9.44s/it]------------------ Training Record ------------------
Epoch: 360/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3180, reward_valid_std=2.2685
[BatchDiag] adv_mean=-0.3477, adv_std=0.9017, adv_abs_mean=0.7165 | ret_mean=6.8436, ret_std=1.6697 | val_mean=7.1914, val_std=1.4127 | explained_var=0.708340
[GradSplit pre-clip] backbone=0.475177, critic=2.000954
[Loss] pg_loss=-0.108947, entropy_loss=0.000117, value_loss=0.043442
[EpochKL] epoch=0 mean_kl=0.00609 max_kl=0.01003
[EpochKL] epoch=1 mean_kl=0.00851 max_kl=0.01247
[EpochKL] epoch=2 mean_kl=0.00983 max_kl=0.01824
[Time] Env Create Time: 2.7059s |Rollout Collect Time: 3.5126s |Loss & Update :1.8755
[PPODiag] kl_mean=0.0081, kl_p90=0.0112, kl_max=0.0182 | clipfrac_mean=0.043, logratio_std_mean=0.131, ratio_p95_mean=1.060 | valid_ratio_mb_mean=0.787, p10=0.784, min=0.776 | pg_loss_mean=0.0035, v_loss_mean=0.1816, ent_mean=0.1193 | gn_bb_mean=1.599, gn_bb_max=2.289 | gn_v_mean=2.060, gn_v_max=3.397
[AttnScore] scale=1.1221, C=10.0

  7%|▋         | 361/5000 [56:51<11:38:35,  9.04s/it]------------------ Training Record ------------------
Epoch: 361/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51120/51200 = 0.998
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.290, reward_valid_mean=0.3138, reward_valid_std=2.2635
[BatchDiag] adv_mean=-0.3539, adv_std=1.0360, adv_abs_mean=0.7529 | ret_mean=6.8018, ret_std=1.7640 | val_mean=7.1558, val_std=1.3945 | explained_var=0.655084
[GradSplit pre-clip] backbone=0.406723, critic=1.918395
[Loss] pg_loss=-0.099062, entropy_loss=0.000043, value_loss=0.045102
[EpochKL] epoch=0 mean_kl=0.00372 max_kl=0.00610
[EpochKL] epoch=1 mean_kl=0.00586 max_kl=0.01152
[EarlyStop] epoch=2 mean_kl=0.01232 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01232 max_kl=0.01445
[Time] Env Create Time: 2.8557s |Rollout Collect Time: 9.2692s |Loss & Update :4.6410
[PPODiag] kl_mean=0.0073, kl_p90=0.0138, kl_max=0.0145 | clipfrac_mean=0.040, logratio_std_mean=0.120, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.290, p10=0.286, min=0.285 | pg_loss_mean=0.0019, v_loss_mean=0.1996, ent_mean=0.0434 | gn_bb_mean=1.578, gn_bb_max=3.468 | gn_v_mean=2.058, gn_v_max=3.927

  7%|▋         | 362/5000 [57:08<14:37:43, 11.35s/it]------------------ Training Record ------------------
Epoch: 362/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3205, reward_valid_std=2.2730
[BatchDiag] adv_mean=-0.3006, adv_std=0.8789, adv_abs_mean=0.6894 | ret_mean=6.8771, ret_std=1.6654 | val_mean=7.1777, val_std=1.4077 | explained_var=0.721510
[GradSplit pre-clip] backbone=0.765393, critic=1.954286
[Loss] pg_loss=-0.086929, entropy_loss=0.000125, value_loss=0.039726
[EpochKL] epoch=0 mean_kl=0.00388 max_kl=0.00724
[EpochKL] epoch=1 mean_kl=0.00732 max_kl=0.01248
[EpochKL] epoch=2 mean_kl=0.00740 max_kl=0.01025
[Time] Env Create Time: 2.8724s |Rollout Collect Time: 3.3476s |Loss & Update :1.8014
[PPODiag] kl_mean=0.0062, kl_p90=0.0088, kl_max=0.0125 | clipfrac_mean=0.036, logratio_std_mean=0.113, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.824, p10=0.818, min=0.817 | pg_loss_mean=0.0024, v_loss_mean=0.1722, ent_mean=0.1188 | gn_bb_mean=1.326, gn_bb_max=1.733 | gn_v_mean=1.967, gn_v_max=3.171

  7%|▋         | 363/5000 [57:16<13:20:15, 10.35s/it]------------------ Training Record ------------------
Epoch: 363/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3176, reward_valid_std=2.2685
[BatchDiag] adv_mean=-0.2953, adv_std=0.9133, adv_abs_mean=0.7070 | ret_mean=6.8367, ret_std=1.6815 | val_mean=7.1320, val_std=1.4104 | explained_var=0.704997
[GradSplit pre-clip] backbone=0.670438, critic=1.473587
[Loss] pg_loss=-0.106762, entropy_loss=0.000129, value_loss=0.039755
[EpochKL] epoch=0 mean_kl=0.00338 max_kl=0.00668
[EpochKL] epoch=1 mean_kl=0.00685 max_kl=0.01299
[EarlyStop] epoch=2 mean_kl=0.01049 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01049 max_kl=0.01765
[Time] Env Create Time: 2.8744s |Rollout Collect Time: 3.3801s |Loss & Update :1.7989
[PPODiag] kl_mean=0.0069, kl_p90=0.0118, kl_max=0.0176 | clipfrac_mean=0.038, logratio_std_mean=0.120, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.825, p10=0.820, min=0.817 | pg_loss_mean=0.0026, v_loss_mean=0.1806, ent_mean=0.1215 | gn_bb_mean=1.475, gn_bb_max=2.150 | gn_v_mean=1.922, gn_v_max=3.271

  7%|▋         | 364/5000 [57:24<12:26:44,  9.66s/it]------------------ Training Record ------------------
Epoch: 364/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.753, reward_valid_mean=0.3200, reward_valid_std=2.2700
[BatchDiag] adv_mean=-0.2990, adv_std=0.9010, adv_abs_mean=0.6954 | ret_mean=6.8568, ret_std=1.6681 | val_mean=7.1558, val_std=1.3910 | explained_var=0.708283
[GradSplit pre-clip] backbone=0.522959, critic=1.597212
[Loss] pg_loss=-0.102831, entropy_loss=0.000122, value_loss=0.040825
[EpochKL] epoch=0 mean_kl=0.00499 max_kl=0.00885
[EpochKL] epoch=1 mean_kl=0.00926 max_kl=0.01238
[EarlyStop] epoch=2 mean_kl=0.01296 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01296 max_kl=0.01584
[Time] Env Create Time: 2.7113s |Rollout Collect Time: 3.6544s |Loss & Update :1.9523
[PPODiag] kl_mean=0.0091, kl_p90=0.0146, kl_max=0.0158 | clipfrac_mean=0.044, logratio_std_mean=0.140, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.753, p10=0.749, min=0.745 | pg_loss_mean=0.0034, v_loss_mean=0.1748, ent_mean=0.1129 | gn_bb_mean=1.545, gn_bb_max=2.462 | gn_v_mean=1.842, gn_v_max=3.158

  7%|▋         | 365/5000 [57:32<11:55:23,  9.26s/it]------------------ Training Record ------------------
Epoch: 365/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.752, reward_valid_mean=0.3213, reward_valid_std=2.2694
[BatchDiag] adv_mean=-0.3314, adv_std=0.8955, adv_abs_mean=0.7067 | ret_mean=6.8741, ret_std=1.6516 | val_mean=7.2056, val_std=1.3684 | explained_var=0.706008
[GradSplit pre-clip] backbone=0.490377, critic=1.993144
[Loss] pg_loss=-0.081274, entropy_loss=0.000121, value_loss=0.042201
[EpochKL] epoch=0 mean_kl=0.00394 max_kl=0.00702
[EpochKL] epoch=1 mean_kl=0.00506 max_kl=0.00952
[EpochKL] epoch=2 mean_kl=0.00603 max_kl=0.00981
[Time] Env Create Time: 2.8446s |Rollout Collect Time: 3.6574s |Loss & Update :1.9582
[PPODiag] kl_mean=0.0050, kl_p90=0.0092, kl_max=0.0098 | clipfrac_mean=0.032, logratio_std_mean=0.101, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.752, p10=0.747, min=0.744 | pg_loss_mean=0.0018, v_loss_mean=0.1771, ent_mean=0.1140 | gn_bb_mean=1.214, gn_bb_max=2.086 | gn_v_mean=1.819, gn_v_max=2.935
[AttnScore] scale=1.1237, C=10.0

  7%|▋         | 366/5000 [57:41<11:36:42,  9.02s/it]------------------ Training Record ------------------
Epoch: 366/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3173, reward_valid_std=2.2649
[BatchDiag] adv_mean=-0.2847, adv_std=0.8957, adv_abs_mean=0.7031 | ret_mean=6.8174, ret_std=1.6826 | val_mean=7.1021, val_std=1.3883 | explained_var=0.716626
[GradSplit pre-clip] backbone=0.491284, critic=1.526348
[Loss] pg_loss=-0.104943, entropy_loss=0.000131, value_loss=0.039878
[EpochKL] epoch=0 mean_kl=0.00691 max_kl=0.01546
[EarlyStop] epoch=1 mean_kl=0.01368 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01368 max_kl=0.02140
[Time] Env Create Time: 2.8450s |Rollout Collect Time: 3.3338s |Loss & Update :1.2194
[PPODiag] kl_mean=0.0103, kl_p90=0.0170, kl_max=0.0214 | clipfrac_mean=0.047, logratio_std_mean=0.146, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.827, p10=0.821, min=0.818 | pg_loss_mean=0.0046, v_loss_mean=0.1809, ent_mean=0.1249 | gn_bb_mean=1.670, gn_bb_max=2.160 | gn_v_mean=2.175, gn_v_max=3.896

  7%|▋         | 367/5000 [57:48<10:58:58,  8.53s/it]------------------ Training Record ------------------
Epoch: 367/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3170, reward_valid_std=2.2678
[BatchDiag] adv_mean=-0.2715, adv_std=0.9013, adv_abs_mean=0.7017 | ret_mean=6.8103, ret_std=1.6937 | val_mean=7.0818, val_std=1.3972 | explained_var=0.716823
[GradSplit pre-clip] backbone=0.596118, critic=1.673678
[Loss] pg_loss=-0.075086, entropy_loss=0.000127, value_loss=0.038598
[EpochKL] epoch=0 mean_kl=0.00945 max_kl=0.01369
[EpochKL] epoch=1 mean_kl=0.00864 max_kl=0.01321
[EarlyStop] epoch=2 mean_kl=0.01008 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01008 max_kl=0.01492
[Time] Env Create Time: 2.8714s |Rollout Collect Time: 3.3610s |Loss & Update :1.8082
[PPODiag] kl_mean=0.0094, kl_p90=0.0134, kl_max=0.0149 | clipfrac_mean=0.048, logratio_std_mean=0.142, ratio_p95_mean=1.065 | valid_ratio_mb_mean=0.825, p10=0.819, min=0.818 | pg_loss_mean=0.0040, v_loss_mean=0.1759, ent_mean=0.1264 | gn_bb_mean=1.662, gn_bb_max=2.951 | gn_v_mean=1.524, gn_v_max=3.235

  7%|▋         | 368/5000 [57:56<10:47:24,  8.39s/it]------------------ Training Record ------------------
Epoch: 368/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3184, reward_valid_std=2.2629
[BatchDiag] adv_mean=-0.2808, adv_std=0.9048, adv_abs_mean=0.7083 | ret_mean=6.8133, ret_std=1.6868 | val_mean=7.0941, val_std=1.3629 | explained_var=0.712258
[GradSplit pre-clip] backbone=0.497635, critic=1.376623
[Loss] pg_loss=-0.109926, entropy_loss=0.000124, value_loss=0.042768
[EpochKL] epoch=0 mean_kl=0.00503 max_kl=0.00913
[EpochKL] epoch=1 mean_kl=0.00858 max_kl=0.01213
[EpochKL] epoch=2 mean_kl=0.00815 max_kl=0.01340
[Time] Env Create Time: 2.6989s |Rollout Collect Time: 3.4825s |Loss & Update :1.8839
[PPODiag] kl_mean=0.0073, kl_p90=0.0107, kl_max=0.0134 | clipfrac_mean=0.040, logratio_std_mean=0.123, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.789, p10=0.781, min=0.780 | pg_loss_mean=0.0028, v_loss_mean=0.1787, ent_mean=0.1191 | gn_bb_mean=1.415, gn_bb_max=2.116 | gn_v_mean=1.638, gn_v_max=3.360

  7%|▋         | 369/5000 [58:04<10:39:51,  8.29s/it]------------------ Training Record ------------------
Epoch: 369/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3165, reward_valid_std=2.2646
[BatchDiag] adv_mean=-0.2046, adv_std=0.8954, adv_abs_mean=0.6878 | ret_mean=6.7842, ret_std=1.7048 | val_mean=6.9888, val_std=1.4140 | explained_var=0.724134
[GradSplit pre-clip] backbone=0.484699, critic=0.780386
[Loss] pg_loss=-0.103640, entropy_loss=0.000125, value_loss=0.038011
[EpochKL] epoch=0 mean_kl=0.00426 max_kl=0.00687
[EpochKL] epoch=1 mean_kl=0.00462 max_kl=0.00620
[EarlyStop] epoch=2 mean_kl=0.01076 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01076 max_kl=0.01621
[Time] Env Create Time: 2.8530s |Rollout Collect Time: 3.3400s |Loss & Update :1.8162
[PPODiag] kl_mean=0.0065, kl_p90=0.0113, kl_max=0.0162 | clipfrac_mean=0.037, logratio_std_mean=0.117, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.827, p10=0.822, min=0.820 | pg_loss_mean=0.0023, v_loss_mean=0.1741, ent_mean=0.1213 | gn_bb_mean=1.297, gn_bb_max=1.997 | gn_v_mean=1.704, gn_v_max=3.200

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 999 episodes: -5.738, Step: 59, Avg Done Step: 18.41, #CS visited: 0.43
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->D->C6->C7->C11->C10->C9->C8->D
Eval cost : 9.6359s
-----------------------------
  7%|▋         | 370/5000 [58:22<14:16:55, 11.10s/it]------------------ Training Record ------------------
Epoch: 370/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3145, reward_valid_std=2.2627
[BatchDiag] adv_mean=-0.1801, adv_std=0.8972, adv_abs_mean=0.6808 | ret_mean=6.7482, ret_std=1.7194 | val_mean=6.9283, val_std=1.4303 | explained_var=0.727675
[GradSplit pre-clip] backbone=0.468752, critic=0.694923
[Loss] pg_loss=-0.085355, entropy_loss=0.000126, value_loss=0.037616
[EpochKL] epoch=0 mean_kl=0.00374 max_kl=0.00578
[EpochKL] epoch=1 mean_kl=0.00546 max_kl=0.00740
[EpochKL] epoch=2 mean_kl=0.00747 max_kl=0.00965
[Time] Env Create Time: 2.8388s |Rollout Collect Time: 3.5036s |Loss & Update :1.8738
[PPODiag] kl_mean=0.0056, kl_p90=0.0079, kl_max=0.0096 | clipfrac_mean=0.035, logratio_std_mean=0.107, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.790, p10=0.782, min=0.781 | pg_loss_mean=0.0022, v_loss_mean=0.1739, ent_mean=0.1173 | gn_bb_mean=1.282, gn_bb_max=1.984 | gn_v_mean=1.794, gn_v_max=3.438
[AttnScore] scale=1.1251, C=10.0

  7%|▋         | 371/5000 [58:30<13:09:53, 10.24s/it]------------------ Training Record ------------------
Epoch: 371/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3194, reward_valid_std=2.2676
[BatchDiag] adv_mean=-0.1660, adv_std=0.8896, adv_abs_mean=0.6789 | ret_mean=6.7887, ret_std=1.7047 | val_mean=6.9547, val_std=1.4327 | explained_var=0.727652
[GradSplit pre-clip] backbone=0.599543, critic=0.892569
[Loss] pg_loss=-0.066329, entropy_loss=0.000124, value_loss=0.038850
[EpochKL] epoch=0 mean_kl=0.00362 max_kl=0.00674
[EpochKL] epoch=1 mean_kl=0.00910 max_kl=0.01184
[EpochKL] epoch=2 mean_kl=0.00997 max_kl=0.01520
[Time] Env Create Time: 2.8720s |Rollout Collect Time: 3.3580s |Loss & Update :1.8024
[PPODiag] kl_mean=0.0076, kl_p90=0.0118, kl_max=0.0152 | clipfrac_mean=0.040, logratio_std_mean=0.126, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.825, p10=0.820, min=0.818 | pg_loss_mean=0.0029, v_loss_mean=0.1695, ent_mean=0.1224 | gn_bb_mean=1.602, gn_bb_max=2.452 | gn_v_mean=1.383, gn_v_max=2.746

  7%|▋         | 372/5000 [58:38<12:18:41,  9.58s/it]------------------ Training Record ------------------
Epoch: 372/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3128, reward_valid_std=2.2623
[BatchDiag] adv_mean=-0.1956, adv_std=0.9211, adv_abs_mean=0.7096 | ret_mean=6.7373, ret_std=1.7186 | val_mean=6.9329, val_std=1.4270 | explained_var=0.712771
[GradSplit pre-clip] backbone=0.534471, critic=0.679038
[Loss] pg_loss=-0.121584, entropy_loss=0.000129, value_loss=0.038485
[EpochKL] epoch=0 mean_kl=0.00637 max_kl=0.01099
[EpochKL] epoch=1 mean_kl=0.00618 max_kl=0.00896
[EpochKL] epoch=2 mean_kl=0.00819 max_kl=0.01324
[Time] Env Create Time: 2.7114s |Rollout Collect Time: 3.5142s |Loss & Update :1.8713
[PPODiag] kl_mean=0.0069, kl_p90=0.0094, kl_max=0.0132 | clipfrac_mean=0.040, logratio_std_mean=0.120, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.789, p10=0.782, min=0.781 | pg_loss_mean=0.0027, v_loss_mean=0.1802, ent_mean=0.1192 | gn_bb_mean=1.465, gn_bb_max=2.282 | gn_v_mean=1.479, gn_v_max=2.407

  7%|▋         | 373/5000 [58:46<11:44:18,  9.13s/it]------------------ Training Record ------------------
Epoch: 373/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3158, reward_valid_std=2.2637
[BatchDiag] adv_mean=-0.1274, adv_std=0.9034, adv_abs_mean=0.6944 | ret_mean=6.7340, ret_std=1.7246 | val_mean=6.8614, val_std=1.4176 | explained_var=0.725624
[GradSplit pre-clip] backbone=0.581404, critic=0.780206
[Loss] pg_loss=-0.072476, entropy_loss=0.000126, value_loss=0.039222
[EpochKL] epoch=0 mean_kl=0.00491 max_kl=0.00864
[EpochKL] epoch=1 mean_kl=0.00884 max_kl=0.01071
[EpochKL] epoch=2 mean_kl=0.00829 max_kl=0.00998
[Time] Env Create Time: 2.8555s |Rollout Collect Time: 3.4908s |Loss & Update :1.8792
[PPODiag] kl_mean=0.0073, kl_p90=0.0095, kl_max=0.0107 | clipfrac_mean=0.041, logratio_std_mean=0.126, ratio_p95_mean=1.059 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.779 | pg_loss_mean=0.0027, v_loss_mean=0.1767, ent_mean=0.1185 | gn_bb_mean=1.373, gn_bb_max=1.869 | gn_v_mean=1.714, gn_v_max=3.281

  7%|▋         | 374/5000 [58:55<11:23:14,  8.86s/it]------------------ Training Record ------------------
Epoch: 374/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.753, reward_valid_mean=0.3198, reward_valid_std=2.2684
[BatchDiag] adv_mean=-0.1094, adv_std=0.9319, adv_abs_mean=0.6981 | ret_mean=6.7729, ret_std=1.7216 | val_mean=6.8823, val_std=1.4299 | explained_var=0.706990
[GradSplit pre-clip] backbone=0.660819, critic=0.474148
[Loss] pg_loss=-0.081251, entropy_loss=0.000125, value_loss=0.040407
[EpochKL] epoch=0 mean_kl=0.00644 max_kl=0.01516
[EpochKL] epoch=1 mean_kl=0.00677 max_kl=0.00970
[EpochKL] epoch=2 mean_kl=0.00679 max_kl=0.01079
[Time] Env Create Time: 2.8352s |Rollout Collect Time: 3.6382s |Loss & Update :1.9512
[PPODiag] kl_mean=0.0067, kl_p90=0.0097, kl_max=0.0152 | clipfrac_mean=0.037, logratio_std_mean=0.119, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.753, p10=0.748, min=0.741 | pg_loss_mean=0.0025, v_loss_mean=0.1795, ent_mean=0.1109 | gn_bb_mean=1.353, gn_bb_max=2.044 | gn_v_mean=1.322, gn_v_max=2.332

  8%|▊         | 375/5000 [59:03<11:12:59,  8.73s/it]------------------ Training Record ------------------
Epoch: 375/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3174, reward_valid_std=2.2674
[BatchDiag] adv_mean=-0.0792, adv_std=0.8956, adv_abs_mean=0.6769 | ret_mean=6.7553, ret_std=1.7324 | val_mean=6.8345, val_std=1.4662 | explained_var=0.732755
[GradSplit pre-clip] backbone=0.599258, critic=0.278183
[Loss] pg_loss=-0.070543, entropy_loss=0.000126, value_loss=0.039015
[EpochKL] epoch=0 mean_kl=0.00280 max_kl=0.00527
[EpochKL] epoch=1 mean_kl=0.00657 max_kl=0.01131
[EpochKL] epoch=2 mean_kl=0.00835 max_kl=0.01101
[Time] Env Create Time: 2.6813s |Rollout Collect Time: 3.4767s |Loss & Update :1.8787
[PPODiag] kl_mean=0.0059, kl_p90=0.0102, kl_max=0.0113 | clipfrac_mean=0.035, logratio_std_mean=0.109, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.788, p10=0.781, min=0.779 | pg_loss_mean=0.0020, v_loss_mean=0.1693, ent_mean=0.1161 | gn_bb_mean=1.310, gn_bb_max=1.857 | gn_v_mean=1.119, gn_v_max=2.418
[AttnScore] scale=1.1269, C=10.0

  8%|▊         | 376/5000 [59:11<10:56:48,  8.52s/it]------------------ Training Record ------------------
Epoch: 376/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3157, reward_valid_std=2.2664
[BatchDiag] adv_mean=-0.0150, adv_std=0.9128, adv_abs_mean=0.6891 | ret_mean=6.7052, ret_std=1.7614 | val_mean=6.7202, val_std=1.5129 | explained_var=0.731468
[GradSplit pre-clip] backbone=0.466331, critic=0.773265
[Loss] pg_loss=-0.073525, entropy_loss=0.000121, value_loss=0.040370
[EpochKL] epoch=0 mean_kl=0.00408 max_kl=0.00790
[EpochKL] epoch=1 mean_kl=0.00371 max_kl=0.00470
[EpochKL] epoch=2 mean_kl=0.00535 max_kl=0.00715
[Time] Env Create Time: 2.8308s |Rollout Collect Time: 3.4838s |Loss & Update :1.8695
[PPODiag] kl_mean=0.0044, kl_p90=0.0061, kl_max=0.0079 | clipfrac_mean=0.030, logratio_std_mean=0.095, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.789, p10=0.782, min=0.781 | pg_loss_mean=0.0015, v_loss_mean=0.1726, ent_mean=0.1142 | gn_bb_mean=1.205, gn_bb_max=1.738 | gn_v_mean=0.985, gn_v_max=2.108

  8%|▊         | 377/5000 [59:19<10:48:51,  8.42s/it]------------------ Training Record ------------------
Epoch: 377/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.754, reward_valid_mean=0.3188, reward_valid_std=2.2673
[BatchDiag] adv_mean=0.0538, adv_std=0.9105, adv_abs_mean=0.6896 | ret_mean=6.7323, ret_std=1.7605 | val_mean=6.6784, val_std=1.5715 | explained_var=0.732515
[GradSplit pre-clip] backbone=0.492740, critic=1.914851
[Loss] pg_loss=-0.131389, entropy_loss=0.000116, value_loss=0.043898
[EpochKL] epoch=0 mean_kl=0.00260 max_kl=0.00420
[EpochKL] epoch=1 mean_kl=0.00437 max_kl=0.00512
[EpochKL] epoch=2 mean_kl=0.00497 max_kl=0.00670
[Time] Env Create Time: 2.8303s |Rollout Collect Time: 3.6354s |Loss & Update :1.9595
[PPODiag] kl_mean=0.0040, kl_p90=0.0051, kl_max=0.0067 | clipfrac_mean=0.028, logratio_std_mean=0.091, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.754, p10=0.749, min=0.744 | pg_loss_mean=0.0013, v_loss_mean=0.1735, ent_mean=0.1104 | gn_bb_mean=1.109, gn_bb_max=1.558 | gn_v_mean=1.363, gn_v_max=2.952

  8%|▊         | 378/5000 [59:28<10:48:49,  8.42s/it]------------------ Training Record ------------------
Epoch: 378/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.754, reward_valid_mean=0.3185, reward_valid_std=2.2669
[BatchDiag] adv_mean=0.0583, adv_std=0.9162, adv_abs_mean=0.6924 | ret_mean=6.7298, ret_std=1.7668 | val_mean=6.6716, val_std=1.5686 | explained_var=0.731078
[GradSplit pre-clip] backbone=0.555500, critic=1.649092
[Loss] pg_loss=-0.090588, entropy_loss=0.000119, value_loss=0.042542
[EpochKL] epoch=0 mean_kl=0.00417 max_kl=0.00989
[EpochKL] epoch=1 mean_kl=0.00599 max_kl=0.00853
[EpochKL] epoch=2 mean_kl=0.00534 max_kl=0.00670
[Time] Env Create Time: 2.8537s |Rollout Collect Time: 3.6261s |Loss & Update :1.9419
[PPODiag] kl_mean=0.0052, kl_p90=0.0082, kl_max=0.0099 | clipfrac_mean=0.031, logratio_std_mean=0.103, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.754, p10=0.749, min=0.745 | pg_loss_mean=0.0020, v_loss_mean=0.1730, ent_mean=0.1077 | gn_bb_mean=1.327, gn_bb_max=2.798 | gn_v_mean=1.028, gn_v_max=1.788

  8%|▊         | 379/5000 [59:36<10:48:40,  8.42s/it]------------------ Training Record ------------------
Epoch: 379/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3157, reward_valid_std=2.2673
[BatchDiag] adv_mean=-0.0164, adv_std=0.9279, adv_abs_mean=0.6942 | ret_mean=6.7086, ret_std=1.7631 | val_mean=6.7250, val_std=1.5535 | explained_var=0.723028
[GradSplit pre-clip] backbone=0.475936, critic=1.011883
[Loss] pg_loss=-0.068746, entropy_loss=0.000117, value_loss=0.042294
[EpochKL] epoch=0 mean_kl=0.00353 max_kl=0.00821
[EpochKL] epoch=1 mean_kl=0.00508 max_kl=0.00687
[EpochKL] epoch=2 mean_kl=0.00519 max_kl=0.00749
[Time] Env Create Time: 2.6887s |Rollout Collect Time: 3.4786s |Loss & Update :1.8797
[PPODiag] kl_mean=0.0046, kl_p90=0.0066, kl_max=0.0082 | clipfrac_mean=0.032, logratio_std_mean=0.097, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.776 | pg_loss_mean=0.0016, v_loss_mean=0.1747, ent_mean=0.1123 | gn_bb_mean=1.211, gn_bb_max=1.568 | gn_v_mean=0.658, gn_v_max=1.257

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.739, Step: 22, Avg Done Step: 18.40, #CS visited: 0.39
D->C12->C1->C15->C14->C3->C5->C2->D->C13->C4->C7->C11->C10->C9->C8->D->C6->D
Eval cost : 4.1888s
-----------------------------
  8%|▊         | 380/5000 [59:48<12:17:15,  9.57s/it]------------------ Training Record ------------------
Epoch: 380/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51104/51200 = 0.998
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.290, reward_valid_mean=0.3130, reward_valid_std=2.2623
[BatchDiag] adv_mean=-0.0313, adv_std=0.9862, adv_abs_mean=0.7174 | ret_mean=6.6919, ret_std=1.8049 | val_mean=6.7231, val_std=1.5603 | explained_var=0.701430
[GradSplit pre-clip] backbone=0.575035, critic=1.032693
[Loss] pg_loss=-0.121497, entropy_loss=0.000043, value_loss=0.039612
[EpochKL] epoch=0 mean_kl=0.00316 max_kl=0.00643
[EpochKL] epoch=1 mean_kl=0.00418 max_kl=0.00672
[EpochKL] epoch=2 mean_kl=0.00622 max_kl=0.00994
[Time] Env Create Time: 2.8261s |Rollout Collect Time: 9.1733s |Loss & Update :4.6640
[PPODiag] kl_mean=0.0045, kl_p90=0.0066, kl_max=0.0099 | clipfrac_mean=0.030, logratio_std_mean=0.096, ratio_p95_mean=1.041 | valid_ratio_mb_mean=0.290, p10=0.287, min=0.286 | pg_loss_mean=0.0007, v_loss_mean=0.1861, ent_mean=0.0407 | gn_bb_mean=1.202, gn_bb_max=1.758 | gn_v_mean=1.061, gn_v_max=2.245
[AttnScore] scale=1.1294, C=10.0

  8%|▊         | 381/5000 [1:00:05<15:00:49, 11.70s/it]------------------ Training Record ------------------
Epoch: 381/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3173, reward_valid_std=2.2684
[BatchDiag] adv_mean=-0.0518, adv_std=0.9271, adv_abs_mean=0.6923 | ret_mean=6.7581, ret_std=1.7463 | val_mean=6.8099, val_std=1.5375 | explained_var=0.718174
[GradSplit pre-clip] backbone=0.649567, critic=0.384407
[Loss] pg_loss=-0.053209, entropy_loss=0.000122, value_loss=0.039797
[EpochKL] epoch=0 mean_kl=0.00257 max_kl=0.00663
[EpochKL] epoch=1 mean_kl=0.00516 max_kl=0.00725
[EpochKL] epoch=2 mean_kl=0.00672 max_kl=0.00792
[Time] Env Create Time: 2.8391s |Rollout Collect Time: 3.5047s |Loss & Update :1.8704
[PPODiag] kl_mean=0.0048, kl_p90=0.0076, kl_max=0.0079 | clipfrac_mean=0.031, logratio_std_mean=0.098, ratio_p95_mean=1.041 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.779 | pg_loss_mean=0.0019, v_loss_mean=0.1752, ent_mean=0.1126 | gn_bb_mean=1.171, gn_bb_max=1.705 | gn_v_mean=0.864, gn_v_max=2.389

  8%|▊         | 382/5000 [1:00:13<13:40:06, 10.66s/it]------------------ Training Record ------------------
Epoch: 382/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51100/51200 = 0.998
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.291, reward_valid_mean=0.3127, reward_valid_std=2.2598
[BatchDiag] adv_mean=-0.1692, adv_std=0.9916, adv_abs_mean=0.7200 | ret_mean=6.7294, ret_std=1.7722 | val_mean=6.8986, val_std=1.4787 | explained_var=0.686914
[GradSplit pre-clip] backbone=0.440315, critic=0.530856
[Loss] pg_loss=-0.128863, entropy_loss=0.000044, value_loss=0.040032
[EpochKL] epoch=0 mean_kl=0.00310 max_kl=0.00656
[EpochKL] epoch=1 mean_kl=0.00548 max_kl=0.00731
[EpochKL] epoch=2 mean_kl=0.00531 max_kl=0.00676
[Time] Env Create Time: 2.8628s |Rollout Collect Time: 9.2165s |Loss & Update :4.6220
[PPODiag] kl_mean=0.0046, kl_p90=0.0068, kl_max=0.0073 | clipfrac_mean=0.032, logratio_std_mean=0.097, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.291, p10=0.288, min=0.287 | pg_loss_mean=0.0009, v_loss_mean=0.1924, ent_mean=0.0429 | gn_bb_mean=1.256, gn_bb_max=1.731 | gn_v_mean=1.931, gn_v_max=4.442

  8%|▊         | 383/5000 [1:00:30<15:59:30, 12.47s/it]------------------ Training Record ------------------
Epoch: 383/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=24, valid_ratio=0.721, reward_valid_mean=0.3177, reward_valid_std=2.2671
[BatchDiag] adv_mean=-0.2297, adv_std=0.9119, adv_abs_mean=0.6994 | ret_mean=6.7985, ret_std=1.7085 | val_mean=7.0282, val_std=1.4494 | explained_var=0.715116
[GradSplit pre-clip] backbone=0.733237, critic=2.050634
[Loss] pg_loss=-0.012818, entropy_loss=0.000107, value_loss=0.041781
[EpochKL] epoch=0 mean_kl=0.00299 max_kl=0.00412
[EpochKL] epoch=1 mean_kl=0.00618 max_kl=0.01232
[EarlyStop] epoch=2 mean_kl=0.01001 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01001 max_kl=0.01647
[Time] Env Create Time: 2.7344s |Rollout Collect Time: 3.8346s |Loss & Update :2.0177
[PPODiag] kl_mean=0.0064, kl_p90=0.0126, kl_max=0.0165 | clipfrac_mean=0.036, logratio_std_mean=0.113, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.721, p10=0.717, min=0.714 | pg_loss_mean=0.0023, v_loss_mean=0.1765, ent_mean=0.1021 | gn_bb_mean=1.408, gn_bb_max=2.234 | gn_v_mean=1.685, gn_v_max=2.841

  8%|▊         | 384/5000 [1:00:38<14:29:42, 11.30s/it]------------------ Training Record ------------------
Epoch: 384/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51100/51200 = 0.998
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.291, reward_valid_mean=0.3105, reward_valid_std=2.2584
[BatchDiag] adv_mean=-0.2798, adv_std=0.9761, adv_abs_mean=0.7288 | ret_mean=6.7479, ret_std=1.7522 | val_mean=7.0276, val_std=1.4309 | explained_var=0.689671
[GradSplit pre-clip] backbone=0.414622, critic=1.753966
[Loss] pg_loss=-0.058608, entropy_loss=0.000044, value_loss=0.040829
[EpochKL] epoch=0 mean_kl=0.00601 max_kl=0.00953
[EpochKL] epoch=1 mean_kl=0.00530 max_kl=0.00823
[EpochKL] epoch=2 mean_kl=0.00658 max_kl=0.00747
[Time] Env Create Time: 2.8817s |Rollout Collect Time: 9.2590s |Loss & Update :4.6523
[PPODiag] kl_mean=0.0060, kl_p90=0.0080, kl_max=0.0095 | clipfrac_mean=0.035, logratio_std_mean=0.112, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.291, p10=0.287, min=0.286 | pg_loss_mean=0.0016, v_loss_mean=0.1882, ent_mean=0.0423 | gn_bb_mean=1.329, gn_bb_max=2.096 | gn_v_mean=1.678, gn_v_max=3.006

  8%|▊         | 385/5000 [1:00:55<16:36:10, 12.95s/it]------------------ Training Record ------------------
Epoch: 385/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=55, valid_ratio=0.315, reward_valid_mean=0.3168, reward_valid_std=2.2705
[BatchDiag] adv_mean=-0.2138, adv_std=0.9291, adv_abs_mean=0.7071 | ret_mean=6.7802, ret_std=1.7160 | val_mean=6.9940, val_std=1.4370 | explained_var=0.706808
[GradSplit pre-clip] backbone=0.802016, critic=1.656221
[Loss] pg_loss=-0.042134, entropy_loss=0.000049, value_loss=0.040456
[EpochKL] epoch=0 mean_kl=0.00330 max_kl=0.00634
[EpochKL] epoch=1 mean_kl=0.00546 max_kl=0.01111
[EpochKL] epoch=2 mean_kl=0.00593 max_kl=0.01126
[Time] Env Create Time: 2.8811s |Rollout Collect Time: 8.4968s |Loss & Update :4.2733
[PPODiag] kl_mean=0.0049, kl_p90=0.0064, kl_max=0.0113 | clipfrac_mean=0.030, logratio_std_mean=0.104, ratio_p95_mean=1.043 | valid_ratio_mb_mean=0.315, p10=0.312, min=0.312 | pg_loss_mean=0.0013, v_loss_mean=0.1788, ent_mean=0.0456 | gn_bb_mean=1.073, gn_bb_max=1.735 | gn_v_mean=1.431, gn_v_max=2.833
[AttnScore] scale=1.1312, C=10.0

  8%|▊         | 386/5000 [1:01:11<17:38:15, 13.76s/it]------------------ Training Record ------------------
Epoch: 386/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.755, reward_valid_mean=0.3130, reward_valid_std=2.2652
[BatchDiag] adv_mean=-0.2686, adv_std=0.9266, adv_abs_mean=0.7111 | ret_mean=6.7837, ret_std=1.7169 | val_mean=7.0523, val_std=1.4207 | explained_var=0.708754
[GradSplit pre-clip] backbone=0.578154, critic=1.233273
[Loss] pg_loss=-0.110471, entropy_loss=0.000114, value_loss=0.038754
[EpochKL] epoch=0 mean_kl=0.00336 max_kl=0.00564
[EpochKL] epoch=1 mean_kl=0.00904 max_kl=0.01337
[EpochKL] epoch=2 mean_kl=0.00922 max_kl=0.01620
[Time] Env Create Time: 2.8965s |Rollout Collect Time: 3.6789s |Loss & Update :1.9440
[PPODiag] kl_mean=0.0072, kl_p90=0.0115, kl_max=0.0162 | clipfrac_mean=0.039, logratio_std_mean=0.121, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.755, p10=0.749, min=0.747 | pg_loss_mean=0.0024, v_loss_mean=0.1867, ent_mean=0.1099 | gn_bb_mean=1.415, gn_bb_max=2.247 | gn_v_mean=2.214, gn_v_max=4.819

  8%|▊         | 387/5000 [1:01:19<15:37:07, 12.19s/it]------------------ Training Record ------------------
Epoch: 387/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3163, reward_valid_std=2.2706
[BatchDiag] adv_mean=-0.2518, adv_std=0.9055, adv_abs_mean=0.6921 | ret_mean=6.8208, ret_std=1.6961 | val_mean=7.0725, val_std=1.4511 | explained_var=0.714963
[GradSplit pre-clip] backbone=0.856379, critic=1.370787
[Loss] pg_loss=-0.090567, entropy_loss=0.000132, value_loss=0.038439
[EpochKL] epoch=0 mean_kl=0.00374 max_kl=0.00574
[EpochKL] epoch=1 mean_kl=0.00661 max_kl=0.00999
[EpochKL] epoch=2 mean_kl=0.00750 max_kl=0.01235
[Time] Env Create Time: 2.7149s |Rollout Collect Time: 3.5062s |Loss & Update :1.8725
[PPODiag] kl_mean=0.0060, kl_p90=0.0097, kl_max=0.0124 | clipfrac_mean=0.035, logratio_std_mean=0.112, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.789, p10=0.783, min=0.779 | pg_loss_mean=0.0021, v_loss_mean=0.1763, ent_mean=0.1179 | gn_bb_mean=1.329, gn_bb_max=2.120 | gn_v_mean=1.754, gn_v_max=2.850

  8%|▊         | 388/5000 [1:01:28<14:02:29, 10.96s/it]------------------ Training Record ------------------
Epoch: 388/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3163, reward_valid_std=2.2685
[BatchDiag] adv_mean=-0.2182, adv_std=0.8941, adv_abs_mean=0.6871 | ret_mean=6.8051, ret_std=1.7041 | val_mean=7.0233, val_std=1.4341 | explained_var=0.724724
[GradSplit pre-clip] backbone=0.694640, critic=1.724701
[Loss] pg_loss=0.029808, entropy_loss=0.000124, value_loss=0.046504
[EpochKL] epoch=0 mean_kl=0.00525 max_kl=0.01099
[EpochKL] epoch=1 mean_kl=0.00808 max_kl=0.01250
[EpochKL] epoch=2 mean_kl=0.00794 max_kl=0.01064
[Time] Env Create Time: 2.8565s |Rollout Collect Time: 3.4998s |Loss & Update :1.8778
[PPODiag] kl_mean=0.0071, kl_p90=0.0106, kl_max=0.0125 | clipfrac_mean=0.040, logratio_std_mean=0.122, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.789, p10=0.785, min=0.784 | pg_loss_mean=0.0029, v_loss_mean=0.1721, ent_mean=0.1160 | gn_bb_mean=1.452, gn_bb_max=2.193 | gn_v_mean=1.541, gn_v_max=3.049

  8%|▊         | 389/5000 [1:01:36<12:59:28, 10.14s/it]------------------ Training Record ------------------
Epoch: 389/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3172, reward_valid_std=2.2695
[BatchDiag] adv_mean=-0.2363, adv_std=0.9063, adv_abs_mean=0.6952 | ret_mean=6.8105, ret_std=1.7053 | val_mean=7.0468, val_std=1.4308 | explained_var=0.717547
[GradSplit pre-clip] backbone=0.597035, critic=0.983774
[Loss] pg_loss=-0.117080, entropy_loss=0.000127, value_loss=0.038489
[EpochKL] epoch=0 mean_kl=0.00365 max_kl=0.00545
[EpochKL] epoch=1 mean_kl=0.00843 max_kl=0.01033
[EpochKL] epoch=2 mean_kl=0.00826 max_kl=0.01305
[Time] Env Create Time: 2.8751s |Rollout Collect Time: 3.3663s |Loss & Update :1.8026
[PPODiag] kl_mean=0.0068, kl_p90=0.0098, kl_max=0.0131 | clipfrac_mean=0.037, logratio_std_mean=0.120, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.825, p10=0.817, min=0.814 | pg_loss_mean=0.0024, v_loss_mean=0.1771, ent_mean=0.1154 | gn_bb_mean=1.330, gn_bb_max=1.945 | gn_v_mean=1.700, gn_v_max=2.956

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.739, Step: 22, Avg Done Step: 18.39, #CS visited: 0.40
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->C8->D->C6->C7->C11->C10->C9->D
Eval cost : 4.2018s
-----------------------------
  8%|▊         | 390/5000 [1:01:48<13:48:24, 10.78s/it]------------------ Training Record ------------------
Epoch: 390/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3209, reward_valid_std=2.2684
[BatchDiag] adv_mean=-0.1983, adv_std=0.8809, adv_abs_mean=0.6675 | ret_mean=6.8457, ret_std=1.6924 | val_mean=7.0440, val_std=1.4582 | explained_var=0.729091
[GradSplit pre-clip] backbone=0.513214, critic=1.534246
[Loss] pg_loss=0.009720, entropy_loss=0.000114, value_loss=0.040754
[EpochKL] epoch=0 mean_kl=0.00409 max_kl=0.00787
[EpochKL] epoch=1 mean_kl=0.00498 max_kl=0.01050
[EpochKL] epoch=2 mean_kl=0.00574 max_kl=0.00679
[Time] Env Create Time: 2.7111s |Rollout Collect Time: 3.3241s |Loss & Update :1.8018
[PPODiag] kl_mean=0.0049, kl_p90=0.0074, kl_max=0.0105 | clipfrac_mean=0.031, logratio_std_mean=0.099, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.824, p10=0.819, min=0.819 | pg_loss_mean=0.0018, v_loss_mean=0.1636, ent_mean=0.1167 | gn_bb_mean=1.221, gn_bb_max=1.786 | gn_v_mean=1.171, gn_v_max=2.298
[AttnScore] scale=1.1322, C=10.0

  8%|▊         | 391/5000 [1:01:56<12:40:22,  9.90s/it]------------------ Training Record ------------------
Epoch: 391/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3168, reward_valid_std=2.2678
[BatchDiag] adv_mean=-0.2208, adv_std=0.9022, adv_abs_mean=0.6955 | ret_mean=6.7960, ret_std=1.7057 | val_mean=7.0168, val_std=1.4102 | explained_var=0.720224
[GradSplit pre-clip] backbone=0.560864, critic=0.753199
[Loss] pg_loss=-0.131759, entropy_loss=0.000121, value_loss=0.035991
[EpochKL] epoch=0 mean_kl=0.00301 max_kl=0.00595
[EpochKL] epoch=1 mean_kl=0.00518 max_kl=0.00762
[EpochKL] epoch=2 mean_kl=0.00691 max_kl=0.00906
[Time] Env Create Time: 2.8217s |Rollout Collect Time: 3.3244s |Loss & Update :1.7957
[PPODiag] kl_mean=0.0050, kl_p90=0.0084, kl_max=0.0091 | clipfrac_mean=0.032, logratio_std_mean=0.101, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.826, p10=0.821, min=0.812 | pg_loss_mean=0.0016, v_loss_mean=0.1718, ent_mean=0.1155 | gn_bb_mean=1.228, gn_bb_max=2.106 | gn_v_mean=1.047, gn_v_max=1.991

  8%|▊         | 392/5000 [1:02:04<11:55:08,  9.31s/it]------------------ Training Record ------------------
Epoch: 392/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3191, reward_valid_std=2.2730
[BatchDiag] adv_mean=-0.1146, adv_std=0.8998, adv_abs_mean=0.6812 | ret_mean=6.7919, ret_std=1.7195 | val_mean=6.9065, val_std=1.4897 | explained_var=0.726133
[GradSplit pre-clip] backbone=0.618160, critic=0.499396
[Loss] pg_loss=-0.037231, entropy_loss=0.000113, value_loss=0.042080
[EpochKL] epoch=0 mean_kl=0.00212 max_kl=0.00358
[EpochKL] epoch=1 mean_kl=0.00498 max_kl=0.00740
[EpochKL] epoch=2 mean_kl=0.00692 max_kl=0.01007
[Time] Env Create Time: 2.8246s |Rollout Collect Time: 3.4702s |Loss & Update :1.8651
[PPODiag] kl_mean=0.0047, kl_p90=0.0080, kl_max=0.0101 | clipfrac_mean=0.030, logratio_std_mean=0.096, ratio_p95_mean=1.041 | valid_ratio_mb_mean=0.786, p10=0.780, min=0.779 | pg_loss_mean=0.0018, v_loss_mean=0.1695, ent_mean=0.1076 | gn_bb_mean=1.158, gn_bb_max=1.629 | gn_v_mean=1.067, gn_v_max=2.204

  8%|▊         | 393/5000 [1:02:12<11:28:27,  8.97s/it]------------------ Training Record ------------------
Epoch: 393/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51001/51200 = 0.996
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.291, reward_valid_mean=0.3141, reward_valid_std=2.2582
[BatchDiag] adv_mean=-0.1770, adv_std=1.0602, adv_abs_mean=0.7270 | ret_mean=6.7259, ret_std=1.8184 | val_mean=6.9030, val_std=1.4667 | explained_var=0.660032
[GradSplit pre-clip] backbone=0.441637, critic=0.451285
[Loss] pg_loss=-0.111498, entropy_loss=0.000041, value_loss=0.036729
[EpochKL] epoch=0 mean_kl=0.00285 max_kl=0.00441
[EpochKL] epoch=1 mean_kl=0.00938 max_kl=0.01299
[EarlyStop] epoch=2 mean_kl=0.01252 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01252 max_kl=0.01655
[Time] Env Create Time: 2.8425s |Rollout Collect Time: 9.1231s |Loss & Update :4.6701
[PPODiag] kl_mean=0.0083, kl_p90=0.0132, kl_max=0.0165 | clipfrac_mean=0.037, logratio_std_mean=0.136, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.291, p10=0.287, min=0.284 | pg_loss_mean=0.0008, v_loss_mean=0.1928, ent_mean=0.0399 | gn_bb_mean=1.128, gn_bb_max=2.349 | gn_v_mean=1.113, gn_v_max=2.102

  8%|▊         | 394/5000 [1:02:29<14:24:56, 11.27s/it]------------------ Training Record ------------------
Epoch: 394/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.754, reward_valid_mean=0.3160, reward_valid_std=2.2685
[BatchDiag] adv_mean=-0.2220, adv_std=0.9120, adv_abs_mean=0.7007 | ret_mean=6.7882, ret_std=1.7071 | val_mean=7.0102, val_std=1.4670 | explained_var=0.714565
[GradSplit pre-clip] backbone=0.446356, critic=1.622977
[Loss] pg_loss=-0.011162, entropy_loss=0.000111, value_loss=0.043412
[EpochKL] epoch=0 mean_kl=0.00394 max_kl=0.00749
[EarlyStop] epoch=1 mean_kl=0.01008 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01008 max_kl=0.01558
[Time] Env Create Time: 2.7115s |Rollout Collect Time: 3.6502s |Loss & Update :1.3274
[PPODiag] kl_mean=0.0070, kl_p90=0.0139, kl_max=0.0156 | clipfrac_mean=0.035, logratio_std_mean=0.119, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.754, p10=0.750, min=0.747 | pg_loss_mean=0.0029, v_loss_mean=0.1782, ent_mean=0.1026 | gn_bb_mean=1.357, gn_bb_max=1.862 | gn_v_mean=1.615, gn_v_max=2.859

  8%|▊         | 395/5000 [1:02:36<13:02:22, 10.19s/it]------------------ Training Record ------------------
Epoch: 395/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.784, reward_valid_mean=0.3215, reward_valid_std=2.2728
[BatchDiag] adv_mean=-0.1086, adv_std=0.8975, adv_abs_mean=0.6864 | ret_mean=6.7833, ret_std=1.7023 | val_mean=6.8918, val_std=1.4196 | explained_var=0.722046
[GradSplit pre-clip] backbone=0.448243, critic=0.754052
[Loss] pg_loss=-0.114774, entropy_loss=0.000115, value_loss=0.039336
[EpochKL] epoch=0 mean_kl=0.00303 max_kl=0.00542
[EpochKL] epoch=1 mean_kl=0.00581 max_kl=0.00683
[EpochKL] epoch=2 mean_kl=0.00668 max_kl=0.00974
[Time] Env Create Time: 2.8581s |Rollout Collect Time: 3.4945s |Loss & Update :1.8633
[PPODiag] kl_mean=0.0052, kl_p90=0.0068, kl_max=0.0097 | clipfrac_mean=0.034, logratio_std_mean=0.102, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.784, p10=0.777, min=0.775 | pg_loss_mean=0.0018, v_loss_mean=0.1726, ent_mean=0.1138 | gn_bb_mean=1.320, gn_bb_max=2.134 | gn_v_mean=1.629, gn_v_max=3.202
[AttnScore] scale=1.1339, C=10.0

  8%|▊         | 396/5000 [1:02:45<12:16:41,  9.60s/it]------------------ Training Record ------------------
Epoch: 396/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3207, reward_valid_std=2.2715
[BatchDiag] adv_mean=-0.0882, adv_std=0.9132, adv_abs_mean=0.6857 | ret_mean=6.7719, ret_std=1.7155 | val_mean=6.8601, val_std=1.4505 | explained_var=0.716629
[GradSplit pre-clip] backbone=0.618229, critic=0.548129
[Loss] pg_loss=-0.059605, entropy_loss=0.000115, value_loss=0.039960
[EpochKL] epoch=0 mean_kl=0.00368 max_kl=0.00629
[EpochKL] epoch=1 mean_kl=0.00611 max_kl=0.00862
[EpochKL] epoch=2 mean_kl=0.00697 max_kl=0.00877
[Time] Env Create Time: 2.8560s |Rollout Collect Time: 3.4954s |Loss & Update :1.8662
[PPODiag] kl_mean=0.0056, kl_p90=0.0082, kl_max=0.0088 | clipfrac_mean=0.034, logratio_std_mean=0.107, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.785, p10=0.781, min=0.778 | pg_loss_mean=0.0020, v_loss_mean=0.1761, ent_mean=0.1117 | gn_bb_mean=1.280, gn_bb_max=1.964 | gn_v_mean=1.554, gn_v_max=3.147

  8%|▊         | 397/5000 [1:02:53<11:44:42,  9.19s/it]------------------ Training Record ------------------
Epoch: 397/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3206, reward_valid_std=2.2761
[BatchDiag] adv_mean=0.0190, adv_std=0.9196, adv_abs_mean=0.6934 | ret_mean=6.7588, ret_std=1.7421 | val_mean=6.7398, val_std=1.5255 | explained_var=0.721365
[GradSplit pre-clip] backbone=0.595825, critic=0.988220
[Loss] pg_loss=-0.049417, entropy_loss=0.000115, value_loss=0.043539
[EpochKL] epoch=0 mean_kl=0.00339 max_kl=0.00654
[EpochKL] epoch=1 mean_kl=0.00652 max_kl=0.00803
[EpochKL] epoch=2 mean_kl=0.00571 max_kl=0.00708
[Time] Env Create Time: 2.8665s |Rollout Collect Time: 3.3533s |Loss & Update :1.8034
[PPODiag] kl_mean=0.0052, kl_p90=0.0069, kl_max=0.0080 | clipfrac_mean=0.032, logratio_std_mean=0.105, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.823, p10=0.818, min=0.813 | pg_loss_mean=0.0018, v_loss_mean=0.1747, ent_mean=0.1154 | gn_bb_mean=1.186, gn_bb_max=1.620 | gn_v_mean=0.962, gn_v_max=2.231

  8%|▊         | 398/5000 [1:03:01<11:17:48,  8.84s/it]------------------ Training Record ------------------
Epoch: 398/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3201, reward_valid_std=2.2699
[BatchDiag] adv_mean=-0.1056, adv_std=0.9109, adv_abs_mean=0.6849 | ret_mean=6.7907, ret_std=1.7177 | val_mean=6.8963, val_std=1.4879 | explained_var=0.718801
[GradSplit pre-clip] backbone=0.543008, critic=0.616620
[Loss] pg_loss=-0.024117, entropy_loss=0.000113, value_loss=0.040237
[EpochKL] epoch=0 mean_kl=0.00234 max_kl=0.00362
[EpochKL] epoch=1 mean_kl=0.00578 max_kl=0.00776
[EpochKL] epoch=2 mean_kl=0.00575 max_kl=0.00720
[Time] Env Create Time: 2.7003s |Rollout Collect Time: 3.4909s |Loss & Update :1.8601
[PPODiag] kl_mean=0.0046, kl_p90=0.0066, kl_max=0.0078 | clipfrac_mean=0.031, logratio_std_mean=0.096, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.787, p10=0.783, min=0.780 | pg_loss_mean=0.0016, v_loss_mean=0.1739, ent_mean=0.1132 | gn_bb_mean=1.186, gn_bb_max=1.905 | gn_v_mean=1.181, gn_v_max=2.644

  8%|▊         | 399/5000 [1:03:09<10:59:35,  8.60s/it]------------------ Training Record ------------------
Epoch: 399/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.784, reward_valid_mean=0.3240, reward_valid_std=2.2786
[BatchDiag] adv_mean=-0.0804, adv_std=0.8977, adv_abs_mean=0.6745 | ret_mean=6.8178, ret_std=1.7082 | val_mean=6.8982, val_std=1.5030 | explained_var=0.723824
[GradSplit pre-clip] backbone=0.614815, critic=0.421772
[Loss] pg_loss=-0.041684, entropy_loss=0.000121, value_loss=0.039249
[EpochKL] epoch=0 mean_kl=0.00222 max_kl=0.00475
[EpochKL] epoch=1 mean_kl=0.00455 max_kl=0.00641
[EpochKL] epoch=2 mean_kl=0.00716 max_kl=0.00912
[Time] Env Create Time: 2.8436s |Rollout Collect Time: 3.4855s |Loss & Update :1.8706
[PPODiag] kl_mean=0.0046, kl_p90=0.0081, kl_max=0.0091 | clipfrac_mean=0.031, logratio_std_mean=0.095, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.784, p10=0.780, min=0.778 | pg_loss_mean=0.0018, v_loss_mean=0.1689, ent_mean=0.1129 | gn_bb_mean=1.240, gn_bb_max=2.361 | gn_v_mean=1.184, gn_v_max=3.182

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.707, Step: 20, Avg Done Step: 18.37, #CS visited: 0.39
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->C8->D->C6->C7->C11->C10->C9->D
Eval cost : 3.8751s
-----------------------------
  8%|▊         | 400/5000 [1:03:21<12:20:29,  9.66s/it]------------------ Training Record ------------------
Epoch: 400/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3217, reward_valid_std=2.2727
[BatchDiag] adv_mean=-0.0820, adv_std=0.9136, adv_abs_mean=0.6856 | ret_mean=6.7850, ret_std=1.7104 | val_mean=6.8670, val_std=1.4844 | explained_var=0.714682
[GradSplit pre-clip] backbone=0.513065, critic=0.420509
[Loss] pg_loss=-0.034841, entropy_loss=0.000117, value_loss=0.043286
[EpochKL] epoch=0 mean_kl=0.00406 max_kl=0.00632
[EpochKL] epoch=1 mean_kl=0.00519 max_kl=0.00776
[EpochKL] epoch=2 mean_kl=0.00555 max_kl=0.00820
[Time] Env Create Time: 2.8316s |Rollout Collect Time: 3.4814s |Loss & Update :1.8706
[PPODiag] kl_mean=0.0049, kl_p90=0.0073, kl_max=0.0082 | clipfrac_mean=0.032, logratio_std_mean=0.101, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.785, p10=0.781, min=0.779 | pg_loss_mean=0.0018, v_loss_mean=0.1728, ent_mean=0.1116 | gn_bb_mean=1.230, gn_bb_max=1.890 | gn_v_mean=1.075, gn_v_max=1.987
[AttnScore] scale=1.1362, C=10.0

  8%|▊         | 401/5000 [1:03:29<11:46:25,  9.22s/it]------------------ Training Record ------------------
Epoch: 401/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3189, reward_valid_std=2.2695
[BatchDiag] adv_mean=-0.0119, adv_std=0.9179, adv_abs_mean=0.6980 | ret_mean=6.7336, ret_std=1.7489 | val_mean=6.7455, val_std=1.4956 | explained_var=0.724519
[GradSplit pre-clip] backbone=0.697477, critic=0.885647
[Loss] pg_loss=-0.064269, entropy_loss=0.000120, value_loss=0.042945
[EpochKL] epoch=0 mean_kl=0.00311 max_kl=0.00478
[EpochKL] epoch=1 mean_kl=0.00476 max_kl=0.00602
[EpochKL] epoch=2 mean_kl=0.00504 max_kl=0.00728
[Time] Env Create Time: 2.8696s |Rollout Collect Time: 3.3640s |Loss & Update :1.8038
[PPODiag] kl_mean=0.0043, kl_p90=0.0060, kl_max=0.0073 | clipfrac_mean=0.030, logratio_std_mean=0.094, ratio_p95_mean=1.043 | valid_ratio_mb_mean=0.824, p10=0.819, min=0.815 | pg_loss_mean=0.0016, v_loss_mean=0.1766, ent_mean=0.1154 | gn_bb_mean=1.138, gn_bb_max=1.505 | gn_v_mean=1.113, gn_v_max=2.337

  8%|▊         | 402/5000 [1:03:37<11:19:11,  8.86s/it]------------------ Training Record ------------------
Epoch: 402/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3169, reward_valid_std=2.2666
[BatchDiag] adv_mean=-0.1237, adv_std=0.9099, adv_abs_mean=0.6819 | ret_mean=6.7621, ret_std=1.7310 | val_mean=6.8858, val_std=1.4979 | explained_var=0.723671
[GradSplit pre-clip] backbone=0.543324, critic=0.330905
[Loss] pg_loss=-0.090063, entropy_loss=0.000113, value_loss=0.038877
[EpochKL] epoch=0 mean_kl=0.00302 max_kl=0.00429
[EpochKL] epoch=1 mean_kl=0.00512 max_kl=0.00792
[EpochKL] epoch=2 mean_kl=0.00548 max_kl=0.00795
[Time] Env Create Time: 2.7000s |Rollout Collect Time: 3.5013s |Loss & Update :1.8788
[PPODiag] kl_mean=0.0045, kl_p90=0.0076, kl_max=0.0079 | clipfrac_mean=0.030, logratio_std_mean=0.096, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.789, p10=0.783, min=0.781 | pg_loss_mean=0.0016, v_loss_mean=0.1721, ent_mean=0.1124 | gn_bb_mean=1.112, gn_bb_max=1.556 | gn_v_mean=1.229, gn_v_max=3.023

  8%|▊         | 403/5000 [1:03:45<11:01:03,  8.63s/it]------------------ Training Record ------------------
Epoch: 403/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3222, reward_valid_std=2.2691
[BatchDiag] adv_mean=-0.1007, adv_std=0.8927, adv_abs_mean=0.6708 | ret_mean=6.7936, ret_std=1.7033 | val_mean=6.8943, val_std=1.4772 | explained_var=0.725324
[GradSplit pre-clip] backbone=0.570326, critic=0.575305
[Loss] pg_loss=-0.037860, entropy_loss=0.000119, value_loss=0.042835
[EpochKL] epoch=0 mean_kl=0.00310 max_kl=0.00575
[EpochKL] epoch=1 mean_kl=0.00402 max_kl=0.00604
[EpochKL] epoch=2 mean_kl=0.00537 max_kl=0.00637
[Time] Env Create Time: 2.8587s |Rollout Collect Time: 3.5058s |Loss & Update :1.8825
[PPODiag] kl_mean=0.0042, kl_p90=0.0059, kl_max=0.0064 | clipfrac_mean=0.030, logratio_std_mean=0.092, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.786, p10=0.780, min=0.778 | pg_loss_mean=0.0012, v_loss_mean=0.1687, ent_mean=0.1131 | gn_bb_mean=1.097, gn_bb_max=1.447 | gn_v_mean=1.301, gn_v_max=2.663

  8%|▊         | 404/5000 [1:03:53<10:52:10,  8.51s/it]------------------ Training Record ------------------
Epoch: 404/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3222, reward_valid_std=2.2725
[BatchDiag] adv_mean=-0.0678, adv_std=0.9063, adv_abs_mean=0.6780 | ret_mean=6.7981, ret_std=1.7234 | val_mean=6.8659, val_std=1.5090 | explained_var=0.723470
[GradSplit pre-clip] backbone=0.505863, critic=0.580699
[Loss] pg_loss=-0.108789, entropy_loss=0.000119, value_loss=0.036952
[EpochKL] epoch=0 mean_kl=0.00338 max_kl=0.00630
[EpochKL] epoch=1 mean_kl=0.00685 max_kl=0.01391
[EpochKL] epoch=2 mean_kl=0.00708 max_kl=0.00893
[Time] Env Create Time: 2.8709s |Rollout Collect Time: 3.4938s |Loss & Update :1.8848
[PPODiag] kl_mean=0.0058, kl_p90=0.0086, kl_max=0.0139 | clipfrac_mean=0.034, logratio_std_mean=0.108, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.786, p10=0.782, min=0.776 | pg_loss_mean=0.0019, v_loss_mean=0.1720, ent_mean=0.1142 | gn_bb_mean=1.217, gn_bb_max=2.245 | gn_v_mean=1.492, gn_v_max=3.885

  8%|▊         | 405/5000 [1:04:02<10:45:57,  8.43s/it]------------------ Training Record ------------------
Epoch: 405/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.751, reward_valid_mean=0.3238, reward_valid_std=2.2731
[BatchDiag] adv_mean=-0.1008, adv_std=0.8864, adv_abs_mean=0.6731 | ret_mean=6.8227, ret_std=1.7017 | val_mean=6.9235, val_std=1.4570 | explained_var=0.728676
[GradSplit pre-clip] backbone=0.471688, critic=0.638814
[Loss] pg_loss=-0.067796, entropy_loss=0.000111, value_loss=0.039002
[EpochKL] epoch=0 mean_kl=0.00240 max_kl=0.00375
[EpochKL] epoch=1 mean_kl=0.00433 max_kl=0.00616
[EpochKL] epoch=2 mean_kl=0.00684 max_kl=0.01068
[Time] Env Create Time: 2.7027s |Rollout Collect Time: 3.6462s |Loss & Update :1.9644
[PPODiag] kl_mean=0.0045, kl_p90=0.0082, kl_max=0.0107 | clipfrac_mean=0.030, logratio_std_mean=0.095, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.751, p10=0.744, min=0.742 | pg_loss_mean=0.0014, v_loss_mean=0.1672, ent_mean=0.1057 | gn_bb_mean=1.343, gn_bb_max=2.248 | gn_v_mean=1.192, gn_v_max=2.969
[AttnScore] scale=1.1384, C=10.0

  8%|▊         | 406/5000 [1:04:10<10:43:02,  8.40s/it]------------------ Training Record ------------------
Epoch: 406/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3191, reward_valid_std=2.2695
[BatchDiag] adv_mean=-0.1988, adv_std=0.8826, adv_abs_mean=0.6803 | ret_mean=6.8138, ret_std=1.6929 | val_mean=7.0126, val_std=1.4421 | explained_var=0.728195
[GradSplit pre-clip] backbone=0.548427, critic=1.436453
[Loss] pg_loss=-0.055539, entropy_loss=0.000116, value_loss=0.042339
[EpochKL] epoch=0 mean_kl=0.00372 max_kl=0.00735
[EpochKL] epoch=1 mean_kl=0.00632 max_kl=0.00975
[EpochKL] epoch=2 mean_kl=0.00549 max_kl=0.00748
[Time] Env Create Time: 2.8528s |Rollout Collect Time: 3.3488s |Loss & Update :1.8094
[PPODiag] kl_mean=0.0052, kl_p90=0.0074, kl_max=0.0097 | clipfrac_mean=0.032, logratio_std_mean=0.104, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.825, p10=0.819, min=0.818 | pg_loss_mean=0.0018, v_loss_mean=0.1672, ent_mean=0.1151 | gn_bb_mean=1.234, gn_bb_max=1.740 | gn_v_mean=1.267, gn_v_max=2.598

  8%|▊         | 407/5000 [1:04:18<10:34:00,  8.28s/it]------------------ Training Record ------------------
Epoch: 407/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3208, reward_valid_std=2.2673
[BatchDiag] adv_mean=-0.1575, adv_std=0.8888, adv_abs_mean=0.6720 | ret_mean=6.8125, ret_std=1.7048 | val_mean=6.9700, val_std=1.4560 | explained_var=0.728233
[GradSplit pre-clip] backbone=0.518771, critic=0.915681
[Loss] pg_loss=-0.084151, entropy_loss=0.000120, value_loss=0.036189
[EpochKL] epoch=0 mean_kl=0.00236 max_kl=0.00423
[EpochKL] epoch=1 mean_kl=0.00470 max_kl=0.00618
[EpochKL] epoch=2 mean_kl=0.00531 max_kl=0.00594
[Time] Env Create Time: 2.8630s |Rollout Collect Time: 3.3535s |Loss & Update :1.8198
[PPODiag] kl_mean=0.0041, kl_p90=0.0058, kl_max=0.0062 | clipfrac_mean=0.029, logratio_std_mean=0.091, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.825, p10=0.819, min=0.814 | pg_loss_mean=0.0011, v_loss_mean=0.1663, ent_mean=0.1148 | gn_bb_mean=1.062, gn_bb_max=1.434 | gn_v_mean=1.278, gn_v_max=2.929

  8%|▊         | 408/5000 [1:04:26<10:28:14,  8.21s/it]------------------ Training Record ------------------
Epoch: 408/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3199, reward_valid_std=2.2724
[BatchDiag] adv_mean=-0.1848, adv_std=0.9044, adv_abs_mean=0.6849 | ret_mean=6.8358, ret_std=1.7007 | val_mean=7.0206, val_std=1.4599 | explained_var=0.717231
[GradSplit pre-clip] backbone=0.523789, critic=0.944700
[Loss] pg_loss=-0.085159, entropy_loss=0.000113, value_loss=0.039393
[EpochKL] epoch=0 mean_kl=0.00220 max_kl=0.00372
[EpochKL] epoch=1 mean_kl=0.00474 max_kl=0.00717
[EpochKL] epoch=2 mean_kl=0.00537 max_kl=0.00737
[Time] Env Create Time: 2.8631s |Rollout Collect Time: 3.4675s |Loss & Update :1.8732
[PPODiag] kl_mean=0.0041, kl_p90=0.0064, kl_max=0.0074 | clipfrac_mean=0.029, logratio_std_mean=0.091, ratio_p95_mean=1.041 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.781 | pg_loss_mean=0.0013, v_loss_mean=0.1734, ent_mean=0.1074 | gn_bb_mean=1.121, gn_bb_max=1.526 | gn_v_mean=1.787, gn_v_max=3.128

  8%|▊         | 409/5000 [1:04:34<10:27:59,  8.21s/it]------------------ Training Record ------------------
Epoch: 409/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3201, reward_valid_std=2.2730
[BatchDiag] adv_mean=-0.2435, adv_std=0.9054, adv_abs_mean=0.6959 | ret_mean=6.8399, ret_std=1.6859 | val_mean=7.0834, val_std=1.4363 | explained_var=0.711594
[GradSplit pre-clip] backbone=0.668090, critic=1.556379
[Loss] pg_loss=-0.076402, entropy_loss=0.000116, value_loss=0.038769
[EpochKL] epoch=0 mean_kl=0.00289 max_kl=0.00460
[EpochKL] epoch=1 mean_kl=0.00581 max_kl=0.00759
[EpochKL] epoch=2 mean_kl=0.00503 max_kl=0.00605
[Time] Env Create Time: 2.6966s |Rollout Collect Time: 3.5046s |Loss & Update :1.8574
[PPODiag] kl_mean=0.0046, kl_p90=0.0062, kl_max=0.0076 | clipfrac_mean=0.031, logratio_std_mean=0.098, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.786, p10=0.781, min=0.779 | pg_loss_mean=0.0014, v_loss_mean=0.1773, ent_mean=0.1075 | gn_bb_mean=1.140, gn_bb_max=1.505 | gn_v_mean=2.010, gn_v_max=3.776

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.680, Step: 21, Avg Done Step: 18.39, #CS visited: 0.39
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->D->C6->C7->C11->C10->C9->C8->D
Eval cost : 4.0638s
-----------------------------
  8%|▊         | 410/5000 [1:04:46<11:58:52,  9.40s/it]------------------ Training Record ------------------
Epoch: 410/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3225, reward_valid_std=2.2717
[BatchDiag] adv_mean=-0.2749, adv_std=0.8795, adv_abs_mean=0.6863 | ret_mean=6.8815, ret_std=1.6520 | val_mean=7.1564, val_std=1.4030 | explained_var=0.716581
[GradSplit pre-clip] backbone=0.579020, critic=1.915570
[Loss] pg_loss=-0.065817, entropy_loss=0.000118, value_loss=0.039720
[EpochKL] epoch=0 mean_kl=0.00452 max_kl=0.00718
[EpochKL] epoch=1 mean_kl=0.00773 max_kl=0.01442
[EarlyStop] epoch=2 mean_kl=0.01229 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01229 max_kl=0.02242
[Time] Env Create Time: 2.8487s |Rollout Collect Time: 3.3480s |Loss & Update :1.8008
[PPODiag] kl_mean=0.0082, kl_p90=0.0146, kl_max=0.0224 | clipfrac_mean=0.040, logratio_std_mean=0.132, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.824, p10=0.818, min=0.814 | pg_loss_mean=0.0030, v_loss_mean=0.1667, ent_mean=0.1133 | gn_bb_mean=1.565, gn_bb_max=2.891 | gn_v_mean=1.240, gn_v_max=2.760
[AttnScore] scale=1.1408, C=10.0

  8%|▊         | 411/5000 [1:04:54<11:26:37,  8.98s/it]------------------ Training Record ------------------
Epoch: 411/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3188, reward_valid_std=2.2663
[BatchDiag] adv_mean=-0.1934, adv_std=0.8901, adv_abs_mean=0.6780 | ret_mean=6.8126, ret_std=1.6834 | val_mean=7.0060, val_std=1.4435 | explained_var=0.720398
[GradSplit pre-clip] backbone=0.509970, critic=1.269550
[Loss] pg_loss=-0.032867, entropy_loss=0.000120, value_loss=0.041059
[EpochKL] epoch=0 mean_kl=0.00621 max_kl=0.01353
[EarlyStop] epoch=1 mean_kl=0.01056 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01056 max_kl=0.01274
[Time] Env Create Time: 2.8632s |Rollout Collect Time: 3.5014s |Loss & Update :1.2562
[PPODiag] kl_mean=0.0084, kl_p90=0.0123, kl_max=0.0135 | clipfrac_mean=0.042, logratio_std_mean=0.132, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.781 | pg_loss_mean=0.0036, v_loss_mean=0.1681, ent_mean=0.1118 | gn_bb_mean=1.514, gn_bb_max=2.303 | gn_v_mean=1.323, gn_v_max=2.391

  8%|▊         | 412/5000 [1:05:02<10:55:21,  8.57s/it]------------------ Training Record ------------------
Epoch: 412/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3235, reward_valid_std=2.2727
[BatchDiag] adv_mean=-0.1812, adv_std=0.8819, adv_abs_mean=0.6768 | ret_mean=6.8591, ret_std=1.6760 | val_mean=7.0403, val_std=1.4007 | explained_var=0.723144
[GradSplit pre-clip] backbone=0.491821, critic=1.351186
[Loss] pg_loss=-0.027113, entropy_loss=0.000124, value_loss=0.039744
[EpochKL] epoch=0 mean_kl=0.00460 max_kl=0.00928
[EarlyStop] epoch=1 mean_kl=0.01053 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01053 max_kl=0.02219
[Time] Env Create Time: 2.8484s |Rollout Collect Time: 3.3212s |Loss & Update :1.2145
[PPODiag] kl_mean=0.0076, kl_p90=0.0120, kl_max=0.0222 | clipfrac_mean=0.037, logratio_std_mean=0.123, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.823, p10=0.817, min=0.815 | pg_loss_mean=0.0034, v_loss_mean=0.1678, ent_mean=0.1143 | gn_bb_mean=1.403, gn_bb_max=2.684 | gn_v_mean=1.572, gn_v_max=2.685

  8%|▊         | 413/5000 [1:05:09<10:28:00,  8.21s/it]------------------ Training Record ------------------
Epoch: 413/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3230, reward_valid_std=2.2751
[BatchDiag] adv_mean=-0.1258, adv_std=0.8950, adv_abs_mean=0.6781 | ret_mean=6.8205, ret_std=1.7012 | val_mean=6.9463, val_std=1.4201 | explained_var=0.723235
[GradSplit pre-clip] backbone=0.528822, critic=0.501296
[Loss] pg_loss=-0.083984, entropy_loss=0.000124, value_loss=0.035743
[EpochKL] epoch=0 mean_kl=0.00450 max_kl=0.00608
[EpochKL] epoch=1 mean_kl=0.00884 max_kl=0.01168
[EarlyStop] epoch=2 mean_kl=0.01496 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01496 max_kl=0.02183
[Time] Env Create Time: 2.6833s |Rollout Collect Time: 3.3278s |Loss & Update :1.8031
[PPODiag] kl_mean=0.0094, kl_p90=0.0197, kl_max=0.0218 | clipfrac_mean=0.043, logratio_std_mean=0.145, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.824, p10=0.816, min=0.812 | pg_loss_mean=0.0038, v_loss_mean=0.1708, ent_mean=0.1130 | gn_bb_mean=1.651, gn_bb_max=2.539 | gn_v_mean=1.606, gn_v_max=3.360

  8%|▊         | 414/5000 [1:05:17<10:18:42,  8.09s/it]------------------ Training Record ------------------
Epoch: 414/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3211, reward_valid_std=2.2749
[BatchDiag] adv_mean=-0.1866, adv_std=0.8892, adv_abs_mean=0.6767 | ret_mean=6.8529, ret_std=1.6998 | val_mean=7.0395, val_std=1.4513 | explained_var=0.726384
[GradSplit pre-clip] backbone=0.691063, critic=1.562301
[Loss] pg_loss=-0.007075, entropy_loss=0.000119, value_loss=0.039202
[EarlyStop] epoch=0 mean_kl=0.01198 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01198 max_kl=0.02206
[Time] Env Create Time: 2.8302s |Rollout Collect Time: 3.4730s |Loss & Update :0.6500
[PPODiag] kl_mean=0.0120, kl_p90=0.0183, kl_max=0.0221 | clipfrac_mean=0.047, logratio_std_mean=0.158, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.786, p10=0.784, min=0.783 | pg_loss_mean=0.0053, v_loss_mean=0.1694, ent_mean=0.1118 | gn_bb_mean=1.732, gn_bb_max=2.763 | gn_v_mean=1.412, gn_v_max=1.945

  8%|▊         | 415/5000 [1:05:24<9:52:24,  7.75s/it] ------------------ Training Record ------------------
Epoch: 415/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3213, reward_valid_std=2.2741
[BatchDiag] adv_mean=-0.0079, adv_std=0.9228, adv_abs_mean=0.6969 | ret_mean=6.7737, ret_std=1.7440 | val_mean=6.7816, val_std=1.4585 | explained_var=0.720017
[GradSplit pre-clip] backbone=0.448733, critic=0.797465
[Loss] pg_loss=-0.069806, entropy_loss=0.000116, value_loss=0.039447
[EpochKL] epoch=0 mean_kl=0.00406 max_kl=0.00586
[EpochKL] epoch=1 mean_kl=0.00707 max_kl=0.01019
[EpochKL] epoch=2 mean_kl=0.00792 max_kl=0.00983
[Time] Env Create Time: 2.8443s |Rollout Collect Time: 3.4758s |Loss & Update :1.8744
[PPODiag] kl_mean=0.0064, kl_p90=0.0096, kl_max=0.0102 | clipfrac_mean=0.036, logratio_std_mean=0.115, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.788, p10=0.782, min=0.778 | pg_loss_mean=0.0024, v_loss_mean=0.1742, ent_mean=0.1141 | gn_bb_mean=1.249, gn_bb_max=1.656 | gn_v_mean=0.844, gn_v_max=1.651
[AttnScore] scale=1.1413, C=10.0

  8%|▊         | 416/5000 [1:05:32<10:02:25,  7.89s/it]------------------ Training Record ------------------
Epoch: 416/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3206, reward_valid_std=2.2713
[BatchDiag] adv_mean=-0.0744, adv_std=0.9071, adv_abs_mean=0.6834 | ret_mean=6.7890, ret_std=1.7158 | val_mean=6.8634, val_std=1.4720 | explained_var=0.720543
[GradSplit pre-clip] backbone=0.547577, critic=0.443811
[Loss] pg_loss=-0.015082, entropy_loss=0.000127, value_loss=0.043057
[EpochKL] epoch=0 mean_kl=0.00322 max_kl=0.00585
[EpochKL] epoch=1 mean_kl=0.00461 max_kl=0.00612
[EpochKL] epoch=2 mean_kl=0.00670 max_kl=0.01029
[Time] Env Create Time: 2.8573s |Rollout Collect Time: 3.4765s |Loss & Update :1.8816
[PPODiag] kl_mean=0.0048, kl_p90=0.0075, kl_max=0.0103 | clipfrac_mean=0.030, logratio_std_mean=0.100, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.787, p10=0.783, min=0.782 | pg_loss_mean=0.0019, v_loss_mean=0.1711, ent_mean=0.1122 | gn_bb_mean=1.121, gn_bb_max=1.941 | gn_v_mean=0.937, gn_v_max=2.160

  8%|▊         | 417/5000 [1:05:41<10:09:52,  7.98s/it]------------------ Training Record ------------------
Epoch: 417/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3201, reward_valid_std=2.2705
[BatchDiag] adv_mean=0.0255, adv_std=0.8969, adv_abs_mean=0.6808 | ret_mean=6.7576, ret_std=1.7445 | val_mean=6.7321, val_std=1.4920 | explained_var=0.735697
[GradSplit pre-clip] backbone=0.720100, critic=0.959471
[Loss] pg_loss=-0.046003, entropy_loss=0.000119, value_loss=0.038780
[EpochKL] epoch=0 mean_kl=0.00252 max_kl=0.00408
[EpochKL] epoch=1 mean_kl=0.00655 max_kl=0.01050
[EarlyStop] epoch=2 mean_kl=0.01058 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01058 max_kl=0.01808
[Time] Env Create Time: 2.6815s |Rollout Collect Time: 3.4844s |Loss & Update :1.8867
[PPODiag] kl_mean=0.0065, kl_p90=0.0114, kl_max=0.0181 | clipfrac_mean=0.036, logratio_std_mean=0.114, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.789, p10=0.785, min=0.782 | pg_loss_mean=0.0024, v_loss_mean=0.1691, ent_mean=0.1145 | gn_bb_mean=1.428, gn_bb_max=2.422 | gn_v_mean=1.129, gn_v_max=2.764

  8%|▊         | 418/5000 [1:05:49<10:11:18,  8.00s/it]------------------ Training Record ------------------
Epoch: 418/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3239, reward_valid_std=2.2780
[BatchDiag] adv_mean=-0.0353, adv_std=0.8828, adv_abs_mean=0.6606 | ret_mean=6.8182, ret_std=1.7258 | val_mean=6.8534, val_std=1.5149 | explained_var=0.738322
[GradSplit pre-clip] backbone=0.342906, critic=0.547766
[Loss] pg_loss=-0.066445, entropy_loss=0.000123, value_loss=0.036444
[EpochKL] epoch=0 mean_kl=0.00438 max_kl=0.00691
[EpochKL] epoch=1 mean_kl=0.00497 max_kl=0.00649
[EpochKL] epoch=2 mean_kl=0.00786 max_kl=0.01325
[Time] Env Create Time: 2.8379s |Rollout Collect Time: 3.3229s |Loss & Update :1.8179
[PPODiag] kl_mean=0.0057, kl_p90=0.0085, kl_max=0.0132 | clipfrac_mean=0.035, logratio_std_mean=0.110, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.823, p10=0.818, min=0.816 | pg_loss_mean=0.0019, v_loss_mean=0.1647, ent_mean=0.1175 | gn_bb_mean=1.232, gn_bb_max=1.848 | gn_v_mean=1.212, gn_v_max=2.903

  8%|▊         | 419/5000 [1:05:57<10:10:35,  8.00s/it]------------------ Training Record ------------------
Epoch: 419/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3237, reward_valid_std=2.2768
[BatchDiag] adv_mean=-0.0799, adv_std=0.8755, adv_abs_mean=0.6568 | ret_mean=6.8327, ret_std=1.7057 | val_mean=6.9126, val_std=1.4747 | explained_var=0.736516
[GradSplit pre-clip] backbone=0.441687, critic=0.462607
[Loss] pg_loss=-0.052579, entropy_loss=0.000116, value_loss=0.034444
[EpochKL] epoch=0 mean_kl=0.00359 max_kl=0.00535
[EpochKL] epoch=1 mean_kl=0.00783 max_kl=0.01250
[EarlyStop] epoch=2 mean_kl=0.01044 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01044 max_kl=0.01712
[Time] Env Create Time: 2.8446s |Rollout Collect Time: 3.3240s |Loss & Update :1.8065
[PPODiag] kl_mean=0.0073, kl_p90=0.0123, kl_max=0.0171 | clipfrac_mean=0.039, logratio_std_mean=0.124, ratio_p95_mean=1.058 | valid_ratio_mb_mean=0.823, p10=0.816, min=0.813 | pg_loss_mean=0.0028, v_loss_mean=0.1624, ent_mean=0.1173 | gn_bb_mean=1.400, gn_bb_max=2.427 | gn_v_mean=0.962, gn_v_max=2.027

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.659, Step: 21, Avg Done Step: 18.41, #CS visited: 0.37
D->C12->C1->C15->C3->C5->C2->D->C4->C14->D->C13->C6->C7->C11->C10->C9->C8->D
Eval cost : 4.0359s
-----------------------------
  8%|▊         | 420/5000 [1:06:09<11:43:54,  9.22s/it]------------------ Training Record ------------------
Epoch: 420/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3230, reward_valid_std=2.2737
[BatchDiag] adv_mean=-0.1156, adv_std=0.9039, adv_abs_mean=0.6839 | ret_mean=6.8231, ret_std=1.7126 | val_mean=6.9387, val_std=1.4763 | explained_var=0.721428
[GradSplit pre-clip] backbone=0.573519, critic=0.963542
[Loss] pg_loss=-0.042439, entropy_loss=0.000113, value_loss=0.039692
[EpochKL] epoch=0 mean_kl=0.00586 max_kl=0.01026
[EarlyStop] epoch=1 mean_kl=0.01011 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01011 max_kl=0.01325
[Time] Env Create Time: 2.8422s |Rollout Collect Time: 3.4841s |Loss & Update :1.2665
[PPODiag] kl_mean=0.0080, kl_p90=0.0110, kl_max=0.0132 | clipfrac_mean=0.040, logratio_std_mean=0.130, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.779 | pg_loss_mean=0.0034, v_loss_mean=0.1692, ent_mean=0.1108 | gn_bb_mean=1.630, gn_bb_max=2.518 | gn_v_mean=0.799, gn_v_max=1.382
[AttnScore] scale=1.1424, C=10.0

  8%|▊         | 421/5000 [1:06:16<11:06:28,  8.73s/it]------------------ Training Record ------------------
Epoch: 421/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51182/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.289, reward_valid_mean=0.3207, reward_valid_std=2.2726
[BatchDiag] adv_mean=-0.0549, adv_std=0.9810, adv_abs_mean=0.7045 | ret_mean=6.7794, ret_std=1.7685 | val_mean=6.8343, val_std=1.4931 | explained_var=0.692320
[GradSplit pre-clip] backbone=0.493233, critic=0.743846
[Loss] pg_loss=-0.069796, entropy_loss=0.000042, value_loss=0.039382
[EpochKL] epoch=0 mean_kl=0.00650 max_kl=0.01530
[EarlyStop] epoch=1 mean_kl=0.01753 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01753 max_kl=0.06071
[Time] Env Create Time: 2.6902s |Rollout Collect Time: 9.1302s |Loss & Update :3.1212
[PPODiag] kl_mean=0.0120, kl_p90=0.0157, kl_max=0.0607 | clipfrac_mean=0.039, logratio_std_mean=0.178, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.289, p10=0.286, min=0.285 | pg_loss_mean=0.0029, v_loss_mean=0.1828, ent_mean=0.0401 | gn_bb_mean=1.223, gn_bb_max=2.223 | gn_v_mean=1.205, gn_v_max=2.317

  8%|▊         | 422/5000 [1:06:31<13:28:27, 10.60s/it]------------------ Training Record ------------------
Epoch: 422/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3233, reward_valid_std=2.2778
[BatchDiag] adv_mean=-0.0947, adv_std=0.9032, adv_abs_mean=0.6805 | ret_mean=6.8209, ret_std=1.7134 | val_mean=6.9157, val_std=1.4497 | explained_var=0.722149
[GradSplit pre-clip] backbone=0.575659, critic=0.783526
[Loss] pg_loss=-0.049363, entropy_loss=0.000114, value_loss=0.040991
[EpochKL] epoch=0 mean_kl=0.00569 max_kl=0.00860
[EpochKL] epoch=1 mean_kl=0.00954 max_kl=0.01303
[EarlyStop] epoch=2 mean_kl=0.01468 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01468 max_kl=0.02360
[Time] Env Create Time: 2.8366s |Rollout Collect Time: 3.3248s |Loss & Update :1.8047
[PPODiag] kl_mean=0.0100, kl_p90=0.0144, kl_max=0.0236 | clipfrac_mean=0.047, logratio_std_mean=0.145, ratio_p95_mean=1.061 | valid_ratio_mb_mean=0.823, p10=0.817, min=0.815 | pg_loss_mean=0.0043, v_loss_mean=0.1770, ent_mean=0.1127 | gn_bb_mean=1.742, gn_bb_max=2.511 | gn_v_mean=2.035, gn_v_max=5.449

  8%|▊         | 423/5000 [1:06:39<12:28:06,  9.81s/it]------------------ Training Record ------------------
Epoch: 423/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3249, reward_valid_std=2.2800
[BatchDiag] adv_mean=-0.1808, adv_std=0.8963, adv_abs_mean=0.6726 | ret_mean=6.8941, ret_std=1.6941 | val_mean=7.0749, val_std=1.4957 | explained_var=0.720109
[GradSplit pre-clip] backbone=0.660175, critic=1.129692
[Loss] pg_loss=-0.046179, entropy_loss=0.000118, value_loss=0.040505
[EpochKL] epoch=0 mean_kl=0.00411 max_kl=0.00606
[EarlyStop] epoch=1 mean_kl=0.01029 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01029 max_kl=0.01544
[Time] Env Create Time: 2.8511s |Rollout Collect Time: 3.4747s |Loss & Update :1.2552
[PPODiag] kl_mean=0.0072, kl_p90=0.0122, kl_max=0.0154 | clipfrac_mean=0.038, logratio_std_mean=0.122, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.786, p10=0.778, min=0.776 | pg_loss_mean=0.0029, v_loss_mean=0.1729, ent_mean=0.1103 | gn_bb_mean=1.486, gn_bb_max=1.986 | gn_v_mean=2.054, gn_v_max=3.503

  8%|▊         | 424/5000 [1:06:47<11:37:01,  9.14s/it]------------------ Training Record ------------------
Epoch: 424/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3212, reward_valid_std=2.2762
[BatchDiag] adv_mean=-0.1157, adv_std=0.9110, adv_abs_mean=0.6827 | ret_mean=6.8237, ret_std=1.7219 | val_mean=6.9393, val_std=1.4882 | explained_var=0.720109
[GradSplit pre-clip] backbone=0.553088, critic=0.534476
[Loss] pg_loss=-0.034949, entropy_loss=0.000115, value_loss=0.042515
[EpochKL] epoch=0 mean_kl=0.00389 max_kl=0.00760
[EpochKL] epoch=1 mean_kl=0.00613 max_kl=0.00899
[EpochKL] epoch=2 mean_kl=0.00623 max_kl=0.01021
[Time] Env Create Time: 2.6768s |Rollout Collect Time: 3.4679s |Loss & Update :1.8701
[PPODiag] kl_mean=0.0054, kl_p90=0.0077, kl_max=0.0102 | clipfrac_mean=0.034, logratio_std_mean=0.105, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.779 | pg_loss_mean=0.0021, v_loss_mean=0.1724, ent_mean=0.1093 | gn_bb_mean=1.235, gn_bb_max=1.821 | gn_v_mean=0.979, gn_v_max=2.219

  8%|▊         | 425/5000 [1:06:55<11:11:09,  8.80s/it]------------------ Training Record ------------------
Epoch: 425/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3245, reward_valid_std=2.2808
[BatchDiag] adv_mean=-0.0675, adv_std=0.9034, adv_abs_mean=0.6776 | ret_mean=6.8259, ret_std=1.7146 | val_mean=6.8934, val_std=1.4919 | explained_var=0.722420
[GradSplit pre-clip] backbone=0.503944, critic=0.393761
[Loss] pg_loss=-0.048690, entropy_loss=0.000118, value_loss=0.041720
[EpochKL] epoch=0 mean_kl=0.00440 max_kl=0.00672
[EpochKL] epoch=1 mean_kl=0.00552 max_kl=0.00705
[EpochKL] epoch=2 mean_kl=0.00947 max_kl=0.01535
[Time] Env Create Time: 2.8397s |Rollout Collect Time: 3.3223s |Loss & Update :1.8044
[PPODiag] kl_mean=0.0065, kl_p90=0.0099, kl_max=0.0153 | clipfrac_mean=0.035, logratio_std_mean=0.116, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.822, p10=0.817, min=0.813 | pg_loss_mean=0.0024, v_loss_mean=0.1702, ent_mean=0.1118 | gn_bb_mean=1.261, gn_bb_max=1.897 | gn_v_mean=1.280, gn_v_max=3.049
[AttnScore] scale=1.1435, C=10.0

  9%|▊         | 426/5000 [1:07:03<10:51:54,  8.55s/it]------------------ Training Record ------------------
Epoch: 426/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3223, reward_valid_std=2.2798
[BatchDiag] adv_mean=-0.1595, adv_std=0.9035, adv_abs_mean=0.6809 | ret_mean=6.8563, ret_std=1.7042 | val_mean=7.0158, val_std=1.4791 | explained_var=0.718925
[GradSplit pre-clip] backbone=0.564957, critic=1.045305
[Loss] pg_loss=-0.061597, entropy_loss=0.000115, value_loss=0.040478
[EpochKL] epoch=0 mean_kl=0.00433 max_kl=0.00833
[EpochKL] epoch=1 mean_kl=0.00568 max_kl=0.00838
[EpochKL] epoch=2 mean_kl=0.00617 max_kl=0.00806
[Time] Env Create Time: 2.8415s |Rollout Collect Time: 3.3253s |Loss & Update :1.8047
[PPODiag] kl_mean=0.0054, kl_p90=0.0082, kl_max=0.0084 | clipfrac_mean=0.033, logratio_std_mean=0.106, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.823, p10=0.820, min=0.816 | pg_loss_mean=0.0020, v_loss_mean=0.1739, ent_mean=0.1081 | gn_bb_mean=1.215, gn_bb_max=1.809 | gn_v_mean=1.606, gn_v_max=3.696

  9%|▊         | 427/5000 [1:07:11<10:38:31,  8.38s/it]------------------ Training Record ------------------
Epoch: 427/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3221, reward_valid_std=2.2756
[BatchDiag] adv_mean=-0.1583, adv_std=0.9070, adv_abs_mean=0.6817 | ret_mean=6.8501, ret_std=1.7090 | val_mean=7.0084, val_std=1.4811 | explained_var=0.718337
[GradSplit pre-clip] backbone=0.398026, critic=0.419514
[Loss] pg_loss=-0.150434, entropy_loss=0.000114, value_loss=0.034516
[EpochKL] epoch=0 mean_kl=0.00225 max_kl=0.00443
[EpochKL] epoch=1 mean_kl=0.00393 max_kl=0.00537
[EpochKL] epoch=2 mean_kl=0.00719 max_kl=0.00934
[Time] Env Create Time: 2.8684s |Rollout Collect Time: 3.4866s |Loss & Update :1.8681
[PPODiag] kl_mean=0.0045, kl_p90=0.0086, kl_max=0.0093 | clipfrac_mean=0.028, logratio_std_mean=0.094, ratio_p95_mean=1.039 | valid_ratio_mb_mean=0.788, p10=0.782, min=0.777 | pg_loss_mean=0.0014, v_loss_mean=0.1741, ent_mean=0.1081 | gn_bb_mean=1.203, gn_bb_max=1.820 | gn_v_mean=1.705, gn_v_max=3.248

  9%|▊         | 428/5000 [1:07:19<10:34:51,  8.33s/it]------------------ Training Record ------------------
Epoch: 428/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3215, reward_valid_std=2.2729
[BatchDiag] adv_mean=-0.1472, adv_std=0.9098, adv_abs_mean=0.6874 | ret_mean=6.8191, ret_std=1.7152 | val_mean=6.9664, val_std=1.4284 | explained_var=0.718624
[GradSplit pre-clip] backbone=0.688502, critic=0.495698
[Loss] pg_loss=-0.167559, entropy_loss=0.000127, value_loss=0.035123
[EpochKL] epoch=0 mean_kl=0.00457 max_kl=0.00991
[EpochKL] epoch=1 mean_kl=0.00720 max_kl=0.00993
[EpochKL] epoch=2 mean_kl=0.00794 max_kl=0.01233
[Time] Env Create Time: 2.6926s |Rollout Collect Time: 3.3251s |Loss & Update :1.8063
[PPODiag] kl_mean=0.0066, kl_p90=0.0098, kl_max=0.0123 | clipfrac_mean=0.038, logratio_std_mean=0.118, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.826, p10=0.821, min=0.809 | pg_loss_mean=0.0023, v_loss_mean=0.1736, ent_mean=0.1171 | gn_bb_mean=1.277, gn_bb_max=2.052 | gn_v_mean=1.287, gn_v_max=2.577

  9%|▊         | 429/5000 [1:07:27<10:23:07,  8.18s/it]------------------ Training Record ------------------
Epoch: 429/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3256, reward_valid_std=2.2769
[BatchDiag] adv_mean=-0.1356, adv_std=0.8816, adv_abs_mean=0.6629 | ret_mean=6.8816, ret_std=1.6928 | val_mean=7.0172, val_std=1.4616 | explained_var=0.728812
[GradSplit pre-clip] backbone=0.578411, critic=0.549774
[Loss] pg_loss=-0.102290, entropy_loss=0.000112, value_loss=0.036542
[EpochKL] epoch=0 mean_kl=0.00440 max_kl=0.00761
[EpochKL] epoch=1 mean_kl=0.00770 max_kl=0.00946
[EpochKL] epoch=2 mean_kl=0.00710 max_kl=0.00943
[Time] Env Create Time: 2.8767s |Rollout Collect Time: 3.3461s |Loss & Update :1.8019
[PPODiag] kl_mean=0.0064, kl_p90=0.0091, kl_max=0.0095 | clipfrac_mean=0.035, logratio_std_mean=0.120, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.824, p10=0.819, min=0.813 | pg_loss_mean=0.0025, v_loss_mean=0.1633, ent_mean=0.1110 | gn_bb_mean=1.304, gn_bb_max=2.020 | gn_v_mean=1.001, gn_v_max=2.084

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.643, Step: 21, Avg Done Step: 18.44, #CS visited: 0.37
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->D->C6->C7->C11->C10->C9->C8->D
Eval cost : 4.0340s
-----------------------------
  9%|▊         | 430/5000 [1:07:39<11:53:08,  9.36s/it]------------------ Training Record ------------------
Epoch: 430/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3230, reward_valid_std=2.2739
[BatchDiag] adv_mean=-0.0906, adv_std=0.8946, adv_abs_mean=0.6768 | ret_mean=6.8336, ret_std=1.7226 | val_mean=6.9242, val_std=1.4635 | explained_var=0.730292
[GradSplit pre-clip] backbone=0.532660, critic=0.649097
[Loss] pg_loss=-0.103397, entropy_loss=0.000122, value_loss=0.036487
[EpochKL] epoch=0 mean_kl=0.00407 max_kl=0.00856
[EpochKL] epoch=1 mean_kl=0.00544 max_kl=0.00735
[EpochKL] epoch=2 mean_kl=0.00631 max_kl=0.00896
[Time] Env Create Time: 2.8297s |Rollout Collect Time: 3.5038s |Loss & Update :1.8873
[PPODiag] kl_mean=0.0053, kl_p90=0.0079, kl_max=0.0090 | clipfrac_mean=0.035, logratio_std_mean=0.104, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.789, p10=0.784, min=0.779 | pg_loss_mean=0.0017, v_loss_mean=0.1676, ent_mean=0.1125 | gn_bb_mean=1.281, gn_bb_max=1.976 | gn_v_mean=0.981, gn_v_max=2.146
[AttnScore] scale=1.1450, C=10.0

  9%|▊         | 431/5000 [1:07:47<11:26:54,  9.02s/it]------------------ Training Record ------------------
Epoch: 431/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=43, valid_ratio=0.404, reward_valid_mean=0.3223, reward_valid_std=2.2723
[BatchDiag] adv_mean=-0.1187, adv_std=0.8842, adv_abs_mean=0.6641 | ret_mean=6.8324, ret_std=1.7144 | val_mean=6.9511, val_std=1.4663 | explained_var=0.733993
[GradSplit pre-clip] backbone=0.513642, critic=0.744491
[Loss] pg_loss=-0.031012, entropy_loss=0.000058, value_loss=0.036700
[EpochKL] epoch=0 mean_kl=0.00424 max_kl=0.00621
[EpochKL] epoch=1 mean_kl=0.00852 max_kl=0.01173
[EpochKL] epoch=2 mean_kl=0.00887 max_kl=0.01303
[Time] Env Create Time: 2.8931s |Rollout Collect Time: 6.6343s |Loss & Update :3.4321
[PPODiag] kl_mean=0.0072, kl_p90=0.0112, kl_max=0.0130 | clipfrac_mean=0.037, logratio_std_mean=0.125, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.404, p10=0.400, min=0.398 | pg_loss_mean=0.0027, v_loss_mean=0.1644, ent_mean=0.0538 | gn_bb_mean=1.336, gn_bb_max=1.881 | gn_v_mean=1.115, gn_v_max=2.043

  9%|▊         | 432/5000 [1:08:00<12:56:44, 10.20s/it]------------------ Training Record ------------------
Epoch: 432/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3230, reward_valid_std=2.2737
[BatchDiag] adv_mean=-0.0319, adv_std=0.8714, adv_abs_mean=0.6596 | ret_mean=6.8266, ret_std=1.7328 | val_mean=6.8585, val_std=1.5022 | explained_var=0.747070
[GradSplit pre-clip] backbone=0.731109, critic=0.985172
[Loss] pg_loss=-0.117805, entropy_loss=0.000115, value_loss=0.034953
[EpochKL] epoch=0 mean_kl=0.00273 max_kl=0.00433
[EpochKL] epoch=1 mean_kl=0.00562 max_kl=0.00889
[EpochKL] epoch=2 mean_kl=0.00825 max_kl=0.02184
[Time] Env Create Time: 2.6895s |Rollout Collect Time: 3.3401s |Loss & Update :1.7915
[PPODiag] kl_mean=0.0055, kl_p90=0.0072, kl_max=0.0218 | clipfrac_mean=0.033, logratio_std_mean=0.108, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.826, p10=0.821, min=0.817 | pg_loss_mean=0.0021, v_loss_mean=0.1630, ent_mean=0.1102 | gn_bb_mean=1.360, gn_bb_max=2.454 | gn_v_mean=1.456, gn_v_max=3.074

  9%|▊         | 433/5000 [1:08:08<12:02:12,  9.49s/it]------------------ Training Record ------------------
Epoch: 433/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=46, valid_ratio=0.377, reward_valid_mean=0.3264, reward_valid_std=2.2752
[BatchDiag] adv_mean=-0.0585, adv_std=0.8837, adv_abs_mean=0.6596 | ret_mean=6.8706, ret_std=1.7159 | val_mean=6.9291, val_std=1.4919 | explained_var=0.734732
[GradSplit pre-clip] backbone=0.487313, critic=0.524802
[Loss] pg_loss=-0.024750, entropy_loss=0.000054, value_loss=0.043191
[EpochKL] epoch=0 mean_kl=0.00410 max_kl=0.00670
[EpochKL] epoch=1 mean_kl=0.00433 max_kl=0.00762
[EpochKL] epoch=2 mean_kl=0.00765 max_kl=0.01068
[Time] Env Create Time: 2.8445s |Rollout Collect Time: 7.1360s |Loss & Update :3.6172
[PPODiag] kl_mean=0.0054, kl_p90=0.0083, kl_max=0.0107 | clipfrac_mean=0.034, logratio_std_mean=0.105, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.377, p10=0.374, min=0.372 | pg_loss_mean=0.0022, v_loss_mean=0.1631, ent_mean=0.0517 | gn_bb_mean=1.398, gn_bb_max=2.605 | gn_v_mean=1.067, gn_v_max=2.541

  9%|▊         | 434/5000 [1:08:22<13:35:52, 10.72s/it]------------------ Training Record ------------------
Epoch: 434/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3222, reward_valid_std=2.2723
[BatchDiag] adv_mean=-0.1518, adv_std=0.8828, adv_abs_mean=0.6608 | ret_mean=6.8649, ret_std=1.7066 | val_mean=7.0167, val_std=1.5070 | explained_var=0.732397
[GradSplit pre-clip] backbone=0.457120, critic=1.034170
[Loss] pg_loss=-0.009806, entropy_loss=0.000122, value_loss=0.041754
[EpochKL] epoch=0 mean_kl=0.00668 max_kl=0.01247
[EarlyStop] epoch=1 mean_kl=0.01171 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01171 max_kl=0.01558
[Time] Env Create Time: 2.8610s |Rollout Collect Time: 3.3579s |Loss & Update :1.2266
[PPODiag] kl_mean=0.0092, kl_p90=0.0139, kl_max=0.0156 | clipfrac_mean=0.042, logratio_std_mean=0.141, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.827, p10=0.821, min=0.816 | pg_loss_mean=0.0035, v_loss_mean=0.1639, ent_mean=0.1116 | gn_bb_mean=1.445, gn_bb_max=1.838 | gn_v_mean=1.149, gn_v_max=2.588

  9%|▊         | 435/5000 [1:08:29<12:20:56,  9.74s/it]------------------ Training Record ------------------
Epoch: 435/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3194, reward_valid_std=2.2693
[BatchDiag] adv_mean=-0.1289, adv_std=0.8954, adv_abs_mean=0.6783 | ret_mean=6.7999, ret_std=1.7256 | val_mean=6.9288, val_std=1.4780 | explained_var=0.730738
[GradSplit pre-clip] backbone=0.543985, critic=0.615305
[Loss] pg_loss=-0.033510, entropy_loss=0.000116, value_loss=0.039509
[EpochKL] epoch=0 mean_kl=0.00698 max_kl=0.01369
[EarlyStop] epoch=1 mean_kl=0.01101 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01101 max_kl=0.01597
[Time] Env Create Time: 2.8662s |Rollout Collect Time: 3.3576s |Loss & Update :1.2222
[PPODiag] kl_mean=0.0090, kl_p90=0.0137, kl_max=0.0160 | clipfrac_mean=0.040, logratio_std_mean=0.137, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.827, p10=0.822, min=0.821 | pg_loss_mean=0.0038, v_loss_mean=0.1688, ent_mean=0.1125 | gn_bb_mean=1.380, gn_bb_max=1.943 | gn_v_mean=1.078, gn_v_max=2.318
[AttnScore] scale=1.1462, C=10.0

  9%|▊         | 436/5000 [1:08:36<11:28:28,  9.05s/it]------------------ Training Record ------------------
Epoch: 436/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3226, reward_valid_std=2.2720
[BatchDiag] adv_mean=-0.0127, adv_std=0.8891, adv_abs_mean=0.6717 | ret_mean=6.8032, ret_std=1.7400 | val_mean=6.8159, val_std=1.4953 | explained_var=0.738901
[GradSplit pre-clip] backbone=0.654607, critic=0.457712
[Loss] pg_loss=0.003060, entropy_loss=0.000120, value_loss=0.045209
[EpochKL] epoch=0 mean_kl=0.00645 max_kl=0.01056
[EpochKL] epoch=1 mean_kl=0.00901 max_kl=0.01165
[EpochKL] epoch=2 mean_kl=0.00976 max_kl=0.01711
[Time] Env Create Time: 2.6989s |Rollout Collect Time: 3.3499s |Loss & Update :1.8055
[PPODiag] kl_mean=0.0084, kl_p90=0.0116, kl_max=0.0171 | clipfrac_mean=0.042, logratio_std_mean=0.135, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.827, p10=0.821, min=0.818 | pg_loss_mean=0.0034, v_loss_mean=0.1652, ent_mean=0.1116 | gn_bb_mean=1.421, gn_bb_max=1.991 | gn_v_mean=0.852, gn_v_max=1.600

  9%|▊         | 437/5000 [1:08:44<11:01:02,  8.69s/it]------------------ Training Record ------------------
Epoch: 437/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3226, reward_valid_std=2.2734
[BatchDiag] adv_mean=0.0340, adv_std=0.8903, adv_abs_mean=0.6705 | ret_mean=6.8043, ret_std=1.7468 | val_mean=6.7702, val_std=1.4906 | explained_var=0.740237
[GradSplit pre-clip] backbone=0.593029, critic=0.990056
[Loss] pg_loss=-0.036761, entropy_loss=0.000119, value_loss=0.039913
[EpochKL] epoch=0 mean_kl=0.00346 max_kl=0.00602
[EpochKL] epoch=1 mean_kl=0.00458 max_kl=0.00613
[EpochKL] epoch=2 mean_kl=0.00575 max_kl=0.00684
[Time] Env Create Time: 2.8777s |Rollout Collect Time: 3.4983s |Loss & Update :1.8660
[PPODiag] kl_mean=0.0046, kl_p90=0.0062, kl_max=0.0068 | clipfrac_mean=0.032, logratio_std_mean=0.097, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.790, p10=0.786, min=0.782 | pg_loss_mean=0.0018, v_loss_mean=0.1711, ent_mean=0.1082 | gn_bb_mean=1.161, gn_bb_max=1.761 | gn_v_mean=2.009, gn_v_max=4.829

  9%|▉         | 438/5000 [1:08:53<10:50:37,  8.56s/it]------------------ Training Record ------------------
Epoch: 438/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.829, reward_valid_mean=0.3210, reward_valid_std=2.2705
[BatchDiag] adv_mean=-0.0902, adv_std=0.9014, adv_abs_mean=0.6712 | ret_mean=6.8397, ret_std=1.7244 | val_mean=6.9299, val_std=1.5320 | explained_var=0.726764
[GradSplit pre-clip] backbone=0.659417, critic=0.571615
[Loss] pg_loss=-0.069202, entropy_loss=0.000114, value_loss=0.038337
[EpochKL] epoch=0 mean_kl=0.00488 max_kl=0.00833
[EpochKL] epoch=1 mean_kl=0.00743 max_kl=0.01318
[EpochKL] epoch=2 mean_kl=0.00587 max_kl=0.00887
[Time] Env Create Time: 2.8710s |Rollout Collect Time: 3.3455s |Loss & Update :1.8011
[PPODiag] kl_mean=0.0061, kl_p90=0.0089, kl_max=0.0132 | clipfrac_mean=0.035, logratio_std_mean=0.112, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.829, p10=0.824, min=0.816 | pg_loss_mean=0.0021, v_loss_mean=0.1772, ent_mean=0.1132 | gn_bb_mean=1.330, gn_bb_max=2.562 | gn_v_mean=2.548, gn_v_max=4.501

  9%|▉         | 439/5000 [1:09:01<10:38:11,  8.40s/it]------------------ Training Record ------------------
Epoch: 439/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.793, reward_valid_mean=0.3183, reward_valid_std=2.2685
[BatchDiag] adv_mean=-0.1070, adv_std=0.9286, adv_abs_mean=0.6827 | ret_mean=6.8064, ret_std=1.7529 | val_mean=6.9134, val_std=1.5251 | explained_var=0.719348
[GradSplit pre-clip] backbone=0.459428, critic=0.776134
[Loss] pg_loss=-0.060068, entropy_loss=0.000121, value_loss=0.038668
[EpochKL] epoch=0 mean_kl=0.00341 max_kl=0.00560
[EpochKL] epoch=1 mean_kl=0.00674 max_kl=0.00934
[EpochKL] epoch=2 mean_kl=0.00801 max_kl=0.01244
[Time] Env Create Time: 2.6922s |Rollout Collect Time: 3.4989s |Loss & Update :1.8746
[PPODiag] kl_mean=0.0061, kl_p90=0.0089, kl_max=0.0124 | clipfrac_mean=0.036, logratio_std_mean=0.112, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.793, p10=0.786, min=0.782 | pg_loss_mean=0.0021, v_loss_mean=0.1789, ent_mean=0.1092 | gn_bb_mean=1.319, gn_bb_max=1.853 | gn_v_mean=1.880, gn_v_max=4.639

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.673, Step: 21, Avg Done Step: 18.56, #CS visited: 0.32
D->C12->C1->C15->C3->C5->C2->D->C4->C14->D->C13->C6->C7->C11->C10->C9->C8->D
Eval cost : 4.0656s
-----------------------------
  9%|▉         | 440/5000 [1:09:13<12:03:51,  9.52s/it]------------------ Training Record ------------------
Epoch: 440/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=29, valid_ratio=0.602, reward_valid_mean=0.3178, reward_valid_std=2.2646
[BatchDiag] adv_mean=-0.0330, adv_std=0.9052, adv_abs_mean=0.6726 | ret_mean=6.7879, ret_std=1.7453 | val_mean=6.8210, val_std=1.5353 | explained_var=0.731018
[GradSplit pre-clip] backbone=0.416363, critic=0.943689
[Loss] pg_loss=-0.025505, entropy_loss=0.000089, value_loss=0.038542
[EpochKL] epoch=0 mean_kl=0.00339 max_kl=0.00731
[EpochKL] epoch=1 mean_kl=0.00797 max_kl=0.01159
[EpochKL] epoch=2 mean_kl=0.00934 max_kl=0.01341
[Time] Env Create Time: 2.8590s |Rollout Collect Time: 4.5515s |Loss & Update :2.3739
[PPODiag] kl_mean=0.0069, kl_p90=0.0114, kl_max=0.0134 | clipfrac_mean=0.039, logratio_std_mean=0.119, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.602, p10=0.598, min=0.594 | pg_loss_mean=0.0028, v_loss_mean=0.1667, ent_mean=0.0850 | gn_bb_mean=1.523, gn_bb_max=2.471 | gn_v_mean=1.320, gn_v_max=2.724
[AttnScore] scale=1.1481, C=10.0

  9%|▉         | 441/5000 [1:09:23<12:09:38,  9.60s/it]------------------ Training Record ------------------
Epoch: 441/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.828, reward_valid_mean=0.3221, reward_valid_std=2.2700
[BatchDiag] adv_mean=-0.0466, adv_std=0.8847, adv_abs_mean=0.6551 | ret_mean=6.8466, ret_std=1.7156 | val_mean=6.8932, val_std=1.5772 | explained_var=0.734070
[GradSplit pre-clip] backbone=0.577021, critic=0.656912
[Loss] pg_loss=-0.016642, entropy_loss=0.000121, value_loss=0.038423
[EpochKL] epoch=0 mean_kl=0.00347 max_kl=0.00591
[EpochKL] epoch=1 mean_kl=0.00878 max_kl=0.01155
[EpochKL] epoch=2 mean_kl=0.00702 max_kl=0.00929
[Time] Env Create Time: 2.8594s |Rollout Collect Time: 3.3510s |Loss & Update :1.7974
[PPODiag] kl_mean=0.0064, kl_p90=0.0098, kl_max=0.0116 | clipfrac_mean=0.034, logratio_std_mean=0.119, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.828, p10=0.821, min=0.816 | pg_loss_mean=0.0019, v_loss_mean=0.1622, ent_mean=0.1114 | gn_bb_mean=1.170, gn_bb_max=2.017 | gn_v_mean=1.202, gn_v_max=2.110

  9%|▉         | 442/5000 [1:09:31<11:33:08,  9.12s/it]------------------ Training Record ------------------
Epoch: 442/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3206, reward_valid_std=2.2717
[BatchDiag] adv_mean=-0.0763, adv_std=0.8917, adv_abs_mean=0.6636 | ret_mean=6.8268, ret_std=1.7241 | val_mean=6.9032, val_std=1.5266 | explained_var=0.732494
[GradSplit pre-clip] backbone=0.790548, critic=0.740749
[Loss] pg_loss=0.002313, entropy_loss=0.000120, value_loss=0.037710
[EpochKL] epoch=0 mean_kl=0.00299 max_kl=0.00497
[EpochKL] epoch=1 mean_kl=0.00589 max_kl=0.00871
[EarlyStop] epoch=2 mean_kl=0.01016 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01016 max_kl=0.01669
[Time] Env Create Time: 2.8534s |Rollout Collect Time: 3.4918s |Loss & Update :1.8612
[PPODiag] kl_mean=0.0063, kl_p90=0.0106, kl_max=0.0167 | clipfrac_mean=0.034, logratio_std_mean=0.114, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.790, p10=0.786, min=0.781 | pg_loss_mean=0.0022, v_loss_mean=0.1666, ent_mean=0.1078 | gn_bb_mean=1.298, gn_bb_max=2.270 | gn_v_mean=1.234, gn_v_max=2.896

  9%|▉         | 443/5000 [1:09:39<11:12:05,  8.85s/it]------------------ Training Record ------------------
Epoch: 443/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3205, reward_valid_std=2.2715
[BatchDiag] adv_mean=-0.1007, adv_std=0.8917, adv_abs_mean=0.6615 | ret_mean=6.8290, ret_std=1.7166 | val_mean=6.9297, val_std=1.5219 | explained_var=0.730179
[GradSplit pre-clip] backbone=0.398050, critic=0.566469
[Loss] pg_loss=-0.116583, entropy_loss=0.000109, value_loss=0.035116
[EpochKL] epoch=0 mean_kl=0.00593 max_kl=0.00941
[EpochKL] epoch=1 mean_kl=0.00859 max_kl=0.01198
[EpochKL] epoch=2 mean_kl=0.00839 max_kl=0.01220
[Time] Env Create Time: 2.7066s |Rollout Collect Time: 3.4992s |Loss & Update :1.8628
[PPODiag] kl_mean=0.0076, kl_p90=0.0106, kl_max=0.0122 | clipfrac_mean=0.040, logratio_std_mean=0.129, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.790, p10=0.785, min=0.781 | pg_loss_mean=0.0030, v_loss_mean=0.1685, ent_mean=0.1096 | gn_bb_mean=1.504, gn_bb_max=2.609 | gn_v_mean=1.771, gn_v_max=3.805

  9%|▉         | 444/5000 [1:09:47<10:54:10,  8.62s/it]------------------ Training Record ------------------
Epoch: 444/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3238, reward_valid_std=2.2767
[BatchDiag] adv_mean=-0.0948, adv_std=0.8858, adv_abs_mean=0.6561 | ret_mean=6.8680, ret_std=1.7134 | val_mean=6.9628, val_std=1.5143 | explained_var=0.732748
[GradSplit pre-clip] backbone=0.412845, critic=0.694663
[Loss] pg_loss=-0.123541, entropy_loss=0.000114, value_loss=0.036744
[EpochKL] epoch=0 mean_kl=0.00357 max_kl=0.00655
[EpochKL] epoch=1 mean_kl=0.00466 max_kl=0.00669
[EarlyStop] epoch=2 mean_kl=0.01041 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01041 max_kl=0.01782
[Time] Env Create Time: 2.8456s |Rollout Collect Time: 3.3525s |Loss & Update :1.7953
[PPODiag] kl_mean=0.0062, kl_p90=0.0103, kl_max=0.0178 | clipfrac_mean=0.035, logratio_std_mean=0.113, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.826, p10=0.818, min=0.814 | pg_loss_mean=0.0020, v_loss_mean=0.1620, ent_mean=0.1107 | gn_bb_mean=1.238, gn_bb_max=1.845 | gn_v_mean=1.035, gn_v_max=1.829

  9%|▉         | 445/5000 [1:09:55<10:39:52,  8.43s/it]------------------ Training Record ------------------
Epoch: 445/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3213, reward_valid_std=2.2723
[BatchDiag] adv_mean=-0.0914, adv_std=0.8761, adv_abs_mean=0.6513 | ret_mean=6.8519, ret_std=1.7213 | val_mean=6.9433, val_std=1.5139 | explained_var=0.740955
[GradSplit pre-clip] backbone=0.493274, critic=0.606526
[Loss] pg_loss=-0.029436, entropy_loss=0.000109, value_loss=0.035821
[EpochKL] epoch=0 mean_kl=0.00537 max_kl=0.00983
[EpochKL] epoch=1 mean_kl=0.00696 max_kl=0.01368
[EarlyStop] epoch=2 mean_kl=0.01193 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01193 max_kl=0.01875
[Time] Env Create Time: 2.8814s |Rollout Collect Time: 3.4977s |Loss & Update :1.8747
[PPODiag] kl_mean=0.0081, kl_p90=0.0136, kl_max=0.0187 | clipfrac_mean=0.041, logratio_std_mean=0.131, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.790, p10=0.786, min=0.781 | pg_loss_mean=0.0029, v_loss_mean=0.1602, ent_mean=0.1081 | gn_bb_mean=1.556, gn_bb_max=2.453 | gn_v_mean=1.103, gn_v_max=2.326
[AttnScore] scale=1.1498, C=10.0

  9%|▉         | 446/5000 [1:10:03<10:35:50,  8.38s/it]------------------ Training Record ------------------
Epoch: 446/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.792, reward_valid_mean=0.3196, reward_valid_std=2.2706
[BatchDiag] adv_mean=-0.1806, adv_std=0.8816, adv_abs_mean=0.6635 | ret_mean=6.8617, ret_std=1.6999 | val_mean=7.0423, val_std=1.4623 | explained_var=0.731008
[GradSplit pre-clip] backbone=0.560023, critic=0.827687
[Loss] pg_loss=-0.068765, entropy_loss=0.000107, value_loss=0.039840
[EpochKL] epoch=0 mean_kl=0.00437 max_kl=0.00814
[EpochKL] epoch=1 mean_kl=0.00809 max_kl=0.01604
[EpochKL] epoch=2 mean_kl=0.00670 max_kl=0.00993
[Time] Env Create Time: 2.8766s |Rollout Collect Time: 3.4867s |Loss & Update :1.8768
[PPODiag] kl_mean=0.0064, kl_p90=0.0094, kl_max=0.0160 | clipfrac_mean=0.036, logratio_std_mean=0.116, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.792, p10=0.787, min=0.782 | pg_loss_mean=0.0021, v_loss_mean=0.1635, ent_mean=0.1078 | gn_bb_mean=1.155, gn_bb_max=2.065 | gn_v_mean=1.244, gn_v_max=2.193

  9%|▉         | 447/5000 [1:10:11<10:32:35,  8.34s/it]------------------ Training Record ------------------
Epoch: 447/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.3217, reward_valid_std=2.2688
[BatchDiag] adv_mean=-0.1942, adv_std=0.8656, adv_abs_mean=0.6560 | ret_mean=6.8709, ret_std=1.6852 | val_mean=7.0651, val_std=1.4524 | explained_var=0.736203
[GradSplit pre-clip] backbone=0.752958, critic=1.236287
[Loss] pg_loss=-0.036386, entropy_loss=0.000110, value_loss=0.036421
[EpochKL] epoch=0 mean_kl=0.00261 max_kl=0.00381
[EpochKL] epoch=1 mean_kl=0.00544 max_kl=0.00757
[EpochKL] epoch=2 mean_kl=0.00592 max_kl=0.00663
[Time] Env Create Time: 2.7059s |Rollout Collect Time: 3.5055s |Loss & Update :1.8789
[PPODiag] kl_mean=0.0047, kl_p90=0.0064, kl_max=0.0076 | clipfrac_mean=0.030, logratio_std_mean=0.098, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.791, p10=0.786, min=0.782 | pg_loss_mean=0.0016, v_loss_mean=0.1587, ent_mean=0.1060 | gn_bb_mean=1.135, gn_bb_max=1.714 | gn_v_mean=1.131, gn_v_max=2.531

  9%|▉         | 448/5000 [1:10:19<10:26:51,  8.26s/it]------------------ Training Record ------------------
Epoch: 448/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.828, reward_valid_mean=0.3211, reward_valid_std=2.2689
[BatchDiag] adv_mean=-0.1877, adv_std=0.8755, adv_abs_mean=0.6565 | ret_mean=6.8665, ret_std=1.6916 | val_mean=7.0542, val_std=1.4786 | explained_var=0.732150
[GradSplit pre-clip] backbone=0.481723, critic=0.969382
[Loss] pg_loss=-0.071896, entropy_loss=0.000116, value_loss=0.036581
[EpochKL] epoch=0 mean_kl=0.00369 max_kl=0.00557
[EpochKL] epoch=1 mean_kl=0.00596 max_kl=0.00829
[EpochKL] epoch=2 mean_kl=0.00981 max_kl=0.01354
[Time] Env Create Time: 2.8544s |Rollout Collect Time: 3.3524s |Loss & Update :1.7960
[PPODiag] kl_mean=0.0065, kl_p90=0.0110, kl_max=0.0135 | clipfrac_mean=0.035, logratio_std_mean=0.116, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.828, p10=0.822, min=0.820 | pg_loss_mean=0.0023, v_loss_mean=0.1620, ent_mean=0.1108 | gn_bb_mean=1.291, gn_bb_max=2.001 | gn_v_mean=1.463, gn_v_max=2.309

  9%|▉         | 449/5000 [1:10:27<10:20:49,  8.18s/it]------------------ Training Record ------------------
Epoch: 449/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=37, valid_ratio=0.469, reward_valid_mean=0.3208, reward_valid_std=2.2738
[BatchDiag] adv_mean=-0.1658, adv_std=0.8641, adv_abs_mean=0.6460 | ret_mean=6.8512, ret_std=1.7034 | val_mean=7.0171, val_std=1.4703 | explained_var=0.742637
[GradSplit pre-clip] backbone=0.517044, critic=1.075115
[Loss] pg_loss=-0.035815, entropy_loss=0.000067, value_loss=0.035763
[EpochKL] epoch=0 mean_kl=0.00389 max_kl=0.00660
[EpochKL] epoch=1 mean_kl=0.00643 max_kl=0.01119
[EarlyStop] epoch=2 mean_kl=0.01096 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01096 max_kl=0.01673
[Time] Env Create Time: 2.8650s |Rollout Collect Time: 5.7378s |Loss & Update :2.9701
[PPODiag] kl_mean=0.0071, kl_p90=0.0127, kl_max=0.0167 | clipfrac_mean=0.036, logratio_std_mean=0.122, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.469, p10=0.465, min=0.464 | pg_loss_mean=0.0025, v_loss_mean=0.1558, ent_mean=0.0620 | gn_bb_mean=1.191, gn_bb_max=1.696 | gn_v_mean=0.908, gn_v_max=2.296

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.647, Step: 22, Avg Done Step: 18.49, #CS visited: 0.33
D->C12->C1->C15->C3->C5->C2->D->C4->C14->D->C13->C6->C7->C11->C10->C9->C8->D
Eval cost : 4.2158s
-----------------------------
  9%|▉         | 450/5000 [1:10:43<13:14:18, 10.47s/it]------------------ Training Record ------------------
Epoch: 450/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3253, reward_valid_std=2.2724
[BatchDiag] adv_mean=-0.0483, adv_std=0.8639, adv_abs_mean=0.6528 | ret_mean=6.8431, ret_std=1.7086 | val_mean=6.8914, val_std=1.4700 | explained_var=0.744336
[GradSplit pre-clip] backbone=0.529686, critic=0.652903
[Loss] pg_loss=-0.094640, entropy_loss=0.000114, value_loss=0.036862
[EpochKL] epoch=0 mean_kl=0.00455 max_kl=0.00793
[EpochKL] epoch=1 mean_kl=0.00657 max_kl=0.00820
[EpochKL] epoch=2 mean_kl=0.00855 max_kl=0.01700
[Time] Env Create Time: 2.7046s |Rollout Collect Time: 3.3559s |Loss & Update :1.8179
[PPODiag] kl_mean=0.0066, kl_p90=0.0081, kl_max=0.0170 | clipfrac_mean=0.036, logratio_std_mean=0.117, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.826, p10=0.820, min=0.816 | pg_loss_mean=0.0024, v_loss_mean=0.1579, ent_mean=0.1101 | gn_bb_mean=1.275, gn_bb_max=1.899 | gn_v_mean=0.832, gn_v_max=1.672
[AttnScore] scale=1.1519, C=10.0

  9%|▉         | 451/5000 [1:10:51<12:15:05,  9.70s/it]------------------ Training Record ------------------
Epoch: 451/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=25, valid_ratio=0.696, reward_valid_mean=0.3181, reward_valid_std=2.2688
[BatchDiag] adv_mean=-0.0380, adv_std=0.8929, adv_abs_mean=0.6688 | ret_mean=6.7936, ret_std=1.7412 | val_mean=6.8315, val_std=1.5063 | explained_var=0.737061
[GradSplit pre-clip] backbone=0.689548, critic=0.525119
[Loss] pg_loss=-0.044921, entropy_loss=0.000100, value_loss=0.040422
[EpochKL] epoch=0 mean_kl=0.00444 max_kl=0.00756
[EpochKL] epoch=1 mean_kl=0.00944 max_kl=0.01272
[EpochKL] epoch=2 mean_kl=0.00982 max_kl=0.01226
[Time] Env Create Time: 2.8472s |Rollout Collect Time: 3.9393s |Loss & Update :2.0818
[PPODiag] kl_mean=0.0079, kl_p90=0.0123, kl_max=0.0127 | clipfrac_mean=0.039, logratio_std_mean=0.130, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.696, p10=0.692, min=0.691 | pg_loss_mean=0.0034, v_loss_mean=0.1686, ent_mean=0.0907 | gn_bb_mean=1.562, gn_bb_max=2.423 | gn_v_mean=1.355, gn_v_max=3.110

  9%|▉         | 452/5000 [1:11:00<11:56:07,  9.45s/it]------------------ Training Record ------------------
Epoch: 452/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3228, reward_valid_std=2.2724
[BatchDiag] adv_mean=0.0151, adv_std=0.8802, adv_abs_mean=0.6659 | ret_mean=6.8181, ret_std=1.7448 | val_mean=6.8030, val_std=1.5423 | explained_var=0.745530
[GradSplit pre-clip] backbone=0.672051, critic=0.861401
[Loss] pg_loss=-0.044407, entropy_loss=0.000114, value_loss=0.038208
[EpochKL] epoch=0 mean_kl=0.00362 max_kl=0.00559
[EpochKL] epoch=1 mean_kl=0.00690 max_kl=0.00976
[EpochKL] epoch=2 mean_kl=0.00623 max_kl=0.00844
[Time] Env Create Time: 2.8668s |Rollout Collect Time: 3.3463s |Loss & Update :1.7999
[PPODiag] kl_mean=0.0056, kl_p90=0.0084, kl_max=0.0098 | clipfrac_mean=0.034, logratio_std_mean=0.107, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.827, p10=0.820, min=0.818 | pg_loss_mean=0.0018, v_loss_mean=0.1646, ent_mean=0.1114 | gn_bb_mean=1.274, gn_bb_max=2.189 | gn_v_mean=1.430, gn_v_max=2.538

  9%|▉         | 453/5000 [1:11:08<11:23:21,  9.02s/it]------------------ Training Record ------------------
Epoch: 453/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3229, reward_valid_std=2.2710
[BatchDiag] adv_mean=-0.0558, adv_std=0.8781, adv_abs_mean=0.6497 | ret_mean=6.8395, ret_std=1.7186 | val_mean=6.8953, val_std=1.5457 | explained_var=0.738973
[GradSplit pre-clip] backbone=0.474466, critic=0.478599
[Loss] pg_loss=0.002779, entropy_loss=0.000113, value_loss=0.038429
[EpochKL] epoch=0 mean_kl=0.00240 max_kl=0.00371
[EpochKL] epoch=1 mean_kl=0.00795 max_kl=0.01425
[EarlyStop] epoch=2 mean_kl=0.01332 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01332 max_kl=0.02047
[Time] Env Create Time: 2.8636s |Rollout Collect Time: 3.5079s |Loss & Update :1.8787
[PPODiag] kl_mean=0.0079, kl_p90=0.0150, kl_max=0.0205 | clipfrac_mean=0.035, logratio_std_mean=0.128, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.790, p10=0.785, min=0.781 | pg_loss_mean=0.0027, v_loss_mean=0.1621, ent_mean=0.1073 | gn_bb_mean=1.235, gn_bb_max=1.966 | gn_v_mean=1.362, gn_v_max=2.619

  9%|▉         | 454/5000 [1:11:16<11:05:47,  8.79s/it]------------------ Training Record ------------------
Epoch: 454/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3234, reward_valid_std=2.2729
[BatchDiag] adv_mean=-0.0969, adv_std=0.8722, adv_abs_mean=0.6572 | ret_mean=6.8438, ret_std=1.7052 | val_mean=6.9407, val_std=1.5212 | explained_var=0.738367
[GradSplit pre-clip] backbone=0.530691, critic=1.180594
[Loss] pg_loss=0.067965, entropy_loss=0.000117, value_loss=0.041448
[EpochKL] epoch=0 mean_kl=0.00774 max_kl=0.01284
[EarlyStop] epoch=1 mean_kl=0.01206 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01206 max_kl=0.01808
[Time] Env Create Time: 2.7037s |Rollout Collect Time: 3.3710s |Loss & Update :1.2220
[PPODiag] kl_mean=0.0099, kl_p90=0.0146, kl_max=0.0181 | clipfrac_mean=0.043, logratio_std_mean=0.147, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.825, p10=0.819, min=0.815 | pg_loss_mean=0.0041, v_loss_mean=0.1618, ent_mean=0.1096 | gn_bb_mean=1.547, gn_bb_max=2.209 | gn_v_mean=1.176, gn_v_max=2.323

  9%|▉         | 455/5000 [1:11:24<10:31:46,  8.34s/it]------------------ Training Record ------------------
Epoch: 455/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3255, reward_valid_std=2.2753
[BatchDiag] adv_mean=-0.0423, adv_std=0.8806, adv_abs_mean=0.6611 | ret_mean=6.8436, ret_std=1.7137 | val_mean=6.8859, val_std=1.4921 | explained_var=0.735954
[GradSplit pre-clip] backbone=0.720064, critic=0.597649
[Loss] pg_loss=-0.062972, entropy_loss=0.000106, value_loss=0.037022
[EpochKL] epoch=0 mean_kl=0.00264 max_kl=0.00382
[EpochKL] epoch=1 mean_kl=0.00638 max_kl=0.01063
[EarlyStop] epoch=2 mean_kl=0.01433 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01433 max_kl=0.01812
[Time] Env Create Time: 2.8686s |Rollout Collect Time: 3.5022s |Loss & Update :1.8817
[PPODiag] kl_mean=0.0078, kl_p90=0.0148, kl_max=0.0181 | clipfrac_mean=0.037, logratio_std_mean=0.126, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.786, p10=0.781, min=0.777 | pg_loss_mean=0.0026, v_loss_mean=0.1657, ent_mean=0.1042 | gn_bb_mean=1.320, gn_bb_max=1.998 | gn_v_mean=1.625, gn_v_max=3.716
[AttnScore] scale=1.1541, C=10.0

  9%|▉         | 456/5000 [1:11:32<10:29:39,  8.31s/it]------------------ Training Record ------------------
Epoch: 456/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=31, valid_ratio=0.559, reward_valid_mean=0.3245, reward_valid_std=2.2745
[BatchDiag] adv_mean=-0.1362, adv_std=0.8778, adv_abs_mean=0.6598 | ret_mean=6.8597, ret_std=1.7023 | val_mean=6.9959, val_std=1.4481 | explained_var=0.734092
[GradSplit pre-clip] backbone=0.438331, critic=0.733921
[Loss] pg_loss=-0.094328, entropy_loss=0.000076, value_loss=0.035366
[EpochKL] epoch=0 mean_kl=0.00717 max_kl=0.01255
[EarlyStop] epoch=1 mean_kl=0.01006 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01006 max_kl=0.01493
[Time] Env Create Time: 2.8730s |Rollout Collect Time: 4.8717s |Loss & Update :1.7084
[PPODiag] kl_mean=0.0086, kl_p90=0.0137, kl_max=0.0149 | clipfrac_mean=0.041, logratio_std_mean=0.134, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.559, p10=0.555, min=0.552 | pg_loss_mean=0.0035, v_loss_mean=0.1622, ent_mean=0.0736 | gn_bb_mean=1.428, gn_bb_max=2.192 | gn_v_mean=1.312, gn_v_max=3.198

  9%|▉         | 457/5000 [1:11:41<10:55:23,  8.66s/it]------------------ Training Record ------------------
Epoch: 457/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3222, reward_valid_std=2.2729
[BatchDiag] adv_mean=-0.0209, adv_std=0.8788, adv_abs_mean=0.6656 | ret_mean=6.7885, ret_std=1.7364 | val_mean=6.8093, val_std=1.4672 | explained_var=0.743835
[GradSplit pre-clip] backbone=0.644327, critic=0.873635
[Loss] pg_loss=-0.061786, entropy_loss=0.000112, value_loss=0.038992
[EpochKL] epoch=0 mean_kl=0.00579 max_kl=0.01120
[EpochKL] epoch=1 mean_kl=0.00661 max_kl=0.00970
[EpochKL] epoch=2 mean_kl=0.00854 max_kl=0.01503
[Time] Env Create Time: 2.8838s |Rollout Collect Time: 3.4948s |Loss & Update :1.8728
[PPODiag] kl_mean=0.0070, kl_p90=0.0100, kl_max=0.0150 | clipfrac_mean=0.037, logratio_std_mean=0.123, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.788, p10=0.785, min=0.778 | pg_loss_mean=0.0027, v_loss_mean=0.1657, ent_mean=0.1029 | gn_bb_mean=1.464, gn_bb_max=2.429 | gn_v_mean=1.728, gn_v_max=3.244

  9%|▉         | 458/5000 [1:11:49<10:46:04,  8.53s/it]------------------ Training Record ------------------
Epoch: 458/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3191, reward_valid_std=2.2681
[BatchDiag] adv_mean=-0.1191, adv_std=0.8804, adv_abs_mean=0.6662 | ret_mean=6.8108, ret_std=1.7236 | val_mean=6.9298, val_std=1.4671 | explained_var=0.739120
[GradSplit pre-clip] backbone=0.685682, critic=0.917626
[Loss] pg_loss=0.003792, entropy_loss=0.000107, value_loss=0.039342
[EpochKL] epoch=0 mean_kl=0.00217 max_kl=0.00388
[EpochKL] epoch=1 mean_kl=0.00350 max_kl=0.00489
[EpochKL] epoch=2 mean_kl=0.00458 max_kl=0.00604
[Time] Env Create Time: 2.6998s |Rollout Collect Time: 3.4833s |Loss & Update :1.8735
[PPODiag] kl_mean=0.0034, kl_p90=0.0051, kl_max=0.0060 | clipfrac_mean=0.024, logratio_std_mean=0.083, ratio_p95_mean=1.038 | valid_ratio_mb_mean=0.789, p10=0.785, min=0.783 | pg_loss_mean=0.0011, v_loss_mean=0.1630, ent_mean=0.1018 | gn_bb_mean=1.026, gn_bb_max=1.720 | gn_v_mean=1.024, gn_v_max=2.210

  9%|▉         | 459/5000 [1:11:58<10:35:05,  8.39s/it]------------------ Training Record ------------------
Epoch: 459/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3237, reward_valid_std=2.2696
[BatchDiag] adv_mean=-0.1241, adv_std=0.8618, adv_abs_mean=0.6506 | ret_mean=6.8520, ret_std=1.6966 | val_mean=6.9761, val_std=1.4412 | explained_var=0.742011
[GradSplit pre-clip] backbone=0.403112, critic=0.683739
[Loss] pg_loss=-0.084909, entropy_loss=0.000118, value_loss=0.035343
[EpochKL] epoch=0 mean_kl=0.00318 max_kl=0.00490
[EpochKL] epoch=1 mean_kl=0.00681 max_kl=0.01198
[EpochKL] epoch=2 mean_kl=0.00675 max_kl=0.00838
[Time] Env Create Time: 2.8772s |Rollout Collect Time: 3.3469s |Loss & Update :1.8021
[PPODiag] kl_mean=0.0056, kl_p90=0.0083, kl_max=0.0120 | clipfrac_mean=0.033, logratio_std_mean=0.107, ratio_p95_mean=1.043 | valid_ratio_mb_mean=0.826, p10=0.821, min=0.816 | pg_loss_mean=0.0019, v_loss_mean=0.1568, ent_mean=0.1074 | gn_bb_mean=1.385, gn_bb_max=2.279 | gn_v_mean=0.924, gn_v_max=2.384

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.675, Step: 21, Avg Done Step: 18.46, #CS visited: 0.34
D->C12->C1->C15->C3->C5->C2->D->C4->C14->C8->D->C13->C6->C7->C11->C10->C9->D
Eval cost : 4.0957s
-----------------------------
  9%|▉         | 460/5000 [1:12:10<12:00:14,  9.52s/it]------------------ Training Record ------------------
Epoch: 460/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3225, reward_valid_std=2.2721
[BatchDiag] adv_mean=-0.0781, adv_std=0.8542, adv_abs_mean=0.6409 | ret_mean=6.8386, ret_std=1.7166 | val_mean=6.9167, val_std=1.4721 | explained_var=0.752389
[GradSplit pre-clip] backbone=0.684120, critic=0.523220
[Loss] pg_loss=-0.017411, entropy_loss=0.000112, value_loss=0.035765
[EpochKL] epoch=0 mean_kl=0.00295 max_kl=0.00509
[EpochKL] epoch=1 mean_kl=0.00481 max_kl=0.00710
[EpochKL] epoch=2 mean_kl=0.00806 max_kl=0.01017
[Time] Env Create Time: 2.8471s |Rollout Collect Time: 3.3460s |Loss & Update :1.8035
[PPODiag] kl_mean=0.0053, kl_p90=0.0089, kl_max=0.0102 | clipfrac_mean=0.031, logratio_std_mean=0.104, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.826, p10=0.821, min=0.818 | pg_loss_mean=0.0017, v_loss_mean=0.1544, ent_mean=0.1078 | gn_bb_mean=1.201, gn_bb_max=1.703 | gn_v_mean=0.800, gn_v_max=1.763
[AttnScore] scale=1.1560, C=10.0

  9%|▉         | 461/5000 [1:12:18<11:25:33,  9.06s/it]------------------ Training Record ------------------
Epoch: 461/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3205, reward_valid_std=2.2706
[BatchDiag] adv_mean=-0.0465, adv_std=0.8649, adv_abs_mean=0.6475 | ret_mean=6.8104, ret_std=1.7379 | val_mean=6.8568, val_std=1.5142 | explained_var=0.752341
[GradSplit pre-clip] backbone=0.626407, critic=0.933998
[Loss] pg_loss=-0.135085, entropy_loss=0.000108, value_loss=0.033899
[EpochKL] epoch=0 mean_kl=0.00184 max_kl=0.00315
[EpochKL] epoch=1 mean_kl=0.00425 max_kl=0.00706
[EpochKL] epoch=2 mean_kl=0.00771 max_kl=0.01349
[Time] Env Create Time: 2.8689s |Rollout Collect Time: 3.4958s |Loss & Update :1.8758
[PPODiag] kl_mean=0.0046, kl_p90=0.0088, kl_max=0.0135 | clipfrac_mean=0.029, logratio_std_mean=0.094, ratio_p95_mean=1.041 | valid_ratio_mb_mean=0.790, p10=0.784, min=0.781 | pg_loss_mean=0.0013, v_loss_mean=0.1582, ent_mean=0.1053 | gn_bb_mean=1.078, gn_bb_max=1.601 | gn_v_mean=1.195, gn_v_max=2.665

  9%|▉         | 462/5000 [1:12:26<11:06:46,  8.82s/it]------------------ Training Record ------------------
Epoch: 462/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.828, reward_valid_mean=0.3207, reward_valid_std=2.2705
[BatchDiag] adv_mean=-0.0804, adv_std=0.8628, adv_abs_mean=0.6475 | ret_mean=6.8340, ret_std=1.7222 | val_mean=6.9144, val_std=1.5239 | explained_var=0.749003
[GradSplit pre-clip] backbone=0.730515, critic=0.447143
[Loss] pg_loss=-0.042242, entropy_loss=0.000114, value_loss=0.036628
[EpochKL] epoch=0 mean_kl=0.00235 max_kl=0.00394
[EpochKL] epoch=1 mean_kl=0.00656 max_kl=0.01086
[EpochKL] epoch=2 mean_kl=0.00864 max_kl=0.01342
[Time] Env Create Time: 2.7108s |Rollout Collect Time: 3.3368s |Loss & Update :1.8062
[PPODiag] kl_mean=0.0059, kl_p90=0.0093, kl_max=0.0134 | clipfrac_mean=0.033, logratio_std_mean=0.110, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.828, p10=0.823, min=0.819 | pg_loss_mean=0.0020, v_loss_mean=0.1582, ent_mean=0.1104 | gn_bb_mean=1.221, gn_bb_max=2.386 | gn_v_mean=1.117, gn_v_max=3.168

  9%|▉         | 463/5000 [1:12:34<10:44:48,  8.53s/it]------------------ Training Record ------------------
Epoch: 463/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3234, reward_valid_std=2.2705
[BatchDiag] adv_mean=-0.0318, adv_std=0.8573, adv_abs_mean=0.6378 | ret_mean=6.8317, ret_std=1.7146 | val_mean=6.8634, val_std=1.5389 | explained_var=0.750006
[GradSplit pre-clip] backbone=0.543341, critic=1.216360
[Loss] pg_loss=-0.149780, entropy_loss=0.000107, value_loss=0.035173
[EpochKL] epoch=0 mean_kl=0.00295 max_kl=0.00476
[EpochKL] epoch=1 mean_kl=0.00467 max_kl=0.00804
[EpochKL] epoch=2 mean_kl=0.00559 max_kl=0.00638
[Time] Env Create Time: 2.8646s |Rollout Collect Time: 3.4862s |Loss & Update :1.8888
[PPODiag] kl_mean=0.0044, kl_p90=0.0062, kl_max=0.0080 | clipfrac_mean=0.030, logratio_std_mean=0.095, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.788, p10=0.780, min=0.777 | pg_loss_mean=0.0013, v_loss_mean=0.1620, ent_mean=0.1058 | gn_bb_mean=1.123, gn_bb_max=1.828 | gn_v_mean=2.318, gn_v_max=5.137

  9%|▉         | 464/5000 [1:12:42<10:38:09,  8.44s/it]------------------ Training Record ------------------
Epoch: 464/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3216, reward_valid_std=2.2681
[BatchDiag] adv_mean=-0.1723, adv_std=0.8575, adv_abs_mean=0.6420 | ret_mean=6.8746, ret_std=1.6951 | val_mean=7.0469, val_std=1.5094 | explained_var=0.744072
[GradSplit pre-clip] backbone=0.465306, critic=1.181141
[Loss] pg_loss=-0.056502, entropy_loss=0.000118, value_loss=0.036034
[EpochKL] epoch=0 mean_kl=0.00528 max_kl=0.01398
[EpochKL] epoch=1 mean_kl=0.00918 max_kl=0.01218
[EarlyStop] epoch=2 mean_kl=0.01237 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01237 max_kl=0.02258
[Time] Env Create Time: 2.8572s |Rollout Collect Time: 3.3358s |Loss & Update :1.8177
[PPODiag] kl_mean=0.0089, kl_p90=0.0136, kl_max=0.0226 | clipfrac_mean=0.043, logratio_std_mean=0.141, ratio_p95_mean=1.059 | valid_ratio_mb_mean=0.827, p10=0.822, min=0.819 | pg_loss_mean=0.0029, v_loss_mean=0.1599, ent_mean=0.1140 | gn_bb_mean=1.413, gn_bb_max=2.439 | gn_v_mean=2.006, gn_v_max=3.514

  9%|▉         | 465/5000 [1:12:50<10:28:15,  8.31s/it]------------------ Training Record ------------------
Epoch: 465/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3216, reward_valid_std=2.2704
[BatchDiag] adv_mean=-0.2677, adv_std=0.8554, adv_abs_mean=0.6586 | ret_mean=6.9029, ret_std=1.6787 | val_mean=7.1706, val_std=1.4571 | explained_var=0.740368
[GradSplit pre-clip] backbone=0.547803, critic=1.996993
[Loss] pg_loss=-0.045452, entropy_loss=0.000113, value_loss=0.038695
[EpochKL] epoch=0 mean_kl=0.00349 max_kl=0.00551
[EpochKL] epoch=1 mean_kl=0.00646 max_kl=0.00914
[EpochKL] epoch=2 mean_kl=0.00601 max_kl=0.00814
[Time] Env Create Time: 2.7288s |Rollout Collect Time: 3.5139s |Loss & Update :1.8769
[PPODiag] kl_mean=0.0053, kl_p90=0.0070, kl_max=0.0091 | clipfrac_mean=0.032, logratio_std_mean=0.106, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.790, p10=0.783, min=0.780 | pg_loss_mean=0.0016, v_loss_mean=0.1576, ent_mean=0.1069 | gn_bb_mean=0.964, gn_bb_max=1.527 | gn_v_mean=1.324, gn_v_max=2.059
[AttnScore] scale=1.1580, C=10.0

  9%|▉         | 466/5000 [1:12:58<10:23:46,  8.25s/it]------------------ Training Record ------------------
Epoch: 466/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3215, reward_valid_std=2.2696
[BatchDiag] adv_mean=-0.2140, adv_std=0.8527, adv_abs_mean=0.6567 | ret_mean=6.8697, ret_std=1.6921 | val_mean=7.0837, val_std=1.4361 | explained_var=0.746031
[GradSplit pre-clip] backbone=0.539474, critic=1.451991
[Loss] pg_loss=-0.046809, entropy_loss=0.000117, value_loss=0.037079
[EpochKL] epoch=0 mean_kl=0.00246 max_kl=0.00480
[EpochKL] epoch=1 mean_kl=0.00485 max_kl=0.00812
[EpochKL] epoch=2 mean_kl=0.00684 max_kl=0.00885
[Time] Env Create Time: 2.8611s |Rollout Collect Time: 3.3578s |Loss & Update :1.8061
[PPODiag] kl_mean=0.0047, kl_p90=0.0080, kl_max=0.0089 | clipfrac_mean=0.029, logratio_std_mean=0.099, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.827, p10=0.822, min=0.810 | pg_loss_mean=0.0012, v_loss_mean=0.1605, ent_mean=0.1131 | gn_bb_mean=1.071, gn_bb_max=1.491 | gn_v_mean=1.800, gn_v_max=2.892

  9%|▉         | 467/5000 [1:13:06<10:18:26,  8.19s/it]------------------ Training Record ------------------
Epoch: 467/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.756, reward_valid_mean=0.3189, reward_valid_std=2.2703
[BatchDiag] adv_mean=-0.2139, adv_std=0.8792, adv_abs_mean=0.6685 | ret_mean=6.8434, ret_std=1.7026 | val_mean=7.0573, val_std=1.4271 | explained_var=0.733388
[GradSplit pre-clip] backbone=0.511664, critic=1.069673
[Loss] pg_loss=-0.103863, entropy_loss=0.000110, value_loss=0.036892
[EpochKL] epoch=0 mean_kl=0.00411 max_kl=0.00613
[EpochKL] epoch=1 mean_kl=0.00846 max_kl=0.01282
[EpochKL] epoch=2 mean_kl=0.00826 max_kl=0.01137
[Time] Env Create Time: 2.8689s |Rollout Collect Time: 3.6534s |Loss & Update :1.9405
[PPODiag] kl_mean=0.0069, kl_p90=0.0108, kl_max=0.0128 | clipfrac_mean=0.037, logratio_std_mean=0.123, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.756, p10=0.750, min=0.747 | pg_loss_mean=0.0021, v_loss_mean=0.1636, ent_mean=0.1040 | gn_bb_mean=1.319, gn_bb_max=2.129 | gn_v_mean=1.228, gn_v_max=2.483

  9%|▉         | 468/5000 [1:13:15<10:24:35,  8.27s/it]------------------ Training Record ------------------
Epoch: 468/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3244, reward_valid_std=2.2716
[BatchDiag] adv_mean=-0.1295, adv_std=0.8568, adv_abs_mean=0.6520 | ret_mean=6.8618, ret_std=1.6896 | val_mean=6.9914, val_std=1.4190 | explained_var=0.742819
[GradSplit pre-clip] backbone=0.441716, critic=1.246134
[Loss] pg_loss=-0.012385, entropy_loss=0.000109, value_loss=0.038605
[EpochKL] epoch=0 mean_kl=0.00411 max_kl=0.00814
[EpochKL] epoch=1 mean_kl=0.00706 max_kl=0.00991
[EpochKL] epoch=2 mean_kl=0.00834 max_kl=0.01113
[Time] Env Create Time: 2.8742s |Rollout Collect Time: 3.5164s |Loss & Update :1.8784
[PPODiag] kl_mean=0.0065, kl_p90=0.0102, kl_max=0.0111 | clipfrac_mean=0.038, logratio_std_mean=0.116, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.789, p10=0.786, min=0.783 | pg_loss_mean=0.0026, v_loss_mean=0.1581, ent_mean=0.1075 | gn_bb_mean=1.389, gn_bb_max=2.390 | gn_v_mean=1.468, gn_v_max=2.897

  9%|▉         | 469/5000 [1:13:23<10:24:27,  8.27s/it]------------------ Training Record ------------------
Epoch: 469/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.828, reward_valid_mean=0.3189, reward_valid_std=2.2658
[BatchDiag] adv_mean=-0.1002, adv_std=0.8718, adv_abs_mean=0.6564 | ret_mean=6.8000, ret_std=1.7096 | val_mean=6.9002, val_std=1.4884 | explained_var=0.739945
[GradSplit pre-clip] backbone=0.590534, critic=0.505397
[Loss] pg_loss=-0.143527, entropy_loss=0.000127, value_loss=0.035547
[EpochKL] epoch=0 mean_kl=0.00492 max_kl=0.00726
[EpochKL] epoch=1 mean_kl=0.00679 max_kl=0.00931
[EpochKL] epoch=2 mean_kl=0.00985 max_kl=0.01499
[Time] Env Create Time: 2.6955s |Rollout Collect Time: 3.3518s |Loss & Update :1.8053
[PPODiag] kl_mean=0.0072, kl_p90=0.0107, kl_max=0.0150 | clipfrac_mean=0.037, logratio_std_mean=0.125, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.828, p10=0.822, min=0.820 | pg_loss_mean=0.0026, v_loss_mean=0.1651, ent_mean=0.1112 | gn_bb_mean=1.440, gn_bb_max=2.155 | gn_v_mean=1.804, gn_v_max=5.396

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.718, Step: 22, Avg Done Step: 18.51, #CS visited: 0.35
D->C12->C1->C15->C3->C5->C2->D->C4->C14->C8->D->C13->C6->C7->C11->C10->C9->D
Eval cost : 4.2280s
-----------------------------
  9%|▉         | 470/5000 [1:13:35<11:51:16,  9.42s/it]------------------ Training Record ------------------
Epoch: 470/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51178/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.290, reward_valid_mean=0.3189, reward_valid_std=2.2677
[BatchDiag] adv_mean=-0.2065, adv_std=0.8923, adv_abs_mean=0.6637 | ret_mean=6.8444, ret_std=1.7069 | val_mean=7.0509, val_std=1.4719 | explained_var=0.726726
[GradSplit pre-clip] backbone=0.468403, critic=1.263052
[Loss] pg_loss=-0.066325, entropy_loss=0.000042, value_loss=0.036919
[EpochKL] epoch=0 mean_kl=0.00272 max_kl=0.00424
[EpochKL] epoch=1 mean_kl=0.00637 max_kl=0.01188
[EarlyStop] epoch=2 mean_kl=0.01005 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01005 max_kl=0.01770
[Time] Env Create Time: 2.8531s |Rollout Collect Time: 9.1768s |Loss & Update :4.6686
[PPODiag] kl_mean=0.0064, kl_p90=0.0114, kl_max=0.0177 | clipfrac_mean=0.035, logratio_std_mean=0.116, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.290, p10=0.287, min=0.286 | pg_loss_mean=0.0018, v_loss_mean=0.1664, ent_mean=0.0394 | gn_bb_mean=1.315, gn_bb_max=1.926 | gn_v_mean=1.810, gn_v_max=3.236
[AttnScore] scale=1.1596, C=10.0

  9%|▉         | 471/5000 [1:13:52<14:35:55, 11.60s/it]------------------ Training Record ------------------
Epoch: 471/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3210, reward_valid_std=2.2713
[BatchDiag] adv_mean=-0.2126, adv_std=0.8620, adv_abs_mean=0.6559 | ret_mean=6.8736, ret_std=1.6872 | val_mean=7.0862, val_std=1.5013 | explained_var=0.738993
[GradSplit pre-clip] backbone=0.744116, critic=1.128161
[Loss] pg_loss=-0.076801, entropy_loss=0.000117, value_loss=0.039845
[EpochKL] epoch=0 mean_kl=0.00486 max_kl=0.00842
[EpochKL] epoch=1 mean_kl=0.00932 max_kl=0.01365
[EarlyStop] epoch=2 mean_kl=0.01581 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01581 max_kl=0.02327
[Time] Env Create Time: 2.8384s |Rollout Collect Time: 3.3375s |Loss & Update :1.8195
[PPODiag] kl_mean=0.0100, kl_p90=0.0166, kl_max=0.0233 | clipfrac_mean=0.045, logratio_std_mean=0.146, ratio_p95_mean=1.063 | valid_ratio_mb_mean=0.826, p10=0.821, min=0.817 | pg_loss_mean=0.0037, v_loss_mean=0.1658, ent_mean=0.1142 | gn_bb_mean=1.571, gn_bb_max=2.740 | gn_v_mean=2.055, gn_v_max=3.934

  9%|▉         | 472/5000 [1:14:00<13:14:02, 10.52s/it]------------------ Training Record ------------------
Epoch: 472/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.829, reward_valid_mean=0.3158, reward_valid_std=2.2649
[BatchDiag] adv_mean=-0.1526, adv_std=0.8956, adv_abs_mean=0.6616 | ret_mean=6.7977, ret_std=1.7244 | val_mean=6.9503, val_std=1.5264 | explained_var=0.730267
[GradSplit pre-clip] backbone=0.443126, critic=1.317811
[Loss] pg_loss=0.027266, entropy_loss=0.000120, value_loss=0.042403
[EpochKL] epoch=0 mean_kl=0.00469 max_kl=0.00964
[EpochKL] epoch=1 mean_kl=0.00733 max_kl=0.00995
[EarlyStop] epoch=2 mean_kl=0.01106 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01106 max_kl=0.01824
[Time] Env Create Time: 2.8538s |Rollout Collect Time: 3.3168s |Loss & Update :1.7989
[PPODiag] kl_mean=0.0077, kl_p90=0.0115, kl_max=0.0182 | clipfrac_mean=0.038, logratio_std_mean=0.130, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.829, p10=0.824, min=0.822 | pg_loss_mean=0.0026, v_loss_mean=0.1641, ent_mean=0.1126 | gn_bb_mean=1.273, gn_bb_max=2.519 | gn_v_mean=1.288, gn_v_max=1.995

  9%|▉         | 473/5000 [1:14:08<12:16:06,  9.76s/it]------------------ Training Record ------------------
Epoch: 473/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3221, reward_valid_std=2.2705
[BatchDiag] adv_mean=-0.1320, adv_std=0.8769, adv_abs_mean=0.6543 | ret_mean=6.8300, ret_std=1.6966 | val_mean=6.9619, val_std=1.4906 | explained_var=0.732855
[GradSplit pre-clip] backbone=0.467653, critic=0.879754
[Loss] pg_loss=-0.006421, entropy_loss=0.000119, value_loss=0.041987
[EpochKL] epoch=0 mean_kl=0.00243 max_kl=0.00388
[EpochKL] epoch=1 mean_kl=0.00626 max_kl=0.00817
[EpochKL] epoch=2 mean_kl=0.00844 max_kl=0.01132
[Time] Env Create Time: 2.6783s |Rollout Collect Time: 3.3273s |Loss & Update :1.8014
[PPODiag] kl_mean=0.0057, kl_p90=0.0093, kl_max=0.0113 | clipfrac_mean=0.033, logratio_std_mean=0.109, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.824, p10=0.820, min=0.816 | pg_loss_mean=0.0019, v_loss_mean=0.1612, ent_mean=0.1158 | gn_bb_mean=1.135, gn_bb_max=1.595 | gn_v_mean=1.254, gn_v_max=2.874

  9%|▉         | 474/5000 [1:14:15<11:31:50,  9.17s/it]------------------ Training Record ------------------
Epoch: 474/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3227, reward_valid_std=2.2690
[BatchDiag] adv_mean=-0.0889, adv_std=0.8604, adv_abs_mean=0.6446 | ret_mean=6.8189, ret_std=1.7111 | val_mean=6.9078, val_std=1.5274 | explained_var=0.747156
[GradSplit pre-clip] backbone=0.659301, critic=0.604363
[Loss] pg_loss=-0.103960, entropy_loss=0.000113, value_loss=0.036697
[EpochKL] epoch=0 mean_kl=0.00443 max_kl=0.00852
[EpochKL] epoch=1 mean_kl=0.00698 max_kl=0.01344
[EpochKL] epoch=2 mean_kl=0.00809 max_kl=0.00999
[Time] Env Create Time: 2.8415s |Rollout Collect Time: 3.3361s |Loss & Update :1.8135
[PPODiag] kl_mean=0.0065, kl_p90=0.0096, kl_max=0.0134 | clipfrac_mean=0.035, logratio_std_mean=0.118, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.824, p10=0.818, min=0.814 | pg_loss_mean=0.0024, v_loss_mean=0.1592, ent_mean=0.1097 | gn_bb_mean=1.321, gn_bb_max=2.349 | gn_v_mean=1.631, gn_v_max=3.966

 10%|▉         | 475/5000 [1:14:23<11:04:59,  8.82s/it]------------------ Training Record ------------------
Epoch: 475/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3219, reward_valid_std=2.2693
[BatchDiag] adv_mean=-0.0620, adv_std=0.8744, adv_abs_mean=0.6499 | ret_mean=6.8171, ret_std=1.7268 | val_mean=6.8791, val_std=1.5256 | explained_var=0.743586
[GradSplit pre-clip] backbone=0.542348, critic=0.526616
[Loss] pg_loss=-0.069936, entropy_loss=0.000111, value_loss=0.037177
[EpochKL] epoch=0 mean_kl=0.00291 max_kl=0.00425
[EpochKL] epoch=1 mean_kl=0.00566 max_kl=0.00786
[EpochKL] epoch=2 mean_kl=0.00465 max_kl=0.00592
[Time] Env Create Time: 2.8568s |Rollout Collect Time: 3.4738s |Loss & Update :1.8701
[PPODiag] kl_mean=0.0044, kl_p90=0.0067, kl_max=0.0079 | clipfrac_mean=0.031, logratio_std_mean=0.095, ratio_p95_mean=1.043 | valid_ratio_mb_mean=0.788, p10=0.782, min=0.781 | pg_loss_mean=0.0017, v_loss_mean=0.1654, ent_mean=0.1053 | gn_bb_mean=1.070, gn_bb_max=1.553 | gn_v_mean=2.111, gn_v_max=4.379
[AttnScore] scale=1.1618, C=10.0

 10%|▉         | 476/5000 [1:14:32<10:50:54,  8.63s/it]------------------ Training Record ------------------
Epoch: 476/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3211, reward_valid_std=2.2733
[BatchDiag] adv_mean=-0.1387, adv_std=0.8993, adv_abs_mean=0.6697 | ret_mean=6.8251, ret_std=1.7174 | val_mean=6.9637, val_std=1.5233 | explained_var=0.725811
[GradSplit pre-clip] backbone=0.624504, critic=0.930425
[Loss] pg_loss=-0.047516, entropy_loss=0.000112, value_loss=0.040972
[EpochKL] epoch=0 mean_kl=0.00270 max_kl=0.00432
[EpochKL] epoch=1 mean_kl=0.00552 max_kl=0.00934
[EpochKL] epoch=2 mean_kl=0.00832 max_kl=0.01293
[Time] Env Create Time: 2.8574s |Rollout Collect Time: 3.5031s |Loss & Update :1.8796
[PPODiag] kl_mean=0.0055, kl_p90=0.0098, kl_max=0.0129 | clipfrac_mean=0.032, logratio_std_mean=0.105, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.777 | pg_loss_mean=0.0018, v_loss_mean=0.1715, ent_mean=0.1030 | gn_bb_mean=1.185, gn_bb_max=1.823 | gn_v_mean=1.827, gn_v_max=3.058

 10%|▉         | 477/5000 [1:14:40<10:41:53,  8.52s/it]------------------ Training Record ------------------
Epoch: 477/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3207, reward_valid_std=2.2712
[BatchDiag] adv_mean=-0.1941, adv_std=0.8850, adv_abs_mean=0.6697 | ret_mean=6.8558, ret_std=1.6994 | val_mean=7.0499, val_std=1.4603 | explained_var=0.728778
[GradSplit pre-clip] backbone=0.444797, critic=0.884003
[Loss] pg_loss=-0.080952, entropy_loss=0.000116, value_loss=0.039916
[EpochKL] epoch=0 mean_kl=0.00594 max_kl=0.01557
[EpochKL] epoch=1 mean_kl=0.00821 max_kl=0.01012
[EpochKL] epoch=2 mean_kl=0.00963 max_kl=0.01525
[Time] Env Create Time: 2.7217s |Rollout Collect Time: 3.3639s |Loss & Update :1.8105
[PPODiag] kl_mean=0.0079, kl_p90=0.0115, kl_max=0.0156 | clipfrac_mean=0.039, logratio_std_mean=0.131, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.827, p10=0.821, min=0.819 | pg_loss_mean=0.0029, v_loss_mean=0.1668, ent_mean=0.1070 | gn_bb_mean=1.391, gn_bb_max=2.425 | gn_v_mean=1.484, gn_v_max=2.363

 10%|▉         | 478/5000 [1:14:48<10:27:45,  8.33s/it]------------------ Training Record ------------------
Epoch: 478/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3226, reward_valid_std=2.2711
[BatchDiag] adv_mean=-0.2408, adv_std=0.8723, adv_abs_mean=0.6634 | ret_mean=6.8739, ret_std=1.6881 | val_mean=7.1147, val_std=1.4703 | explained_var=0.733017
[GradSplit pre-clip] backbone=0.678769, critic=1.221957
[Loss] pg_loss=-0.132706, entropy_loss=0.000113, value_loss=0.035709
[EpochKL] epoch=0 mean_kl=0.00252 max_kl=0.00352
[EpochKL] epoch=1 mean_kl=0.00560 max_kl=0.00803
[EarlyStop] epoch=2 mean_kl=0.01075 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01075 max_kl=0.01477
[Time] Env Create Time: 2.8553s |Rollout Collect Time: 3.4769s |Loss & Update :1.8852
[PPODiag] kl_mean=0.0063, kl_p90=0.0113, kl_max=0.0148 | clipfrac_mean=0.036, logratio_std_mean=0.112, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.787, p10=0.781, min=0.781 | pg_loss_mean=0.0021, v_loss_mean=0.1645, ent_mean=0.1022 | gn_bb_mean=1.282, gn_bb_max=2.081 | gn_v_mean=1.796, gn_v_max=3.332

 10%|▉         | 479/5000 [1:14:56<10:25:06,  8.30s/it]------------------ Training Record ------------------
Epoch: 479/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3251, reward_valid_std=2.2714
[BatchDiag] adv_mean=-0.2309, adv_std=0.8641, adv_abs_mean=0.6612 | ret_mean=6.9067, ret_std=1.6586 | val_mean=7.1376, val_std=1.4383 | explained_var=0.728569
[GradSplit pre-clip] backbone=0.708930, critic=1.715719
[Loss] pg_loss=-0.048878, entropy_loss=0.000119, value_loss=0.038320
[EpochKL] epoch=0 mean_kl=0.00284 max_kl=0.00492
[EpochKL] epoch=1 mean_kl=0.00663 max_kl=0.00922
[EpochKL] epoch=2 mean_kl=0.00986 max_kl=0.01267
[Time] Env Create Time: 2.8735s |Rollout Collect Time: 3.3228s |Loss & Update :1.8070
[PPODiag] kl_mean=0.0064, kl_p90=0.0106, kl_max=0.0127 | clipfrac_mean=0.034, logratio_std_mean=0.116, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.824, p10=0.820, min=0.815 | pg_loss_mean=0.0022, v_loss_mean=0.1624, ent_mean=0.1051 | gn_bb_mean=1.253, gn_bb_max=2.194 | gn_v_mean=1.744, gn_v_max=3.182

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.661, Step: 21, Avg Done Step: 18.41, #CS visited: 0.36
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->D->C6->C7->C11->C10->C9->C8->D
Eval cost : 4.0563s
-----------------------------
 10%|▉         | 480/5000 [1:15:08<11:50:34,  9.43s/it]------------------ Training Record ------------------
Epoch: 480/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3271, reward_valid_std=2.2742
[BatchDiag] adv_mean=-0.1778, adv_std=0.8451, adv_abs_mean=0.6390 | ret_mean=6.8942, ret_std=1.6626 | val_mean=7.0720, val_std=1.4252 | explained_var=0.741626
[GradSplit pre-clip] backbone=0.625156, critic=1.406390
[Loss] pg_loss=-0.026341, entropy_loss=0.000114, value_loss=0.038408
[EpochKL] epoch=0 mean_kl=0.00481 max_kl=0.00723
[EpochKL] epoch=1 mean_kl=0.00908 max_kl=0.01598
[EarlyStop] epoch=2 mean_kl=0.01438 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01438 max_kl=0.02351
[Time] Env Create Time: 2.6906s |Rollout Collect Time: 3.3243s |Loss & Update :1.8090
[PPODiag] kl_mean=0.0094, kl_p90=0.0156, kl_max=0.0235 | clipfrac_mean=0.042, logratio_std_mean=0.142, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.823, p10=0.816, min=0.815 | pg_loss_mean=0.0036, v_loss_mean=0.1544, ent_mean=0.1071 | gn_bb_mean=1.505, gn_bb_max=2.412 | gn_v_mean=1.413, gn_v_max=2.636
[AttnScore] scale=1.1634, C=10.0

 10%|▉         | 481/5000 [1:15:16<11:14:04,  8.95s/it]------------------ Training Record ------------------
Epoch: 481/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3268, reward_valid_std=2.2775
[BatchDiag] adv_mean=-0.2421, adv_std=0.8520, adv_abs_mean=0.6500 | ret_mean=6.9109, ret_std=1.6496 | val_mean=7.1530, val_std=1.4398 | explained_var=0.733261
[GradSplit pre-clip] backbone=0.495338, critic=1.626641
[Loss] pg_loss=-0.062437, entropy_loss=0.000102, value_loss=0.036397
[EpochKL] epoch=0 mean_kl=0.00535 max_kl=0.00906
[EpochKL] epoch=1 mean_kl=0.00554 max_kl=0.00752
[EpochKL] epoch=2 mean_kl=0.00605 max_kl=0.00684
[Time] Env Create Time: 2.8366s |Rollout Collect Time: 3.4680s |Loss & Update :1.8709
[PPODiag] kl_mean=0.0056, kl_p90=0.0070, kl_max=0.0091 | clipfrac_mean=0.032, logratio_std_mean=0.108, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.785, p10=0.781, min=0.780 | pg_loss_mean=0.0023, v_loss_mean=0.1581, ent_mean=0.1013 | gn_bb_mean=1.162, gn_bb_max=1.645 | gn_v_mean=1.775, gn_v_max=3.125

 10%|▉         | 482/5000 [1:15:24<10:56:26,  8.72s/it]------------------ Training Record ------------------
Epoch: 482/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3258, reward_valid_std=2.2754
[BatchDiag] adv_mean=-0.2773, adv_std=0.8824, adv_abs_mean=0.6840 | ret_mean=6.9047, ret_std=1.6647 | val_mean=7.1819, val_std=1.3872 | explained_var=0.719030
[GradSplit pre-clip] backbone=0.491487, critic=2.024006
[Loss] pg_loss=-0.029658, entropy_loss=0.000109, value_loss=0.041383
[EpochKL] epoch=0 mean_kl=0.00321 max_kl=0.00592
[EpochKL] epoch=1 mean_kl=0.00512 max_kl=0.00658
[EpochKL] epoch=2 mean_kl=0.00630 max_kl=0.00874
[Time] Env Create Time: 2.8412s |Rollout Collect Time: 3.3211s |Loss & Update :1.8059
[PPODiag] kl_mean=0.0049, kl_p90=0.0068, kl_max=0.0087 | clipfrac_mean=0.030, logratio_std_mean=0.100, ratio_p95_mean=1.038 | valid_ratio_mb_mean=0.823, p10=0.819, min=0.814 | pg_loss_mean=0.0017, v_loss_mean=0.1692, ent_mean=0.1071 | gn_bb_mean=1.153, gn_bb_max=1.575 | gn_v_mean=1.708, gn_v_max=2.702

 10%|▉         | 483/5000 [1:15:32<10:39:22,  8.49s/it]------------------ Training Record ------------------
Epoch: 483/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3238, reward_valid_std=2.2729
[BatchDiag] adv_mean=-0.2473, adv_std=0.8619, adv_abs_mean=0.6642 | ret_mean=6.8708, ret_std=1.6676 | val_mean=7.1181, val_std=1.3965 | explained_var=0.732846
[GradSplit pre-clip] backbone=0.632663, critic=1.611764
[Loss] pg_loss=-0.074062, entropy_loss=0.000119, value_loss=0.040892
[EpochKL] epoch=0 mean_kl=0.00314 max_kl=0.00571
[EpochKL] epoch=1 mean_kl=0.00538 max_kl=0.00911
[EpochKL] epoch=2 mean_kl=0.00678 max_kl=0.00998
[Time] Env Create Time: 2.8705s |Rollout Collect Time: 3.3362s |Loss & Update :1.8118
[PPODiag] kl_mean=0.0051, kl_p90=0.0074, kl_max=0.0100 | clipfrac_mean=0.029, logratio_std_mean=0.108, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.823, p10=0.819, min=0.816 | pg_loss_mean=0.0017, v_loss_mean=0.1625, ent_mean=0.1080 | gn_bb_mean=1.020, gn_bb_max=1.688 | gn_v_mean=1.599, gn_v_max=2.842

 10%|▉         | 484/5000 [1:15:40<10:28:32,  8.35s/it]------------------ Training Record ------------------
Epoch: 484/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3208, reward_valid_std=2.2717
[BatchDiag] adv_mean=-0.2323, adv_std=0.8737, adv_abs_mean=0.6687 | ret_mean=6.8381, ret_std=1.6886 | val_mean=7.0704, val_std=1.4375 | explained_var=0.732266
[GradSplit pre-clip] backbone=0.503915, critic=1.757073
[Loss] pg_loss=-0.012363, entropy_loss=0.000113, value_loss=0.039141
[EpochKL] epoch=0 mean_kl=0.00259 max_kl=0.00487
[EpochKL] epoch=1 mean_kl=0.00483 max_kl=0.00627
[EpochKL] epoch=2 mean_kl=0.00532 max_kl=0.00679
[Time] Env Create Time: 2.6927s |Rollout Collect Time: 3.4924s |Loss & Update :1.8859
[PPODiag] kl_mean=0.0042, kl_p90=0.0062, kl_max=0.0068 | clipfrac_mean=0.029, logratio_std_mean=0.094, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.787, p10=0.783, min=0.779 | pg_loss_mean=0.0013, v_loss_mean=0.1636, ent_mean=0.1083 | gn_bb_mean=1.153, gn_bb_max=2.463 | gn_v_mean=1.404, gn_v_max=3.256

 10%|▉         | 485/5000 [1:15:48<10:22:05,  8.27s/it]------------------ Training Record ------------------
Epoch: 485/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3235, reward_valid_std=2.2731
[BatchDiag] adv_mean=-0.1903, adv_std=0.8840, adv_abs_mean=0.6661 | ret_mean=6.8533, ret_std=1.6913 | val_mean=7.0436, val_std=1.4281 | explained_var=0.726807
[GradSplit pre-clip] backbone=0.596606, critic=1.487216
[Loss] pg_loss=0.015531, entropy_loss=0.000106, value_loss=0.042133
[EpochKL] epoch=0 mean_kl=0.00345 max_kl=0.00828
[EpochKL] epoch=1 mean_kl=0.00509 max_kl=0.00630
[EpochKL] epoch=2 mean_kl=0.00685 max_kl=0.01008
[Time] Env Create Time: 2.8436s |Rollout Collect Time: 3.4726s |Loss & Update :1.8685
[PPODiag] kl_mean=0.0051, kl_p90=0.0088, kl_max=0.0101 | clipfrac_mean=0.031, logratio_std_mean=0.103, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.778 | pg_loss_mean=0.0021, v_loss_mean=0.1665, ent_mean=0.1045 | gn_bb_mean=1.137, gn_bb_max=1.610 | gn_v_mean=1.708, gn_v_max=3.271
[AttnScore] scale=1.1652, C=10.0

 10%|▉         | 486/5000 [1:15:56<10:20:06,  8.24s/it]------------------ Training Record ------------------
Epoch: 486/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=40, valid_ratio=0.433, reward_valid_mean=0.3230, reward_valid_std=2.2693
[BatchDiag] adv_mean=-0.3023, adv_std=0.8812, adv_abs_mean=0.6856 | ret_mean=6.8930, ret_std=1.6700 | val_mean=7.1953, val_std=1.4012 | explained_var=0.721591
[GradSplit pre-clip] backbone=0.482013, critic=2.164141
[Loss] pg_loss=-0.056642, entropy_loss=0.000056, value_loss=0.038005
[EpochKL] epoch=0 mean_kl=0.00309 max_kl=0.00554
[EpochKL] epoch=1 mean_kl=0.00669 max_kl=0.01018
[EpochKL] epoch=2 mean_kl=0.00912 max_kl=0.01526
[Time] Env Create Time: 2.8512s |Rollout Collect Time: 6.1481s |Loss & Update :3.1842
[PPODiag] kl_mean=0.0063, kl_p90=0.0101, kl_max=0.0153 | clipfrac_mean=0.034, logratio_std_mean=0.114, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.433, p10=0.431, min=0.429 | pg_loss_mean=0.0025, v_loss_mean=0.1679, ent_mean=0.0569 | gn_bb_mean=1.320, gn_bb_max=2.538 | gn_v_mean=1.443, gn_v_max=3.259

 10%|▉         | 487/5000 [1:16:09<11:48:54,  9.42s/it]------------------ Training Record ------------------
Epoch: 487/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3244, reward_valid_std=2.2715
[BatchDiag] adv_mean=-0.2060, adv_std=0.8757, adv_abs_mean=0.6634 | ret_mean=6.8680, ret_std=1.6799 | val_mean=7.0740, val_std=1.4156 | explained_var=0.728241
[GradSplit pre-clip] backbone=0.523478, critic=1.484139
[Loss] pg_loss=-0.036420, entropy_loss=0.000115, value_loss=0.037651
[EpochKL] epoch=0 mean_kl=0.00493 max_kl=0.00735
[EpochKL] epoch=1 mean_kl=0.00698 max_kl=0.00941
[EpochKL] epoch=2 mean_kl=0.00779 max_kl=0.01033
[Time] Env Create Time: 2.8587s |Rollout Collect Time: 3.3293s |Loss & Update :1.8137
[PPODiag] kl_mean=0.0066, kl_p90=0.0086, kl_max=0.0103 | clipfrac_mean=0.035, logratio_std_mean=0.119, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.824, p10=0.816, min=0.813 | pg_loss_mean=0.0021, v_loss_mean=0.1629, ent_mean=0.1070 | gn_bb_mean=1.191, gn_bb_max=1.530 | gn_v_mean=1.331, gn_v_max=3.410

 10%|▉         | 488/5000 [1:16:17<11:16:39,  9.00s/it]------------------ Training Record ------------------
Epoch: 488/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51140/51200 = 0.999
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.290, reward_valid_mean=0.3173, reward_valid_std=2.2639
[BatchDiag] adv_mean=-0.1716, adv_std=0.9395, adv_abs_mean=0.6889 | ret_mean=6.7732, ret_std=1.7537 | val_mean=6.9448, val_std=1.4227 | explained_var=0.712988
[GradSplit pre-clip] backbone=0.444492, critic=0.907469
[Loss] pg_loss=-0.067521, entropy_loss=0.000037, value_loss=0.039353
[EpochKL] epoch=0 mean_kl=0.00583 max_kl=0.01240
[EarlyStop] epoch=1 mean_kl=0.01803 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01803 max_kl=0.08173
[Time] Env Create Time: 2.7040s |Rollout Collect Time: 9.1268s |Loss & Update :3.1220
[PPODiag] kl_mean=0.0119, kl_p90=0.0137, kl_max=0.0817 | clipfrac_mean=0.035, logratio_std_mean=0.167, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.290, p10=0.287, min=0.286 | pg_loss_mean=0.0016, v_loss_mean=0.1769, ent_mean=0.0374 | gn_bb_mean=1.233, gn_bb_max=1.817 | gn_v_mean=1.379, gn_v_max=3.344

 10%|▉         | 489/5000 [1:16:31<13:30:49, 10.78s/it]------------------ Training Record ------------------
Epoch: 489/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=37, valid_ratio=0.469, reward_valid_mean=0.3189, reward_valid_std=2.2660
[BatchDiag] adv_mean=-0.1580, adv_std=0.8859, adv_abs_mean=0.6697 | ret_mean=6.7926, ret_std=1.7188 | val_mean=6.9506, val_std=1.4337 | explained_var=0.734342
[GradSplit pre-clip] backbone=0.602549, critic=1.141794
[Loss] pg_loss=-0.019532, entropy_loss=0.000062, value_loss=0.038237
[EpochKL] epoch=0 mean_kl=0.00312 max_kl=0.00563
[EpochKL] epoch=1 mean_kl=0.00596 max_kl=0.01065
[EarlyStop] epoch=2 mean_kl=0.01078 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01078 max_kl=0.01699
[Time] Env Create Time: 2.8924s |Rollout Collect Time: 5.7852s |Loss & Update :2.9809
[PPODiag] kl_mean=0.0066, kl_p90=0.0119, kl_max=0.0170 | clipfrac_mean=0.033, logratio_std_mean=0.119, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.469, p10=0.465, min=0.464 | pg_loss_mean=0.0028, v_loss_mean=0.1627, ent_mean=0.0601 | gn_bb_mean=1.344, gn_bb_max=2.243 | gn_v_mean=1.065, gn_v_max=2.596

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.711, Step: 21, Avg Done Step: 18.50, #CS visited: 0.35
D->C12->C1->C15->C3->C5->C2->D->C4->C14->C8->D->C13->C6->C7->C11->C10->C9->D
Eval cost : 4.0827s
-----------------------------
 10%|▉         | 490/5000 [1:16:47<15:23:04, 12.28s/it]------------------ Training Record ------------------
Epoch: 490/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.792, reward_valid_mean=0.3165, reward_valid_std=2.2627
[BatchDiag] adv_mean=-0.1602, adv_std=0.8778, adv_abs_mean=0.6713 | ret_mean=6.7818, ret_std=1.7251 | val_mean=6.9420, val_std=1.4306 | explained_var=0.741096
[GradSplit pre-clip] backbone=0.390656, critic=1.028075
[Loss] pg_loss=-0.039429, entropy_loss=0.000114, value_loss=0.039074
[EpochKL] epoch=0 mean_kl=0.00643 max_kl=0.01260
[EpochKL] epoch=1 mean_kl=0.00785 max_kl=0.01101
[EpochKL] epoch=2 mean_kl=0.00971 max_kl=0.01306
[Time] Env Create Time: 2.8628s |Rollout Collect Time: 3.5105s |Loss & Update :1.8838
[PPODiag] kl_mean=0.0080, kl_p90=0.0125, kl_max=0.0131 | clipfrac_mean=0.040, logratio_std_mean=0.133, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.792, p10=0.786, min=0.784 | pg_loss_mean=0.0032, v_loss_mean=0.1644, ent_mean=0.1060 | gn_bb_mean=1.505, gn_bb_max=2.116 | gn_v_mean=1.102, gn_v_max=1.835
[AttnScore] scale=1.1667, C=10.0

 10%|▉         | 491/5000 [1:16:56<13:52:10, 11.07s/it]------------------ Training Record ------------------
Epoch: 491/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3180, reward_valid_std=2.2662
[BatchDiag] adv_mean=-0.1549, adv_std=0.8752, adv_abs_mean=0.6585 | ret_mean=6.8000, ret_std=1.7143 | val_mean=6.9549, val_std=1.4882 | explained_var=0.739321
[GradSplit pre-clip] backbone=0.583681, critic=0.773189
[Loss] pg_loss=-0.062212, entropy_loss=0.000105, value_loss=0.038962
[EpochKL] epoch=0 mean_kl=0.00342 max_kl=0.00572
[EpochKL] epoch=1 mean_kl=0.00738 max_kl=0.00944
[EpochKL] epoch=2 mean_kl=0.00691 max_kl=0.00924
[Time] Env Create Time: 2.8967s |Rollout Collect Time: 3.5116s |Loss & Update :1.8777
[PPODiag] kl_mean=0.0059, kl_p90=0.0089, kl_max=0.0094 | clipfrac_mean=0.033, logratio_std_mean=0.113, ratio_p95_mean=1.043 | valid_ratio_mb_mean=0.790, p10=0.785, min=0.780 | pg_loss_mean=0.0021, v_loss_mean=0.1602, ent_mean=0.1068 | gn_bb_mean=1.188, gn_bb_max=2.062 | gn_v_mean=1.051, gn_v_max=2.679

 10%|▉         | 492/5000 [1:17:04<12:49:14, 10.24s/it]------------------ Training Record ------------------
Epoch: 492/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3223, reward_valid_std=2.2679
[BatchDiag] adv_mean=-0.1086, adv_std=0.8591, adv_abs_mean=0.6443 | ret_mean=6.8313, ret_std=1.7182 | val_mean=6.9399, val_std=1.4838 | explained_var=0.750029
[GradSplit pre-clip] backbone=0.484285, critic=0.552541
[Loss] pg_loss=-0.051679, entropy_loss=0.000104, value_loss=0.035144
[EpochKL] epoch=0 mean_kl=0.00302 max_kl=0.00514
[EpochKL] epoch=1 mean_kl=0.00797 max_kl=0.01266
[EpochKL] epoch=2 mean_kl=0.00665 max_kl=0.01034
[Time] Env Create Time: 2.6856s |Rollout Collect Time: 3.4869s |Loss & Update :1.8788
[PPODiag] kl_mean=0.0059, kl_p90=0.0101, kl_max=0.0127 | clipfrac_mean=0.033, logratio_std_mean=0.110, ratio_p95_mean=1.041 | valid_ratio_mb_mean=0.789, p10=0.783, min=0.783 | pg_loss_mean=0.0020, v_loss_mean=0.1563, ent_mean=0.1032 | gn_bb_mean=1.197, gn_bb_max=1.786 | gn_v_mean=0.969, gn_v_max=2.118

 10%|▉         | 493/5000 [1:17:12<11:59:47,  9.58s/it]------------------ Training Record ------------------
Epoch: 493/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3199, reward_valid_std=2.2679
[BatchDiag] adv_mean=-0.0842, adv_std=0.8709, adv_abs_mean=0.6548 | ret_mean=6.7904, ret_std=1.7272 | val_mean=6.8746, val_std=1.4789 | explained_var=0.745773
[GradSplit pre-clip] backbone=0.492305, critic=0.435542
[Loss] pg_loss=-0.070443, entropy_loss=0.000109, value_loss=0.035835
[EpochKL] epoch=0 mean_kl=0.00388 max_kl=0.00831
[EpochKL] epoch=1 mean_kl=0.00564 max_kl=0.00929
[EpochKL] epoch=2 mean_kl=0.00692 max_kl=0.01083
[Time] Env Create Time: 2.8536s |Rollout Collect Time: 3.4837s |Loss & Update :1.8834
[PPODiag] kl_mean=0.0055, kl_p90=0.0084, kl_max=0.0108 | clipfrac_mean=0.033, logratio_std_mean=0.107, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.789, p10=0.784, min=0.782 | pg_loss_mean=0.0018, v_loss_mean=0.1611, ent_mean=0.1051 | gn_bb_mean=1.125, gn_bb_max=1.706 | gn_v_mean=1.130, gn_v_max=2.233

 10%|▉         | 494/5000 [1:17:20<11:28:58,  9.17s/it]------------------ Training Record ------------------
Epoch: 494/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=35, valid_ratio=0.496, reward_valid_mean=0.3234, reward_valid_std=2.2688
[BatchDiag] adv_mean=-0.1098, adv_std=0.8681, adv_abs_mean=0.6564 | ret_mean=6.8322, ret_std=1.7148 | val_mean=6.9420, val_std=1.4617 | explained_var=0.743739
[GradSplit pre-clip] backbone=0.564286, critic=1.018473
[Loss] pg_loss=0.003739, entropy_loss=0.000074, value_loss=0.041223
[EpochKL] epoch=0 mean_kl=0.00381 max_kl=0.00620
[EpochKL] epoch=1 mean_kl=0.00592 max_kl=0.00720
[EpochKL] epoch=2 mean_kl=0.00721 max_kl=0.00897
[Time] Env Create Time: 2.8671s |Rollout Collect Time: 5.4123s |Loss & Update :2.8391
[PPODiag] kl_mean=0.0056, kl_p90=0.0077, kl_max=0.0090 | clipfrac_mean=0.034, logratio_std_mean=0.110, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.496, p10=0.492, min=0.491 | pg_loss_mean=0.0020, v_loss_mean=0.1588, ent_mean=0.0683 | gn_bb_mean=1.174, gn_bb_max=1.762 | gn_v_mean=0.985, gn_v_max=1.795

 10%|▉         | 495/5000 [1:17:31<12:12:37,  9.76s/it]------------------ Training Record ------------------
Epoch: 495/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.790, reward_valid_mean=0.3204, reward_valid_std=2.2676
[BatchDiag] adv_mean=-0.1869, adv_std=0.8553, adv_abs_mean=0.6541 | ret_mean=6.8259, ret_std=1.7024 | val_mean=7.0128, val_std=1.4254 | explained_var=0.747543
[GradSplit pre-clip] backbone=0.475685, critic=1.057563
[Loss] pg_loss=-0.094648, entropy_loss=0.000121, value_loss=0.037248
[EpochKL] epoch=0 mean_kl=0.00419 max_kl=0.00626
[EpochKL] epoch=1 mean_kl=0.00608 max_kl=0.00845
[EpochKL] epoch=2 mean_kl=0.00901 max_kl=0.01527
[Time] Env Create Time: 2.6999s |Rollout Collect Time: 3.4791s |Loss & Update :1.8830
[PPODiag] kl_mean=0.0064, kl_p90=0.0092, kl_max=0.0153 | clipfrac_mean=0.036, logratio_std_mean=0.117, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.790, p10=0.786, min=0.781 | pg_loss_mean=0.0026, v_loss_mean=0.1589, ent_mean=0.1063 | gn_bb_mean=1.389, gn_bb_max=2.224 | gn_v_mean=1.475, gn_v_max=3.277
[AttnScore] scale=1.1683, C=10.0

 10%|▉         | 496/5000 [1:17:39<11:34:17,  9.25s/it]------------------ Training Record ------------------
Epoch: 496/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=24, valid_ratio=0.726, reward_valid_mean=0.3190, reward_valid_std=2.2648
[BatchDiag] adv_mean=-0.1534, adv_std=0.8960, adv_abs_mean=0.6711 | ret_mean=6.7981, ret_std=1.7325 | val_mean=6.9515, val_std=1.4365 | explained_var=0.732559
[GradSplit pre-clip] backbone=0.482780, critic=0.876572
[Loss] pg_loss=-0.037494, entropy_loss=0.000117, value_loss=0.041180
[EpochKL] epoch=0 mean_kl=0.00369 max_kl=0.00735
[EpochKL] epoch=1 mean_kl=0.00773 max_kl=0.01292
[EarlyStop] epoch=2 mean_kl=0.01100 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01100 max_kl=0.01571
[Time] Env Create Time: 2.8336s |Rollout Collect Time: 3.7803s |Loss & Update :2.0368
[PPODiag] kl_mean=0.0075, kl_p90=0.0129, kl_max=0.0157 | clipfrac_mean=0.040, logratio_std_mean=0.122, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.726, p10=0.721, min=0.718 | pg_loss_mean=0.0029, v_loss_mean=0.1671, ent_mean=0.1040 | gn_bb_mean=1.482, gn_bb_max=2.249 | gn_v_mean=1.447, gn_v_max=2.775

 10%|▉         | 497/5000 [1:17:48<11:20:40,  9.07s/it]------------------ Training Record ------------------
Epoch: 497/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.3190, reward_valid_std=2.2647
[BatchDiag] adv_mean=-0.1862, adv_std=0.8686, adv_abs_mean=0.6614 | ret_mean=6.8075, ret_std=1.7036 | val_mean=6.9937, val_std=1.4455 | explained_var=0.740062
[GradSplit pre-clip] backbone=0.585963, critic=0.777639
[Loss] pg_loss=-0.123319, entropy_loss=0.000122, value_loss=0.035410
[EpochKL] epoch=0 mean_kl=0.00496 max_kl=0.01132
[EpochKL] epoch=1 mean_kl=0.00921 max_kl=0.01278
[EarlyStop] epoch=2 mean_kl=0.01017 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01017 max_kl=0.01543
[Time] Env Create Time: 2.8334s |Rollout Collect Time: 3.4986s |Loss & Update :1.8637
[PPODiag] kl_mean=0.0081, kl_p90=0.0126, kl_max=0.0154 | clipfrac_mean=0.040, logratio_std_mean=0.134, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.791, p10=0.786, min=0.779 | pg_loss_mean=0.0028, v_loss_mean=0.1630, ent_mean=0.1145 | gn_bb_mean=1.242, gn_bb_max=1.852 | gn_v_mean=1.585, gn_v_max=3.187

 10%|▉         | 498/5000 [1:17:56<11:00:51,  8.81s/it]------------------ Training Record ------------------
Epoch: 498/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.830, reward_valid_mean=0.3193, reward_valid_std=2.2635
[BatchDiag] adv_mean=-0.1907, adv_std=0.8622, adv_abs_mean=0.6604 | ret_mean=6.8243, ret_std=1.7044 | val_mean=7.0150, val_std=1.4439 | explained_var=0.744117
[GradSplit pre-clip] backbone=0.498452, critic=1.489677
[Loss] pg_loss=-0.040340, entropy_loss=0.000132, value_loss=0.037462
[EpochKL] epoch=0 mean_kl=0.00544 max_kl=0.01173
[EpochKL] epoch=1 mean_kl=0.00728 max_kl=0.00901
[EarlyStop] epoch=2 mean_kl=0.01191 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01191 max_kl=0.01449
[Time] Env Create Time: 2.8774s |Rollout Collect Time: 3.3423s |Loss & Update :1.8054
[PPODiag] kl_mean=0.0082, kl_p90=0.0137, kl_max=0.0145 | clipfrac_mean=0.042, logratio_std_mean=0.134, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.830, p10=0.825, min=0.820 | pg_loss_mean=0.0028, v_loss_mean=0.1599, ent_mean=0.1203 | gn_bb_mean=1.304, gn_bb_max=1.804 | gn_v_mean=1.034, gn_v_max=2.116

 10%|▉         | 499/5000 [1:18:04<10:43:07,  8.57s/it]------------------ Training Record ------------------
Epoch: 499/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.793, reward_valid_mean=0.3177, reward_valid_std=2.2636
[BatchDiag] adv_mean=-0.1498, adv_std=0.8624, adv_abs_mean=0.6505 | ret_mean=6.8024, ret_std=1.7159 | val_mean=6.9523, val_std=1.4636 | explained_var=0.747399
[GradSplit pre-clip] backbone=0.511524, critic=1.559169
[Loss] pg_loss=0.053417, entropy_loss=0.000129, value_loss=0.043661
[EpochKL] epoch=0 mean_kl=0.00432 max_kl=0.00658
[EpochKL] epoch=1 mean_kl=0.00726 max_kl=0.01173
[EarlyStop] epoch=2 mean_kl=0.01125 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01125 max_kl=0.01618
[Time] Env Create Time: 2.6959s |Rollout Collect Time: 3.4929s |Loss & Update :1.8744
[PPODiag] kl_mean=0.0076, kl_p90=0.0120, kl_max=0.0162 | clipfrac_mean=0.038, logratio_std_mean=0.130, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.793, p10=0.788, min=0.786 | pg_loss_mean=0.0024, v_loss_mean=0.1581, ent_mean=0.1162 | gn_bb_mean=1.301, gn_bb_max=1.972 | gn_v_mean=1.268, gn_v_max=2.980

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.690, Step: 22, Avg Done Step: 18.57, #CS visited: 0.33
D->C12->C1->C15->C3->C5->C2->D->C4->C14->C8->D->C13->C6->C7->C11->C10->C9->D
Eval cost : 4.1976s
-----------------------------
 10%|█         | 500/5000 [1:18:16<12:06:34,  9.69s/it]------------------ Training Record ------------------
Epoch: 500/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=27, valid_ratio=0.648, reward_valid_mean=0.3169, reward_valid_std=2.2604
[BatchDiag] adv_mean=-0.0778, adv_std=0.8880, adv_abs_mean=0.6629 | ret_mean=6.7799, ret_std=1.7395 | val_mean=6.8577, val_std=1.5146 | explained_var=0.739398
[GradSplit pre-clip] backbone=0.580843, critic=0.491614
[Loss] pg_loss=-0.092309, entropy_loss=0.000105, value_loss=0.035482
[EpochKL] epoch=0 mean_kl=0.00422 max_kl=0.00796
[EpochKL] epoch=1 mean_kl=0.00901 max_kl=0.01209
[EpochKL] epoch=2 mean_kl=0.00733 max_kl=0.01146
[Time] Env Create Time: 2.8486s |Rollout Collect Time: 4.2316s |Loss & Update :2.2553
[PPODiag] kl_mean=0.0069, kl_p90=0.0105, kl_max=0.0121 | clipfrac_mean=0.038, logratio_std_mean=0.121, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.648, p10=0.644, min=0.639 | pg_loss_mean=0.0020, v_loss_mean=0.1673, ent_mean=0.0956 | gn_bb_mean=1.195, gn_bb_max=1.884 | gn_v_mean=1.493, gn_v_max=2.646
[AttnScore] scale=1.1698, C=10.0

 10%|█         | 501/5000 [1:18:26<11:58:30,  9.58s/it]------------------ Training Record ------------------
Epoch: 501/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.828, reward_valid_mean=0.3207, reward_valid_std=2.2679
[BatchDiag] adv_mean=-0.0380, adv_std=0.8608, adv_abs_mean=0.6525 | ret_mean=6.7808, ret_std=1.7328 | val_mean=6.8188, val_std=1.4870 | explained_var=0.753243
[GradSplit pre-clip] backbone=0.812201, critic=0.446906
[Loss] pg_loss=-0.054358, entropy_loss=0.000129, value_loss=0.039101
[EpochKL] epoch=0 mean_kl=0.00570 max_kl=0.00928
[EpochKL] epoch=1 mean_kl=0.00846 max_kl=0.01202
[EpochKL] epoch=2 mean_kl=0.00972 max_kl=0.01360
[Time] Env Create Time: 2.8352s |Rollout Collect Time: 3.3315s |Loss & Update :1.8023
[PPODiag] kl_mean=0.0080, kl_p90=0.0119, kl_max=0.0136 | clipfrac_mean=0.042, logratio_std_mean=0.131, ratio_p95_mean=1.057 | valid_ratio_mb_mean=0.828, p10=0.821, min=0.817 | pg_loss_mean=0.0027, v_loss_mean=0.1631, ent_mean=0.1193 | gn_bb_mean=1.566, gn_bb_max=2.272 | gn_v_mean=1.715, gn_v_max=4.367

 10%|█         | 502/5000 [1:18:34<11:22:04,  9.10s/it]------------------ Training Record ------------------
Epoch: 502/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.791, reward_valid_mean=0.3214, reward_valid_std=2.2660
[BatchDiag] adv_mean=-0.0362, adv_std=0.8627, adv_abs_mean=0.6468 | ret_mean=6.7984, ret_std=1.7250 | val_mean=6.8347, val_std=1.5370 | explained_var=0.749909
[GradSplit pre-clip] backbone=0.455203, critic=0.749322
[Loss] pg_loss=-0.104501, entropy_loss=0.000125, value_loss=0.034892
[EpochKL] epoch=0 mean_kl=0.00369 max_kl=0.00846
[EpochKL] epoch=1 mean_kl=0.00526 max_kl=0.00768
[EpochKL] epoch=2 mean_kl=0.00864 max_kl=0.01179
[Time] Env Create Time: 2.8471s |Rollout Collect Time: 3.4866s |Loss & Update :1.8872
[PPODiag] kl_mean=0.0059, kl_p90=0.0107, kl_max=0.0118 | clipfrac_mean=0.033, logratio_std_mean=0.111, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.791, p10=0.786, min=0.782 | pg_loss_mean=0.0018, v_loss_mean=0.1647, ent_mean=0.1120 | gn_bb_mean=1.149, gn_bb_max=1.998 | gn_v_mean=2.235, gn_v_max=3.574

 10%|█         | 503/5000 [1:18:42<11:02:11,  8.84s/it]------------------ Training Record ------------------
Epoch: 503/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.792, reward_valid_mean=0.3197, reward_valid_std=2.2651
[BatchDiag] adv_mean=0.0679, adv_std=0.8868, adv_abs_mean=0.6714 | ret_mean=6.7463, ret_std=1.7647 | val_mean=6.6784, val_std=1.5648 | explained_var=0.747445
[GradSplit pre-clip] backbone=0.603917, critic=1.057553
[Loss] pg_loss=0.014648, entropy_loss=0.000110, value_loss=0.040940
[EpochKL] epoch=0 mean_kl=0.00557 max_kl=0.01010
[EarlyStop] epoch=1 mean_kl=0.01036 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01036 max_kl=0.01217
[Time] Env Create Time: 2.6785s |Rollout Collect Time: 3.4895s |Loss & Update :1.2714
[PPODiag] kl_mean=0.0080, kl_p90=0.0119, kl_max=0.0122 | clipfrac_mean=0.042, logratio_std_mean=0.129, ratio_p95_mean=1.056 | valid_ratio_mb_mean=0.792, p10=0.785, min=0.782 | pg_loss_mean=0.0027, v_loss_mean=0.1680, ent_mean=0.1100 | gn_bb_mean=1.440, gn_bb_max=2.251 | gn_v_mean=1.542, gn_v_max=3.357

 10%|█         | 504/5000 [1:18:49<10:30:40,  8.42s/it]------------------ Training Record ------------------
Epoch: 504/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.828, reward_valid_mean=0.3193, reward_valid_std=2.2665
[BatchDiag] adv_mean=0.0068, adv_std=0.8801, adv_abs_mean=0.6609 | ret_mean=6.7541, ret_std=1.7505 | val_mean=6.7473, val_std=1.5628 | explained_var=0.747220
[GradSplit pre-clip] backbone=0.481258, critic=0.956286
[Loss] pg_loss=-0.036170, entropy_loss=0.000120, value_loss=0.042192
[EpochKL] epoch=0 mean_kl=0.00584 max_kl=0.01032
[EpochKL] epoch=1 mean_kl=0.00785 max_kl=0.01220
[EpochKL] epoch=2 mean_kl=0.00801 max_kl=0.01014
[Time] Env Create Time: 2.8305s |Rollout Collect Time: 3.3286s |Loss & Update :1.8098
[PPODiag] kl_mean=0.0072, kl_p90=0.0098, kl_max=0.0122 | clipfrac_mean=0.039, logratio_std_mean=0.126, ratio_p95_mean=1.055 | valid_ratio_mb_mean=0.828, p10=0.821, min=0.818 | pg_loss_mean=0.0022, v_loss_mean=0.1619, ent_mean=0.1163 | gn_bb_mean=1.356, gn_bb_max=2.614 | gn_v_mean=0.999, gn_v_max=2.468

 10%|█         | 505/5000 [1:18:57<10:20:29,  8.28s/it]------------------ Training Record ------------------
Epoch: 505/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3211, reward_valid_std=2.2698
[BatchDiag] adv_mean=-0.0778, adv_std=0.8724, adv_abs_mean=0.6480 | ret_mean=6.7962, ret_std=1.7282 | val_mean=6.8740, val_std=1.5169 | explained_var=0.745157
[GradSplit pre-clip] backbone=0.581141, critic=0.499933
[Loss] pg_loss=-0.047394, entropy_loss=0.000115, value_loss=0.038408
[EpochKL] epoch=0 mean_kl=0.00349 max_kl=0.00674
[EpochKL] epoch=1 mean_kl=0.00643 max_kl=0.01021
[EpochKL] epoch=2 mean_kl=0.00799 max_kl=0.00981
[Time] Env Create Time: 2.8435s |Rollout Collect Time: 3.4783s |Loss & Update :1.8675
[PPODiag] kl_mean=0.0060, kl_p90=0.0094, kl_max=0.0102 | clipfrac_mean=0.034, logratio_std_mean=0.112, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.781 | pg_loss_mean=0.0019, v_loss_mean=0.1642, ent_mean=0.1083 | gn_bb_mean=1.187, gn_bb_max=1.769 | gn_v_mean=1.915, gn_v_max=4.851
[AttnScore] scale=1.1714, C=10.0

 10%|█         | 506/5000 [1:19:06<10:18:16,  8.25s/it]------------------ Training Record ------------------
Epoch: 506/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.828, reward_valid_mean=0.3199, reward_valid_std=2.2672
[BatchDiag] adv_mean=-0.2111, adv_std=0.8673, adv_abs_mean=0.6608 | ret_mean=6.8513, ret_std=1.6961 | val_mean=7.0624, val_std=1.5030 | explained_var=0.738555
[GradSplit pre-clip] backbone=0.471050, critic=1.488347
[Loss] pg_loss=-0.016455, entropy_loss=0.000112, value_loss=0.042600
[EpochKL] epoch=0 mean_kl=0.00536 max_kl=0.01031
[EpochKL] epoch=1 mean_kl=0.00878 max_kl=0.01359
[EpochKL] epoch=2 mean_kl=0.00924 max_kl=0.01204
[Time] Env Create Time: 2.8485s |Rollout Collect Time: 3.3256s |Loss & Update :1.7990
[PPODiag] kl_mean=0.0078, kl_p90=0.0117, kl_max=0.0136 | clipfrac_mean=0.039, logratio_std_mean=0.132, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.828, p10=0.823, min=0.819 | pg_loss_mean=0.0028, v_loss_mean=0.1618, ent_mean=0.1115 | gn_bb_mean=1.323, gn_bb_max=2.106 | gn_v_mean=1.538, gn_v_max=2.984

 10%|█         | 507/5000 [1:19:14<10:11:48,  8.17s/it]------------------ Training Record ------------------
Epoch: 507/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3213, reward_valid_std=2.2676
[BatchDiag] adv_mean=-0.1812, adv_std=0.8625, adv_abs_mean=0.6514 | ret_mean=6.8384, ret_std=1.6906 | val_mean=7.0196, val_std=1.4772 | explained_var=0.739714
[GradSplit pre-clip] backbone=0.622997, critic=1.006706
[Loss] pg_loss=-0.073534, entropy_loss=0.000115, value_loss=0.035946
[EpochKL] epoch=0 mean_kl=0.00513 max_kl=0.01046
[EpochKL] epoch=1 mean_kl=0.00773 max_kl=0.01101
[EpochKL] epoch=2 mean_kl=0.00912 max_kl=0.01402
[Time] Env Create Time: 2.6778s |Rollout Collect Time: 3.4778s |Loss & Update :1.8625
[PPODiag] kl_mean=0.0073, kl_p90=0.0108, kl_max=0.0140 | clipfrac_mean=0.038, logratio_std_mean=0.126, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.788, p10=0.782, min=0.780 | pg_loss_mean=0.0027, v_loss_mean=0.1575, ent_mean=0.1065 | gn_bb_mean=1.344, gn_bb_max=2.201 | gn_v_mean=1.016, gn_v_max=1.933

 10%|█         | 508/5000 [1:19:22<10:08:16,  8.12s/it]------------------ Training Record ------------------
Epoch: 508/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3194, reward_valid_std=2.2668
[BatchDiag] adv_mean=-0.1410, adv_std=0.8721, adv_abs_mean=0.6566 | ret_mean=6.8050, ret_std=1.6984 | val_mean=6.9460, val_std=1.4779 | explained_var=0.736344
[GradSplit pre-clip] backbone=0.619520, critic=0.348257
[Loss] pg_loss=-0.141199, entropy_loss=0.000121, value_loss=0.033554
[EpochKL] epoch=0 mean_kl=0.00271 max_kl=0.00527
[EpochKL] epoch=1 mean_kl=0.00649 max_kl=0.00798
[EarlyStop] epoch=2 mean_kl=0.01101 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01101 max_kl=0.01768
[Time] Env Create Time: 2.8447s |Rollout Collect Time: 3.3201s |Loss & Update :1.7935
[PPODiag] kl_mean=0.0067, kl_p90=0.0112, kl_max=0.0177 | clipfrac_mean=0.037, logratio_std_mean=0.115, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.827, p10=0.823, min=0.817 | pg_loss_mean=0.0026, v_loss_mean=0.1629, ent_mean=0.1151 | gn_bb_mean=1.395, gn_bb_max=2.035 | gn_v_mean=1.326, gn_v_max=3.455

 10%|█         | 509/5000 [1:19:30<10:04:24,  8.07s/it]------------------ Training Record ------------------
Epoch: 509/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3200, reward_valid_std=2.2692
[BatchDiag] adv_mean=-0.2492, adv_std=0.8759, adv_abs_mean=0.6735 | ret_mean=6.8314, ret_std=1.6867 | val_mean=7.0806, val_std=1.4422 | explained_var=0.730306
[GradSplit pre-clip] backbone=0.501378, critic=1.698361
[Loss] pg_loss=-0.058360, entropy_loss=0.000109, value_loss=0.041910
[EpochKL] epoch=0 mean_kl=0.00425 max_kl=0.00693
[EpochKL] epoch=1 mean_kl=0.00698 max_kl=0.00866
[EpochKL] epoch=2 mean_kl=0.00812 max_kl=0.01048
[Time] Env Create Time: 2.8599s |Rollout Collect Time: 3.4908s |Loss & Update :1.8727
[PPODiag] kl_mean=0.0065, kl_p90=0.0087, kl_max=0.0105 | clipfrac_mean=0.036, logratio_std_mean=0.118, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.788, p10=0.783, min=0.780 | pg_loss_mean=0.0022, v_loss_mean=0.1652, ent_mean=0.1052 | gn_bb_mean=1.251, gn_bb_max=1.895 | gn_v_mean=1.580, gn_v_max=3.087

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.684, Step: 21, Avg Done Step: 18.40, #CS visited: 0.36
D->C12->C1->C15->C3->C5->C2->D->C4->C14->C8->D->C13->C6->C7->C11->C10->C9->D
Eval cost : 4.0376s
-----------------------------
 10%|█         | 510/5000 [1:19:42<11:38:52,  9.34s/it]------------------ Training Record ------------------
Epoch: 510/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=28, valid_ratio=0.619, reward_valid_mean=0.3225, reward_valid_std=2.2710
[BatchDiag] adv_mean=-0.2102, adv_std=0.8848, adv_abs_mean=0.6790 | ret_mean=6.8506, ret_std=1.6949 | val_mean=7.0608, val_std=1.4409 | explained_var=0.727511
[GradSplit pre-clip] backbone=0.447243, critic=1.560937
[Loss] pg_loss=-0.040608, entropy_loss=0.000093, value_loss=0.041188
[EpochKL] epoch=0 mean_kl=0.00352 max_kl=0.00675
[EpochKL] epoch=1 mean_kl=0.00865 max_kl=0.01554
[EpochKL] epoch=2 mean_kl=0.00895 max_kl=0.01207
[Time] Env Create Time: 2.6920s |Rollout Collect Time: 4.3590s |Loss & Update :2.3062
[PPODiag] kl_mean=0.0070, kl_p90=0.0107, kl_max=0.0155 | clipfrac_mean=0.037, logratio_std_mean=0.122, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.619, p10=0.615, min=0.613 | pg_loss_mean=0.0028, v_loss_mean=0.1701, ent_mean=0.0839 | gn_bb_mean=1.338, gn_bb_max=2.224 | gn_v_mean=1.862, gn_v_max=3.271
[AttnScore] scale=1.1727, C=10.0

 10%|█         | 511/5000 [1:19:51<11:39:08,  9.34s/it]------------------ Training Record ------------------
Epoch: 511/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3214, reward_valid_std=2.2671
[BatchDiag] adv_mean=-0.2936, adv_std=0.8751, adv_abs_mean=0.6823 | ret_mean=6.8642, ret_std=1.6712 | val_mean=7.1578, val_std=1.4537 | explained_var=0.725773
[GradSplit pre-clip] backbone=0.432708, critic=1.958330
[Loss] pg_loss=-0.051363, entropy_loss=0.000117, value_loss=0.043996
[EpochKL] epoch=0 mean_kl=0.00320 max_kl=0.00569
[EpochKL] epoch=1 mean_kl=0.00593 max_kl=0.00924
[EpochKL] epoch=2 mean_kl=0.00646 max_kl=0.00997
[Time] Env Create Time: 2.8446s |Rollout Collect Time: 3.3310s |Loss & Update :1.7936
[PPODiag] kl_mean=0.0052, kl_p90=0.0074, kl_max=0.0100 | clipfrac_mean=0.032, logratio_std_mean=0.104, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.826, p10=0.822, min=0.818 | pg_loss_mean=0.0018, v_loss_mean=0.1703, ent_mean=0.1118 | gn_bb_mean=1.194, gn_bb_max=1.824 | gn_v_mean=2.180, gn_v_max=3.173

 10%|█         | 512/5000 [1:19:59<11:08:07,  8.93s/it]------------------ Training Record ------------------
Epoch: 512/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3225, reward_valid_std=2.2703
[BatchDiag] adv_mean=-0.3053, adv_std=0.8714, adv_abs_mean=0.6880 | ret_mean=6.8850, ret_std=1.6591 | val_mean=7.1903, val_std=1.3971 | explained_var=0.724149
[GradSplit pre-clip] backbone=0.427258, critic=1.876342
[Loss] pg_loss=-0.096358, entropy_loss=0.000108, value_loss=0.037732
[EpochKL] epoch=0 mean_kl=0.00370 max_kl=0.00773
[EarlyStop] epoch=1 mean_kl=0.01089 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01089 max_kl=0.01361
[Time] Env Create Time: 2.8701s |Rollout Collect Time: 3.4712s |Loss & Update :1.2510
[PPODiag] kl_mean=0.0073, kl_p90=0.0129, kl_max=0.0136 | clipfrac_mean=0.037, logratio_std_mean=0.121, ratio_p95_mean=1.048 | valid_ratio_mb_mean=0.788, p10=0.785, min=0.779 | pg_loss_mean=0.0029, v_loss_mean=0.1680, ent_mean=0.1054 | gn_bb_mean=1.419, gn_bb_max=1.932 | gn_v_mean=1.876, gn_v_max=2.613

 10%|█         | 513/5000 [1:20:07<10:37:55,  8.53s/it]------------------ Training Record ------------------
Epoch: 513/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3264, reward_valid_std=2.2720
[BatchDiag] adv_mean=-0.1275, adv_std=0.8669, adv_abs_mean=0.6588 | ret_mean=6.8437, ret_std=1.6835 | val_mean=6.9713, val_std=1.3941 | explained_var=0.734822
[GradSplit pre-clip] backbone=0.561339, critic=0.819495
[Loss] pg_loss=-0.054137, entropy_loss=0.000120, value_loss=0.036913
[EpochKL] epoch=0 mean_kl=0.00603 max_kl=0.01465
[EpochKL] epoch=1 mean_kl=0.00724 max_kl=0.01121
[EpochKL] epoch=2 mean_kl=0.00915 max_kl=0.01125
[Time] Env Create Time: 2.8756s |Rollout Collect Time: 3.3322s |Loss & Update :1.7948
[PPODiag] kl_mean=0.0075, kl_p90=0.0111, kl_max=0.0147 | clipfrac_mean=0.040, logratio_std_mean=0.126, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.823, p10=0.818, min=0.815 | pg_loss_mean=0.0028, v_loss_mean=0.1597, ent_mean=0.1142 | gn_bb_mean=1.413, gn_bb_max=2.028 | gn_v_mean=1.020, gn_v_max=1.679

 10%|█         | 514/5000 [1:20:15<10:25:57,  8.37s/it]------------------ Training Record ------------------
Epoch: 514/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.827, reward_valid_mean=0.3210, reward_valid_std=2.2673
[BatchDiag] adv_mean=-0.1107, adv_std=0.8630, adv_abs_mean=0.6551 | ret_mean=6.8016, ret_std=1.7193 | val_mean=6.9123, val_std=1.4398 | explained_var=0.748043
[GradSplit pre-clip] backbone=0.741473, critic=0.609381
[Loss] pg_loss=-0.136232, entropy_loss=0.000111, value_loss=0.036063
[EpochKL] epoch=0 mean_kl=0.00494 max_kl=0.00936
[EpochKL] epoch=1 mean_kl=0.00575 max_kl=0.00906
[EpochKL] epoch=2 mean_kl=0.00643 max_kl=0.00868
[Time] Env Create Time: 2.7439s |Rollout Collect Time: 3.3643s |Loss & Update :1.8172
[PPODiag] kl_mean=0.0057, kl_p90=0.0085, kl_max=0.0094 | clipfrac_mean=0.035, logratio_std_mean=0.110, ratio_p95_mean=1.045 | valid_ratio_mb_mean=0.827, p10=0.822, min=0.817 | pg_loss_mean=0.0022, v_loss_mean=0.1595, ent_mean=0.1097 | gn_bb_mean=1.374, gn_bb_max=2.357 | gn_v_mean=1.316, gn_v_max=3.028

 10%|█         | 515/5000 [1:20:23<10:15:48,  8.24s/it]------------------ Training Record ------------------
Epoch: 515/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3233, reward_valid_std=2.2693
[BatchDiag] adv_mean=-0.1620, adv_std=0.8671, adv_abs_mean=0.6621 | ret_mean=6.8548, ret_std=1.6973 | val_mean=7.0167, val_std=1.4373 | explained_var=0.738994
[GradSplit pre-clip] backbone=0.424684, critic=0.726633
[Loss] pg_loss=-0.097255, entropy_loss=0.000112, value_loss=0.037392
[EpochKL] epoch=0 mean_kl=0.00484 max_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.00988 max_kl=0.01737
[EpochKL] epoch=2 mean_kl=0.00962 max_kl=0.01432
[Time] Env Create Time: 2.8608s |Rollout Collect Time: 3.3512s |Loss & Update :1.8099
[PPODiag] kl_mean=0.0081, kl_p90=0.0121, kl_max=0.0174 | clipfrac_mean=0.037, logratio_std_mean=0.136, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.826, p10=0.819, min=0.816 | pg_loss_mean=0.0029, v_loss_mean=0.1640, ent_mean=0.1057 | gn_bb_mean=1.209, gn_bb_max=1.960 | gn_v_mean=1.729, gn_v_max=3.859
[AttnScore] scale=1.1739, C=10.0

 10%|█         | 516/5000 [1:20:31<10:10:50,  8.17s/it]------------------ Training Record ------------------
Epoch: 516/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.789, reward_valid_mean=0.3219, reward_valid_std=2.2665
[BatchDiag] adv_mean=-0.2224, adv_std=0.8773, adv_abs_mean=0.6668 | ret_mean=6.8538, ret_std=1.6995 | val_mean=7.0762, val_std=1.4397 | explained_var=0.733497
[GradSplit pre-clip] backbone=0.556952, critic=1.305579
[Loss] pg_loss=-0.084346, entropy_loss=0.000112, value_loss=0.038733
[EpochKL] epoch=0 mean_kl=0.00299 max_kl=0.00627
[EpochKL] epoch=1 mean_kl=0.00646 max_kl=0.00967
[EpochKL] epoch=2 mean_kl=0.00715 max_kl=0.01061
[Time] Env Create Time: 2.8685s |Rollout Collect Time: 3.4999s |Loss & Update :1.8736
[PPODiag] kl_mean=0.0055, kl_p90=0.0088, kl_max=0.0106 | clipfrac_mean=0.031, logratio_std_mean=0.107, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.789, p10=0.784, min=0.783 | pg_loss_mean=0.0017, v_loss_mean=0.1688, ent_mean=0.1050 | gn_bb_mean=1.069, gn_bb_max=1.709 | gn_v_mean=2.068, gn_v_max=3.948

 10%|█         | 517/5000 [1:20:39<10:12:14,  8.19s/it]------------------ Training Record ------------------
Epoch: 517/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3222, reward_valid_std=2.2653
[BatchDiag] adv_mean=-0.3220, adv_std=0.8544, adv_abs_mean=0.6764 | ret_mean=6.8924, ret_std=1.6608 | val_mean=7.2144, val_std=1.4054 | explained_var=0.735376
[GradSplit pre-clip] backbone=0.660276, critic=2.396584
[Loss] pg_loss=-0.042683, entropy_loss=0.000106, value_loss=0.041413
[EpochKL] epoch=0 mean_kl=0.00381 max_kl=0.00917
[EpochKL] epoch=1 mean_kl=0.00538 max_kl=0.00857
[EpochKL] epoch=2 mean_kl=0.00710 max_kl=0.01074
[Time] Env Create Time: 2.8701s |Rollout Collect Time: 3.5117s |Loss & Update :1.8701
[PPODiag] kl_mean=0.0054, kl_p90=0.0084, kl_max=0.0107 | clipfrac_mean=0.032, logratio_std_mean=0.106, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.788, p10=0.784, min=0.783 | pg_loss_mean=0.0020, v_loss_mean=0.1646, ent_mean=0.1045 | gn_bb_mean=1.185, gn_bb_max=1.915 | gn_v_mean=1.908, gn_v_max=3.070

 10%|█         | 518/5000 [1:20:47<10:13:24,  8.21s/it]------------------ Training Record ------------------
Epoch: 518/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3224, reward_valid_std=2.2697
[BatchDiag] adv_mean=-0.2342, adv_std=0.8646, adv_abs_mean=0.6719 | ret_mean=6.8721, ret_std=1.6704 | val_mean=7.1064, val_std=1.4163 | explained_var=0.732110
[GradSplit pre-clip] backbone=0.627190, critic=1.708619
[Loss] pg_loss=-0.066181, entropy_loss=0.000119, value_loss=0.037798
[EpochKL] epoch=0 mean_kl=0.00334 max_kl=0.00688
[EpochKL] epoch=1 mean_kl=0.00657 max_kl=0.00904
[EpochKL] epoch=2 mean_kl=0.00689 max_kl=0.00956
[Time] Env Create Time: 2.7103s |Rollout Collect Time: 3.3641s |Loss & Update :1.8051
[PPODiag] kl_mean=0.0056, kl_p90=0.0081, kl_max=0.0096 | clipfrac_mean=0.032, logratio_std_mean=0.109, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.826, p10=0.820, min=0.819 | pg_loss_mean=0.0018, v_loss_mean=0.1670, ent_mean=0.1081 | gn_bb_mean=1.172, gn_bb_max=2.426 | gn_v_mean=2.075, gn_v_max=3.954

 10%|█         | 519/5000 [1:20:55<10:05:50,  8.11s/it]------------------ Training Record ------------------
Epoch: 519/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3245, reward_valid_std=2.2752
[BatchDiag] adv_mean=-0.2843, adv_std=0.8380, adv_abs_mean=0.6561 | ret_mean=6.9165, ret_std=1.6664 | val_mean=7.2008, val_std=1.4230 | explained_var=0.747098
[GradSplit pre-clip] backbone=0.631890, critic=2.329921
[Loss] pg_loss=-0.021520, entropy_loss=0.000108, value_loss=0.039519
[EpochKL] epoch=0 mean_kl=0.00283 max_kl=0.00526
[EpochKL] epoch=1 mean_kl=0.00633 max_kl=0.00955
[EpochKL] epoch=2 mean_kl=0.00803 max_kl=0.01264
[Time] Env Create Time: 2.8586s |Rollout Collect Time: 3.3542s |Loss & Update :1.8046
[PPODiag] kl_mean=0.0057, kl_p90=0.0090, kl_max=0.0126 | clipfrac_mean=0.032, logratio_std_mean=0.109, ratio_p95_mean=1.041 | valid_ratio_mb_mean=0.823, p10=0.819, min=0.815 | pg_loss_mean=0.0022, v_loss_mean=0.1624, ent_mean=0.1039 | gn_bb_mean=1.104, gn_bb_max=1.594 | gn_v_mean=2.324, gn_v_max=3.518

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.671, Step: 21, Avg Done Step: 18.40, #CS visited: 0.38
D->C12->C1->C15->C3->C5->C2->D->C4->C14->C8->D->C13->C6->C7->C11->C10->C9->D
Eval cost : 4.0702s
-----------------------------
 10%|█         | 520/5000 [1:21:07<11:35:17,  9.31s/it]------------------ Training Record ------------------
Epoch: 520/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3235, reward_valid_std=2.2695
[BatchDiag] adv_mean=-0.2590, adv_std=0.8528, adv_abs_mean=0.6564 | ret_mean=6.8913, ret_std=1.6780 | val_mean=7.1503, val_std=1.4388 | explained_var=0.741734
[GradSplit pre-clip] backbone=0.467243, critic=1.250807
[Loss] pg_loss=-0.123820, entropy_loss=0.000109, value_loss=0.036113
[EpochKL] epoch=0 mean_kl=0.00251 max_kl=0.00443
[EpochKL] epoch=1 mean_kl=0.00583 max_kl=0.00747
[EpochKL] epoch=2 mean_kl=0.00675 max_kl=0.00917
[Time] Env Create Time: 2.8624s |Rollout Collect Time: 3.3523s |Loss & Update :1.7870
[PPODiag] kl_mean=0.0050, kl_p90=0.0074, kl_max=0.0092 | clipfrac_mean=0.030, logratio_std_mean=0.102, ratio_p95_mean=1.037 | valid_ratio_mb_mean=0.826, p10=0.819, min=0.814 | pg_loss_mean=0.0017, v_loss_mean=0.1607, ent_mean=0.1068 | gn_bb_mean=1.109, gn_bb_max=1.462 | gn_v_mean=1.862, gn_v_max=3.314
[AttnScore] scale=1.1752, C=10.0

 10%|█         | 521/5000 [1:21:15<11:05:48,  8.92s/it]------------------ Training Record ------------------
Epoch: 521/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3217, reward_valid_std=2.2720
[BatchDiag] adv_mean=-0.2735, adv_std=0.8749, adv_abs_mean=0.6733 | ret_mean=6.8746, ret_std=1.6853 | val_mean=7.1480, val_std=1.4512 | explained_var=0.730525
[GradSplit pre-clip] backbone=0.654740, critic=1.934585
[Loss] pg_loss=-0.035421, entropy_loss=0.000117, value_loss=0.040380
[EpochKL] epoch=0 mean_kl=0.00316 max_kl=0.00553
[EpochKL] epoch=1 mean_kl=0.00475 max_kl=0.00588
[EpochKL] epoch=2 mean_kl=0.00471 max_kl=0.00781
[Time] Env Create Time: 2.8671s |Rollout Collect Time: 3.3584s |Loss & Update :1.7914
[PPODiag] kl_mean=0.0042, kl_p90=0.0058, kl_max=0.0078 | clipfrac_mean=0.029, logratio_std_mean=0.093, ratio_p95_mean=1.039 | valid_ratio_mb_mean=0.825, p10=0.820, min=0.814 | pg_loss_mean=0.0012, v_loss_mean=0.1650, ent_mean=0.1101 | gn_bb_mean=1.041, gn_bb_max=1.488 | gn_v_mean=1.476, gn_v_max=2.518

 10%|█         | 522/5000 [1:21:23<10:45:28,  8.65s/it]------------------ Training Record ------------------
Epoch: 522/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.826, reward_valid_mean=0.3219, reward_valid_std=2.2688
[BatchDiag] adv_mean=-0.2472, adv_std=0.8639, adv_abs_mean=0.6737 | ret_mean=6.8571, ret_std=1.6776 | val_mean=7.1043, val_std=1.4167 | explained_var=0.734823
[GradSplit pre-clip] backbone=0.460446, critic=1.594746
[Loss] pg_loss=-0.069017, entropy_loss=0.000114, value_loss=0.037833
[EpochKL] epoch=0 mean_kl=0.00245 max_kl=0.00574
[EpochKL] epoch=1 mean_kl=0.00515 max_kl=0.00964
[EpochKL] epoch=2 mean_kl=0.00835 max_kl=0.01109
[Time] Env Create Time: 2.7043s |Rollout Collect Time: 3.3398s |Loss & Update :1.7979
[PPODiag] kl_mean=0.0053, kl_p90=0.0098, kl_max=0.0111 | clipfrac_mean=0.031, logratio_std_mean=0.101, ratio_p95_mean=1.040 | valid_ratio_mb_mean=0.826, p10=0.822, min=0.814 | pg_loss_mean=0.0017, v_loss_mean=0.1631, ent_mean=0.1089 | gn_bb_mean=1.193, gn_bb_max=2.177 | gn_v_mean=1.601, gn_v_max=2.396

 10%|█         | 523/5000 [1:21:31<10:27:16,  8.41s/it]------------------ Training Record ------------------
Epoch: 523/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.753, reward_valid_mean=0.3260, reward_valid_std=2.2723
[BatchDiag] adv_mean=-0.0881, adv_std=0.8551, adv_abs_mean=0.6427 | ret_mean=6.8587, ret_std=1.7015 | val_mean=6.9468, val_std=1.5015 | explained_var=0.747442
[GradSplit pre-clip] backbone=0.512860, critic=0.581081
[Loss] pg_loss=-0.006728, entropy_loss=0.000107, value_loss=0.040590
[EpochKL] epoch=0 mean_kl=0.00437 max_kl=0.00813
[EpochKL] epoch=1 mean_kl=0.00994 max_kl=0.01235
[EpochKL] epoch=2 mean_kl=0.00808 max_kl=0.00960
[Time] Env Create Time: 2.8464s |Rollout Collect Time: 3.6496s |Loss & Update :1.9415
[PPODiag] kl_mean=0.0075, kl_p90=0.0104, kl_max=0.0124 | clipfrac_mean=0.038, logratio_std_mean=0.129, ratio_p95_mean=1.049 | valid_ratio_mb_mean=0.753, p10=0.746, min=0.744 | pg_loss_mean=0.0025, v_loss_mean=0.1546, ent_mean=0.0970 | gn_bb_mean=1.295, gn_bb_max=1.937 | gn_v_mean=0.890, gn_v_max=2.270

 10%|█         | 524/5000 [1:21:39<10:27:50,  8.42s/it]------------------ Training Record ------------------
Epoch: 524/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=30, valid_ratio=0.577, reward_valid_mean=0.3235, reward_valid_std=2.2705
[BatchDiag] adv_mean=-0.0330, adv_std=0.8541, adv_abs_mean=0.6387 | ret_mean=6.8035, ret_std=1.7013 | val_mean=6.8364, val_std=1.5104 | explained_var=0.747969
[GradSplit pre-clip] backbone=0.395267, critic=0.798293
[Loss] pg_loss=-0.097854, entropy_loss=0.000071, value_loss=0.036450
[EpochKL] epoch=0 mean_kl=0.00289 max_kl=0.00433
[EpochKL] epoch=1 mean_kl=0.00469 max_kl=0.00608
[EpochKL] epoch=2 mean_kl=0.00580 max_kl=0.00850
[Time] Env Create Time: 2.8584s |Rollout Collect Time: 4.6957s |Loss & Update :2.4569
[PPODiag] kl_mean=0.0045, kl_p90=0.0067, kl_max=0.0085 | clipfrac_mean=0.028, logratio_std_mean=0.095, ratio_p95_mean=1.038 | valid_ratio_mb_mean=0.577, p10=0.573, min=0.570 | pg_loss_mean=0.0014, v_loss_mean=0.1531, ent_mean=0.0725 | gn_bb_mean=1.070, gn_bb_max=1.904 | gn_v_mean=0.882, gn_v_max=1.406

 10%|█         | 525/5000 [1:21:49<11:03:23,  8.89s/it]------------------ Training Record ------------------
Epoch: 525/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3264, reward_valid_std=2.2778
[BatchDiag] adv_mean=-0.0983, adv_std=0.8619, adv_abs_mean=0.6448 | ret_mean=6.8724, ret_std=1.6952 | val_mean=6.9708, val_std=1.4921 | explained_var=0.741511
[GradSplit pre-clip] backbone=0.748521, critic=0.991044
[Loss] pg_loss=0.008073, entropy_loss=0.000100, value_loss=0.038189
[EpochKL] epoch=0 mean_kl=0.00362 max_kl=0.00622
[EpochKL] epoch=1 mean_kl=0.00900 max_kl=0.01380
[EarlyStop] epoch=2 mean_kl=0.01200 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01200 max_kl=0.01504
[Time] Env Create Time: 2.7007s |Rollout Collect Time: 3.5092s |Loss & Update :1.8560
[PPODiag] kl_mean=0.0082, kl_p90=0.0141, kl_max=0.0150 | clipfrac_mean=0.040, logratio_std_mean=0.130, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.785, p10=0.780, min=0.778 | pg_loss_mean=0.0031, v_loss_mean=0.1560, ent_mean=0.0988 | gn_bb_mean=1.593, gn_bb_max=2.558 | gn_v_mean=1.115, gn_v_max=2.145
[AttnScore] scale=1.1769, C=10.0

 11%|█         | 526/5000 [1:21:58<10:44:43,  8.65s/it]------------------ Training Record ------------------
Epoch: 526/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3236, reward_valid_std=2.2784
[BatchDiag] adv_mean=-0.0224, adv_std=0.8565, adv_abs_mean=0.6383 | ret_mean=6.8307, ret_std=1.7284 | val_mean=6.8531, val_std=1.5419 | explained_var=0.754449
[GradSplit pre-clip] backbone=0.538698, critic=0.950680
[Loss] pg_loss=-0.108888, entropy_loss=0.000104, value_loss=0.033934
[EpochKL] epoch=0 mean_kl=0.00703 max_kl=0.01502
[EpochKL] epoch=1 mean_kl=0.00944 max_kl=0.01492
[EpochKL] epoch=2 mean_kl=0.00824 max_kl=0.01088
[Time] Env Create Time: 2.8549s |Rollout Collect Time: 3.3466s |Loss & Update :1.7927
[PPODiag] kl_mean=0.0082, kl_p90=0.0131, kl_max=0.0150 | clipfrac_mean=0.040, logratio_std_mean=0.135, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.823, p10=0.818, min=0.813 | pg_loss_mean=0.0033, v_loss_mean=0.1582, ent_mean=0.1021 | gn_bb_mean=1.556, gn_bb_max=2.582 | gn_v_mean=1.676, gn_v_max=3.024

 11%|█         | 527/5000 [1:22:06<10:30:00,  8.45s/it]------------------ Training Record ------------------
Epoch: 527/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.783, reward_valid_mean=0.3284, reward_valid_std=2.2781
[BatchDiag] adv_mean=-0.0393, adv_std=0.8557, adv_abs_mean=0.6304 | ret_mean=6.8710, ret_std=1.6937 | val_mean=6.9103, val_std=1.5663 | explained_var=0.744761
[GradSplit pre-clip] backbone=0.668648, critic=0.443963
[Loss] pg_loss=-0.031191, entropy_loss=0.000106, value_loss=0.033245
[EpochKL] epoch=0 mean_kl=0.00279 max_kl=0.00457
[EpochKL] epoch=1 mean_kl=0.00432 max_kl=0.00692
[EpochKL] epoch=2 mean_kl=0.00661 max_kl=0.00847
[Time] Env Create Time: 2.8722s |Rollout Collect Time: 3.4916s |Loss & Update :1.8675
[PPODiag] kl_mean=0.0046, kl_p90=0.0069, kl_max=0.0085 | clipfrac_mean=0.029, logratio_std_mean=0.097, ratio_p95_mean=1.036 | valid_ratio_mb_mean=0.783, p10=0.778, min=0.772 | pg_loss_mean=0.0014, v_loss_mean=0.1530, ent_mean=0.0973 | gn_bb_mean=1.101, gn_bb_max=1.837 | gn_v_mean=1.311, gn_v_max=2.451

 11%|█         | 528/5000 [1:22:14<10:24:58,  8.39s/it]------------------ Training Record ------------------
Epoch: 528/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3246, reward_valid_std=2.2752
[BatchDiag] adv_mean=-0.0560, adv_std=0.8656, adv_abs_mean=0.6426 | ret_mean=6.8535, ret_std=1.7120 | val_mean=6.9094, val_std=1.5681 | explained_var=0.744323
[GradSplit pre-clip] backbone=0.434383, critic=0.813919
[Loss] pg_loss=-0.048449, entropy_loss=0.000108, value_loss=0.036689
[EpochKL] epoch=0 mean_kl=0.00254 max_kl=0.00508
[EpochKL] epoch=1 mean_kl=0.00598 max_kl=0.00844
[EpochKL] epoch=2 mean_kl=0.00686 max_kl=0.00956
[Time] Env Create Time: 2.8780s |Rollout Collect Time: 3.4905s |Loss & Update :1.8784
[PPODiag] kl_mean=0.0051, kl_p90=0.0082, kl_max=0.0096 | clipfrac_mean=0.031, logratio_std_mean=0.103, ratio_p95_mean=1.038 | valid_ratio_mb_mean=0.786, p10=0.781, min=0.776 | pg_loss_mean=0.0018, v_loss_mean=0.1568, ent_mean=0.0968 | gn_bb_mean=1.070, gn_bb_max=1.594 | gn_v_mean=1.091, gn_v_max=2.310

 11%|█         | 529/5000 [1:22:22<10:21:44,  8.34s/it]------------------ Training Record ------------------
Epoch: 529/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.821, reward_valid_mean=0.3307, reward_valid_std=2.2773
[BatchDiag] adv_mean=-0.1424, adv_std=0.8398, adv_abs_mean=0.6302 | ret_mean=6.9351, ret_std=1.6605 | val_mean=7.0775, val_std=1.4718 | explained_var=0.744203
[GradSplit pre-clip] backbone=0.760357, critic=1.233386
[Loss] pg_loss=-0.008643, entropy_loss=0.000106, value_loss=0.034743
[EpochKL] epoch=0 mean_kl=0.00580 max_kl=0.01035
[EarlyStop] epoch=1 mean_kl=0.01134 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01134 max_kl=0.02299
[Time] Env Create Time: 2.7014s |Rollout Collect Time: 3.3357s |Loss & Update :1.2188
[PPODiag] kl_mean=0.0086, kl_p90=0.0135, kl_max=0.0230 | clipfrac_mean=0.037, logratio_std_mean=0.135, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.821, p10=0.817, min=0.815 | pg_loss_mean=0.0035, v_loss_mean=0.1527, ent_mean=0.0983 | gn_bb_mean=1.297, gn_bb_max=1.818 | gn_v_mean=1.655, gn_v_max=3.738

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.653, Step: 21, Avg Done Step: 18.37, #CS visited: 0.38
D->C12->C1->C15->C3->C5->C2->D->C4->C14->C8->D->C13->C6->C7->C11->C10->C9->D
Eval cost : 4.2220s
-----------------------------
 11%|█         | 530/5000 [1:22:34<11:32:21,  9.29s/it]------------------ Training Record ------------------
Epoch: 530/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.753, reward_valid_mean=0.3238, reward_valid_std=2.2723
[BatchDiag] adv_mean=-0.1348, adv_std=0.8545, adv_abs_mean=0.6431 | ret_mean=6.8510, ret_std=1.6880 | val_mean=6.9858, val_std=1.4526 | explained_var=0.743753
[GradSplit pre-clip] backbone=0.717447, critic=0.663505
[Loss] pg_loss=-0.087382, entropy_loss=0.000097, value_loss=0.032910
[EpochKL] epoch=0 mean_kl=0.00620 max_kl=0.01003
[EpochKL] epoch=1 mean_kl=0.00889 max_kl=0.01362
[EarlyStop] epoch=2 mean_kl=0.01037 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01037 max_kl=0.01525
[Time] Env Create Time: 2.6845s |Rollout Collect Time: 3.6390s |Loss & Update :1.9374
[PPODiag] kl_mean=0.0085, kl_p90=0.0115, kl_max=0.0153 | clipfrac_mean=0.040, logratio_std_mean=0.137, ratio_p95_mean=1.043 | valid_ratio_mb_mean=0.753, p10=0.747, min=0.745 | pg_loss_mean=0.0030, v_loss_mean=0.1563, ent_mean=0.0920 | gn_bb_mean=1.286, gn_bb_max=2.248 | gn_v_mean=1.325, gn_v_max=3.619
[AttnScore] scale=1.1788, C=10.0

 11%|█         | 531/5000 [1:22:42<11:09:08,  8.98s/it]------------------ Training Record ------------------
Epoch: 531/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3234, reward_valid_std=2.2699
[BatchDiag] adv_mean=-0.1389, adv_std=0.8536, adv_abs_mean=0.6450 | ret_mean=6.8460, ret_std=1.6849 | val_mean=6.9849, val_std=1.4860 | explained_var=0.743341
[GradSplit pre-clip] backbone=0.487376, critic=0.792556
[Loss] pg_loss=-0.093223, entropy_loss=0.000107, value_loss=0.039412
[EpochKL] epoch=0 mean_kl=0.00214 max_kl=0.00451
[EpochKL] epoch=1 mean_kl=0.00421 max_kl=0.00539
[EpochKL] epoch=2 mean_kl=0.00561 max_kl=0.00768
[Time] Env Create Time: 2.8672s |Rollout Collect Time: 3.3380s |Loss & Update :1.8052
[PPODiag] kl_mean=0.0040, kl_p90=0.0055, kl_max=0.0077 | clipfrac_mean=0.026, logratio_std_mean=0.090, ratio_p95_mean=1.036 | valid_ratio_mb_mean=0.825, p10=0.820, min=0.814 | pg_loss_mean=0.0012, v_loss_mean=0.1568, ent_mean=0.1031 | gn_bb_mean=0.957, gn_bb_max=1.224 | gn_v_mean=1.385, gn_v_max=2.386

 11%|█         | 532/5000 [1:22:50<10:47:15,  8.69s/it]------------------ Training Record ------------------
Epoch: 532/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3266, reward_valid_std=2.2774
[BatchDiag] adv_mean=-0.1027, adv_std=0.8696, adv_abs_mean=0.6471 | ret_mean=6.8757, ret_std=1.6934 | val_mean=6.9784, val_std=1.4987 | explained_var=0.736301
[GradSplit pre-clip] backbone=0.533414, critic=0.562146
[Loss] pg_loss=-0.032118, entropy_loss=0.000102, value_loss=0.038140
[EpochKL] epoch=0 mean_kl=0.00248 max_kl=0.00466
[EpochKL] epoch=1 mean_kl=0.00524 max_kl=0.00827
[EpochKL] epoch=2 mean_kl=0.00582 max_kl=0.00703
[Time] Env Create Time: 2.8709s |Rollout Collect Time: 3.3441s |Loss & Update :1.8101
[PPODiag] kl_mean=0.0045, kl_p90=0.0068, kl_max=0.0083 | clipfrac_mean=0.028, logratio_std_mean=0.096, ratio_p95_mean=1.036 | valid_ratio_mb_mean=0.822, p10=0.816, min=0.813 | pg_loss_mean=0.0015, v_loss_mean=0.1581, ent_mean=0.1018 | gn_bb_mean=1.056, gn_bb_max=1.513 | gn_v_mean=1.360, gn_v_max=3.196

 11%|█         | 533/5000 [1:22:58<10:32:13,  8.49s/it]------------------ Training Record ------------------
Epoch: 533/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3245, reward_valid_std=2.2759
[BatchDiag] adv_mean=-0.1363, adv_std=0.8907, adv_abs_mean=0.6568 | ret_mean=6.8570, ret_std=1.7015 | val_mean=6.9933, val_std=1.5032 | explained_var=0.725957
[GradSplit pre-clip] backbone=0.629563, critic=0.755940
[Loss] pg_loss=-0.096047, entropy_loss=0.000100, value_loss=0.036549
[EpochKL] epoch=0 mean_kl=0.00511 max_kl=0.00871
[EpochKL] epoch=1 mean_kl=0.00599 max_kl=0.01133
[EpochKL] epoch=2 mean_kl=0.00754 max_kl=0.00845
[Time] Env Create Time: 2.7012s |Rollout Collect Time: 3.4907s |Loss & Update :1.8592
[PPODiag] kl_mean=0.0062, kl_p90=0.0086, kl_max=0.0113 | clipfrac_mean=0.035, logratio_std_mean=0.114, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.786, p10=0.779, min=0.778 | pg_loss_mean=0.0021, v_loss_mean=0.1617, ent_mean=0.0987 | gn_bb_mean=1.332, gn_bb_max=2.066 | gn_v_mean=0.964, gn_v_max=1.469

 11%|█         | 534/5000 [1:23:06<10:22:15,  8.36s/it]------------------ Training Record ------------------
Epoch: 534/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=23, valid_ratio=0.749, reward_valid_mean=0.3272, reward_valid_std=2.2783
[BatchDiag] adv_mean=-0.1527, adv_std=0.8613, adv_abs_mean=0.6453 | ret_mean=6.8773, ret_std=1.6826 | val_mean=7.0300, val_std=1.4801 | explained_var=0.737973
[GradSplit pre-clip] backbone=0.608136, critic=0.712350
[Loss] pg_loss=-0.123337, entropy_loss=0.000095, value_loss=0.037693
[EpochKL] epoch=0 mean_kl=0.00355 max_kl=0.00711
[EpochKL] epoch=1 mean_kl=0.00713 max_kl=0.00937
[EpochKL] epoch=2 mean_kl=0.00782 max_kl=0.00938
[Time] Env Create Time: 2.8608s |Rollout Collect Time: 3.6432s |Loss & Update :1.9495
[PPODiag] kl_mean=0.0062, kl_p90=0.0090, kl_max=0.0094 | clipfrac_mean=0.034, logratio_std_mean=0.114, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.749, p10=0.746, min=0.739 | pg_loss_mean=0.0022, v_loss_mean=0.1576, ent_mean=0.0934 | gn_bb_mean=1.145, gn_bb_max=1.654 | gn_v_mean=1.380, gn_v_max=2.331

 11%|█         | 535/5000 [1:23:14<10:24:12,  8.39s/it]------------------ Training Record ------------------
Epoch: 535/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.821, reward_valid_mean=0.3267, reward_valid_std=2.2757
[BatchDiag] adv_mean=-0.1698, adv_std=0.8562, adv_abs_mean=0.6382 | ret_mean=6.8782, ret_std=1.6675 | val_mean=7.0479, val_std=1.5110 | explained_var=0.736356
[GradSplit pre-clip] backbone=0.587176, critic=0.959251
[Loss] pg_loss=-0.065875, entropy_loss=0.000107, value_loss=0.038966
[EpochKL] epoch=0 mean_kl=0.00331 max_kl=0.00607
[EpochKL] epoch=1 mean_kl=0.00635 max_kl=0.00862
[EpochKL] epoch=2 mean_kl=0.00664 max_kl=0.01084
[Time] Env Create Time: 2.8488s |Rollout Collect Time: 3.3478s |Loss & Update :1.7945
[PPODiag] kl_mean=0.0054, kl_p90=0.0078, kl_max=0.0108 | clipfrac_mean=0.031, logratio_std_mean=0.107, ratio_p95_mean=1.042 | valid_ratio_mb_mean=0.821, p10=0.816, min=0.811 | pg_loss_mean=0.0020, v_loss_mean=0.1556, ent_mean=0.1021 | gn_bb_mean=1.166, gn_bb_max=1.670 | gn_v_mean=1.565, gn_v_max=2.721
[AttnScore] scale=1.1812, C=10.0

 11%|█         | 536/5000 [1:23:22<10:15:13,  8.27s/it]------------------ Training Record ------------------
Epoch: 536/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=33, valid_ratio=0.524, reward_valid_mean=0.3239, reward_valid_std=2.2758
[BatchDiag] adv_mean=-0.2278, adv_std=0.8713, adv_abs_mean=0.6545 | ret_mean=6.8780, ret_std=1.6707 | val_mean=7.1058, val_std=1.4744 | explained_var=0.728048
[GradSplit pre-clip] backbone=0.521248, critic=1.281426
[Loss] pg_loss=-0.094693, entropy_loss=0.000070, value_loss=0.038587
[EpochKL] epoch=0 mean_kl=0.00183 max_kl=0.00302
[EpochKL] epoch=1 mean_kl=0.00459 max_kl=0.00733
[EpochKL] epoch=2 mean_kl=0.00668 max_kl=0.00844
[Time] Env Create Time: 2.8672s |Rollout Collect Time: 5.1334s |Loss & Update :2.6897
[PPODiag] kl_mean=0.0044, kl_p90=0.0081, kl_max=0.0084 | clipfrac_mean=0.027, logratio_std_mean=0.094, ratio_p95_mean=1.037 | valid_ratio_mb_mean=0.524, p10=0.520, min=0.517 | pg_loss_mean=0.0014, v_loss_mean=0.1612, ent_mean=0.0668 | gn_bb_mean=1.065, gn_bb_max=1.750 | gn_v_mean=1.625, gn_v_max=2.653

 11%|█         | 537/5000 [1:23:33<11:09:07,  9.00s/it]------------------ Training Record ------------------
Epoch: 537/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3241, reward_valid_std=2.2711
[BatchDiag] adv_mean=-0.1174, adv_std=0.8591, adv_abs_mean=0.6407 | ret_mean=6.8471, ret_std=1.6890 | val_mean=6.9645, val_std=1.5390 | explained_var=0.741279
[GradSplit pre-clip] backbone=0.534873, critic=0.648674
[Loss] pg_loss=-0.091997, entropy_loss=0.000106, value_loss=0.036796
[EpochKL] epoch=0 mean_kl=0.00220 max_kl=0.00353
[EpochKL] epoch=1 mean_kl=0.00409 max_kl=0.00618
[EpochKL] epoch=2 mean_kl=0.00558 max_kl=0.00833
[Time] Env Create Time: 2.6927s |Rollout Collect Time: 3.3383s |Loss & Update :1.8102
[PPODiag] kl_mean=0.0040, kl_p90=0.0063, kl_max=0.0083 | clipfrac_mean=0.027, logratio_std_mean=0.090, ratio_p95_mean=1.038 | valid_ratio_mb_mean=0.824, p10=0.819, min=0.812 | pg_loss_mean=0.0012, v_loss_mean=0.1557, ent_mean=0.1055 | gn_bb_mean=1.038, gn_bb_max=1.631 | gn_v_mean=1.353, gn_v_max=2.114

 11%|█         | 538/5000 [1:23:41<10:43:13,  8.65s/it]------------------ Training Record ------------------
Epoch: 538/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=53, valid_ratio=0.327, reward_valid_mean=0.3256, reward_valid_std=2.2719
[BatchDiag] adv_mean=-0.1597, adv_std=0.8692, adv_abs_mean=0.6429 | ret_mean=6.8828, ret_std=1.6802 | val_mean=7.0425, val_std=1.5195 | explained_var=0.732393
[GradSplit pre-clip] backbone=0.556898, critic=0.804141
[Loss] pg_loss=-0.150547, entropy_loss=0.000042, value_loss=0.035939
[EpochKL] epoch=0 mean_kl=0.00328 max_kl=0.00744
[EpochKL] epoch=1 mean_kl=0.00786 max_kl=0.01158
[EarlyStop] epoch=2 mean_kl=0.01091 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01091 max_kl=0.01550
[Time] Env Create Time: 2.8586s |Rollout Collect Time: 8.1590s |Loss & Update :4.1863
[PPODiag] kl_mean=0.0073, kl_p90=0.0125, kl_max=0.0155 | clipfrac_mean=0.035, logratio_std_mean=0.124, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.327, p10=0.325, min=0.323 | pg_loss_mean=0.0025, v_loss_mean=0.1573, ent_mean=0.0402 | gn_bb_mean=1.223, gn_bb_max=2.087 | gn_v_mean=1.360, gn_v_max=3.280

 11%|█         | 539/5000 [1:23:56<13:09:17, 10.62s/it]------------------ Training Record ------------------
Epoch: 539/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3229, reward_valid_std=2.2679
[BatchDiag] adv_mean=-0.1304, adv_std=0.8690, adv_abs_mean=0.6533 | ret_mean=6.8257, ret_std=1.6982 | val_mean=6.9562, val_std=1.4923 | explained_var=0.738164
[GradSplit pre-clip] backbone=0.467348, critic=0.735307
[Loss] pg_loss=-0.055583, entropy_loss=0.000109, value_loss=0.035940
[EpochKL] epoch=0 mean_kl=0.00441 max_kl=0.00818
[EpochKL] epoch=1 mean_kl=0.00747 max_kl=0.00990
[EpochKL] epoch=2 mean_kl=0.01000 max_kl=0.01581
[Time] Env Create Time: 2.8782s |Rollout Collect Time: 3.3451s |Loss & Update :1.7965
[PPODiag] kl_mean=0.0073, kl_p90=0.0110, kl_max=0.0158 | clipfrac_mean=0.038, logratio_std_mean=0.124, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.825, p10=0.819, min=0.817 | pg_loss_mean=0.0027, v_loss_mean=0.1621, ent_mean=0.1063 | gn_bb_mean=1.396, gn_bb_max=1.993 | gn_v_mean=1.609, gn_v_max=4.532

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.687, Step: 20, Avg Done Step: 18.41, #CS visited: 0.39
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->C8->D->C6->C7->C11->C10->C9->D
Eval cost : 3.9343s
-----------------------------
 11%|█         | 540/5000 [1:24:08<13:39:36, 11.03s/it]------------------ Training Record ------------------
Epoch: 540/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3248, reward_valid_std=2.2709
[BatchDiag] adv_mean=-0.1857, adv_std=0.8560, adv_abs_mean=0.6492 | ret_mean=6.8667, ret_std=1.6854 | val_mean=7.0524, val_std=1.4566 | explained_var=0.742044
[GradSplit pre-clip] backbone=0.502198, critic=0.976035
[Loss] pg_loss=-0.076153, entropy_loss=0.000099, value_loss=0.039469
[EpochKL] epoch=0 mean_kl=0.00457 max_kl=0.00898
[EpochKL] epoch=1 mean_kl=0.00699 max_kl=0.01086
[EpochKL] epoch=2 mean_kl=0.00997 max_kl=0.01511
[Time] Env Create Time: 2.8912s |Rollout Collect Time: 3.4898s |Loss & Update :1.8834
[PPODiag] kl_mean=0.0072, kl_p90=0.0105, kl_max=0.0151 | clipfrac_mean=0.036, logratio_std_mean=0.125, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.788, p10=0.781, min=0.780 | pg_loss_mean=0.0024, v_loss_mean=0.1577, ent_mean=0.0983 | gn_bb_mean=1.313, gn_bb_max=2.528 | gn_v_mean=1.521, gn_v_max=3.127
[AttnScore] scale=1.1834, C=10.0

 11%|█         | 541/5000 [1:24:16<12:37:51, 10.20s/it]------------------ Training Record ------------------
Epoch: 541/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3247, reward_valid_std=2.2712
[BatchDiag] adv_mean=-0.2098, adv_std=0.8656, adv_abs_mean=0.6549 | ret_mean=6.8738, ret_std=1.6746 | val_mean=7.0837, val_std=1.4871 | explained_var=0.732825
[GradSplit pre-clip] backbone=0.778839, critic=0.780929
[Loss] pg_loss=-0.156331, entropy_loss=0.000112, value_loss=0.035725
[EpochKL] epoch=0 mean_kl=0.00398 max_kl=0.00759
[EarlyStop] epoch=1 mean_kl=0.01031 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01031 max_kl=0.01436
[Time] Env Create Time: 2.7133s |Rollout Collect Time: 3.3392s |Loss & Update :1.2170
[PPODiag] kl_mean=0.0071, kl_p90=0.0121, kl_max=0.0144 | clipfrac_mean=0.036, logratio_std_mean=0.121, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.824, p10=0.815, min=0.812 | pg_loss_mean=0.0025, v_loss_mean=0.1636, ent_mean=0.1064 | gn_bb_mean=1.451, gn_bb_max=1.947 | gn_v_mean=2.098, gn_v_max=3.701

 11%|█         | 542/5000 [1:24:24<11:32:25,  9.32s/it]------------------ Training Record ------------------
Epoch: 542/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=55, valid_ratio=0.314, reward_valid_mean=0.3239, reward_valid_std=2.2699
[BatchDiag] adv_mean=-0.2836, adv_std=0.8642, adv_abs_mean=0.6757 | ret_mean=6.8605, ret_std=1.6657 | val_mean=7.1441, val_std=1.4117 | explained_var=0.730800
[GradSplit pre-clip] backbone=0.599936, critic=1.654010
[Loss] pg_loss=-0.112564, entropy_loss=0.000043, value_loss=0.038256
[EpochKL] epoch=0 mean_kl=0.00420 max_kl=0.00741
[EpochKL] epoch=1 mean_kl=0.00862 max_kl=0.01623
[EarlyStop] epoch=2 mean_kl=0.01102 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01102 max_kl=0.02267
[Time] Env Create Time: 2.8691s |Rollout Collect Time: 8.4642s |Loss & Update :4.2806
[PPODiag] kl_mean=0.0079, kl_p90=0.0126, kl_max=0.0227 | clipfrac_mean=0.040, logratio_std_mean=0.133, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.314, p10=0.311, min=0.310 | pg_loss_mean=0.0027, v_loss_mean=0.1669, ent_mean=0.0413 | gn_bb_mean=1.356, gn_bb_max=1.993 | gn_v_mean=2.208, gn_v_max=3.829

 11%|█         | 543/5000 [1:24:39<13:52:33, 11.21s/it]------------------ Training Record ------------------
Epoch: 543/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.822, reward_valid_mean=0.3245, reward_valid_std=2.2744
[BatchDiag] adv_mean=-0.2880, adv_std=0.8589, adv_abs_mean=0.6694 | ret_mean=6.8925, ret_std=1.6489 | val_mean=7.1805, val_std=1.4352 | explained_var=0.728689
[GradSplit pre-clip] backbone=0.471164, critic=2.588536
[Loss] pg_loss=-0.002203, entropy_loss=0.000108, value_loss=0.041714
[EpochKL] epoch=0 mean_kl=0.00365 max_kl=0.00665
[EpochKL] epoch=1 mean_kl=0.00755 max_kl=0.01237
[EpochKL] epoch=2 mean_kl=0.00923 max_kl=0.01094
[Time] Env Create Time: 2.8670s |Rollout Collect Time: 3.3298s |Loss & Update :1.8010
[PPODiag] kl_mean=0.0068, kl_p90=0.0106, kl_max=0.0124 | clipfrac_mean=0.036, logratio_std_mean=0.120, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.822, p10=0.818, min=0.813 | pg_loss_mean=0.0027, v_loss_mean=0.1625, ent_mean=0.1070 | gn_bb_mean=1.364, gn_bb_max=2.411 | gn_v_mean=1.504, gn_v_max=3.622

 11%|█         | 544/5000 [1:24:47<12:40:51, 10.24s/it]------------------ Training Record ------------------
Epoch: 544/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3199, reward_valid_std=2.2696
[BatchDiag] adv_mean=-0.1773, adv_std=0.8868, adv_abs_mean=0.6699 | ret_mean=6.8065, ret_std=1.6948 | val_mean=6.9838, val_std=1.4884 | explained_var=0.726209
[GradSplit pre-clip] backbone=0.490195, critic=0.888803
[Loss] pg_loss=-0.076307, entropy_loss=0.000118, value_loss=0.039076
[EpochKL] epoch=0 mean_kl=0.00305 max_kl=0.00518
[EpochKL] epoch=1 mean_kl=0.00547 max_kl=0.00769
[EpochKL] epoch=2 mean_kl=0.00713 max_kl=0.01054
[Time] Env Create Time: 2.7063s |Rollout Collect Time: 3.3118s |Loss & Update :1.8076
[PPODiag] kl_mean=0.0052, kl_p90=0.0085, kl_max=0.0105 | clipfrac_mean=0.031, logratio_std_mean=0.103, ratio_p95_mean=1.044 | valid_ratio_mb_mean=0.824, p10=0.819, min=0.815 | pg_loss_mean=0.0018, v_loss_mean=0.1674, ent_mean=0.1096 | gn_bb_mean=1.120, gn_bb_max=1.904 | gn_v_mean=1.683, gn_v_max=2.709

 11%|█         | 545/5000 [1:24:55<11:46:48,  9.52s/it]------------------ Training Record ------------------
Epoch: 545/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.821, reward_valid_mean=0.3236, reward_valid_std=2.2734
[BatchDiag] adv_mean=-0.2193, adv_std=0.8702, adv_abs_mean=0.6625 | ret_mean=6.8497, ret_std=1.6652 | val_mean=7.0690, val_std=1.4530 | explained_var=0.726906
[GradSplit pre-clip] backbone=0.573975, critic=0.894669
[Loss] pg_loss=-0.122823, entropy_loss=0.000115, value_loss=0.038136
[EpochKL] epoch=0 mean_kl=0.00371 max_kl=0.00776
[EpochKL] epoch=1 mean_kl=0.00691 max_kl=0.00839
[EpochKL] epoch=2 mean_kl=0.00866 max_kl=0.01107
[Time] Env Create Time: 2.8311s |Rollout Collect Time: 3.3142s |Loss & Update :1.8016
[PPODiag] kl_mean=0.0064, kl_p90=0.0093, kl_max=0.0111 | clipfrac_mean=0.034, logratio_std_mean=0.117, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.821, p10=0.815, min=0.812 | pg_loss_mean=0.0020, v_loss_mean=0.1639, ent_mean=0.1093 | gn_bb_mean=1.138, gn_bb_max=1.638 | gn_v_mean=1.727, gn_v_max=3.772
[AttnScore] scale=1.1846, C=10.0

 11%|█         | 546/5000 [1:25:03<11:11:38,  9.05s/it]------------------ Training Record ------------------
Epoch: 546/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3233, reward_valid_std=2.2721
[BatchDiag] adv_mean=-0.2251, adv_std=0.8798, adv_abs_mean=0.6722 | ret_mean=6.8334, ret_std=1.6775 | val_mean=7.0585, val_std=1.4058 | explained_var=0.724925
[GradSplit pre-clip] backbone=0.510232, critic=1.528316
[Loss] pg_loss=-0.070036, entropy_loss=0.000112, value_loss=0.040206
[EpochKL] epoch=0 mean_kl=0.00351 max_kl=0.00862
[EpochKL] epoch=1 mean_kl=0.00637 max_kl=0.00866
[EpochKL] epoch=2 mean_kl=0.00742 max_kl=0.01086
[Time] Env Create Time: 2.8389s |Rollout Collect Time: 3.4663s |Loss & Update :1.8846
[PPODiag] kl_mean=0.0058, kl_p90=0.0086, kl_max=0.0109 | clipfrac_mean=0.033, logratio_std_mean=0.112, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.785, p10=0.779, min=0.778 | pg_loss_mean=0.0019, v_loss_mean=0.1642, ent_mean=0.1037 | gn_bb_mean=1.153, gn_bb_max=1.695 | gn_v_mean=1.473, gn_v_max=3.007

 11%|█         | 547/5000 [1:25:11<10:52:24,  8.79s/it]------------------ Training Record ------------------
Epoch: 547/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3253, reward_valid_std=2.2727
[BatchDiag] adv_mean=-0.2412, adv_std=0.8717, adv_abs_mean=0.6664 | ret_mean=6.8592, ret_std=1.6690 | val_mean=7.1004, val_std=1.4050 | explained_var=0.727228
[GradSplit pre-clip] backbone=0.369137, critic=1.814808
[Loss] pg_loss=-0.018060, entropy_loss=0.000111, value_loss=0.040669
[EpochKL] epoch=0 mean_kl=0.00447 max_kl=0.00832
[EpochKL] epoch=1 mean_kl=0.00709 max_kl=0.00960
[EarlyStop] epoch=2 mean_kl=0.01081 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01081 max_kl=0.01466
[Time] Env Create Time: 2.8484s |Rollout Collect Time: 3.4580s |Loss & Update :1.8703
[PPODiag] kl_mean=0.0075, kl_p90=0.0122, kl_max=0.0147 | clipfrac_mean=0.039, logratio_std_mean=0.125, ratio_p95_mean=1.053 | valid_ratio_mb_mean=0.785, p10=0.779, min=0.778 | pg_loss_mean=0.0027, v_loss_mean=0.1616, ent_mean=0.1053 | gn_bb_mean=1.535, gn_bb_max=2.239 | gn_v_mean=1.219, gn_v_max=2.337

 11%|█         | 548/5000 [1:25:19<10:38:36,  8.61s/it]------------------ Training Record ------------------
Epoch: 548/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.785, reward_valid_mean=0.3227, reward_valid_std=2.2720
[BatchDiag] adv_mean=-0.1696, adv_std=0.8677, adv_abs_mean=0.6601 | ret_mean=6.8147, ret_std=1.6996 | val_mean=6.9843, val_std=1.4114 | explained_var=0.739384
[GradSplit pre-clip] backbone=0.458856, critic=0.964097
[Loss] pg_loss=-0.074668, entropy_loss=0.000112, value_loss=0.039325
[EpochKL] epoch=0 mean_kl=0.00506 max_kl=0.00857
[EpochKL] epoch=1 mean_kl=0.00767 max_kl=0.00999
[EpochKL] epoch=2 mean_kl=0.00792 max_kl=0.01360
[Time] Env Create Time: 2.6799s |Rollout Collect Time: 3.4784s |Loss & Update :1.8712
[PPODiag] kl_mean=0.0069, kl_p90=0.0092, kl_max=0.0136 | clipfrac_mean=0.038, logratio_std_mean=0.121, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.785, p10=0.780, min=0.774 | pg_loss_mean=0.0023, v_loss_mean=0.1606, ent_mean=0.1093 | gn_bb_mean=1.307, gn_bb_max=2.175 | gn_v_mean=1.206, gn_v_max=3.093

 11%|█         | 549/5000 [1:25:27<10:25:37,  8.43s/it]------------------ Training Record ------------------
Epoch: 549/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51198/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.289, reward_valid_mean=0.3215, reward_valid_std=2.2654
[BatchDiag] adv_mean=-0.0694, adv_std=0.8923, adv_abs_mean=0.6579 | ret_mean=6.7550, ret_std=1.7273 | val_mean=6.8244, val_std=1.4758 | explained_var=0.733161
[GradSplit pre-clip] backbone=0.507640, critic=0.896634
[Loss] pg_loss=-0.139070, entropy_loss=0.000040, value_loss=0.036760
[EpochKL] epoch=0 mean_kl=0.00624 max_kl=0.01322
[EarlyStop] epoch=1 mean_kl=0.01098 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01098 max_kl=0.03293
[Time] Env Create Time: 2.8407s |Rollout Collect Time: 9.1195s |Loss & Update :3.1254
[PPODiag] kl_mean=0.0086, kl_p90=0.0117, kl_max=0.0329 | clipfrac_mean=0.036, logratio_std_mean=0.141, ratio_p95_mean=1.050 | valid_ratio_mb_mean=0.289, p10=0.286, min=0.285 | pg_loss_mean=0.0025, v_loss_mean=0.1646, ent_mean=0.0394 | gn_bb_mean=1.309, gn_bb_max=2.363 | gn_v_mean=1.491, gn_v_max=2.939

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.718, Step: 21, Avg Done Step: 18.38, #CS visited: 0.38
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->C8->D->C6->C7->C11->C10->C9->D
Eval cost : 4.0358s
-----------------------------
 11%|█         | 550/5000 [1:25:46<14:23:53, 11.65s/it]------------------ Training Record ------------------
Epoch: 550/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.825, reward_valid_mean=0.3202, reward_valid_std=2.2702
[BatchDiag] adv_mean=-0.1616, adv_std=0.8732, adv_abs_mean=0.6611 | ret_mean=6.7885, ret_std=1.7059 | val_mean=6.9501, val_std=1.4693 | explained_var=0.737975
[GradSplit pre-clip] backbone=0.402910, critic=1.299213
[Loss] pg_loss=-0.012553, entropy_loss=0.000123, value_loss=0.037802
[EpochKL] epoch=0 mean_kl=0.00428 max_kl=0.00728
[EpochKL] epoch=1 mean_kl=0.00675 max_kl=0.00881
[EpochKL] epoch=2 mean_kl=0.00950 max_kl=0.01614
[Time] Env Create Time: 2.8419s |Rollout Collect Time: 3.3221s |Loss & Update :1.7968
[PPODiag] kl_mean=0.0068, kl_p90=0.0097, kl_max=0.0161 | clipfrac_mean=0.037, logratio_std_mean=0.120, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.825, p10=0.818, min=0.817 | pg_loss_mean=0.0026, v_loss_mean=0.1621, ent_mean=0.1147 | gn_bb_mean=1.466, gn_bb_max=2.345 | gn_v_mean=1.252, gn_v_max=2.318
[AttnScore] scale=1.1856, C=10.0

 11%|█         | 551/5000 [1:25:54<13:01:41, 10.54s/it]------------------ Training Record ------------------
Epoch: 551/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3222, reward_valid_std=2.2693
[BatchDiag] adv_mean=-0.2010, adv_std=0.8580, adv_abs_mean=0.6521 | ret_mean=6.8176, ret_std=1.6805 | val_mean=7.0186, val_std=1.4422 | explained_var=0.739362
[GradSplit pre-clip] backbone=0.518213, critic=1.592249
[Loss] pg_loss=-0.028152, entropy_loss=0.000125, value_loss=0.037488
[EpochKL] epoch=0 mean_kl=0.00514 max_kl=0.00773
[EpochKL] epoch=1 mean_kl=0.00981 max_kl=0.01391
[EarlyStop] epoch=2 mean_kl=0.01092 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01092 max_kl=0.01445
[Time] Env Create Time: 2.8468s |Rollout Collect Time: 3.3238s |Loss & Update :1.8020
[PPODiag] kl_mean=0.0086, kl_p90=0.0124, kl_max=0.0144 | clipfrac_mean=0.043, logratio_std_mean=0.137, ratio_p95_mean=1.060 | valid_ratio_mb_mean=0.824, p10=0.817, min=0.814 | pg_loss_mean=0.0031, v_loss_mean=0.1607, ent_mean=0.1160 | gn_bb_mean=1.395, gn_bb_max=2.054 | gn_v_mean=1.703, gn_v_max=3.423

 11%|█         | 552/5000 [1:26:02<12:04:22,  9.77s/it]------------------ Training Record ------------------
Epoch: 552/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3224, reward_valid_std=2.2712
[BatchDiag] adv_mean=-0.1848, adv_std=0.8701, adv_abs_mean=0.6523 | ret_mean=6.8300, ret_std=1.6897 | val_mean=7.0148, val_std=1.4847 | explained_var=0.734850
[GradSplit pre-clip] backbone=0.460690, critic=1.100051
[Loss] pg_loss=-0.044896, entropy_loss=0.000115, value_loss=0.042451
[EpochKL] epoch=0 mean_kl=0.00374 max_kl=0.00559
[EpochKL] epoch=1 mean_kl=0.00698 max_kl=0.00985
[EarlyStop] epoch=2 mean_kl=0.01220 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01220 max_kl=0.01919
[Time] Env Create Time: 2.6804s |Rollout Collect Time: 3.4622s |Loss & Update :1.8645
[PPODiag] kl_mean=0.0076, kl_p90=0.0140, kl_max=0.0192 | clipfrac_mean=0.039, logratio_std_mean=0.126, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.786, p10=0.780, min=0.779 | pg_loss_mean=0.0024, v_loss_mean=0.1679, ent_mean=0.1089 | gn_bb_mean=1.324, gn_bb_max=2.650 | gn_v_mean=2.342, gn_v_max=4.088

 11%|█         | 553/5000 [1:26:10<11:24:59,  9.24s/it]------------------ Training Record ------------------
Epoch: 553/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.787, reward_valid_mean=0.3225, reward_valid_std=2.2697
[BatchDiag] adv_mean=-0.2234, adv_std=0.8634, adv_abs_mean=0.6586 | ret_mean=6.8441, ret_std=1.6792 | val_mean=7.0674, val_std=1.4416 | explained_var=0.735645
[GradSplit pre-clip] backbone=0.493886, critic=1.792063
[Loss] pg_loss=-0.031459, entropy_loss=0.000114, value_loss=0.038971
[EpochKL] epoch=0 mean_kl=0.00538 max_kl=0.00969
[EpochKL] epoch=1 mean_kl=0.00940 max_kl=0.02060
[EpochKL] epoch=2 mean_kl=0.00839 max_kl=0.01212
[Time] Env Create Time: 2.8244s |Rollout Collect Time: 3.4655s |Loss & Update :1.8744
[PPODiag] kl_mean=0.0077, kl_p90=0.0118, kl_max=0.0206 | clipfrac_mean=0.040, logratio_std_mean=0.128, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.787, p10=0.782, min=0.779 | pg_loss_mean=0.0030, v_loss_mean=0.1632, ent_mean=0.1053 | gn_bb_mean=1.349, gn_bb_max=2.567 | gn_v_mean=1.845, gn_v_max=2.987

 11%|█         | 554/5000 [1:26:19<11:00:53,  8.92s/it]------------------ Training Record ------------------
Epoch: 554/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3239, reward_valid_std=2.2697
[BatchDiag] adv_mean=-0.1585, adv_std=0.8725, adv_abs_mean=0.6519 | ret_mean=6.8267, ret_std=1.6911 | val_mean=6.9852, val_std=1.4708 | explained_var=0.733815
[GradSplit pre-clip] backbone=0.406058, critic=1.295140
[Loss] pg_loss=-0.003040, entropy_loss=0.000113, value_loss=0.040956
[EpochKL] epoch=0 mean_kl=0.00218 max_kl=0.00316
[EpochKL] epoch=1 mean_kl=0.00470 max_kl=0.00657
[EpochKL] epoch=2 mean_kl=0.00584 max_kl=0.00815
[Time] Env Create Time: 2.8425s |Rollout Collect Time: 3.4672s |Loss & Update :1.8643
[PPODiag] kl_mean=0.0042, kl_p90=0.0075, kl_max=0.0081 | clipfrac_mean=0.028, logratio_std_mean=0.092, ratio_p95_mean=1.043 | valid_ratio_mb_mean=0.786, p10=0.781, min=0.778 | pg_loss_mean=0.0013, v_loss_mean=0.1597, ent_mean=0.1068 | gn_bb_mean=1.106, gn_bb_max=1.726 | gn_v_mean=1.412, gn_v_max=2.277

 11%|█         | 555/5000 [1:26:27<10:44:11,  8.70s/it]------------------ Training Record ------------------
Epoch: 555/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3208, reward_valid_std=2.2692
[BatchDiag] adv_mean=-0.2063, adv_std=0.8635, adv_abs_mean=0.6512 | ret_mean=6.8340, ret_std=1.7012 | val_mean=7.0403, val_std=1.4887 | explained_var=0.742354
[GradSplit pre-clip] backbone=0.581950, critic=0.868511
[Loss] pg_loss=-0.116754, entropy_loss=0.000110, value_loss=0.034053
[EpochKL] epoch=0 mean_kl=0.00658 max_kl=0.01267
[EpochKL] epoch=1 mean_kl=0.00901 max_kl=0.01205
[EarlyStop] epoch=2 mean_kl=0.01007 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01007 max_kl=0.01651
[Time] Env Create Time: 2.6646s |Rollout Collect Time: 3.4657s |Loss & Update :1.8765
[PPODiag] kl_mean=0.0086, kl_p90=0.0121, kl_max=0.0165 | clipfrac_mean=0.043, logratio_std_mean=0.137, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.788, p10=0.784, min=0.782 | pg_loss_mean=0.0031, v_loss_mean=0.1593, ent_mean=0.1045 | gn_bb_mean=1.554, gn_bb_max=2.158 | gn_v_mean=1.551, gn_v_max=2.707
[AttnScore] scale=1.1874, C=10.0

 11%|█         | 556/5000 [1:26:35<10:28:45,  8.49s/it]------------------ Training Record ------------------
Epoch: 556/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51112/51200 = 0.998
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=60, valid_ratio=0.290, reward_valid_mean=0.3203, reward_valid_std=2.2659
[BatchDiag] adv_mean=-0.2472, adv_std=0.9638, adv_abs_mean=0.6906 | ret_mean=6.8419, ret_std=1.7306 | val_mean=7.0891, val_std=1.4677 | explained_var=0.689805
[GradSplit pre-clip] backbone=0.505101, critic=1.205075
[Loss] pg_loss=-0.098241, entropy_loss=0.000040, value_loss=0.040581
[EpochKL] epoch=0 mean_kl=0.00324 max_kl=0.00527
[EpochKL] epoch=1 mean_kl=0.00551 max_kl=0.00850
[EpochKL] epoch=2 mean_kl=0.00504 max_kl=0.00721
[Time] Env Create Time: 2.8307s |Rollout Collect Time: 9.1059s |Loss & Update :4.6683
[PPODiag] kl_mean=0.0046, kl_p90=0.0070, kl_max=0.0085 | clipfrac_mean=0.030, logratio_std_mean=0.098, ratio_p95_mean=1.040 | valid_ratio_mb_mean=0.290, p10=0.286, min=0.286 | pg_loss_mean=0.0005, v_loss_mean=0.1750, ent_mean=0.0388 | gn_bb_mean=1.051, gn_bb_max=1.872 | gn_v_mean=1.395, gn_v_max=2.294

 11%|█         | 557/5000 [1:26:51<13:28:55, 10.92s/it]------------------ Training Record ------------------
Epoch: 557/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3248, reward_valid_std=2.2732
[BatchDiag] adv_mean=-0.1456, adv_std=0.8557, adv_abs_mean=0.6439 | ret_mean=6.8406, ret_std=1.6929 | val_mean=6.9863, val_std=1.4612 | explained_var=0.744515
[GradSplit pre-clip] backbone=0.707346, critic=1.152981
[Loss] pg_loss=-0.006256, entropy_loss=0.000112, value_loss=0.038713
[EpochKL] epoch=0 mean_kl=0.00340 max_kl=0.00536
[EpochKL] epoch=1 mean_kl=0.00534 max_kl=0.00843
[EpochKL] epoch=2 mean_kl=0.00706 max_kl=0.01244
[Time] Env Create Time: 2.8376s |Rollout Collect Time: 3.4685s |Loss & Update :1.8752
[PPODiag] kl_mean=0.0053, kl_p90=0.0082, kl_max=0.0124 | clipfrac_mean=0.032, logratio_std_mean=0.104, ratio_p95_mean=1.046 | valid_ratio_mb_mean=0.786, p10=0.781, min=0.774 | pg_loss_mean=0.0018, v_loss_mean=0.1541, ent_mean=0.1048 | gn_bb_mean=1.252, gn_bb_max=1.915 | gn_v_mean=0.904, gn_v_max=1.804

 11%|█         | 558/5000 [1:27:00<12:27:49, 10.10s/it]------------------ Training Record ------------------
Epoch: 558/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.788, reward_valid_mean=0.3198, reward_valid_std=2.2666
[BatchDiag] adv_mean=-0.1488, adv_std=0.8720, adv_abs_mean=0.6579 | ret_mean=6.7859, ret_std=1.7196 | val_mean=6.9347, val_std=1.4501 | explained_var=0.742871
[GradSplit pre-clip] backbone=0.567272, critic=0.956542
[Loss] pg_loss=-0.065500, entropy_loss=0.000111, value_loss=0.040681
[EpochKL] epoch=0 mean_kl=0.00259 max_kl=0.00512
[EpochKL] epoch=1 mean_kl=0.00533 max_kl=0.00673
[EpochKL] epoch=2 mean_kl=0.00610 max_kl=0.00805
[Time] Env Create Time: 2.8441s |Rollout Collect Time: 3.4681s |Loss & Update :1.8589
[PPODiag] kl_mean=0.0047, kl_p90=0.0066, kl_max=0.0081 | clipfrac_mean=0.031, logratio_std_mean=0.098, ratio_p95_mean=1.043 | valid_ratio_mb_mean=0.788, p10=0.784, min=0.781 | pg_loss_mean=0.0016, v_loss_mean=0.1603, ent_mean=0.1090 | gn_bb_mean=1.149, gn_bb_max=1.676 | gn_v_mean=1.194, gn_v_max=2.574

 11%|█         | 559/5000 [1:27:08<11:44:48,  9.52s/it]------------------ Training Record ------------------
Epoch: 559/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3233, reward_valid_std=2.2685
[BatchDiag] adv_mean=-0.1224, adv_std=0.8516, adv_abs_mean=0.6426 | ret_mean=6.8083, ret_std=1.6987 | val_mean=6.9307, val_std=1.4965 | explained_var=0.748641
[GradSplit pre-clip] backbone=0.512631, critic=0.372845
[Loss] pg_loss=-0.099036, entropy_loss=0.000119, value_loss=0.035481
[EpochKL] epoch=0 mean_kl=0.00311 max_kl=0.00525
[EpochKL] epoch=1 mean_kl=0.00719 max_kl=0.01014
[EpochKL] epoch=2 mean_kl=0.00893 max_kl=0.01243
[Time] Env Create Time: 2.6698s |Rollout Collect Time: 3.3209s |Loss & Update :1.7910
[PPODiag] kl_mean=0.0064, kl_p90=0.0102, kl_max=0.0124 | clipfrac_mean=0.035, logratio_std_mean=0.116, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.823, p10=0.816, min=0.811 | pg_loss_mean=0.0021, v_loss_mean=0.1593, ent_mean=0.1136 | gn_bb_mean=1.276, gn_bb_max=2.306 | gn_v_mean=1.749, gn_v_max=2.974

----- Evaluation Result -----
Number of Customers: 15 Number of Charging Stations: 3
Evaluation over 1000 episodes: -5.748, Step: 20, Avg Done Step: 18.45, #CS visited: 0.37
D->C12->C1->C15->C3->C5->C2->D->C13->C4->C14->C8->D->C6->C7->C11->C10->C9->D
Eval cost : 3.9317s
-----------------------------
 11%|█         | 560/5000 [1:27:19<12:33:51, 10.19s/it]------------------ Training Record ------------------
Epoch: 560/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.823, reward_valid_mean=0.3217, reward_valid_std=2.2688
[BatchDiag] adv_mean=-0.0957, adv_std=0.8736, adv_abs_mean=0.6577 | ret_mean=6.7787, ret_std=1.7221 | val_mean=6.8744, val_std=1.5135 | explained_var=0.742636
[GradSplit pre-clip] backbone=0.451514, critic=0.624569
[Loss] pg_loss=-0.024900, entropy_loss=0.000114, value_loss=0.037174
[EpochKL] epoch=0 mean_kl=0.00488 max_kl=0.00787
[EpochKL] epoch=1 mean_kl=0.00803 max_kl=0.01064
[EpochKL] epoch=2 mean_kl=0.00910 max_kl=0.01110
[Time] Env Create Time: 2.8619s |Rollout Collect Time: 3.3264s |Loss & Update :1.8144
[PPODiag] kl_mean=0.0073, kl_p90=0.0104, kl_max=0.0111 | clipfrac_mean=0.040, logratio_std_mean=0.126, ratio_p95_mean=1.054 | valid_ratio_mb_mean=0.823, p10=0.817, min=0.814 | pg_loss_mean=0.0027, v_loss_mean=0.1639, ent_mean=0.1112 | gn_bb_mean=1.432, gn_bb_max=2.013 | gn_v_mean=1.574, gn_v_max=3.533
[AttnScore] scale=1.1896, C=10.0

 11%|█         | 561/5000 [1:27:27<11:45:12,  9.53s/it]------------------ Training Record ------------------
Epoch: 561/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3215, reward_valid_std=2.2696
[BatchDiag] adv_mean=-0.0715, adv_std=0.8624, adv_abs_mean=0.6501 | ret_mean=6.7703, ret_std=1.7174 | val_mean=6.8419, val_std=1.4987 | explained_var=0.747857
[GradSplit pre-clip] backbone=0.482891, critic=0.449292
[Loss] pg_loss=-0.071320, entropy_loss=0.000125, value_loss=0.037413
[EpochKL] epoch=0 mean_kl=0.00874 max_kl=0.01606
[EarlyStop] epoch=1 mean_kl=0.01276 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01276 max_kl=0.01901
[Time] Env Create Time: 2.8384s |Rollout Collect Time: 3.3219s |Loss & Update :1.2140
[PPODiag] kl_mean=0.0107, kl_p90=0.0173, kl_max=0.0190 | clipfrac_mean=0.046, logratio_std_mean=0.153, ratio_p95_mean=1.062 | valid_ratio_mb_mean=0.824, p10=0.819, min=0.816 | pg_loss_mean=0.0043, v_loss_mean=0.1611, ent_mean=0.1133 | gn_bb_mean=1.624, gn_bb_max=2.393 | gn_v_mean=1.416, gn_v_max=3.009

 11%|█         | 562/5000 [1:27:35<10:57:11,  8.88s/it]------------------ Training Record ------------------
Epoch: 562/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=21, valid_ratio=0.824, reward_valid_mean=0.3231, reward_valid_std=2.2687
[BatchDiag] adv_mean=-0.1054, adv_std=0.8616, adv_abs_mean=0.6533 | ret_mean=6.7788, ret_std=1.7140 | val_mean=6.8842, val_std=1.4392 | explained_var=0.747296
[GradSplit pre-clip] backbone=0.427069, critic=0.407048
[Loss] pg_loss=-0.121296, entropy_loss=0.000119, value_loss=0.034570
[EpochKL] epoch=0 mean_kl=0.00422 max_kl=0.00895
[EpochKL] epoch=1 mean_kl=0.00627 max_kl=0.00843
[EpochKL] epoch=2 mean_kl=0.00641 max_kl=0.00904
[Time] Env Create Time: 2.8539s |Rollout Collect Time: 3.3182s |Loss & Update :1.7998
[PPODiag] kl_mean=0.0056, kl_p90=0.0081, kl_max=0.0090 | clipfrac_mean=0.034, logratio_std_mean=0.109, ratio_p95_mean=1.047 | valid_ratio_mb_mean=0.824, p10=0.818, min=0.813 | pg_loss_mean=0.0020, v_loss_mean=0.1583, ent_mean=0.1132 | gn_bb_mean=1.187, gn_bb_max=1.814 | gn_v_mean=1.251, gn_v_max=2.606

 11%|█▏        | 563/5000 [1:27:43<10:36:47,  8.61s/it]------------------ Training Record ------------------
Epoch: 563/5000
Customer Numbers: 14 Charging Stations Numbers: 2
Avg Customer Visits: 14.00
Finish Rate: 51200/51200 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=22, valid_ratio=0.786, reward_valid_mean=0.3223, reward_valid_std=2.2715
[BatchDiag] adv_mean=-0.1111, adv_std=0.8674, adv_abs_mean=0.6527 | ret_mean=6.7897, ret_std=1.7202 | val_mean=6.9008, val_std=1.4697 | explained_var=0.745746
[GradSplit pre-clip] backbone=0.692537, critic=0.473462
[Loss] pg_loss=-0.086041, entropy_loss=0.000119, value_loss=0.035081
[EpochKL] epoch=0 mean_kl=0.00222 max_kl=0.00380
[EpochKL] epoch=1 mean_kl=0.00799 max_kl=0.01373
[EpochKL] epoch=2 mean_kl=0.00863 max_kl=0.01059
[Time] Env Create Time: 2.6682s |Rollout Collect Time: 3.4827s |Loss & Update :1.8660
[PPODiag] kl_mean=0.0063, kl_p90=0.0106, kl_max=0.0137 | clipfrac_mean=0.035, logratio_std_mean=0.112, ratio_p95_mean=1.052 | valid_ratio_mb_mean=0.786, p10=0.780, min=0.777 | pg_loss_mean=0.0022, v_loss_mean=0.1609, ent_mean=0.1101 | gn_bb_mean=1.327, gn_bb_max=2.290 | gn_v_mean=1.447, gn_v_max=3.341

 11%|█▏        | 564/5000 [1:27:51<10:23:28,  8.43s/it]