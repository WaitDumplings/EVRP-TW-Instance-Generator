nohup: ignoring input
---------------- Training Info ---------------------
exp_name DRL_train
seed 1234
cuda_id 2
torch_deterministic True
cuda True
track False
wandb_project_name cleanRL
wandb_entity None
capture_video False
problem evrptw
env_id evrptw-v0
env_entry_point evrptw_gen.benchmarks.DRL_Solver.envs.evrp_vector_env:EVRPTWVectorEnv
total_timesteps 500000000
learning_rate 3e-05
critic_lr 3e-05
weight_decay 1e-05
num_envs 1024
num_steps 20
anneal_lr True
gamma 0.99
gae_lambda 0.95
num_minibatches 8
update_epochs 3
tanh_clipping 10.0
n_encode_layers 3
norm_adv True
clip_coef 0.2
clip_vloss True
ent_coef 0.001
vf_coef 0.5
max_grad_norm_backbone 2.0
max_grad_norm_critic 10.0
target_kl 0.01
n_traj 100
n_test None
test_sample_mode greedy
multi_greedy_inference True
test_agent 1
use_graph_token True
lambda_fail_init 10.0
target_success 0.95
lambda_lr 1.0
lambda_max 50.0
lambda_lr_up 1.0
lambda_lr_down 2.0
lambda_tolerance 0.05
env_mode train
accum_steps 1
save_dir ./checkpoint
eval_batch_size 1000
eval_data_path ./eval/Cus_5/pickle/evrptw_5C_2R.pkl
config_path ./evrptw_gen/configs/config.yaml
----------------------------------------------------
  0%|          | 0/5000 [00:00<?, ?it/s]/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:175: UserWarning: [33mWARN: Future gym versions will require that `Env.reset` can be passed a `seed` instead of using `Env.seed` for resetting the environment random number generator.[0m
  logger.warn(
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:188: UserWarning: [33mWARN: Future gym versions will require that `Env.reset` can be passed `options` to allow the environment initialisation to be passed additional information.[0m
  logger.warn(
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:196: UserWarning: [33mWARN: The result returned by `env.reset()` was not a tuple of the form `(obs, info)`, where `obs` is a observation and `info` is a dictionary containing additional information. Actual type: `<class 'dict'>`[0m
  logger.warn(
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:220: DeprecationWarning: [33mWARN: Core environment is written in old step API which returns one bool instead of two. It is recommended to rewrite the environment with new step API. [0m
  logger.deprecation(
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:226: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  if not isinstance(done, (bool, np.bool8)):
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:227: UserWarning: [33mWARN: Expects `done` signal to be a boolean, actual type: <class 'numpy.ndarray'>[0m
  logger.warn(
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:142: UserWarning: [33mWARN: The obs returned by the `step()` method was expecting numpy array dtype to be float32, actual type: float64[0m
  logger.warn(
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:166: UserWarning: [33mWARN: The obs returned by the `step()` method is not within the observation space.[0m
  logger.warn(f"{pre} is not within the observation space.")
/home/npg/miniconda3/envs/maojie/lib/python3.11/site-packages/gym/utils/passive_env_checker.py:253: UserWarning: [33mWARN: The reward returned by `step()` must be a float, int, np.integer or np.floating, actual type: <class 'numpy.ndarray'>[0m
  logger.warn(
------------------ Training Record ------------------
Epoch: 0/5000
Customer Numbers: 5 Charging Stations Numbers: 2
Avg Customer Visits: 2.77
Finish Rate: 4602/102400 = 0.045
Current lambda_fail (before): 10.000
Updated lambda_fail: 10.905
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.997, reward_valid_mean=-0.7030, reward_valid_std=1.1620
[BatchDiag] adv_mean=-6.1723, adv_std=2.4550, adv_abs_mean=6.3078 | ret_mean=-6.1723, ret_std=2.4550 | val_mean=0.0000, val_std=0.0000 | explained_var=-0.000000
[GradSplit pre-clip] backbone=6.646849, critic=0.243743
[Loss] pg_loss=0.094979, entropy_loss=0.000922, value_loss=1.345792
[EarlyStop] epoch=0 mean_kl=0.16053 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.16053 max_kl=0.60740
[Time] Env Create Time: 5.1490s |Rollout Collect Time: 5.7417s |Loss & Update :1.1959
[PPODiag] kl_mean=0.1605, kl_p90=0.5117, kl_max=0.6074 | clipfrac_mean=0.378, logratio_std_mean=0.386, ratio_p95_mean=2.131 | valid_ratio_mb_mean=0.997, p10=0.997, min=0.997 | pg_loss_mean=0.0517, v_loss_mean=2.9041, ent_mean=1.0695 | gn_bb_mean=7.242, gn_bb_max=10.903 | gn_v_mean=0.243, gn_v_max=0.244
[AttnScore] scale=0.9998, C=10.0

  0%|          | 1/5000 [00:12<16:47:03, 12.09s/it]------------------ Training Record ------------------
Epoch: 1/5000
Customer Numbers: 5 Charging Stations Numbers: 2
Avg Customer Visits: 3.79
Finish Rate: 22530/102400 = 0.220
Current lambda_fail (before): 10.905
Updated lambda_fail: 11.635
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.983, reward_valid_mean=-0.5490, reward_valid_std=1.1387
[BatchDiag] adv_mean=-4.3964, adv_std=3.5481, adv_abs_mean=5.2325 | ret_mean=-4.3980, ret_std=3.5481 | val_mean=-0.0016, val_std=0.0000 | explained_var=0.000003
[GradSplit pre-clip] backbone=6.520734, critic=0.206496
[Loss] pg_loss=0.058618, entropy_loss=0.001111, value_loss=1.096749
[EarlyStop] epoch=0 mean_kl=0.06951 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.06951 max_kl=0.15312
[Time] Env Create Time: 4.8641s |Rollout Collect Time: 5.6506s |Loss & Update :0.9735
[PPODiag] kl_mean=0.0695, kl_p90=0.1396, kl_max=0.1531 | clipfrac_mean=0.422, logratio_std_mean=0.319, ratio_p95_mean=1.774 | valid_ratio_mb_mean=0.983, p10=0.982, min=0.981 | pg_loss_mean=0.0163, v_loss_mean=2.3686, ent_mean=1.1934 | gn_bb_mean=6.890, gn_bb_max=8.722 | gn_v_mean=0.206, gn_v_max=0.209

  0%|          | 2/5000 [00:23<16:17:31, 11.74s/it]------------------ Training Record ------------------
Epoch: 2/5000
Customer Numbers: 5 Charging Stations Numbers: 2
Avg Customer Visits: 3.61
Finish Rate: 17956/102400 = 0.175
Current lambda_fail (before): 11.635
Updated lambda_fail: 12.410
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.985, reward_valid_mean=-0.5889, reward_valid_std=1.1972
[BatchDiag] adv_mean=-4.8596, adv_std=3.5160, adv_abs_mean=5.5903 | ret_mean=-4.8636, ret_std=3.5160 | val_mean=-0.0040, val_std=0.0000 | explained_var=0.000002
[GradSplit pre-clip] backbone=6.602467, critic=0.219083
[Loss] pg_loss=0.062952, entropy_loss=0.001067, value_loss=1.177548
[EarlyStop] epoch=0 mean_kl=0.01960 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01960 max_kl=0.04716
[Time] Env Create Time: 4.8363s |Rollout Collect Time: 5.6633s |Loss & Update :0.9639
[PPODiag] kl_mean=0.0196, kl_p90=0.0425, kl_max=0.0472 | clipfrac_mean=0.303, logratio_std_mean=0.172, ratio_p95_mean=1.339 | valid_ratio_mb_mean=0.985, p10=0.984, min=0.984 | pg_loss_mean=-0.0044, v_loss_mean=2.5468, ent_mean=1.1400 | gn_bb_mean=6.770, gn_bb_max=9.036 | gn_v_mean=0.221, gn_v_max=0.227

  0%|          | 3/5000 [00:35<16:07:01, 11.61s/it]------------------ Training Record ------------------
Epoch: 3/5000
Customer Numbers: 5 Charging Stations Numbers: 2
Avg Customer Visits: 3.97
Finish Rate: 31460/102400 = 0.307
Current lambda_fail (before): 12.410
Updated lambda_fail: 13.052
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.967, reward_valid_mean=-0.4940, reward_valid_std=1.3516
[BatchDiag] adv_mean=-3.7821, adv_std=4.2633, adv_abs_mean=5.2157 | ret_mean=-3.7896, ret_std=4.2634 | val_mean=-0.0075, val_std=0.0000 | explained_var=0.000003
[GradSplit pre-clip] backbone=7.583237, critic=0.184052
[Loss] pg_loss=0.024512, entropy_loss=0.001052, value_loss=1.080694
[EarlyStop] epoch=0 mean_kl=0.01669 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01669 max_kl=0.04233
[Time] Env Create Time: 4.8262s |Rollout Collect Time: 5.6678s |Loss & Update :0.9703
[PPODiag] kl_mean=0.0167, kl_p90=0.0381, kl_max=0.0423 | clipfrac_mean=0.253, logratio_std_mean=0.155, ratio_p95_mean=1.313 | valid_ratio_mb_mean=0.967, p10=0.965, min=0.965 | pg_loss_mean=-0.0122, v_loss_mean=2.3612, ent_mean=1.1227 | gn_bb_mean=5.677, gn_bb_max=8.522 | gn_v_mean=0.190, gn_v_max=0.198

  0%|          | 4/5000 [00:46<16:02:01, 11.55s/it]------------------ Training Record ------------------
Epoch: 4/5000
Customer Numbers: 5 Charging Stations Numbers: 2
Avg Customer Visits: 4.52
Finish Rate: 62225/102400 = 0.608
Current lambda_fail (before): 13.052
Updated lambda_fail: 13.395
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.903, reward_valid_mean=-0.2543, reward_valid_std=1.7728
[BatchDiag] adv_mean=-1.1042, adv_std=5.1235, adv_abs_mean=4.5996 | ret_mean=-1.1166, ret_std=5.1235 | val_mean=-0.0124, val_std=0.0000 | explained_var=0.000003
[GradSplit pre-clip] backbone=8.715909, critic=0.072214
[Loss] pg_loss=0.034223, entropy_loss=0.001027, value_loss=0.940536
[EarlyStop] epoch=0 mean_kl=0.01476 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01476 max_kl=0.03573
[Time] Env Create Time: 4.8398s |Rollout Collect Time: 5.7348s |Loss & Update :0.9572
[PPODiag] kl_mean=0.0148, kl_p90=0.0356, kl_max=0.0357 | clipfrac_mean=0.250, logratio_std_mean=0.147, ratio_p95_mean=1.258 | valid_ratio_mb_mean=0.903, p10=0.901, min=0.900 | pg_loss_mean=-0.0092, v_loss_mean=2.0577, ent_mean=1.0483 | gn_bb_mean=7.131, gn_bb_max=8.877 | gn_v_mean=0.069, gn_v_max=0.075

  0%|          | 5/5000 [00:58<16:01:11, 11.55s/it]------------------ Training Record ------------------
Epoch: 5/5000
Customer Numbers: 5 Charging Stations Numbers: 2
Avg Customer Visits: 4.73
Finish Rate: 78164/102400 = 0.763
Current lambda_fail (before): 13.395
Updated lambda_fail: 13.581
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.850, reward_valid_mean=-0.1025, reward_valid_std=2.0318
[BatchDiag] adv_mean=0.5289, adv_std=5.1150, adv_abs_mean=4.4099 | ret_mean=0.5113, ret_std=5.1150 | val_mean=-0.0175, val_std=0.0000 | explained_var=0.000004
[GradSplit pre-clip] backbone=9.227278, critic=0.014826
[Loss] pg_loss=0.033150, entropy_loss=0.000949, value_loss=0.888589
[EarlyStop] epoch=0 mean_kl=0.01415 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01415 max_kl=0.03123
[Time] Env Create Time: 4.8505s |Rollout Collect Time: 5.7275s |Loss & Update :0.9793
[PPODiag] kl_mean=0.0142, kl_p90=0.0303, kl_max=0.0312 | clipfrac_mean=0.231, logratio_std_mean=0.149, ratio_p95_mean=1.268 | valid_ratio_mb_mean=0.850, p10=0.847, min=0.845 | pg_loss_mean=-0.0181, v_loss_mean=1.9651, ent_mean=0.9738 | gn_bb_mean=5.430, gn_bb_max=9.227 | gn_v_mean=0.023, gn_v_max=0.030
[AttnScore] scale=0.9995, C=10.0

  0%|          | 6/5000 [01:09<16:01:20, 11.55s/it]------------------ Training Record ------------------
Epoch: 6/5000
Customer Numbers: 5 Charging Stations Numbers: 2
Avg Customer Visits: 4.96
Finish Rate: 98723/102400 = 0.964
Current lambda_fail (before): 13.581
Updated lambda_fail: 13.581
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.705, reward_valid_mean=0.2058, reward_valid_std=2.5017
[BatchDiag] adv_mean=3.5148, adv_std=3.9749, adv_abs_mean=4.4871 | ret_mean=3.4943, ret_std=3.9749 | val_mean=-0.0205, val_std=0.0001 | explained_var=0.000010
[GradSplit pre-clip] backbone=8.660116, critic=0.203986
[Loss] pg_loss=0.024969, entropy_loss=0.000806, value_loss=0.886306
[EarlyStop] epoch=0 mean_kl=0.01358 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01358 max_kl=0.03534
[Time] Env Create Time: 5.0421s |Rollout Collect Time: 5.7050s |Loss & Update :0.9660
[PPODiag] kl_mean=0.0136, kl_p90=0.0348, kl_max=0.0353 | clipfrac_mean=0.247, logratio_std_mean=0.135, ratio_p95_mean=1.193 | valid_ratio_mb_mean=0.705, p10=0.702, min=0.700 | pg_loss_mean=-0.0099, v_loss_mean=2.0036, ent_mean=0.8055 | gn_bb_mean=7.053, gn_bb_max=8.660 | gn_v_mean=0.208, gn_v_max=0.213

  0%|          | 7/5000 [01:21<16:05:35, 11.60s/it]------------------ Training Record ------------------
Epoch: 7/5000
Customer Numbers: 5 Charging Stations Numbers: 2
Avg Customer Visits: 4.99
Finish Rate: 101248/102400 = 0.989
Current lambda_fail (before): 13.581
Updated lambda_fail: 13.581
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.650, reward_valid_mean=0.2997, reward_valid_std=2.6365
[BatchDiag] adv_mean=4.2446, adv_std=3.4602, adv_abs_mean=4.6868 | ret_mean=4.2279, ret_std=3.4604 | val_mean=-0.0166, val_std=0.0004 | explained_var=0.000070
[GradSplit pre-clip] backbone=8.135132, critic=0.237367
[Loss] pg_loss=0.030226, entropy_loss=0.000725, value_loss=0.928684
[EarlyStop] epoch=0 mean_kl=0.01588 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01588 max_kl=0.03949
[Time] Env Create Time: 4.6697s |Rollout Collect Time: 5.7126s |Loss & Update :0.9614
[PPODiag] kl_mean=0.0159, kl_p90=0.0366, kl_max=0.0395 | clipfrac_mean=0.267, logratio_std_mean=0.155, ratio_p95_mean=1.228 | valid_ratio_mb_mean=0.650, p10=0.647, min=0.647 | pg_loss_mean=-0.0127, v_loss_mean=2.1005, ent_mean=0.7114 | gn_bb_mean=7.109, gn_bb_max=8.722 | gn_v_mean=0.226, gn_v_max=0.237

  0%|          | 8/5000 [01:32<15:58:32, 11.52s/it]------------------ Training Record ------------------
Epoch: 8/5000
Customer Numbers: 5 Charging Stations Numbers: 2
Avg Customer Visits: 5.00
Finish Rate: 102317/102400 = 0.999
Current lambda_fail (before): 13.581
Updated lambda_fail: 13.581
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.573, reward_valid_mean=0.4303, reward_valid_std=2.8079
[BatchDiag] adv_mean=5.0304, adv_std=2.8891, adv_abs_mean=5.1208 | ret_mean=5.0248, ret_std=2.8895 | val_mean=-0.0056, val_std=0.0008 | explained_var=0.000220
[GradSplit pre-clip] backbone=7.119567, critic=0.237413
[Loss] pg_loss=0.031639, entropy_loss=0.000618, value_loss=1.017817
[EarlyStop] epoch=0 mean_kl=0.01284 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01284 max_kl=0.03125
[Time] Env Create Time: 5.0701s |Rollout Collect Time: 5.6346s |Loss & Update :0.9566
[PPODiag] kl_mean=0.0128, kl_p90=0.0307, kl_max=0.0312 | clipfrac_mean=0.208, logratio_std_mean=0.140, ratio_p95_mean=1.193 | valid_ratio_mb_mean=0.573, p10=0.570, min=0.570 | pg_loss_mean=-0.0094, v_loss_mean=2.3138, ent_mean=0.5986 | gn_bb_mean=5.881, gn_bb_max=7.813 | gn_v_mean=0.234, gn_v_max=0.237

  0%|          | 9/5000 [01:44<16:02:00, 11.56s/it]------------------ Training Record ------------------
Epoch: 9/5000
Customer Numbers: 5 Charging Stations Numbers: 2
Avg Customer Visits: 5.00
Finish Rate: 102394/102400 = 1.000
Current lambda_fail (before): 13.581
Updated lambda_fail: 13.581
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.535, reward_valid_mean=0.4994, reward_valid_std=2.8975
[BatchDiag] adv_mean=5.3595, adv_std=2.6765, adv_abs_mean=5.3886 | ret_mean=5.3629, ret_std=2.6767 | val_mean=0.0034, val_std=0.0004 | explained_var=0.000113
[GradSplit pre-clip] backbone=6.142788, critic=0.246457
[Loss] pg_loss=0.024822, entropy_loss=0.000555, value_loss=1.081958
[EarlyStop] epoch=0 mean_kl=0.01540 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01540 max_kl=0.03090
[Time] Env Create Time: 4.6642s |Rollout Collect Time: 5.5886s |Loss & Update :0.9628
[PPODiag] kl_mean=0.0154, kl_p90=0.0270, kl_max=0.0309 | clipfrac_mean=0.215, logratio_std_mean=0.165, ratio_p95_mean=1.203 | valid_ratio_mb_mean=0.535, p10=0.532, min=0.531 | pg_loss_mean=-0.0120, v_loss_mean=2.4465, ent_mean=0.5325 | gn_bb_mean=4.241, gn_bb_max=6.356 | gn_v_mean=0.260, gn_v_max=0.275

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -4.494, Step: 14, Avg Done Step: 9.16, #CS visited: 2.08
D->R->C5->C4->C1->R->C3->D->R->C2->D
Eval cost : 3.0363s
-----------------------------
  0%|          | 10/5000 [01:58<17:15:43, 12.45s/it]------------------ Training Record ------------------
Epoch: 10/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102398/102400 = 1.000
Current lambda_fail (before): 13.581
Updated lambda_fail: 13.581
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.287, reward_valid_mean=1.3508, reward_valid_std=3.7431
[BatchDiag] adv_mean=7.3689, adv_std=1.6254, adv_abs_mean=7.3695 | ret_mean=7.3785, ret_std=1.6254 | val_mean=0.0096, val_std=0.0001 | explained_var=0.000069
[GradSplit pre-clip] backbone=6.181507, critic=0.290632
[Loss] pg_loss=-0.016526, entropy_loss=0.000179, value_loss=1.541937
[EarlyStop] epoch=0 mean_kl=0.01705 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01705 max_kl=0.03692
[Time] Env Create Time: 4.3806s |Rollout Collect Time: 5.1500s |Loss & Update :0.9012
[PPODiag] kl_mean=0.0170, kl_p90=0.0353, kl_max=0.0369 | clipfrac_mean=0.157, logratio_std_mean=0.173, ratio_p95_mean=1.190 | valid_ratio_mb_mean=0.287, p10=0.286, min=0.286 | pg_loss_mean=-0.0073, v_loss_mean=3.4332, ent_mean=0.1681 | gn_bb_mean=4.198, gn_bb_max=6.182 | gn_v_mean=0.309, gn_v_max=0.329
[AttnScore] scale=0.9994, C=10.0

  0%|          | 11/5000 [02:09<16:24:04, 11.83s/it]------------------ Training Record ------------------
Epoch: 11/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102399/102400 = 1.000
Current lambda_fail (before): 13.581
Updated lambda_fail: 13.581
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.283, reward_valid_mean=1.3754, reward_valid_std=3.7598
[BatchDiag] adv_mean=7.4003, adv_std=1.6022, adv_abs_mean=7.4011 | ret_mean=7.4178, ret_std=1.6022 | val_mean=0.0175, val_std=0.0001 | explained_var=-0.000011
[GradSplit pre-clip] backbone=5.409240, critic=0.334434
[Loss] pg_loss=-0.008775, entropy_loss=0.000165, value_loss=1.546097
[EarlyStop] epoch=0 mean_kl=0.01359 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01359 max_kl=0.03205
[Time] Env Create Time: 4.3723s |Rollout Collect Time: 5.1554s |Loss & Update :0.9088
[PPODiag] kl_mean=0.0136, kl_p90=0.0301, kl_max=0.0321 | clipfrac_mean=0.157, logratio_std_mean=0.149, ratio_p95_mean=1.187 | valid_ratio_mb_mean=0.283, p10=0.282, min=0.281 | pg_loss_mean=-0.0058, v_loss_mean=3.4484, ent_mean=0.1581 | gn_bb_mean=4.155, gn_bb_max=5.409 | gn_v_mean=0.355, gn_v_max=0.377

  0%|          | 12/5000 [02:19<15:48:31, 11.41s/it]------------------ Training Record ------------------
Epoch: 12/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 13.581
Updated lambda_fail: 13.481
----------------------------------------------------
[RolloutDiag] valid_step=11, valid_ratio=0.511, reward_valid_mean=1.3883, reward_valid_std=3.7710
[BatchDiag] adv_mean=7.4063, adv_std=1.5875, adv_abs_mean=7.4063 | ret_mean=7.4344, ret_std=1.5875 | val_mean=0.0281, val_std=0.0001 | explained_var=-0.000003
[GradSplit pre-clip] backbone=5.026487, critic=0.383716
[Loss] pg_loss=-0.012492, entropy_loss=0.000282, value_loss=1.548739
[EarlyStop] epoch=0 mean_kl=0.01217 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01217 max_kl=0.03005
[Time] Env Create Time: 4.3873s |Rollout Collect Time: 2.9946s |Loss & Update :0.5492
[PPODiag] kl_mean=0.0122, kl_p90=0.0283, kl_max=0.0300 | clipfrac_mean=0.156, logratio_std_mean=0.136, ratio_p95_mean=1.194 | valid_ratio_mb_mean=0.511, p10=0.509, min=0.509 | pg_loss_mean=-0.0049, v_loss_mean=3.4503, ent_mean=0.2773 | gn_bb_mean=4.264, gn_bb_max=5.026 | gn_v_mean=0.408, gn_v_max=0.433

  0%|          | 13/5000 [02:27<14:20:45, 10.36s/it]------------------ Training Record ------------------
Epoch: 13/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 13.481
Updated lambda_fail: 13.381
----------------------------------------------------
[RolloutDiag] valid_step=11, valid_ratio=0.507, reward_valid_mean=1.4021, reward_valid_std=3.7800
[BatchDiag] adv_mean=7.4115, adv_std=1.5792, adv_abs_mean=7.4115 | ret_mean=7.4537, ret_std=1.5793 | val_mean=0.0422, val_std=0.0001 | explained_var=0.000016
[GradSplit pre-clip] backbone=4.600781, critic=0.440868
[Loss] pg_loss=-0.009449, entropy_loss=0.000271, value_loss=1.548796
[EarlyStop] epoch=0 mean_kl=0.01179 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01179 max_kl=0.02974
[Time] Env Create Time: 4.3700s |Rollout Collect Time: 3.0079s |Loss & Update :0.5694
[PPODiag] kl_mean=0.0118, kl_p90=0.0277, kl_max=0.0297 | clipfrac_mean=0.152, logratio_std_mean=0.130, ratio_p95_mean=1.202 | valid_ratio_mb_mean=0.507, p10=0.505, min=0.504 | pg_loss_mean=-0.0046, v_loss_mean=3.4520, ent_mean=0.2690 | gn_bb_mean=4.221, gn_bb_max=4.681 | gn_v_mean=0.469, gn_v_max=0.498

  0%|          | 14/5000 [02:35<13:20:08,  9.63s/it]------------------ Training Record ------------------
Epoch: 14/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 13.381
Updated lambda_fail: 13.281
----------------------------------------------------
[RolloutDiag] valid_step=11, valid_ratio=0.504, reward_valid_mean=1.4211, reward_valid_std=3.7920
[BatchDiag] adv_mean=7.4330, adv_std=1.5637, adv_abs_mean=7.4330 | ret_mean=7.4930, ret_std=1.5637 | val_mean=0.0601, val_std=0.0001 | explained_var=0.000003
[GradSplit pre-clip] backbone=4.602351, critic=0.506462
[Loss] pg_loss=-0.009995, entropy_loss=0.000264, value_loss=1.553753
[EarlyStop] epoch=0 mean_kl=0.01159 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01159 max_kl=0.02940
[Time] Env Create Time: 4.3819s |Rollout Collect Time: 3.0294s |Loss & Update :0.5438
[PPODiag] kl_mean=0.0116, kl_p90=0.0275, kl_max=0.0294 | clipfrac_mean=0.150, logratio_std_mean=0.127, ratio_p95_mean=1.208 | valid_ratio_mb_mean=0.504, p10=0.502, min=0.501 | pg_loss_mean=-0.0044, v_loss_mean=3.4619, ent_mean=0.2630 | gn_bb_mean=4.266, gn_bb_max=4.716 | gn_v_mean=0.537, gn_v_max=0.569

  0%|          | 15/5000 [02:43<12:38:04,  9.12s/it]------------------ Training Record ------------------
Epoch: 15/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 13.281
Updated lambda_fail: 13.181
----------------------------------------------------
[RolloutDiag] valid_step=11, valid_ratio=0.501, reward_valid_mean=1.4311, reward_valid_std=3.8003
[BatchDiag] adv_mean=7.4215, adv_std=1.5529, adv_abs_mean=7.4215 | ret_mean=7.5032, ret_std=1.5529 | val_mean=0.0817, val_std=0.0000 | explained_var=-0.000002
[GradSplit pre-clip] backbone=4.597608, critic=0.578583
[Loss] pg_loss=-0.000153, entropy_loss=0.000258, value_loss=1.547748
[EarlyStop] epoch=0 mean_kl=0.01193 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01193 max_kl=0.03041
[Time] Env Create Time: 4.5888s |Rollout Collect Time: 2.9860s |Loss & Update :0.5605
[PPODiag] kl_mean=0.0119, kl_p90=0.0285, kl_max=0.0304 | clipfrac_mean=0.149, logratio_std_mean=0.128, ratio_p95_mean=1.216 | valid_ratio_mb_mean=0.501, p10=0.499, min=0.496 | pg_loss_mean=-0.0044, v_loss_mean=3.4554, ent_mean=0.2580 | gn_bb_mean=4.333, gn_bb_max=4.831 | gn_v_mean=0.612, gn_v_max=0.647
[AttnScore] scale=0.9996, C=10.0

  0%|          | 16/5000 [02:51<12:13:12,  8.83s/it]------------------ Training Record ------------------
Epoch: 16/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 13.181
Updated lambda_fail: 13.081
----------------------------------------------------
[RolloutDiag] valid_step=11, valid_ratio=0.498, reward_valid_mean=1.4429, reward_valid_std=3.8071
[BatchDiag] adv_mean=7.4127, adv_std=1.5440, adv_abs_mean=7.4127 | ret_mean=7.5200, ret_std=1.5440 | val_mean=0.1073, val_std=0.0001 | explained_var=-0.000003
[GradSplit pre-clip] backbone=4.655090, critic=0.656975
[Loss] pg_loss=-0.012222, entropy_loss=0.000252, value_loss=1.549943
[EarlyStop] epoch=0 mean_kl=0.01231 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01231 max_kl=0.03159
[Time] Env Create Time: 4.3866s |Rollout Collect Time: 2.9861s |Loss & Update :0.5519
[PPODiag] kl_mean=0.0123, kl_p90=0.0294, kl_max=0.0316 | clipfrac_mean=0.148, logratio_std_mean=0.130, ratio_p95_mean=1.221 | valid_ratio_mb_mean=0.498, p10=0.496, min=0.495 | pg_loss_mean=-0.0047, v_loss_mean=3.4501, ent_mean=0.2532 | gn_bb_mean=4.318, gn_bb_max=4.745 | gn_v_mean=0.693, gn_v_max=0.730

  0%|          | 17/5000 [02:59<11:50:32,  8.56s/it]------------------ Training Record ------------------
Epoch: 17/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 13.081
Updated lambda_fail: 12.981
----------------------------------------------------
[RolloutDiag] valid_step=10, valid_ratio=0.543, reward_valid_mean=1.4605, reward_valid_std=3.8181
[BatchDiag] adv_mean=7.4094, adv_std=1.5280, adv_abs_mean=7.4094 | ret_mean=7.5462, ret_std=1.5280 | val_mean=0.1368, val_std=0.0001 | explained_var=-0.000009
[GradSplit pre-clip] backbone=4.335533, critic=0.740954
[Loss] pg_loss=-0.011702, entropy_loss=0.000273, value_loss=1.548981
[EarlyStop] epoch=0 mean_kl=0.01301 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01301 max_kl=0.03337
[Time] Env Create Time: 4.3965s |Rollout Collect Time: 2.7341s |Loss & Update :0.5082
[PPODiag] kl_mean=0.0130, kl_p90=0.0311, kl_max=0.0334 | clipfrac_mean=0.146, logratio_std_mean=0.134, ratio_p95_mean=1.229 | valid_ratio_mb_mean=0.543, p10=0.540, min=0.539 | pg_loss_mean=-0.0045, v_loss_mean=3.4476, ent_mean=0.2735 | gn_bb_mean=4.357, gn_bb_max=4.987 | gn_v_mean=0.780, gn_v_max=0.819

  0%|          | 18/5000 [03:07<11:27:32,  8.28s/it]------------------ Training Record ------------------
Epoch: 18/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 12.981
Updated lambda_fail: 12.881
----------------------------------------------------
[RolloutDiag] valid_step=10, valid_ratio=0.538, reward_valid_mean=1.4769, reward_valid_std=3.8298
[BatchDiag] adv_mean=7.3985, adv_std=1.5137, adv_abs_mean=7.3985 | ret_mean=7.5688, ret_std=1.5137 | val_mean=0.1703, val_std=0.0001 | explained_var=-0.000014
[GradSplit pre-clip] backbone=4.597762, critic=0.830085
[Loss] pg_loss=-0.033265, entropy_loss=0.000266, value_loss=1.553813
[EarlyStop] epoch=0 mean_kl=0.01409 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01409 max_kl=0.03597
[Time] Env Create Time: 4.3965s |Rollout Collect Time: 2.7721s |Loss & Update :0.5292
[PPODiag] kl_mean=0.0141, kl_p90=0.0336, kl_max=0.0360 | clipfrac_mean=0.145, logratio_std_mean=0.140, ratio_p95_mean=1.238 | valid_ratio_mb_mean=0.538, p10=0.536, min=0.536 | pg_loss_mean=-0.0045, v_loss_mean=3.4413, ent_mean=0.2672 | gn_bb_mean=4.255, gn_bb_max=4.951 | gn_v_mean=0.871, gn_v_max=0.912

  0%|          | 19/5000 [03:14<11:12:53,  8.11s/it]------------------ Training Record ------------------
Epoch: 19/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 12.881
Updated lambda_fail: 12.781
----------------------------------------------------
[RolloutDiag] valid_step=11, valid_ratio=0.484, reward_valid_mean=1.4949, reward_valid_std=3.8412
[BatchDiag] adv_mean=7.3835, adv_std=1.5033, adv_abs_mean=7.3835 | ret_mean=7.5914, ret_std=1.5033 | val_mean=0.2078, val_std=0.0001 | explained_var=-0.000017
[GradSplit pre-clip] backbone=4.871599, critic=0.923971
[Loss] pg_loss=-0.024732, entropy_loss=0.000237, value_loss=1.547516
[EarlyStop] epoch=0 mean_kl=0.01470 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01470 max_kl=0.03750
[Time] Env Create Time: 4.3846s |Rollout Collect Time: 2.9755s |Loss & Update :0.5609
[PPODiag] kl_mean=0.0147, kl_p90=0.0350, kl_max=0.0375 | clipfrac_mean=0.142, logratio_std_mean=0.144, ratio_p95_mean=1.243 | valid_ratio_mb_mean=0.484, p10=0.482, min=0.482 | pg_loss_mean=-0.0043, v_loss_mean=3.4329, ent_mean=0.2370 | gn_bb_mean=4.331, gn_bb_max=4.951 | gn_v_mean=0.967, gn_v_max=1.010

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.984, Step: 11, Avg Done Step: 7.95, #CS visited: 1.44
D->R->C5->C4->C1->R->C3->D->R->C2->D
Eval cost : 2.3338s
-----------------------------
  0%|          | 20/5000 [03:25<12:07:35,  8.77s/it]------------------ Training Record ------------------
Epoch: 20/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 12.781
Updated lambda_fail: 12.681
----------------------------------------------------
[RolloutDiag] valid_step=10, valid_ratio=0.529, reward_valid_mean=1.5117, reward_valid_std=3.8538
[BatchDiag] adv_mean=7.3673, adv_std=1.4920, adv_abs_mean=7.3673 | ret_mean=7.6167, ret_std=1.4920 | val_mean=0.2494, val_std=0.0001 | explained_var=-0.000021
[GradSplit pre-clip] backbone=4.683845, critic=1.022328
[Loss] pg_loss=-0.019524, entropy_loss=0.000255, value_loss=1.542084
[EarlyStop] epoch=0 mean_kl=0.01543 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01543 max_kl=0.03925
[Time] Env Create Time: 4.3796s |Rollout Collect Time: 2.7532s |Loss & Update :0.5176
[PPODiag] kl_mean=0.0154, kl_p90=0.0369, kl_max=0.0392 | clipfrac_mean=0.141, logratio_std_mean=0.147, ratio_p95_mean=1.249 | valid_ratio_mb_mean=0.529, p10=0.525, min=0.523 | pg_loss_mean=-0.0041, v_loss_mean=3.4240, ent_mean=0.2541 | gn_bb_mean=4.228, gn_bb_max=4.939 | gn_v_mean=1.067, gn_v_max=1.112
[AttnScore] scale=1.0004, C=10.0

  0%|          | 21/5000 [03:32<11:39:45,  8.43s/it]------------------ Training Record ------------------
Epoch: 21/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 12.681
Updated lambda_fail: 12.581
----------------------------------------------------
[RolloutDiag] valid_step=9, valid_ratio=0.582, reward_valid_mean=1.5302, reward_valid_std=3.8647
[BatchDiag] adv_mean=7.3480, adv_std=1.4716, adv_abs_mean=7.3480 | ret_mean=7.6431, ret_std=1.4716 | val_mean=0.2951, val_std=0.0001 | explained_var=-0.000025
[GradSplit pre-clip] backbone=4.767397, critic=1.124833
[Loss] pg_loss=-0.024653, entropy_loss=0.000274, value_loss=1.539369
[EarlyStop] epoch=0 mean_kl=0.01620 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01620 max_kl=0.04116
[Time] Env Create Time: 4.3543s |Rollout Collect Time: 2.5039s |Loss & Update :0.4895
[PPODiag] kl_mean=0.0162, kl_p90=0.0388, kl_max=0.0412 | clipfrac_mean=0.138, logratio_std_mean=0.151, ratio_p95_mean=1.256 | valid_ratio_mb_mean=0.582, p10=0.579, min=0.576 | pg_loss_mean=-0.0036, v_loss_mean=3.4134, ent_mean=0.2742 | gn_bb_mean=4.184, gn_bb_max=5.078 | gn_v_mean=1.171, gn_v_max=1.218

  0%|          | 22/5000 [03:40<11:12:37,  8.11s/it]------------------ Training Record ------------------
Epoch: 22/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 12.581
Updated lambda_fail: 12.481
----------------------------------------------------
[RolloutDiag] valid_step=11, valid_ratio=0.472, reward_valid_mean=1.5521, reward_valid_std=3.8759
[BatchDiag] adv_mean=7.3410, adv_std=1.4469, adv_abs_mean=7.3410 | ret_mean=7.6859, ret_std=1.4469 | val_mean=0.3449, val_std=0.0001 | explained_var=-0.000027
[GradSplit pre-clip] backbone=4.930126, critic=1.231222
[Loss] pg_loss=-0.037910, entropy_loss=0.000218, value_loss=1.541968
[EarlyStop] epoch=0 mean_kl=0.01677 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01677 max_kl=0.04369
[Time] Env Create Time: 4.5831s |Rollout Collect Time: 2.9748s |Loss & Update :0.5638
[PPODiag] kl_mean=0.0168, kl_p90=0.0402, kl_max=0.0437 | clipfrac_mean=0.137, logratio_std_mean=0.155, ratio_p95_mean=1.256 | valid_ratio_mb_mean=0.472, p10=0.469, min=0.468 | pg_loss_mean=-0.0034, v_loss_mean=3.4090, ent_mean=0.2170 | gn_bb_mean=4.189, gn_bb_max=5.474 | gn_v_mean=1.279, gn_v_max=1.327

  0%|          | 23/5000 [03:48<11:12:51,  8.11s/it]------------------ Training Record ------------------
Epoch: 23/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 12.481
Updated lambda_fail: 12.381
----------------------------------------------------
[RolloutDiag] valid_step=18, valid_ratio=0.286, reward_valid_mean=1.5712, reward_valid_std=3.8884
[BatchDiag] adv_mean=7.3120, adv_std=1.4341, adv_abs_mean=7.3122 | ret_mean=7.7107, ret_std=1.4341 | val_mean=0.3987, val_std=0.0001 | explained_var=-0.000030
[GradSplit pre-clip] backbone=4.972263, critic=1.341242
[Loss] pg_loss=-0.012911, entropy_loss=0.000129, value_loss=1.527344
[EarlyStop] epoch=0 mean_kl=0.01129 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01129 max_kl=0.03203
[Time] Env Create Time: 4.4163s |Rollout Collect Time: 4.6551s |Loss & Update :0.8471
[PPODiag] kl_mean=0.0113, kl_p90=0.0264, kl_max=0.0320 | clipfrac_mean=0.116, logratio_std_mean=0.125, ratio_p95_mean=1.204 | valid_ratio_mb_mean=0.286, p10=0.284, min=0.284 | pg_loss_mean=-0.0055, v_loss_mean=3.3937, ent_mean=0.1283 | gn_bb_mean=3.713, gn_bb_max=5.699 | gn_v_mean=1.390, gn_v_max=1.439

  0%|          | 24/5000 [03:58<11:57:41,  8.65s/it]------------------ Training Record ------------------
Epoch: 24/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 12.381
Updated lambda_fail: 12.281
----------------------------------------------------
[RolloutDiag] valid_step=10, valid_ratio=0.508, reward_valid_mean=1.5954, reward_valid_std=3.9037
[BatchDiag] adv_mean=7.2828, adv_std=1.4113, adv_abs_mean=7.2828 | ret_mean=7.7395, ret_std=1.4113 | val_mean=0.4567, val_std=0.0001 | explained_var=-0.000033
[GradSplit pre-clip] backbone=4.947967, critic=1.454618
[Loss] pg_loss=-0.044861, entropy_loss=0.000222, value_loss=1.530844
[EpochKL] epoch=0 mean_kl=0.00615 max_kl=0.01274
[EarlyStop] epoch=1 mean_kl=0.01017 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01017 max_kl=0.01784
[Time] Env Create Time: 4.3992s |Rollout Collect Time: 2.7490s |Loss & Update :0.9688
[PPODiag] kl_mean=0.0082, kl_p90=0.0160, kl_max=0.0178 | clipfrac_mean=0.112, logratio_std_mean=0.120, ratio_p95_mean=1.192 | valid_ratio_mb_mean=0.508, p10=0.504, min=0.501 | pg_loss_mean=-0.0123, v_loss_mean=3.3622, ent_mean=0.2182 | gn_bb_mean=3.178, gn_bb_max=5.417 | gn_v_mean=1.564, gn_v_max=1.675

  0%|          | 25/5000 [04:06<11:44:12,  8.49s/it]------------------ Training Record ------------------
Epoch: 25/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 12.281
Updated lambda_fail: 12.181
----------------------------------------------------
[RolloutDiag] valid_step=11, valid_ratio=0.448, reward_valid_mean=1.6640, reward_valid_std=3.9483
[BatchDiag] adv_mean=7.2495, adv_std=1.3539, adv_abs_mean=7.2495 | ret_mean=7.8344, ret_std=1.3539 | val_mean=0.5849, val_std=0.0002 | explained_var=-0.000040
[GradSplit pre-clip] backbone=4.951471, critic=1.690264
[Loss] pg_loss=-0.044886, entropy_loss=0.000186, value_loss=1.522816
[EpochKL] epoch=0 mean_kl=0.00291 max_kl=0.01096
[EarlyStop] epoch=1 mean_kl=0.01245 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01245 max_kl=0.02675
[Time] Env Create Time: 4.4111s |Rollout Collect Time: 2.9832s |Loss & Update :1.0560
[PPODiag] kl_mean=0.0077, kl_p90=0.0172, kl_max=0.0268 | clipfrac_mean=0.087, logratio_std_mean=0.106, ratio_p95_mean=1.160 | valid_ratio_mb_mean=0.448, p10=0.444, min=0.443 | pg_loss_mean=-0.0068, v_loss_mean=3.3417, ent_mean=0.1815 | gn_bb_mean=3.729, gn_bb_max=6.031 | gn_v_mean=1.804, gn_v_max=1.918
[AttnScore] scale=1.0023, C=10.0

  1%|          | 26/5000 [04:14<11:43:01,  8.48s/it]------------------ Training Record ------------------
Epoch: 26/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102374/102400 = 1.000
Current lambda_fail (before): 12.181
Updated lambda_fail: 12.181
----------------------------------------------------
[RolloutDiag] valid_step=20, valid_ratio=0.243, reward_valid_mean=1.6880, reward_valid_std=3.9648
[BatchDiag] adv_mean=7.1211, adv_std=1.4025, adv_abs_mean=7.1338 | ret_mean=7.8505, ret_std=1.4025 | val_mean=0.7293, val_std=0.0002 | explained_var=-0.000039
[GradSplit pre-clip] backbone=4.496633, critic=1.935950
[Loss] pg_loss=-0.073131, entropy_loss=0.000094, value_loss=1.503468
[EpochKL] epoch=0 mean_kl=0.00424 max_kl=0.01385
[EarlyStop] epoch=1 mean_kl=0.01344 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01344 max_kl=0.03689
[Time] Env Create Time: 4.3912s |Rollout Collect Time: 5.1560s |Loss & Update :1.7714
[PPODiag] kl_mean=0.0088, kl_p90=0.0223, kl_max=0.0369 | clipfrac_mean=0.083, logratio_std_mean=0.112, ratio_p95_mean=1.149 | valid_ratio_mb_mean=0.243, p10=0.240, min=0.239 | pg_loss_mean=-0.0052, v_loss_mean=3.2804, ent_mean=0.0931 | gn_bb_mean=3.846, gn_bb_max=6.310 | gn_v_mean=2.048, gn_v_max=2.173

  1%|          | 27/5000 [04:26<12:53:27,  9.33s/it]------------------ Training Record ------------------
Epoch: 27/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 12.181
Updated lambda_fail: 12.081
----------------------------------------------------
[RolloutDiag] valid_step=9, valid_ratio=0.529, reward_valid_mean=1.7384, reward_valid_std=3.9936
[BatchDiag] adv_mean=7.0533, adv_std=1.2726, adv_abs_mean=7.0533 | ret_mean=7.9430, ret_std=1.2725 | val_mean=0.8897, val_std=0.0002 | explained_var=-0.000044
[GradSplit pre-clip] backbone=4.923995, critic=2.189305
[Loss] pg_loss=-0.052153, entropy_loss=0.000197, value_loss=1.480214
[EpochKL] epoch=0 mean_kl=0.00648 max_kl=0.02263
[EarlyStop] epoch=1 mean_kl=0.01010 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01010 max_kl=0.02612
[Time] Env Create Time: 4.3809s |Rollout Collect Time: 2.4841s |Loss & Update :0.8884
[PPODiag] kl_mean=0.0083, kl_p90=0.0206, kl_max=0.0261 | clipfrac_mean=0.073, logratio_std_mean=0.111, ratio_p95_mean=1.150 | valid_ratio_mb_mean=0.529, p10=0.523, min=0.521 | pg_loss_mean=-0.0027, v_loss_mean=3.2362, ent_mean=0.1931 | gn_bb_mean=3.980, gn_bb_max=5.712 | gn_v_mean=2.311, gn_v_max=2.433

  1%|          | 28/5000 [04:33<12:14:04,  8.86s/it]------------------ Training Record ------------------
Epoch: 28/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 12.081
Updated lambda_fail: 11.981
----------------------------------------------------
[RolloutDiag] valid_step=13, valid_ratio=0.353, reward_valid_mean=1.8156, reward_valid_std=4.0389
[BatchDiag] adv_mean=6.9615, adv_std=1.2125, adv_abs_mean=6.9615 | ret_mean=8.0274, ret_std=1.2125 | val_mean=1.0659, val_std=0.0002 | explained_var=-0.000050
[GradSplit pre-clip] backbone=3.870397, critic=2.448907
[Loss] pg_loss=-0.015146, entropy_loss=0.000121, value_loss=1.448931
[EpochKL] epoch=0 mean_kl=0.00471 max_kl=0.01064
[EpochKL] epoch=1 mean_kl=0.00430 max_kl=0.01007
[EpochKL] epoch=2 mean_kl=0.00480 max_kl=0.00820
[Time] Env Create Time: 4.5904s |Rollout Collect Time: 3.4216s |Loss & Update :1.7839
[PPODiag] kl_mean=0.0046, kl_p90=0.0098, kl_max=0.0106 | clipfrac_mean=0.046, logratio_std_mean=0.091, ratio_p95_mean=1.091 | valid_ratio_mb_mean=0.353, p10=0.350, min=0.350 | pg_loss_mean=-0.0048, v_loss_mean=3.1682, ent_mean=0.1150 | gn_bb_mean=3.190, gn_bb_max=5.143 | gn_v_mean=1.828, gn_v_max=2.713

  1%|          | 29/5000 [04:43<12:37:14,  9.14s/it]------------------ Training Record ------------------
Epoch: 29/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 11.981
Updated lambda_fail: 11.881
----------------------------------------------------
[RolloutDiag] valid_step=9, valid_ratio=0.496, reward_valid_mean=1.8833, reward_valid_std=4.0815
[BatchDiag] adv_mean=6.7941, adv_std=1.1369, adv_abs_mean=6.7941 | ret_mean=8.1244, ret_std=1.1369 | val_mean=1.3303, val_std=0.0002 | explained_var=-0.000048
[GradSplit pre-clip] backbone=3.137908, critic=2.808641
[Loss] pg_loss=-0.047629, entropy_loss=0.000152, value_loss=1.419505
[EpochKL] epoch=0 mean_kl=0.00133 max_kl=0.00305
[EpochKL] epoch=1 mean_kl=0.00484 max_kl=0.01047
[EpochKL] epoch=2 mean_kl=0.00602 max_kl=0.01085
[Time] Env Create Time: 4.4099s |Rollout Collect Time: 2.4560s |Loss & Update :1.3195
[PPODiag] kl_mean=0.0041, kl_p90=0.0100, kl_max=0.0109 | clipfrac_mean=0.038, logratio_std_mean=0.085, ratio_p95_mean=1.073 | valid_ratio_mb_mean=0.496, p10=0.492, min=0.489 | pg_loss_mean=-0.0005, v_loss_mean=3.0917, ent_mean=0.1471 | gn_bb_mean=3.247, gn_bb_max=6.354 | gn_v_mean=2.312, gn_v_max=3.052

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.322, Step: 8, Avg Done Step: 6.68, #CS visited: 0.26
D->C5->C2->C4->D->R->C1->C3->D
Eval cost : 1.9401s
-----------------------------
  1%|          | 30/5000 [04:53<13:02:52,  9.45s/it]------------------ Training Record ------------------
Epoch: 30/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 11.881
Updated lambda_fail: 11.781
----------------------------------------------------
[RolloutDiag] valid_step=10, valid_ratio=0.448, reward_valid_mean=1.8715, reward_valid_std=4.0714
[BatchDiag] adv_mean=6.5321, adv_std=1.1368, adv_abs_mean=6.5321 | ret_mean=8.1162, ret_std=1.1368 | val_mean=1.5841, val_std=0.0002 | explained_var=-0.000050
[GradSplit pre-clip] backbone=3.167042, critic=3.127055
[Loss] pg_loss=-0.065182, entropy_loss=0.000128, value_loss=1.365391
[EpochKL] epoch=0 mean_kl=0.00438 max_kl=0.01401
[EpochKL] epoch=1 mean_kl=0.00551 max_kl=0.01469
[EpochKL] epoch=2 mean_kl=0.00293 max_kl=0.00786
[Time] Env Create Time: 4.3689s |Rollout Collect Time: 2.6863s |Loss & Update :1.4280
[PPODiag] kl_mean=0.0043, kl_p90=0.0109, kl_max=0.0147 | clipfrac_mean=0.033, logratio_std_mean=0.084, ratio_p95_mean=1.072 | valid_ratio_mb_mean=0.448, p10=0.443, min=0.441 | pg_loss_mean=-0.0015, v_loss_mean=2.9560, ent_mean=0.1257 | gn_bb_mean=2.741, gn_bb_max=3.915 | gn_v_mean=2.289, gn_v_max=3.350
[AttnScore] scale=1.0049, C=10.0

  1%|          | 31/5000 [05:02<12:38:40,  9.16s/it]------------------ Training Record ------------------
Epoch: 31/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 11.781
Updated lambda_fail: 11.681
----------------------------------------------------
[RolloutDiag] valid_step=8, valid_ratio=0.544, reward_valid_mean=1.9512, reward_valid_std=4.1131
[BatchDiag] adv_mean=6.3751, adv_std=1.0560, adv_abs_mean=6.3751 | ret_mean=8.2293, ret_std=1.0560 | val_mean=1.8542, val_std=0.0002 | explained_var=-0.000033
[GradSplit pre-clip] backbone=2.108918, critic=3.442156
[Loss] pg_loss=0.029608, entropy_loss=0.000140, value_loss=1.306719
[EarlyStop] epoch=0 mean_kl=0.01647 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01647 max_kl=0.03203
[Time] Env Create Time: 4.3831s |Rollout Collect Time: 2.2073s |Loss & Update :0.4316
[PPODiag] kl_mean=0.0165, kl_p90=0.0277, kl_max=0.0320 | clipfrac_mean=0.039, logratio_std_mean=0.206, ratio_p95_mean=1.092 | valid_ratio_mb_mean=0.544, p10=0.537, min=0.534 | pg_loss_mean=0.0072, v_loss_mean=2.9213, ent_mean=0.1272 | gn_bb_mean=1.233, gn_bb_max=2.109 | gn_v_mean=3.479, gn_v_max=3.521

  1%|          | 32/5000 [05:09<11:45:24,  8.52s/it]------------------ Training Record ------------------
Epoch: 32/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 11.681
Updated lambda_fail: 11.581
----------------------------------------------------
[RolloutDiag] valid_step=8, valid_ratio=0.543, reward_valid_mean=1.9493, reward_valid_std=4.1165
[BatchDiag] adv_mean=6.2927, adv_std=1.0665, adv_abs_mean=6.2927 | ret_mean=8.2293, ret_std=1.0665 | val_mean=1.9366, val_std=0.0002 | explained_var=-0.000068
[GradSplit pre-clip] backbone=1.989681, critic=3.534243
[Loss] pg_loss=-0.028708, entropy_loss=0.000132, value_loss=1.302137
[EpochKL] epoch=0 mean_kl=0.00253 max_kl=0.00641
[EpochKL] epoch=1 mean_kl=0.00248 max_kl=0.00523
[EpochKL] epoch=2 mean_kl=0.00506 max_kl=0.01230
[Time] Env Create Time: 4.3588s |Rollout Collect Time: 2.2041s |Loss & Update :1.1935
[PPODiag] kl_mean=0.0034, kl_p90=0.0069, kl_max=0.0123 | clipfrac_mean=0.026, logratio_std_mean=0.079, ratio_p95_mean=1.051 | valid_ratio_mb_mean=0.543, p10=0.537, min=0.536 | pg_loss_mean=-0.0002, v_loss_mean=2.8286, ent_mean=0.1261 | gn_bb_mean=1.910, gn_bb_max=3.680 | gn_v_mean=2.119, gn_v_max=3.736

  1%|          | 33/5000 [05:17<11:26:19,  8.29s/it]------------------ Training Record ------------------
Epoch: 33/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 11.581
Updated lambda_fail: 11.481
----------------------------------------------------
[RolloutDiag] valid_step=8, valid_ratio=0.535, reward_valid_mean=1.9886, reward_valid_std=4.1340
[BatchDiag] adv_mean=6.0558, adv_std=1.0145, adv_abs_mean=6.0558 | ret_mean=8.2877, ret_std=1.0145 | val_mean=2.2319, val_std=0.0002 | explained_var=-0.000050
[GradSplit pre-clip] backbone=1.643556, critic=3.849864
[Loss] pg_loss=-0.024996, entropy_loss=0.000112, value_loss=1.247985
[EpochKL] epoch=0 mean_kl=0.00078 max_kl=0.00174
[EpochKL] epoch=1 mean_kl=0.00134 max_kl=0.00254
[EpochKL] epoch=2 mean_kl=0.00177 max_kl=0.00285
[Time] Env Create Time: 4.5890s |Rollout Collect Time: 2.1935s |Loss & Update :1.1866
[PPODiag] kl_mean=0.0013, kl_p90=0.0024, kl_max=0.0028 | clipfrac_mean=0.011, logratio_std_mean=0.050, ratio_p95_mean=1.035 | valid_ratio_mb_mean=0.535, p10=0.530, min=0.529 | pg_loss_mean=-0.0017, v_loss_mean=2.7180, ent_mean=0.1074 | gn_bb_mean=1.076, gn_bb_max=1.958 | gn_v_mean=2.790, gn_v_max=4.049

  1%|          | 34/5000 [05:25<11:18:12,  8.19s/it]------------------ Training Record ------------------
Epoch: 34/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 11.481
Updated lambda_fail: 11.381
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.607, reward_valid_mean=2.0031, reward_valid_std=4.1406
[BatchDiag] adv_mean=5.7960, adv_std=0.9859, adv_abs_mean=5.7960 | ret_mean=8.3163, ret_std=0.9858 | val_mean=2.5203, val_std=0.0002 | explained_var=-0.000041
[GradSplit pre-clip] backbone=1.448094, critic=4.139505
[Loss] pg_loss=-0.030585, entropy_loss=0.000116, value_loss=1.190957
[EpochKL] epoch=0 mean_kl=0.00043 max_kl=0.00120
[EpochKL] epoch=1 mean_kl=0.00089 max_kl=0.00143
[EpochKL] epoch=2 mean_kl=0.00127 max_kl=0.00209
[Time] Env Create Time: 4.3844s |Rollout Collect Time: 1.9623s |Loss & Update :1.0759
[PPODiag] kl_mean=0.0009, kl_p90=0.0015, kl_max=0.0021 | clipfrac_mean=0.009, logratio_std_mean=0.040, ratio_p95_mean=1.029 | valid_ratio_mb_mean=0.607, p10=0.601, min=0.599 | pg_loss_mean=-0.0017, v_loss_mean=2.5839, ent_mean=0.1146 | gn_bb_mean=0.960, gn_bb_max=1.635 | gn_v_mean=2.639, gn_v_max=4.320

  1%|          | 35/5000 [05:32<10:58:56,  7.96s/it]------------------ Training Record ------------------
Epoch: 35/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 11.381
Updated lambda_fail: 11.281
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.607, reward_valid_mean=2.0071, reward_valid_std=4.1430
[BatchDiag] adv_mean=5.5326, adv_std=0.9665, adv_abs_mean=5.5326 | ret_mean=8.3503, ret_std=0.9665 | val_mean=2.8177, val_std=0.0002 | explained_var=-0.000021
[GradSplit pre-clip] backbone=1.129259, critic=4.421934
[Loss] pg_loss=-0.059206, entropy_loss=0.000111, value_loss=1.138121
[EpochKL] epoch=0 mean_kl=0.00047 max_kl=0.00107
[EpochKL] epoch=1 mean_kl=0.00065 max_kl=0.00094
[EpochKL] epoch=2 mean_kl=0.00099 max_kl=0.00168
[Time] Env Create Time: 4.4142s |Rollout Collect Time: 1.9553s |Loss & Update :1.0752
[PPODiag] kl_mean=0.0007, kl_p90=0.0012, kl_max=0.0017 | clipfrac_mean=0.008, logratio_std_mean=0.037, ratio_p95_mean=1.028 | valid_ratio_mb_mean=0.607, p10=0.603, min=0.600 | pg_loss_mean=-0.0016, v_loss_mean=2.4527, ent_mean=0.1103 | gn_bb_mean=1.040, gn_bb_max=1.930 | gn_v_mean=2.812, gn_v_max=4.593
[AttnScore] scale=1.0069, C=10.0

  1%|          | 36/5000 [05:39<10:45:57,  7.81s/it]------------------ Training Record ------------------
Epoch: 36/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 11.281
Updated lambda_fail: 11.181
----------------------------------------------------
[RolloutDiag] valid_step=8, valid_ratio=0.530, reward_valid_mean=2.0078, reward_valid_std=4.1453
[BatchDiag] adv_mean=5.2503, adv_std=0.9540, adv_abs_mean=5.2503 | ret_mean=8.3689, ret_std=0.9540 | val_mean=3.1186, val_std=0.0002 | explained_var=-0.000041
[GradSplit pre-clip] backbone=1.344962, critic=4.693098
[Loss] pg_loss=-0.000029, entropy_loss=0.000088, value_loss=1.062203
[EpochKL] epoch=0 mean_kl=0.00120 max_kl=0.00269
[EpochKL] epoch=1 mean_kl=0.00130 max_kl=0.00234
[EpochKL] epoch=2 mean_kl=0.00085 max_kl=0.00136
[Time] Env Create Time: 4.3854s |Rollout Collect Time: 2.1986s |Loss & Update :1.1848
[PPODiag] kl_mean=0.0011, kl_p90=0.0023, kl_max=0.0027 | clipfrac_mean=0.009, logratio_std_mean=0.047, ratio_p95_mean=1.030 | valid_ratio_mb_mean=0.530, p10=0.527, min=0.525 | pg_loss_mean=-0.0007, v_loss_mean=2.3103, ent_mean=0.0878 | gn_bb_mean=1.023, gn_bb_max=1.611 | gn_v_mean=2.981, gn_v_max=4.864

  1%|          | 37/5000 [05:47<10:44:52,  7.80s/it]------------------ Training Record ------------------
Epoch: 37/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 11.181
Updated lambda_fail: 11.081
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.601, reward_valid_mean=2.0315, reward_valid_std=4.1555
[BatchDiag] adv_mean=4.9843, adv_std=0.9147, adv_abs_mean=4.9843 | ret_mean=8.4177, ret_std=0.9147 | val_mean=3.4334, val_std=0.0002 | explained_var=0.000154
[GradSplit pre-clip] backbone=0.933073, critic=4.963472
[Loss] pg_loss=-0.064361, entropy_loss=0.000095, value_loss=1.015877
[EpochKL] epoch=0 mean_kl=0.00131 max_kl=0.00446
[EpochKL] epoch=1 mean_kl=0.00150 max_kl=0.00256
[EpochKL] epoch=2 mean_kl=0.00162 max_kl=0.00267
[Time] Env Create Time: 4.3930s |Rollout Collect Time: 1.9489s |Loss & Update :1.0660
[PPODiag] kl_mean=0.0015, kl_p90=0.0025, kl_max=0.0045 | clipfrac_mean=0.010, logratio_std_mean=0.054, ratio_p95_mean=1.028 | valid_ratio_mb_mean=0.601, p10=0.597, min=0.596 | pg_loss_mean=0.0006, v_loss_mean=2.1760, ent_mean=0.0942 | gn_bb_mean=1.061, gn_bb_max=3.600 | gn_v_mean=2.936, gn_v_max=5.119

  1%|          | 38/5000 [05:55<10:35:07,  7.68s/it]------------------ Training Record ------------------
Epoch: 38/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 11.081
Updated lambda_fail: 10.981
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.600, reward_valid_mean=2.0402, reward_valid_std=4.1546
[BatchDiag] adv_mean=4.6964, adv_std=0.8956, adv_abs_mean=4.6964 | ret_mean=8.4453, ret_std=0.8957 | val_mean=3.7489, val_std=0.0001 | explained_var=0.000095
[GradSplit pre-clip] backbone=0.546466, critic=5.222153
[Loss] pg_loss=-0.033585, entropy_loss=0.000082, value_loss=0.945078
[EpochKL] epoch=0 mean_kl=0.00020 max_kl=0.00031
[EpochKL] epoch=1 mean_kl=0.00041 max_kl=0.00065
[EpochKL] epoch=2 mean_kl=0.00069 max_kl=0.00077
[Time] Env Create Time: 4.3834s |Rollout Collect Time: 1.9633s |Loss & Update :1.0647
[PPODiag] kl_mean=0.0004, kl_p90=0.0007, kl_max=0.0008 | clipfrac_mean=0.005, logratio_std_mean=0.029, ratio_p95_mean=1.024 | valid_ratio_mb_mean=0.600, p10=0.595, min=0.593 | pg_loss_mean=-0.0012, v_loss_mean=2.0320, ent_mean=0.0834 | gn_bb_mean=0.318, gn_bb_max=0.704 | gn_v_mean=3.085, gn_v_max=5.373

  1%|          | 39/5000 [06:02<10:28:20,  7.60s/it]------------------ Training Record ------------------
Epoch: 39/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 10.981
Updated lambda_fail: 10.881
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.595, reward_valid_mean=2.0563, reward_valid_std=4.1642
[BatchDiag] adv_mean=4.4038, adv_std=0.8617, adv_abs_mean=4.4038 | ret_mean=8.4749, ret_std=0.8616 | val_mean=4.0711, val_std=0.0001 | explained_var=-0.000064
[GradSplit pre-clip] backbone=0.486222, critic=5.475153
[Loss] pg_loss=-0.040228, entropy_loss=0.000076, value_loss=0.880674
[EpochKL] epoch=0 mean_kl=0.00013 max_kl=0.00027
[EpochKL] epoch=1 mean_kl=0.00053 max_kl=0.00082
[EpochKL] epoch=2 mean_kl=0.00063 max_kl=0.00074
[Time] Env Create Time: 4.3791s |Rollout Collect Time: 1.9552s |Loss & Update :1.0715
[PPODiag] kl_mean=0.0004, kl_p90=0.0007, kl_max=0.0008 | clipfrac_mean=0.005, logratio_std_mean=0.028, ratio_p95_mean=1.022 | valid_ratio_mb_mean=0.595, p10=0.591, min=0.588 | pg_loss_mean=-0.0011, v_loss_mean=1.8848, ent_mean=0.0770 | gn_bb_mean=0.465, gn_bb_max=0.816 | gn_v_mean=3.233, gn_v_max=5.626

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.288, Step: 7, Avg Done Step: 6.64, #CS visited: 0.23
D->C5->C2->C4->D->C1->C3->D
Eval cost : 1.7944s
-----------------------------
  1%|          | 40/5000 [06:11<11:09:01,  8.09s/it]------------------ Training Record ------------------
Epoch: 40/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 10.881
Updated lambda_fail: 10.781
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.595, reward_valid_mean=2.0592, reward_valid_std=4.1704
[BatchDiag] adv_mean=4.1072, adv_std=0.8495, adv_abs_mean=4.1072 | ret_mean=8.5129, ret_std=0.8496 | val_mean=4.4057, val_std=0.0001 | explained_var=0.000172
[GradSplit pre-clip] backbone=0.328124, critic=5.727287
[Loss] pg_loss=-0.066007, entropy_loss=0.000070, value_loss=0.819144
[EpochKL] epoch=0 mean_kl=0.00017 max_kl=0.00033
[EpochKL] epoch=1 mean_kl=0.00065 max_kl=0.00077
[EpochKL] epoch=2 mean_kl=0.00050 max_kl=0.00063
[Time] Env Create Time: 4.5832s |Rollout Collect Time: 1.9574s |Loss & Update :1.0717
[PPODiag] kl_mean=0.0004, kl_p90=0.0007, kl_max=0.0008 | clipfrac_mean=0.004, logratio_std_mean=0.029, ratio_p95_mean=1.022 | valid_ratio_mb_mean=0.595, p10=0.590, min=0.589 | pg_loss_mean=-0.0008, v_loss_mean=1.7355, ent_mean=0.0705 | gn_bb_mean=0.371, gn_bb_max=0.636 | gn_v_mean=3.135, gn_v_max=5.861
[AttnScore] scale=1.0084, C=10.0

  1%|          | 41/5000 [06:19<10:56:58,  7.95s/it]------------------ Training Record ------------------
Epoch: 41/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 10.781
Updated lambda_fail: 10.681
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.596, reward_valid_mean=2.0546, reward_valid_std=4.1637
[BatchDiag] adv_mean=3.7923, adv_std=0.8328, adv_abs_mean=3.7923 | ret_mean=8.5281, ret_std=0.8328 | val_mean=4.7358, val_std=0.0001 | explained_var=-0.000026
[GradSplit pre-clip] backbone=0.368421, critic=5.966196
[Loss] pg_loss=-0.036042, entropy_loss=0.000063, value_loss=0.742897
[EpochKL] epoch=0 mean_kl=0.00007 max_kl=0.00015
[EpochKL] epoch=1 mean_kl=0.00041 max_kl=0.00063
[EpochKL] epoch=2 mean_kl=0.00047 max_kl=0.00075
[Time] Env Create Time: 4.4251s |Rollout Collect Time: 1.9259s |Loss & Update :1.0745
[PPODiag] kl_mean=0.0003, kl_p90=0.0006, kl_max=0.0008 | clipfrac_mean=0.003, logratio_std_mean=0.024, ratio_p95_mean=1.018 | valid_ratio_mb_mean=0.596, p10=0.590, min=0.588 | pg_loss_mean=-0.0007, v_loss_mean=1.5780, ent_mean=0.0663 | gn_bb_mean=0.415, gn_bb_max=0.689 | gn_v_mean=3.262, gn_v_max=6.093

  1%|          | 42/5000 [06:26<10:43:52,  7.79s/it]------------------ Training Record ------------------
Epoch: 42/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 10.681
Updated lambda_fail: 10.581
----------------------------------------------------
[RolloutDiag] valid_step=8, valid_ratio=0.521, reward_valid_mean=2.0503, reward_valid_std=4.1668
[BatchDiag] adv_mean=3.4745, adv_std=0.8288, adv_abs_mean=3.4750 | ret_mean=8.5453, ret_std=0.8288 | val_mean=5.0708, val_std=0.0001 | explained_var=0.000082
[GradSplit pre-clip] backbone=0.344884, critic=6.197524
[Loss] pg_loss=-0.049423, entropy_loss=0.000054, value_loss=0.674293
[EpochKL] epoch=0 mean_kl=0.00021 max_kl=0.00041
[EpochKL] epoch=1 mean_kl=0.00061 max_kl=0.00086
[EpochKL] epoch=2 mean_kl=0.00049 max_kl=0.00099
[Time] Env Create Time: 4.3867s |Rollout Collect Time: 2.1826s |Loss & Update :1.1849
[PPODiag] kl_mean=0.0004, kl_p90=0.0008, kl_max=0.0010 | clipfrac_mean=0.004, logratio_std_mean=0.029, ratio_p95_mean=1.020 | valid_ratio_mb_mean=0.521, p10=0.518, min=0.517 | pg_loss_mean=-0.0005, v_loss_mean=1.4188, ent_mean=0.0548 | gn_bb_mean=0.581, gn_bb_max=1.047 | gn_v_mean=3.381, gn_v_max=6.298

  1%|          | 43/5000 [06:34<10:42:49,  7.78s/it]------------------ Training Record ------------------
Epoch: 43/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 10.581
Updated lambda_fail: 10.481
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0631, reward_valid_std=4.1729
[BatchDiag] adv_mean=3.1706, adv_std=0.8045, adv_abs_mean=3.1706 | ret_mean=8.5862, ret_std=0.8046 | val_mean=5.4157, val_std=0.0001 | explained_var=0.000185
[GradSplit pre-clip] backbone=0.358930, critic=6.404223
[Loss] pg_loss=0.002153, entropy_loss=0.000065, value_loss=0.597100
[EpochKL] epoch=0 mean_kl=0.00019 max_kl=0.00040
[EpochKL] epoch=1 mean_kl=0.00029 max_kl=0.00039
[EpochKL] epoch=2 mean_kl=0.00036 max_kl=0.00056
[Time] Env Create Time: 4.3758s |Rollout Collect Time: 1.6987s |Loss & Update :0.9589
[PPODiag] kl_mean=0.0003, kl_p90=0.0004, kl_max=0.0006 | clipfrac_mean=0.002, logratio_std_mean=0.024, ratio_p95_mean=1.016 | valid_ratio_mb_mean=0.692, p10=0.686, min=0.684 | pg_loss_mean=-0.0007, v_loss_mean=1.2663, ent_mean=0.0666 | gn_bb_mean=0.345, gn_bb_max=0.617 | gn_v_mean=3.226, gn_v_max=6.513

  1%|          | 44/5000 [06:41<10:24:11,  7.56s/it]------------------ Training Record ------------------
Epoch: 44/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 10.481
Updated lambda_fail: 10.381
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0678, reward_valid_std=4.1759
[BatchDiag] adv_mean=2.8605, adv_std=0.7768, adv_abs_mean=2.8610 | ret_mean=8.6138, ret_std=0.7768 | val_mean=5.7533, val_std=0.0001 | explained_var=-0.000088
[GradSplit pre-clip] backbone=0.196487, critic=6.614120
[Loss] pg_loss=0.014205, entropy_loss=0.000051, value_loss=0.525719
[EpochKL] epoch=0 mean_kl=0.00017 max_kl=0.00045
[EpochKL] epoch=1 mean_kl=0.00030 max_kl=0.00048
[EpochKL] epoch=2 mean_kl=0.00055 max_kl=0.00093
[Time] Env Create Time: 4.3781s |Rollout Collect Time: 1.9378s |Loss & Update :1.0685
[PPODiag] kl_mean=0.0003, kl_p90=0.0006, kl_max=0.0009 | clipfrac_mean=0.003, logratio_std_mean=0.025, ratio_p95_mean=1.017 | valid_ratio_mb_mean=0.592, p10=0.587, min=0.586 | pg_loss_mean=-0.0004, v_loss_mean=1.1127, ent_mean=0.0514 | gn_bb_mean=0.296, gn_bb_max=0.578 | gn_v_mean=3.335, gn_v_max=6.711

  1%|          | 45/5000 [06:48<10:19:48,  7.51s/it]------------------ Training Record ------------------
Epoch: 45/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 10.381
Updated lambda_fail: 10.281
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0677, reward_valid_std=4.1733
[BatchDiag] adv_mean=2.5385, adv_std=0.7753, adv_abs_mean=2.5401 | ret_mean=8.6317, ret_std=0.7753 | val_mean=6.0933, val_std=0.0001 | explained_var=0.000024
[GradSplit pre-clip] backbone=0.414729, critic=6.750894
[Loss] pg_loss=-0.078401, entropy_loss=0.000050, value_loss=0.470944
[EpochKL] epoch=0 mean_kl=0.00045 max_kl=0.00086
[EpochKL] epoch=1 mean_kl=0.00040 max_kl=0.00057
[EpochKL] epoch=2 mean_kl=0.00031 max_kl=0.00056
[Time] Env Create Time: 4.3560s |Rollout Collect Time: 1.9384s |Loss & Update :1.0768
[PPODiag] kl_mean=0.0004, kl_p90=0.0006, kl_max=0.0009 | clipfrac_mean=0.003, logratio_std_mean=0.027, ratio_p95_mean=1.016 | valid_ratio_mb_mean=0.592, p10=0.589, min=0.586 | pg_loss_mean=-0.0003, v_loss_mean=0.9544, ent_mean=0.0507 | gn_bb_mean=0.400, gn_bb_max=0.710 | gn_v_mean=3.395, gn_v_max=6.828
[AttnScore] scale=1.0096, C=10.0

  1%|          | 46/5000 [06:56<10:16:22,  7.47s/it]------------------ Training Record ------------------
Epoch: 46/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 10.281
Updated lambda_fail: 10.181
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0738, reward_valid_std=4.1760
[BatchDiag] adv_mean=2.2298, adv_std=0.7471, adv_abs_mean=2.2357 | ret_mean=8.6680, ret_std=0.7471 | val_mean=6.4382, val_std=0.0001 | explained_var=-0.000016
[GradSplit pre-clip] backbone=0.183697, critic=6.945825
[Loss] pg_loss=-0.071551, entropy_loss=0.000055, value_loss=0.400341
[EpochKL] epoch=0 mean_kl=0.00067 max_kl=0.00107
[EpochKL] epoch=1 mean_kl=0.00048 max_kl=0.00094
[EpochKL] epoch=2 mean_kl=0.00073 max_kl=0.00126
[Time] Env Create Time: 4.5801s |Rollout Collect Time: 1.7066s |Loss & Update :0.9492
[PPODiag] kl_mean=0.0006, kl_p90=0.0010, kl_max=0.0013 | clipfrac_mean=0.006, logratio_std_mean=0.035, ratio_p95_mean=1.016 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.682 | pg_loss_mean=-0.0001, v_loss_mean=0.8042, ent_mean=0.0543 | gn_bb_mean=0.318, gn_bb_max=0.845 | gn_v_mean=3.470, gn_v_max=7.000

  1%|          | 47/5000 [07:03<10:10:34,  7.40s/it]------------------ Training Record ------------------
Epoch: 47/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 10.181
Updated lambda_fail: 10.081
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.0797, reward_valid_std=4.1775
[BatchDiag] adv_mean=1.9090, adv_std=0.7275, adv_abs_mean=1.9220 | ret_mean=8.6975, ret_std=0.7273 | val_mean=6.7885, val_std=0.0003 | explained_var=-0.000430
[GradSplit pre-clip] backbone=0.181445, critic=6.990269
[Loss] pg_loss=-0.017063, entropy_loss=0.000042, value_loss=0.321664
[EpochKL] epoch=0 mean_kl=0.00013 max_kl=0.00033
[EpochKL] epoch=1 mean_kl=0.00028 max_kl=0.00051
[EpochKL] epoch=2 mean_kl=0.00041 max_kl=0.00054
[Time] Env Create Time: 4.3864s |Rollout Collect Time: 1.9338s |Loss & Update :1.0867
[PPODiag] kl_mean=0.0003, kl_p90=0.0005, kl_max=0.0005 | clipfrac_mean=0.002, logratio_std_mean=0.022, ratio_p95_mean=1.014 | valid_ratio_mb_mean=0.590, p10=0.584, min=0.580 | pg_loss_mean=-0.0007, v_loss_mean=0.6513, ent_mean=0.0429 | gn_bb_mean=0.195, gn_bb_max=0.437 | gn_v_mean=3.496, gn_v_max=7.077

  1%|          | 48/5000 [07:10<10:10:43,  7.40s/it]------------------ Training Record ------------------
Epoch: 48/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 10.081
Updated lambda_fail: 9.981
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0657, reward_valid_std=4.1686
[BatchDiag] adv_mean=1.5711, adv_std=0.7244, adv_abs_mean=1.5999 | ret_mean=8.7114, ret_std=0.7242 | val_mean=7.1402, val_std=0.0004 | explained_var=-0.000542
[GradSplit pre-clip] backbone=0.076659, critic=6.831065
[Loss] pg_loss=-0.052867, entropy_loss=0.000043, value_loss=0.256819
[EpochKL] epoch=0 mean_kl=0.00032 max_kl=0.00093
[EpochKL] epoch=1 mean_kl=0.00026 max_kl=0.00039
[EpochKL] epoch=2 mean_kl=0.00028 max_kl=0.00053
[Time] Env Create Time: 4.3933s |Rollout Collect Time: 1.6990s |Loss & Update :0.9504
[PPODiag] kl_mean=0.0003, kl_p90=0.0005, kl_max=0.0009 | clipfrac_mean=0.003, logratio_std_mean=0.023, ratio_p95_mean=1.011 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.683 | pg_loss_mean=-0.0004, v_loss_mean=0.5012, ent_mean=0.0466 | gn_bb_mean=0.180, gn_bb_max=0.490 | gn_v_mean=3.403, gn_v_max=6.836

  1%|          | 49/5000 [07:18<10:01:46,  7.29s/it]------------------ Training Record ------------------
Epoch: 49/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 9.981
Updated lambda_fail: 9.881
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.0858, reward_valid_std=4.1784
[BatchDiag] adv_mean=1.2795, adv_std=0.6934, adv_abs_mean=1.3248 | ret_mean=8.7561, ret_std=0.6928 | val_mean=7.4766, val_std=0.0009 | explained_var=-0.001549
[GradSplit pre-clip] backbone=0.108873, critic=6.529980
[Loss] pg_loss=-0.049816, entropy_loss=0.000037, value_loss=0.199735
[EpochKL] epoch=0 mean_kl=0.00018 max_kl=0.00044
[EpochKL] epoch=1 mean_kl=0.00058 max_kl=0.00085
[EpochKL] epoch=2 mean_kl=0.00054 max_kl=0.00094
[Time] Env Create Time: 4.3881s |Rollout Collect Time: 1.9287s |Loss & Update :1.0637
[PPODiag] kl_mean=0.0004, kl_p90=0.0008, kl_max=0.0009 | clipfrac_mean=0.004, logratio_std_mean=0.029, ratio_p95_mean=1.014 | valid_ratio_mb_mean=0.589, p10=0.585, min=0.584 | pg_loss_mean=-0.0004, v_loss_mean=0.3767, ent_mean=0.0369 | gn_bb_mean=0.227, gn_bb_max=0.599 | gn_v_mean=3.514, gn_v_max=6.530

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.290, Step: 7, Avg Done Step: 6.63, #CS visited: 0.23
D->C5->C2->C4->D->C1->C3->D
Eval cost : 1.7919s
-----------------------------
  1%|          | 50/5000 [07:27<10:48:57,  7.87s/it]------------------ Training Record ------------------
Epoch: 50/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 9.881
Updated lambda_fail: 9.781
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.0827, reward_valid_std=4.1770
[BatchDiag] adv_mean=0.9739, adv_std=0.6667, adv_abs_mean=1.0472 | ret_mean=8.7843, ret_std=0.6661 | val_mean=7.8104, val_std=0.0011 | explained_var=-0.001767
[GradSplit pre-clip] backbone=0.155685, critic=5.725282
[Loss] pg_loss=-0.016152, entropy_loss=0.000039, value_loss=0.138519
[EpochKL] epoch=0 mean_kl=0.00026 max_kl=0.00047
[EpochKL] epoch=1 mean_kl=0.00040 max_kl=0.00055
[EpochKL] epoch=2 mean_kl=0.00049 max_kl=0.00085
[Time] Env Create Time: 4.3778s |Rollout Collect Time: 1.8865s |Loss & Update :0.9630
[PPODiag] kl_mean=0.0004, kl_p90=0.0006, kl_max=0.0009 | clipfrac_mean=0.003, logratio_std_mean=0.028, ratio_p95_mean=1.012 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.681 | pg_loss_mean=-0.0000, v_loss_mean=0.2617, ent_mean=0.0427 | gn_bb_mean=0.233, gn_bb_max=0.495 | gn_v_mean=3.350, gn_v_max=5.847
[AttnScore] scale=1.0105, C=10.0

  1%|          | 51/5000 [07:34<10:33:02,  7.67s/it]------------------ Training Record ------------------
Epoch: 51/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 9.781
Updated lambda_fail: 9.681
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.0881, reward_valid_std=4.1815
[BatchDiag] adv_mean=0.6792, adv_std=0.6601, adv_abs_mean=0.8172 | ret_mean=8.8064, ret_std=0.6586 | val_mean=8.1272, val_std=0.0028 | explained_var=-0.004716
[GradSplit pre-clip] backbone=0.287062, critic=4.705559
[Loss] pg_loss=-0.028190, entropy_loss=0.000041, value_loss=0.095107
[EpochKL] epoch=0 mean_kl=0.00024 max_kl=0.00071
[EpochKL] epoch=1 mean_kl=0.00070 max_kl=0.00098
[EpochKL] epoch=2 mean_kl=0.00085 max_kl=0.00164
[Time] Env Create Time: 4.3893s |Rollout Collect Time: 1.6866s |Loss & Update :0.9625
[PPODiag] kl_mean=0.0006, kl_p90=0.0010, kl_max=0.0016 | clipfrac_mean=0.006, logratio_std_mean=0.034, ratio_p95_mean=1.012 | valid_ratio_mb_mean=0.686, p10=0.682, min=0.677 | pg_loss_mean=0.0001, v_loss_mean=0.1782, ent_mean=0.0404 | gn_bb_mean=0.299, gn_bb_max=0.474 | gn_v_mean=3.044, gn_v_max=4.897

  1%|          | 52/5000 [07:41<10:17:10,  7.48s/it]------------------ Training Record ------------------
Epoch: 52/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 9.681
Updated lambda_fail: 9.581
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.0793, reward_valid_std=4.1793
[BatchDiag] adv_mean=0.4114, adv_std=0.6592, adv_abs_mean=0.6545 | ret_mean=8.8152, ret_std=0.6584 | val_mean=8.4038, val_std=0.0018 | explained_var=-0.002596
[GradSplit pre-clip] backbone=0.171997, critic=3.726374
[Loss] pg_loss=-0.120603, entropy_loss=0.000038, value_loss=0.064088
[EpochKL] epoch=0 mean_kl=0.00031 max_kl=0.00090
[EpochKL] epoch=1 mean_kl=0.00021 max_kl=0.00036
[EpochKL] epoch=2 mean_kl=0.00032 max_kl=0.00053
[Time] Env Create Time: 4.4009s |Rollout Collect Time: 1.9199s |Loss & Update :1.0705
[PPODiag] kl_mean=0.0003, kl_p90=0.0005, kl_max=0.0009 | clipfrac_mean=0.003, logratio_std_mean=0.022, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.589, p10=0.587, min=0.583 | pg_loss_mean=-0.0002, v_loss_mean=0.1285, ent_mean=0.0349 | gn_bb_mean=0.279, gn_bb_max=0.568 | gn_v_mean=2.405, gn_v_max=3.726

  1%|          | 53/5000 [07:48<10:14:46,  7.46s/it]------------------ Training Record ------------------
Epoch: 53/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 9.581
Updated lambda_fail: 9.481
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.0874, reward_valid_std=4.1816
[BatchDiag] adv_mean=0.2303, adv_std=0.6251, adv_abs_mean=0.5513 | ret_mean=8.8503, ret_std=0.6302 | val_mean=8.6200, val_std=0.0087 | explained_var=0.016143
[GradSplit pre-clip] backbone=0.192115, critic=2.113852
[Loss] pg_loss=-0.030626, entropy_loss=0.000037, value_loss=0.048930
[EpochKL] epoch=0 mean_kl=0.00038 max_kl=0.00080
[EpochKL] epoch=1 mean_kl=0.00053 max_kl=0.00093
[EpochKL] epoch=2 mean_kl=0.00089 max_kl=0.00213
[Time] Env Create Time: 4.3822s |Rollout Collect Time: 1.6894s |Loss & Update :0.9604
[PPODiag] kl_mean=0.0006, kl_p90=0.0009, kl_max=0.0021 | clipfrac_mean=0.006, logratio_std_mean=0.032, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.687, p10=0.680, min=0.676 | pg_loss_mean=-0.0000, v_loss_mean=0.0949, ent_mean=0.0385 | gn_bb_mean=0.349, gn_bb_max=0.759 | gn_v_mean=1.854, gn_v_max=2.456

  1%|          | 54/5000 [07:55<10:04:09,  7.33s/it]------------------ Training Record ------------------
Epoch: 54/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 9.481
Updated lambda_fail: 9.381
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0723, reward_valid_std=4.1702
[BatchDiag] adv_mean=0.1297, adv_std=0.5822, adv_abs_mean=0.4811 | ret_mean=8.8383, ret_std=0.6456 | val_mean=8.7086, val_std=0.1343 | explained_var=0.186810
[GradSplit pre-clip] backbone=0.285494, critic=1.705553
[Loss] pg_loss=-0.095322, entropy_loss=0.000038, value_loss=0.036773
[EpochKL] epoch=0 mean_kl=0.00090 max_kl=0.00251
[EpochKL] epoch=1 mean_kl=0.00100 max_kl=0.00176
[EpochKL] epoch=2 mean_kl=0.00102 max_kl=0.00212
[Time] Env Create Time: 4.3828s |Rollout Collect Time: 1.6942s |Loss & Update :0.9572
[PPODiag] kl_mean=0.0010, kl_p90=0.0017, kl_max=0.0025 | clipfrac_mean=0.010, logratio_std_mean=0.043, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.684 | pg_loss_mean=0.0006, v_loss_mean=0.0780, ent_mean=0.0380 | gn_bb_mean=0.419, gn_bb_max=0.723 | gn_v_mean=1.120, gn_v_max=1.813

  1%|          | 55/5000 [08:02<9:56:45,  7.24s/it] ------------------ Training Record ------------------
Epoch: 55/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 9.381
Updated lambda_fail: 9.281
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.0821, reward_valid_std=4.1815
[BatchDiag] adv_mean=0.1172, adv_std=0.5257, adv_abs_mean=0.4253 | ret_mean=8.8663, ret_std=0.6311 | val_mean=8.7491, val_std=0.2795 | explained_var=0.306091
[GradSplit pre-clip] backbone=0.260707, critic=1.546554
[Loss] pg_loss=-0.101233, entropy_loss=0.000033, value_loss=0.031223
[EpochKL] epoch=0 mean_kl=0.00055 max_kl=0.00098
[EpochKL] epoch=1 mean_kl=0.00045 max_kl=0.00062
[EpochKL] epoch=2 mean_kl=0.00113 max_kl=0.00221
[Time] Env Create Time: 4.3836s |Rollout Collect Time: 1.9268s |Loss & Update :1.0817
[PPODiag] kl_mean=0.0007, kl_p90=0.0014, kl_max=0.0022 | clipfrac_mean=0.007, logratio_std_mean=0.036, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.590, p10=0.585, min=0.584 | pg_loss_mean=-0.0001, v_loss_mean=0.0672, ent_mean=0.0334 | gn_bb_mean=0.410, gn_bb_max=0.837 | gn_v_mean=0.692, gn_v_max=1.547
[AttnScore] scale=1.0113, C=10.0

  1%|          | 56/5000 [08:10<10:00:23,  7.29s/it]------------------ Training Record ------------------
Epoch: 56/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 9.281
Updated lambda_fail: 9.181
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.0882, reward_valid_std=4.1783
[BatchDiag] adv_mean=0.0467, adv_std=0.5100, adv_abs_mean=0.3922 | ret_mean=8.8697, ret_std=0.6232 | val_mean=8.8230, val_std=0.2988 | explained_var=0.330300
[GradSplit pre-clip] backbone=0.209640, critic=0.464318
[Loss] pg_loss=0.023537, entropy_loss=0.000035, value_loss=0.029619
[EpochKL] epoch=0 mean_kl=0.00116 max_kl=0.00321
[EpochKL] epoch=1 mean_kl=0.00101 max_kl=0.00265
[EpochKL] epoch=2 mean_kl=0.00062 max_kl=0.00114
[Time] Env Create Time: 4.5927s |Rollout Collect Time: 1.6869s |Loss & Update :0.9533
[PPODiag] kl_mean=0.0009, kl_p90=0.0019, kl_max=0.0032 | clipfrac_mean=0.007, logratio_std_mean=0.041, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.686, p10=0.682, min=0.678 | pg_loss_mean=0.0000, v_loss_mean=0.0611, ent_mean=0.0374 | gn_bb_mean=0.389, gn_bb_max=0.807 | gn_v_mean=0.519, gn_v_max=1.024

  1%|          | 57/5000 [08:17<9:58:57,  7.27s/it] ------------------ Training Record ------------------
Epoch: 57/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 9.181
Updated lambda_fail: 9.081
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.0820, reward_valid_std=4.1823
[BatchDiag] adv_mean=0.0456, adv_std=0.4962, adv_abs_mean=0.3793 | ret_mean=8.8680, ret_std=0.6231 | val_mean=8.8224, val_std=0.3381 | explained_var=0.365733
[GradSplit pre-clip] backbone=0.210970, critic=0.873068
[Loss] pg_loss=-0.088886, entropy_loss=0.000037, value_loss=0.027582
[EpochKL] epoch=0 mean_kl=0.00048 max_kl=0.00157
[EpochKL] epoch=1 mean_kl=0.00127 max_kl=0.00229
[EpochKL] epoch=2 mean_kl=0.00099 max_kl=0.00178
[Time] Env Create Time: 4.4073s |Rollout Collect Time: 1.6945s |Loss & Update :0.9497
[PPODiag] kl_mean=0.0009, kl_p90=0.0016, kl_max=0.0023 | clipfrac_mean=0.009, logratio_std_mean=0.041, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.681 | pg_loss_mean=-0.0004, v_loss_mean=0.0584, ent_mean=0.0388 | gn_bb_mean=0.461, gn_bb_max=1.181 | gn_v_mean=0.414, gn_v_max=0.873

  1%|          | 58/5000 [08:24<9:53:26,  7.20s/it]------------------ Training Record ------------------
Epoch: 58/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 9.081
Updated lambda_fail: 8.981
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0741, reward_valid_std=4.1743
[BatchDiag] adv_mean=0.0254, adv_std=0.5092, adv_abs_mean=0.3799 | ret_mean=8.8659, ret_std=0.6367 | val_mean=8.8405, val_std=0.3439 | explained_var=0.360396
[GradSplit pre-clip] backbone=0.165406, critic=0.566880
[Loss] pg_loss=-0.044257, entropy_loss=0.000036, value_loss=0.026523
[EpochKL] epoch=0 mean_kl=0.00083 max_kl=0.00179
[EpochKL] epoch=1 mean_kl=0.00188 max_kl=0.00344
[EpochKL] epoch=2 mean_kl=0.00190 max_kl=0.00352
[Time] Env Create Time: 4.4139s |Rollout Collect Time: 1.6798s |Loss & Update :0.9523
[PPODiag] kl_mean=0.0015, kl_p90=0.0029, kl_max=0.0035 | clipfrac_mean=0.013, logratio_std_mean=0.055, ratio_p95_mean=1.012 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.683 | pg_loss_mean=-0.0000, v_loss_mean=0.0609, ent_mean=0.0381 | gn_bb_mean=0.462, gn_bb_max=0.909 | gn_v_mean=0.344, gn_v_max=0.667

  1%|          | 59/5000 [08:31<9:49:24,  7.16s/it]------------------ Training Record ------------------
Epoch: 59/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 8.981
Updated lambda_fail: 8.881
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.0799, reward_valid_std=4.1786
[BatchDiag] adv_mean=0.0736, adv_std=0.4870, adv_abs_mean=0.3661 | ret_mean=8.8735, ret_std=0.6264 | val_mean=8.7999, val_std=0.3780 | explained_var=0.395416
[GradSplit pre-clip] backbone=0.471204, critic=1.123951
[Loss] pg_loss=-0.099269, entropy_loss=0.000031, value_loss=0.023283
[EpochKL] epoch=0 mean_kl=0.00070 max_kl=0.00179
[EpochKL] epoch=1 mean_kl=0.00140 max_kl=0.00224
[EpochKL] epoch=2 mean_kl=0.00266 max_kl=0.00358
[Time] Env Create Time: 4.3800s |Rollout Collect Time: 1.9421s |Loss & Update :1.0701
[PPODiag] kl_mean=0.0016, kl_p90=0.0029, kl_max=0.0036 | clipfrac_mean=0.012, logratio_std_mean=0.055, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.590, p10=0.585, min=0.580 | pg_loss_mean=-0.0005, v_loss_mean=0.0561, ent_mean=0.0307 | gn_bb_mean=0.514, gn_bb_max=0.965 | gn_v_mean=0.354, gn_v_max=1.124

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.248, Step: 7, Avg Done Step: 6.62, #CS visited: 0.20
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.7875s
-----------------------------
  1%|          | 60/5000 [08:40<10:40:31,  7.78s/it]------------------ Training Record ------------------
Epoch: 60/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 8.881
Updated lambda_fail: 8.781
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.0869, reward_valid_std=4.1793
[BatchDiag] adv_mean=0.0275, adv_std=0.4686, adv_abs_mean=0.3487 | ret_mean=8.8782, ret_std=0.6114 | val_mean=8.8507, val_std=0.3661 | explained_var=0.412591
[GradSplit pre-clip] backbone=0.500051, critic=0.460010
[Loss] pg_loss=-0.031726, entropy_loss=0.000039, value_loss=0.024585
[EpochKL] epoch=0 mean_kl=0.00225 max_kl=0.00642
[EpochKL] epoch=1 mean_kl=0.00285 max_kl=0.00376
[EpochKL] epoch=2 mean_kl=0.00201 max_kl=0.00296
[Time] Env Create Time: 4.3757s |Rollout Collect Time: 1.6863s |Loss & Update :0.9597
[PPODiag] kl_mean=0.0024, kl_p90=0.0036, kl_max=0.0064 | clipfrac_mean=0.014, logratio_std_mean=0.075, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.676 | pg_loss_mean=0.0004, v_loss_mean=0.0523, ent_mean=0.0368 | gn_bb_mean=0.635, gn_bb_max=1.543 | gn_v_mean=0.239, gn_v_max=0.596
[AttnScore] scale=1.0122, C=10.0

  1%|          | 61/5000 [08:47<10:21:41,  7.55s/it]------------------ Training Record ------------------
Epoch: 61/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 8.781
Updated lambda_fail: 8.681
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0784, reward_valid_std=4.1721
[BatchDiag] adv_mean=0.0195, adv_std=0.4890, adv_abs_mean=0.3598 | ret_mean=8.8802, ret_std=0.6277 | val_mean=8.8607, val_std=0.3601 | explained_var=0.393046
[GradSplit pre-clip] backbone=0.360583, critic=0.382281
[Loss] pg_loss=-0.019542, entropy_loss=0.000037, value_loss=0.024414
[EpochKL] epoch=0 mean_kl=0.00140 max_kl=0.00427
[EpochKL] epoch=1 mean_kl=0.00207 max_kl=0.00359
[EpochKL] epoch=2 mean_kl=0.00351 max_kl=0.00636
[Time] Env Create Time: 4.3733s |Rollout Collect Time: 1.7008s |Loss & Update :0.9575
[PPODiag] kl_mean=0.0023, kl_p90=0.0039, kl_max=0.0064 | clipfrac_mean=0.016, logratio_std_mean=0.065, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.678 | pg_loss_mean=0.0001, v_loss_mean=0.0565, ent_mean=0.0391 | gn_bb_mean=0.712, gn_bb_max=1.604 | gn_v_mean=0.303, gn_v_max=0.679

  1%|          | 62/5000 [08:54<10:08:43,  7.40s/it]------------------ Training Record ------------------
Epoch: 62/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 8.681
Updated lambda_fail: 8.581
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.0947, reward_valid_std=4.1785
[BatchDiag] adv_mean=0.0153, adv_std=0.4802, adv_abs_mean=0.3530 | ret_mean=8.9004, ret_std=0.6204 | val_mean=8.8851, val_std=0.3486 | explained_var=0.401020
[GradSplit pre-clip] backbone=0.413221, critic=0.432769
[Loss] pg_loss=-0.050016, entropy_loss=0.000038, value_loss=0.022475
[EpochKL] epoch=0 mean_kl=0.00302 max_kl=0.01235
[EpochKL] epoch=1 mean_kl=0.00370 max_kl=0.00731
[EpochKL] epoch=2 mean_kl=0.00268 max_kl=0.00626
[Time] Env Create Time: 4.5684s |Rollout Collect Time: 1.6975s |Loss & Update :0.9610
[PPODiag] kl_mean=0.0031, kl_p90=0.0061, kl_max=0.0123 | clipfrac_mean=0.019, logratio_std_mean=0.077, ratio_p95_mean=1.013 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.680 | pg_loss_mean=0.0011, v_loss_mean=0.0543, ent_mean=0.0367 | gn_bb_mean=0.840, gn_bb_max=2.051 | gn_v_mean=0.351, gn_v_max=0.607

  1%|▏         | 63/5000 [09:02<10:04:25,  7.35s/it]------------------ Training Record ------------------
Epoch: 63/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 8.581
Updated lambda_fail: 8.481
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.684, reward_valid_mean=2.1062, reward_valid_std=4.1830
[BatchDiag] adv_mean=-0.0167, adv_std=0.4398, adv_abs_mean=0.3284 | ret_mean=8.9153, ret_std=0.5876 | val_mean=8.9320, val_std=0.3247 | explained_var=0.439743
[GradSplit pre-clip] backbone=0.502793, critic=0.110888
[Loss] pg_loss=-0.041899, entropy_loss=0.000033, value_loss=0.017667
[EpochKL] epoch=0 mean_kl=0.00214 max_kl=0.00468
[EpochKL] epoch=1 mean_kl=0.00633 max_kl=0.01054
[EpochKL] epoch=2 mean_kl=0.00859 max_kl=0.01175
[Time] Env Create Time: 4.4126s |Rollout Collect Time: 1.6872s |Loss & Update :0.9607
[PPODiag] kl_mean=0.0057, kl_p90=0.0109, kl_max=0.0117 | clipfrac_mean=0.024, logratio_std_mean=0.110, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.684, p10=0.678, min=0.676 | pg_loss_mean=0.0035, v_loss_mean=0.0483, ent_mean=0.0374 | gn_bb_mean=1.005, gn_bb_max=2.113 | gn_v_mean=0.475, gn_v_max=1.141

  1%|▏         | 64/5000 [09:09<9:57:16,  7.26s/it] ------------------ Training Record ------------------
Epoch: 64/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 8.481
Updated lambda_fail: 8.381
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.588, reward_valid_mean=2.0909, reward_valid_std=4.1774
[BatchDiag] adv_mean=0.0317, adv_std=0.4741, adv_abs_mean=0.3532 | ret_mean=8.8841, ret_std=0.6185 | val_mean=8.8525, val_std=0.4367 | explained_var=0.412543
[GradSplit pre-clip] backbone=0.453804, critic=0.555845
[Loss] pg_loss=-0.038296, entropy_loss=0.000031, value_loss=0.023370
[EpochKL] epoch=0 mean_kl=0.00228 max_kl=0.00520
[EpochKL] epoch=1 mean_kl=0.00308 max_kl=0.00423
[EpochKL] epoch=2 mean_kl=0.00492 max_kl=0.00889
[Time] Env Create Time: 4.4050s |Rollout Collect Time: 1.9296s |Loss & Update :1.0588
[PPODiag] kl_mean=0.0034, kl_p90=0.0063, kl_max=0.0089 | clipfrac_mean=0.021, logratio_std_mean=0.082, ratio_p95_mean=1.012 | valid_ratio_mb_mean=0.588, p10=0.584, min=0.583 | pg_loss_mean=0.0014, v_loss_mean=0.0532, ent_mean=0.0326 | gn_bb_mean=0.776, gn_bb_max=1.410 | gn_v_mean=0.387, gn_v_max=1.021

  1%|▏         | 65/5000 [09:16<10:00:27,  7.30s/it]------------------ Training Record ------------------
Epoch: 65/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 8.381
Updated lambda_fail: 8.281
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.0867, reward_valid_std=4.1754
[BatchDiag] adv_mean=0.0586, adv_std=0.4712, adv_abs_mean=0.3552 | ret_mean=8.8866, ret_std=0.6160 | val_mean=8.8280, val_std=0.4541 | explained_var=0.414930
[GradSplit pre-clip] backbone=0.392335, critic=0.701508
[Loss] pg_loss=-0.038806, entropy_loss=0.000029, value_loss=0.022678
[EpochKL] epoch=0 mean_kl=0.00169 max_kl=0.00305
[EpochKL] epoch=1 mean_kl=0.00523 max_kl=0.00831
[EpochKL] epoch=2 mean_kl=0.00499 max_kl=0.00898
[Time] Env Create Time: 4.4235s |Rollout Collect Time: 1.9325s |Loss & Update :1.0687
[PPODiag] kl_mean=0.0040, kl_p90=0.0081, kl_max=0.0090 | clipfrac_mean=0.021, logratio_std_mean=0.086, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.590, p10=0.586, min=0.584 | pg_loss_mean=0.0023, v_loss_mean=0.0537, ent_mean=0.0314 | gn_bb_mean=0.814, gn_bb_max=1.431 | gn_v_mean=0.418, gn_v_max=1.084
[AttnScore] scale=1.0134, C=10.0

  1%|▏         | 66/5000 [09:24<10:03:24,  7.34s/it]------------------ Training Record ------------------
Epoch: 66/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 8.281
Updated lambda_fail: 8.181
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.587, reward_valid_mean=2.0983, reward_valid_std=4.1844
[BatchDiag] adv_mean=0.0010, adv_std=0.4515, adv_abs_mean=0.3347 | ret_mean=8.9039, ret_std=0.5958 | val_mean=8.9029, val_std=0.4465 | explained_var=0.425798
[GradSplit pre-clip] backbone=0.350221, critic=0.425746
[Loss] pg_loss=-0.089729, entropy_loss=0.000027, value_loss=0.023071
[EpochKL] epoch=0 mean_kl=0.00425 max_kl=0.00692
[EpochKL] epoch=1 mean_kl=0.00810 max_kl=0.01183
[EpochKL] epoch=2 mean_kl=0.00723 max_kl=0.01096
[Time] Env Create Time: 4.3585s |Rollout Collect Time: 1.9219s |Loss & Update :1.0814
[PPODiag] kl_mean=0.0065, kl_p90=0.0099, kl_max=0.0118 | clipfrac_mean=0.029, logratio_std_mean=0.118, ratio_p95_mean=1.014 | valid_ratio_mb_mean=0.587, p10=0.583, min=0.582 | pg_loss_mean=0.0030, v_loss_mean=0.0493, ent_mean=0.0314 | gn_bb_mean=0.907, gn_bb_max=1.742 | gn_v_mean=0.505, gn_v_max=1.116

  1%|▏         | 67/5000 [09:31<10:03:53,  7.35s/it]------------------ Training Record ------------------
Epoch: 67/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 8.181
Updated lambda_fail: 8.081
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.0859, reward_valid_std=4.1793
[BatchDiag] adv_mean=0.0671, adv_std=0.4774, adv_abs_mean=0.3594 | ret_mean=8.8931, ret_std=0.6202 | val_mean=8.8260, val_std=0.5019 | explained_var=0.407457
[GradSplit pre-clip] backbone=0.344877, critic=0.737622
[Loss] pg_loss=-0.032480, entropy_loss=0.000032, value_loss=0.021607
[EpochKL] epoch=0 mean_kl=0.00362 max_kl=0.00672
[EarlyStop] epoch=1 mean_kl=0.01113 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01113 max_kl=0.02146
[Time] Env Create Time: 4.3679s |Rollout Collect Time: 1.6878s |Loss & Update :0.6520
[PPODiag] kl_mean=0.0074, kl_p90=0.0160, kl_max=0.0215 | clipfrac_mean=0.029, logratio_std_mean=0.118, ratio_p95_mean=1.012 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.681 | pg_loss_mean=0.0050, v_loss_mean=0.0553, ent_mean=0.0374 | gn_bb_mean=1.077, gn_bb_max=1.622 | gn_v_mean=0.741, gn_v_max=1.355

  1%|▏         | 68/5000 [09:38<9:48:03,  7.15s/it] ------------------ Training Record ------------------
Epoch: 68/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 8.081
Updated lambda_fail: 7.981
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1023, reward_valid_std=4.1836
[BatchDiag] adv_mean=0.0874, adv_std=0.4519, adv_abs_mean=0.3483 | ret_mean=8.9040, ret_std=0.6051 | val_mean=8.8166, val_std=0.4273 | explained_var=0.442121
[GradSplit pre-clip] backbone=0.484537, critic=0.895177
[Loss] pg_loss=-0.023858, entropy_loss=0.000028, value_loss=0.022141
[EpochKL] epoch=0 mean_kl=0.00209 max_kl=0.00425
[EarlyStop] epoch=1 mean_kl=0.01174 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01174 max_kl=0.01942
[Time] Env Create Time: 4.5929s |Rollout Collect Time: 1.6946s |Loss & Update :0.6644
[PPODiag] kl_mean=0.0069, kl_p90=0.0161, kl_max=0.0194 | clipfrac_mean=0.023, logratio_std_mean=0.119, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.685, p10=0.681, min=0.680 | pg_loss_mean=0.0025, v_loss_mean=0.0496, ent_mean=0.0337 | gn_bb_mean=0.898, gn_bb_max=1.801 | gn_v_mean=0.507, gn_v_max=1.046

  1%|▏         | 69/5000 [09:45<9:42:58,  7.09s/it]------------------ Training Record ------------------
Epoch: 69/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 7.981
Updated lambda_fail: 7.881
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.0957, reward_valid_std=4.1731
[BatchDiag] adv_mean=0.0697, adv_std=0.4613, adv_abs_mean=0.3456 | ret_mean=8.8927, ret_std=0.6180 | val_mean=8.8229, val_std=0.4075 | explained_var=0.442786
[GradSplit pre-clip] backbone=0.506017, critic=0.722932
[Loss] pg_loss=0.008887, entropy_loss=0.000033, value_loss=0.024283
[EpochKL] epoch=0 mean_kl=0.00450 max_kl=0.00801
[EpochKL] epoch=1 mean_kl=0.00507 max_kl=0.00717
[EpochKL] epoch=2 mean_kl=0.00793 max_kl=0.01167
[Time] Env Create Time: 4.4230s |Rollout Collect Time: 1.6995s |Loss & Update :0.9538
[PPODiag] kl_mean=0.0058, kl_p90=0.0093, kl_max=0.0117 | clipfrac_mean=0.025, logratio_std_mean=0.114, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.680 | pg_loss_mean=0.0024, v_loss_mean=0.0518, ent_mean=0.0333 | gn_bb_mean=0.838, gn_bb_max=1.625 | gn_v_mean=0.393, gn_v_max=1.093

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.142, Step: 7, Avg Done Step: 6.58, #CS visited: 0.17
D->C5->C4->C3->D->C2->C1->D
Eval cost : 1.8222s
-----------------------------
  1%|▏         | 70/5000 [09:54<10:28:42,  7.65s/it]------------------ Training Record ------------------
Epoch: 70/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 7.881
Updated lambda_fail: 7.781
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.0966, reward_valid_std=4.1786
[BatchDiag] adv_mean=0.0242, adv_std=0.4395, adv_abs_mean=0.3255 | ret_mean=8.9086, ret_std=0.6003 | val_mean=8.8844, val_std=0.4335 | explained_var=0.463900
[GradSplit pre-clip] backbone=0.425959, critic=0.140793
[Loss] pg_loss=0.036234, entropy_loss=0.000032, value_loss=0.019843
[EpochKL] epoch=0 mean_kl=0.00374 max_kl=0.01153
[EpochKL] epoch=1 mean_kl=0.00494 max_kl=0.00802
[EpochKL] epoch=2 mean_kl=0.00529 max_kl=0.00919
[Time] Env Create Time: 4.4067s |Rollout Collect Time: 1.6910s |Loss & Update :0.9629
[PPODiag] kl_mean=0.0047, kl_p90=0.0079, kl_max=0.0115 | clipfrac_mean=0.022, logratio_std_mean=0.095, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.678 | pg_loss_mean=0.0023, v_loss_mean=0.0463, ent_mean=0.0336 | gn_bb_mean=0.902, gn_bb_max=1.736 | gn_v_mean=0.312, gn_v_max=0.721
[AttnScore] scale=1.0145, C=10.0

  1%|▏         | 71/5000 [10:01<10:14:01,  7.47s/it]------------------ Training Record ------------------
Epoch: 71/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 7.781
Updated lambda_fail: 7.681
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.0999, reward_valid_std=4.1817
[BatchDiag] adv_mean=0.0136, adv_std=0.4294, adv_abs_mean=0.3156 | ret_mean=8.9138, ret_std=0.5989 | val_mean=8.9002, val_std=0.4197 | explained_var=0.485862
[GradSplit pre-clip] backbone=0.519501, critic=0.283398
[Loss] pg_loss=-0.018813, entropy_loss=0.000038, value_loss=0.019140
[EpochKL] epoch=0 mean_kl=0.00407 max_kl=0.01058
[EpochKL] epoch=1 mean_kl=0.00887 max_kl=0.01562
[EpochKL] epoch=2 mean_kl=0.00754 max_kl=0.01763
[Time] Env Create Time: 4.4036s |Rollout Collect Time: 1.6978s |Loss & Update :0.9577
[PPODiag] kl_mean=0.0068, kl_p90=0.0127, kl_max=0.0176 | clipfrac_mean=0.026, logratio_std_mean=0.117, ratio_p95_mean=1.012 | valid_ratio_mb_mean=0.686, p10=0.683, min=0.679 | pg_loss_mean=0.0025, v_loss_mean=0.0439, ent_mean=0.0360 | gn_bb_mean=0.920, gn_bb_max=1.893 | gn_v_mean=0.253, gn_v_max=0.550

  1%|▏         | 72/5000 [10:08<10:03:40,  7.35s/it]------------------ Training Record ------------------
Epoch: 72/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 7.681
Updated lambda_fail: 7.581
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.0926, reward_valid_std=4.1731
[BatchDiag] adv_mean=0.0312, adv_std=0.4426, adv_abs_mean=0.3243 | ret_mean=8.8957, ret_std=0.6065 | val_mean=8.8644, val_std=0.4318 | explained_var=0.467433
[GradSplit pre-clip] backbone=1.184899, critic=0.675269
[Loss] pg_loss=-0.079600, entropy_loss=0.000038, value_loss=0.020942
[EpochKL] epoch=0 mean_kl=0.00452 max_kl=0.00791
[EpochKL] epoch=1 mean_kl=0.00935 max_kl=0.01292
[EarlyStop] epoch=2 mean_kl=0.01257 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01257 max_kl=0.02135
[Time] Env Create Time: 4.3833s |Rollout Collect Time: 1.7055s |Loss & Update :0.9581
[PPODiag] kl_mean=0.0088, kl_p90=0.0147, kl_max=0.0213 | clipfrac_mean=0.030, logratio_std_mean=0.139, ratio_p95_mean=1.012 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.681 | pg_loss_mean=0.0046, v_loss_mean=0.0484, ent_mean=0.0366 | gn_bb_mean=0.878, gn_bb_max=1.729 | gn_v_mean=0.430, gn_v_max=0.864

  1%|▏         | 73/5000 [10:15<9:56:05,  7.26s/it] ------------------ Training Record ------------------
Epoch: 73/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 7.581
Updated lambda_fail: 7.481
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1059, reward_valid_std=4.1808
[BatchDiag] adv_mean=-0.0003, adv_std=0.4270, adv_abs_mean=0.3137 | ret_mean=8.9200, ret_std=0.5887 | val_mean=8.9203, val_std=0.3734 | explained_var=0.473930
[GradSplit pre-clip] backbone=0.635815, critic=0.091222
[Loss] pg_loss=0.029313, entropy_loss=0.000029, value_loss=0.019517
[EpochKL] epoch=0 mean_kl=0.00375 max_kl=0.00761
[EpochKL] epoch=1 mean_kl=0.00549 max_kl=0.00802
[EpochKL] epoch=2 mean_kl=0.00454 max_kl=0.00588
[Time] Env Create Time: 4.5897s |Rollout Collect Time: 1.6804s |Loss & Update :0.9588
[PPODiag] kl_mean=0.0046, kl_p90=0.0065, kl_max=0.0080 | clipfrac_mean=0.024, logratio_std_mean=0.097, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.685, p10=0.682, min=0.679 | pg_loss_mean=0.0026, v_loss_mean=0.0432, ent_mean=0.0341 | gn_bb_mean=0.911, gn_bb_max=1.442 | gn_v_mean=0.306, gn_v_max=0.825

  1%|▏         | 74/5000 [10:22<9:55:14,  7.25s/it]------------------ Training Record ------------------
Epoch: 74/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 7.481
Updated lambda_fail: 7.381
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0886, reward_valid_std=4.1730
[BatchDiag] adv_mean=-0.0092, adv_std=0.4389, adv_abs_mean=0.3191 | ret_mean=8.8976, ret_std=0.6038 | val_mean=8.9068, val_std=0.3809 | explained_var=0.471525
[GradSplit pre-clip] backbone=1.126870, critic=0.163396
[Loss] pg_loss=-0.036386, entropy_loss=0.000038, value_loss=0.019912
[EpochKL] epoch=0 mean_kl=0.00208 max_kl=0.00352
[EpochKL] epoch=1 mean_kl=0.00270 max_kl=0.00483
[EpochKL] epoch=2 mean_kl=0.00583 max_kl=0.00872
[Time] Env Create Time: 4.3953s |Rollout Collect Time: 1.6766s |Loss & Update :0.9608
[PPODiag] kl_mean=0.0035, kl_p90=0.0068, kl_max=0.0087 | clipfrac_mean=0.022, logratio_std_mean=0.081, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.681 | pg_loss_mean=0.0016, v_loss_mean=0.0452, ent_mean=0.0356 | gn_bb_mean=0.945, gn_bb_max=2.087 | gn_v_mean=0.257, gn_v_max=0.745

  2%|▏         | 75/5000 [10:29<9:49:46,  7.19s/it]------------------ Training Record ------------------
Epoch: 75/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 7.381
Updated lambda_fail: 7.281
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.0805, reward_valid_std=4.1756
[BatchDiag] adv_mean=-0.0345, adv_std=0.4270, adv_abs_mean=0.3062 | ret_mean=8.8911, ret_std=0.6013 | val_mean=8.9256, val_std=0.4016 | explained_var=0.495825
[GradSplit pre-clip] backbone=0.409251, critic=0.075770
[Loss] pg_loss=-0.049458, entropy_loss=0.000030, value_loss=0.017976
[EpochKL] epoch=0 mean_kl=0.00166 max_kl=0.00358
[EpochKL] epoch=1 mean_kl=0.00686 max_kl=0.01302
[EarlyStop] epoch=2 mean_kl=0.01094 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01094 max_kl=0.02822
[Time] Env Create Time: 4.3983s |Rollout Collect Time: 1.9191s |Loss & Update :1.0689
[PPODiag] kl_mean=0.0065, kl_p90=0.0135, kl_max=0.0282 | clipfrac_mean=0.025, logratio_std_mean=0.112, ratio_p95_mean=1.011 | valid_ratio_mb_mean=0.591, p10=0.586, min=0.583 | pg_loss_mean=0.0021, v_loss_mean=0.0448, ent_mean=0.0320 | gn_bb_mean=0.993, gn_bb_max=1.813 | gn_v_mean=0.600, gn_v_max=1.654
[AttnScore] scale=1.0159, C=10.0

  2%|▏         | 76/5000 [10:36<9:54:37,  7.25s/it]------------------ Training Record ------------------
Epoch: 76/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 7.281
Updated lambda_fail: 7.181
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1012, reward_valid_std=4.1821
[BatchDiag] adv_mean=0.1227, adv_std=0.4110, adv_abs_mean=0.3239 | ret_mean=8.9143, ret_std=0.5992 | val_mean=8.7916, val_std=0.4452 | explained_var=0.529487
[GradSplit pre-clip] backbone=0.687423, critic=1.291360
[Loss] pg_loss=-0.058398, entropy_loss=0.000032, value_loss=0.019060
[EpochKL] epoch=0 mean_kl=0.00597 max_kl=0.01516
[EpochKL] epoch=1 mean_kl=0.00964 max_kl=0.01946
[EarlyStop] epoch=2 mean_kl=0.01349 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01349 max_kl=0.02291
[Time] Env Create Time: 4.4087s |Rollout Collect Time: 1.7043s |Loss & Update :0.9763
[PPODiag] kl_mean=0.0097, kl_p90=0.0182, kl_max=0.0229 | clipfrac_mean=0.030, logratio_std_mean=0.147, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.679 | pg_loss_mean=0.0048, v_loss_mean=0.0417, ent_mean=0.0337 | gn_bb_mean=1.047, gn_bb_max=1.798 | gn_v_mean=0.654, gn_v_max=1.291

  2%|▏         | 77/5000 [10:43<9:50:40,  7.20s/it]------------------ Training Record ------------------
Epoch: 77/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 7.181
Updated lambda_fail: 7.081
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.0950, reward_valid_std=4.1748
[BatchDiag] adv_mean=-0.0328, adv_std=0.4141, adv_abs_mean=0.2903 | ret_mean=8.9166, ret_std=0.5971 | val_mean=8.9495, val_std=0.3840 | explained_var=0.519065
[GradSplit pre-clip] backbone=0.468976, critic=0.065321
[Loss] pg_loss=-0.031278, entropy_loss=0.000025, value_loss=0.019300
[EpochKL] epoch=0 mean_kl=0.00185 max_kl=0.00426
[EarlyStop] epoch=1 mean_kl=0.01461 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01461 max_kl=0.02544
[Time] Env Create Time: 4.3970s |Rollout Collect Time: 1.9346s |Loss & Update :0.7331
[PPODiag] kl_mean=0.0082, kl_p90=0.0200, kl_max=0.0254 | clipfrac_mean=0.025, logratio_std_mean=0.122, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.590, p10=0.587, min=0.586 | pg_loss_mean=0.0048, v_loss_mean=0.0410, ent_mean=0.0283 | gn_bb_mean=1.137, gn_bb_max=2.331 | gn_v_mean=0.423, gn_v_max=1.017

  2%|▏         | 78/5000 [10:51<9:47:15,  7.16s/it]------------------ Training Record ------------------
Epoch: 78/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 7.081
Updated lambda_fail: 6.981
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0924, reward_valid_std=4.1741
[BatchDiag] adv_mean=-0.0168, adv_std=0.4303, adv_abs_mean=0.3120 | ret_mean=8.9074, ret_std=0.6029 | val_mean=8.9242, val_std=0.3619 | explained_var=0.490791
[GradSplit pre-clip] backbone=0.487610, critic=0.146162
[Loss] pg_loss=-0.050482, entropy_loss=0.000031, value_loss=0.017319
[EarlyStop] epoch=0 mean_kl=0.01054 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01054 max_kl=0.01871
[Time] Env Create Time: 4.3740s |Rollout Collect Time: 1.6898s |Loss & Update :0.3565
[PPODiag] kl_mean=0.0105, kl_p90=0.0177, kl_max=0.0187 | clipfrac_mean=0.030, logratio_std_mean=0.142, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.685 | pg_loss_mean=0.0074, v_loss_mean=0.0443, ent_mean=0.0344 | gn_bb_mean=1.272, gn_bb_max=2.665 | gn_v_mean=0.311, gn_v_max=0.645

  2%|▏         | 79/5000 [10:57<9:28:58,  6.94s/it]------------------ Training Record ------------------
Epoch: 79/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 6.981
Updated lambda_fail: 6.881
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.0921, reward_valid_std=4.1744
[BatchDiag] adv_mean=0.0156, adv_std=0.4289, adv_abs_mean=0.3102 | ret_mean=8.9056, ret_std=0.6032 | val_mean=8.8900, val_std=0.4167 | explained_var=0.494297
[GradSplit pre-clip] backbone=0.876275, critic=0.160192
[Loss] pg_loss=0.041647, entropy_loss=0.000034, value_loss=0.019694
[EpochKL] epoch=0 mean_kl=0.00720 max_kl=0.01397
[EpochKL] epoch=1 mean_kl=0.00700 max_kl=0.01213
[EpochKL] epoch=2 mean_kl=0.00688 max_kl=0.01243
[Time] Env Create Time: 4.3600s |Rollout Collect Time: 1.6912s |Loss & Update :0.9617
[PPODiag] kl_mean=0.0070, kl_p90=0.0124, kl_max=0.0140 | clipfrac_mean=0.028, logratio_std_mean=0.123, ratio_p95_mean=1.015 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.679 | pg_loss_mean=0.0042, v_loss_mean=0.0446, ent_mean=0.0348 | gn_bb_mean=1.063, gn_bb_max=1.737 | gn_v_mean=0.260, gn_v_max=0.798

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.062, Step: 7, Avg Done Step: 6.60, #CS visited: 0.14
D->C5->C4->C3->D->C2->C1->D
Eval cost : 1.7839s
-----------------------------
  2%|▏         | 80/5000 [11:06<10:16:03,  7.51s/it]------------------ Training Record ------------------
Epoch: 80/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 6.881
Updated lambda_fail: 6.781
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0873, reward_valid_std=4.1715
[BatchDiag] adv_mean=0.0434, adv_std=0.4288, adv_abs_mean=0.3139 | ret_mean=8.9089, ret_std=0.6032 | val_mean=8.8655, val_std=0.4160 | explained_var=0.494525
[GradSplit pre-clip] backbone=0.436585, critic=0.815497
[Loss] pg_loss=-0.091627, entropy_loss=0.000030, value_loss=0.019580
[EpochKL] epoch=0 mean_kl=0.00650 max_kl=0.01919
[EpochKL] epoch=1 mean_kl=0.00657 max_kl=0.01294
[EpochKL] epoch=2 mean_kl=0.00729 max_kl=0.01099
[Time] Env Create Time: 4.5781s |Rollout Collect Time: 1.6802s |Loss & Update :0.9590
[PPODiag] kl_mean=0.0068, kl_p90=0.0109, kl_max=0.0192 | clipfrac_mean=0.028, logratio_std_mean=0.121, ratio_p95_mean=1.017 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.679 | pg_loss_mean=0.0028, v_loss_mean=0.0449, ent_mean=0.0343 | gn_bb_mean=0.953, gn_bb_max=1.576 | gn_v_mean=0.405, gn_v_max=0.815
[AttnScore] scale=1.0170, C=10.0

  2%|▏         | 81/5000 [11:13<10:08:40,  7.42s/it]------------------ Training Record ------------------
Epoch: 81/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 6.781
Updated lambda_fail: 6.681
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.587, reward_valid_mean=2.1085, reward_valid_std=4.1849
[BatchDiag] adv_mean=0.0563, adv_std=0.3975, adv_abs_mean=0.2969 | ret_mean=8.9266, ret_std=0.5827 | val_mean=8.8703, val_std=0.4071 | explained_var=0.534807
[GradSplit pre-clip] backbone=0.828640, critic=0.377350
[Loss] pg_loss=0.055959, entropy_loss=0.000030, value_loss=0.018860
[EpochKL] epoch=0 mean_kl=0.00498 max_kl=0.01023
[EpochKL] epoch=1 mean_kl=0.00962 max_kl=0.01204
[EarlyStop] epoch=2 mean_kl=0.01320 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01320 max_kl=0.02320
[Time] Env Create Time: 4.4068s |Rollout Collect Time: 1.9426s |Loss & Update :1.0666
[PPODiag] kl_mean=0.0093, kl_p90=0.0153, kl_max=0.0232 | clipfrac_mean=0.028, logratio_std_mean=0.141, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.587, p10=0.583, min=0.582 | pg_loss_mean=0.0045, v_loss_mean=0.0399, ent_mean=0.0275 | gn_bb_mean=1.053, gn_bb_max=1.685 | gn_v_mean=0.522, gn_v_max=0.976

  2%|▏         | 82/5000 [11:20<10:08:21,  7.42s/it]------------------ Training Record ------------------
Epoch: 82/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 6.681
Updated lambda_fail: 6.581
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0857, reward_valid_std=4.1714
[BatchDiag] adv_mean=0.0712, adv_std=0.4290, adv_abs_mean=0.3162 | ret_mean=8.9108, ret_std=0.6099 | val_mean=8.8396, val_std=0.4345 | explained_var=0.505101
[GradSplit pre-clip] backbone=0.584248, critic=0.918551
[Loss] pg_loss=-0.077377, entropy_loss=0.000026, value_loss=0.015657
[EpochKL] epoch=0 mean_kl=0.00296 max_kl=0.00824
[EpochKL] epoch=1 mean_kl=0.00459 max_kl=0.00862
[EpochKL] epoch=2 mean_kl=0.00659 max_kl=0.00851
[Time] Env Create Time: 4.3782s |Rollout Collect Time: 1.9101s |Loss & Update :1.0783
[PPODiag] kl_mean=0.0047, kl_p90=0.0082, kl_max=0.0086 | clipfrac_mean=0.021, logratio_std_mean=0.101, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.592, p10=0.588, min=0.586 | pg_loss_mean=0.0023, v_loss_mean=0.0448, ent_mean=0.0281 | gn_bb_mean=0.971, gn_bb_max=2.226 | gn_v_mean=0.370, gn_v_max=0.946

  2%|▏         | 83/5000 [11:28<10:06:53,  7.41s/it]------------------ Training Record ------------------
Epoch: 83/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 6.581
Updated lambda_fail: 6.481
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0938, reward_valid_std=4.1768
[BatchDiag] adv_mean=-0.0116, adv_std=0.4300, adv_abs_mean=0.3043 | ret_mean=8.9134, ret_std=0.6071 | val_mean=8.9249, val_std=0.3649 | explained_var=0.498337
[GradSplit pre-clip] backbone=0.967889, critic=0.113354
[Loss] pg_loss=-0.018535, entropy_loss=0.000032, value_loss=0.017165
[EpochKL] epoch=0 mean_kl=0.00322 max_kl=0.00461
[EpochKL] epoch=1 mean_kl=0.00986 max_kl=0.02016
[EarlyStop] epoch=2 mean_kl=0.01190 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01190 max_kl=0.02180
[Time] Env Create Time: 4.3697s |Rollout Collect Time: 1.6869s |Loss & Update :0.9529
[PPODiag] kl_mean=0.0083, kl_p90=0.0188, kl_max=0.0218 | clipfrac_mean=0.030, logratio_std_mean=0.135, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.679 | pg_loss_mean=0.0045, v_loss_mean=0.0431, ent_mean=0.0326 | gn_bb_mean=1.192, gn_bb_max=2.142 | gn_v_mean=0.306, gn_v_max=0.635

  2%|▏         | 84/5000 [11:35<9:57:02,  7.29s/it] ------------------ Training Record ------------------
Epoch: 84/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 6.481
Updated lambda_fail: 6.381
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.694, reward_valid_mean=2.0718, reward_valid_std=4.1677
[BatchDiag] adv_mean=-0.0271, adv_std=0.4475, adv_abs_mean=0.3104 | ret_mean=8.9050, ret_std=0.6233 | val_mean=8.9321, val_std=0.4321 | explained_var=0.484566
[GradSplit pre-clip] backbone=0.744694, critic=0.138808
[Loss] pg_loss=-0.030876, entropy_loss=0.000026, value_loss=0.020629
[EpochKL] epoch=0 mean_kl=0.00403 max_kl=0.00891
[EarlyStop] epoch=1 mean_kl=0.01261 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01261 max_kl=0.02487
[Time] Env Create Time: 4.3655s |Rollout Collect Time: 1.6950s |Loss & Update :0.6532
[PPODiag] kl_mean=0.0083, kl_p90=0.0177, kl_max=0.0249 | clipfrac_mean=0.026, logratio_std_mean=0.139, ratio_p95_mean=1.012 | valid_ratio_mb_mean=0.694, p10=0.687, min=0.685 | pg_loss_mean=0.0007, v_loss_mean=0.0474, ent_mean=0.0326 | gn_bb_mean=0.764, gn_bb_max=1.080 | gn_v_mean=0.358, gn_v_max=0.823

  2%|▏         | 85/5000 [11:42<9:42:50,  7.12s/it]------------------ Training Record ------------------
Epoch: 85/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 6.381
Updated lambda_fail: 6.281
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0906, reward_valid_std=4.1703
[BatchDiag] adv_mean=-0.0374, adv_std=0.4189, adv_abs_mean=0.2984 | ret_mean=8.9114, ret_std=0.6014 | val_mean=8.9488, val_std=0.3484 | explained_var=0.514788
[GradSplit pre-clip] backbone=1.093814, critic=0.134813
[Loss] pg_loss=-0.047780, entropy_loss=0.000031, value_loss=0.018314
[EpochKL] epoch=0 mean_kl=0.00258 max_kl=0.00601
[EpochKL] epoch=1 mean_kl=0.00406 max_kl=0.00737
[EpochKL] epoch=2 mean_kl=0.00514 max_kl=0.00708
[Time] Env Create Time: 4.3561s |Rollout Collect Time: 1.6801s |Loss & Update :0.9490
[PPODiag] kl_mean=0.0039, kl_p90=0.0061, kl_max=0.0074 | clipfrac_mean=0.019, logratio_std_mean=0.092, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.684 | pg_loss_mean=0.0002, v_loss_mean=0.0425, ent_mean=0.0295 | gn_bb_mean=0.635, gn_bb_max=1.100 | gn_v_mean=0.337, gn_v_max=0.614
[AttnScore] scale=1.0181, C=10.0

  2%|▏         | 86/5000 [11:49<9:39:32,  7.08s/it]------------------ Training Record ------------------
Epoch: 86/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 6.281
Updated lambda_fail: 6.181
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0823, reward_valid_std=4.1729
[BatchDiag] adv_mean=-0.0554, adv_std=0.4393, adv_abs_mean=0.3111 | ret_mean=8.9125, ret_std=0.6125 | val_mean=8.9679, val_std=0.3549 | explained_var=0.485577
[GradSplit pre-clip] backbone=0.891618, critic=0.503212
[Loss] pg_loss=0.046456, entropy_loss=0.000031, value_loss=0.021522
[EpochKL] epoch=0 mean_kl=0.00188 max_kl=0.00326
[EpochKL] epoch=1 mean_kl=0.00537 max_kl=0.01123
[EarlyStop] epoch=2 mean_kl=0.01041 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01041 max_kl=0.02476
[Time] Env Create Time: 4.5685s |Rollout Collect Time: 1.6946s |Loss & Update :0.9520
[PPODiag] kl_mean=0.0059, kl_p90=0.0146, kl_max=0.0248 | clipfrac_mean=0.023, logratio_std_mean=0.106, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.692, p10=0.685, min=0.682 | pg_loss_mean=0.0019, v_loss_mean=0.0452, ent_mean=0.0319 | gn_bb_mean=0.961, gn_bb_max=2.300 | gn_v_mean=0.353, gn_v_max=0.878

  2%|▏         | 87/5000 [11:56<9:42:50,  7.12s/it]------------------ Training Record ------------------
Epoch: 87/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 6.181
Updated lambda_fail: 6.081
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0951, reward_valid_std=4.1791
[BatchDiag] adv_mean=-0.0084, adv_std=0.4150, adv_abs_mean=0.2989 | ret_mean=8.9347, ret_std=0.5997 | val_mean=8.9431, val_std=0.3969 | explained_var=0.521036
[GradSplit pre-clip] backbone=0.624651, critic=0.319523
[Loss] pg_loss=-0.090492, entropy_loss=0.000028, value_loss=0.013743
[EpochKL] epoch=0 mean_kl=0.00774 max_kl=0.01569
[EarlyStop] epoch=1 mean_kl=0.01222 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01222 max_kl=0.02587
[Time] Env Create Time: 4.3928s |Rollout Collect Time: 1.6764s |Loss & Update :0.6520
[PPODiag] kl_mean=0.0100, kl_p90=0.0212, kl_max=0.0259 | clipfrac_mean=0.027, logratio_std_mean=0.155, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.681 | pg_loss_mean=0.0035, v_loss_mean=0.0408, ent_mean=0.0298 | gn_bb_mean=0.936, gn_bb_max=1.650 | gn_v_mean=0.215, gn_v_max=0.536

  2%|▏         | 88/5000 [12:02<9:32:59,  7.00s/it]------------------ Training Record ------------------
Epoch: 88/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 6.081
Updated lambda_fail: 5.981
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.593, reward_valid_mean=2.0805, reward_valid_std=4.1702
[BatchDiag] adv_mean=-0.0035, adv_std=0.4245, adv_abs_mean=0.2972 | ret_mean=8.9017, ret_std=0.6114 | val_mean=8.9052, val_std=0.4263 | explained_var=0.517997
[GradSplit pre-clip] backbone=0.849370, critic=0.309020
[Loss] pg_loss=-0.042781, entropy_loss=0.000025, value_loss=0.019823
[EpochKL] epoch=0 mean_kl=0.00824 max_kl=0.01652
[EpochKL] epoch=1 mean_kl=0.00823 max_kl=0.01456
[EpochKL] epoch=2 mean_kl=0.00592 max_kl=0.00832
[Time] Env Create Time: 4.4043s |Rollout Collect Time: 1.9226s |Loss & Update :1.0783
[PPODiag] kl_mean=0.0075, kl_p90=0.0134, kl_max=0.0165 | clipfrac_mean=0.028, logratio_std_mean=0.129, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.593, p10=0.588, min=0.585 | pg_loss_mean=0.0019, v_loss_mean=0.0424, ent_mean=0.0272 | gn_bb_mean=0.941, gn_bb_max=1.589 | gn_v_mean=0.311, gn_v_max=0.801

  2%|▏         | 89/5000 [12:10<9:42:51,  7.12s/it]------------------ Training Record ------------------
Epoch: 89/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 5.981
Updated lambda_fail: 5.881
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0890, reward_valid_std=4.1743
[BatchDiag] adv_mean=0.0425, adv_std=0.4106, adv_abs_mean=0.2945 | ret_mean=8.9180, ret_std=0.6076 | val_mean=8.8755, val_std=0.4415 | explained_var=0.543373
[GradSplit pre-clip] backbone=0.546001, critic=0.638367
[Loss] pg_loss=-0.059891, entropy_loss=0.000026, value_loss=0.015687
[EpochKL] epoch=0 mean_kl=0.00301 max_kl=0.00576
[EarlyStop] epoch=1 mean_kl=0.01109 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01109 max_kl=0.02574
[Time] Env Create Time: 4.3956s |Rollout Collect Time: 1.6947s |Loss & Update :0.6555
[PPODiag] kl_mean=0.0071, kl_p90=0.0152, kl_max=0.0257 | clipfrac_mean=0.023, logratio_std_mean=0.119, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.691, p10=0.687, min=0.683 | pg_loss_mean=0.0021, v_loss_mean=0.0417, ent_mean=0.0300 | gn_bb_mean=0.864, gn_bb_max=1.713 | gn_v_mean=0.363, gn_v_max=0.664

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.059, Step: 8, Avg Done Step: 6.65, #CS visited: 0.14
D->C5->C2->C3->D->C4->C1->D
Eval cost : 1.9252s
-----------------------------
  2%|▏         | 90/5000 [12:19<10:22:19,  7.60s/it]------------------ Training Record ------------------
Epoch: 90/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 5.881
Updated lambda_fail: 5.781
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0935, reward_valid_std=4.1702
[BatchDiag] adv_mean=0.0422, adv_std=0.4145, adv_abs_mean=0.2963 | ret_mean=8.9234, ret_std=0.6051 | val_mean=8.8813, val_std=0.4771 | explained_var=0.530705
[GradSplit pre-clip] backbone=0.543620, critic=0.702718
[Loss] pg_loss=-0.093601, entropy_loss=0.000022, value_loss=0.014494
[EarlyStop] epoch=0 mean_kl=0.01193 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01193 max_kl=0.02860
[Time] Env Create Time: 4.3848s |Rollout Collect Time: 2.1153s |Loss & Update :0.3957
[PPODiag] kl_mean=0.0119, kl_p90=0.0220, kl_max=0.0286 | clipfrac_mean=0.028, logratio_std_mean=0.168, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.592, p10=0.588, min=0.587 | pg_loss_mean=0.0044, v_loss_mean=0.0421, ent_mean=0.0252 | gn_bb_mean=1.102, gn_bb_max=1.878 | gn_v_mean=0.432, gn_v_max=0.726
[AttnScore] scale=1.0189, C=10.0

  2%|▏         | 91/5000 [12:25<10:04:48,  7.39s/it]------------------ Training Record ------------------
Epoch: 91/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 5.781
Updated lambda_fail: 5.681
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0882, reward_valid_std=4.1794
[BatchDiag] adv_mean=-0.0471, adv_std=0.4127, adv_abs_mean=0.2906 | ret_mean=8.9177, ret_std=0.6007 | val_mean=8.9648, val_std=0.4229 | explained_var=0.528082
[GradSplit pre-clip] backbone=0.726506, critic=0.280766
[Loss] pg_loss=-0.023457, entropy_loss=0.000028, value_loss=0.017499
[EpochKL] epoch=0 mean_kl=0.00374 max_kl=0.01025
[EpochKL] epoch=1 mean_kl=0.00817 max_kl=0.01560
[EarlyStop] epoch=2 mean_kl=0.01290 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01290 max_kl=0.02217
[Time] Env Create Time: 4.3898s |Rollout Collect Time: 1.6901s |Loss & Update :0.9526
[PPODiag] kl_mean=0.0083, kl_p90=0.0153, kl_max=0.0222 | clipfrac_mean=0.028, logratio_std_mean=0.133, ratio_p95_mean=1.012 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.683 | pg_loss_mean=0.0033, v_loss_mean=0.0405, ent_mean=0.0313 | gn_bb_mean=0.993, gn_bb_max=2.151 | gn_v_mean=0.316, gn_v_max=0.724

  2%|▏         | 92/5000 [12:33<9:55:56,  7.29s/it] ------------------ Training Record ------------------
Epoch: 92/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 5.681
Updated lambda_fail: 5.581
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.0935, reward_valid_std=4.1822
[BatchDiag] adv_mean=-0.0566, adv_std=0.4079, adv_abs_mean=0.2889 | ret_mean=8.9157, ret_std=0.6009 | val_mean=8.9722, val_std=0.3900 | explained_var=0.539089
[GradSplit pre-clip] backbone=0.920387, critic=0.226254
[Loss] pg_loss=-0.071539, entropy_loss=0.000033, value_loss=0.016311
[EpochKL] epoch=0 mean_kl=0.00518 max_kl=0.01506
[EpochKL] epoch=1 mean_kl=0.00948 max_kl=0.03173
[EpochKL] epoch=2 mean_kl=0.00728 max_kl=0.01209
[Time] Env Create Time: 4.3954s |Rollout Collect Time: 1.6989s |Loss & Update :0.9527
[PPODiag] kl_mean=0.0073, kl_p90=0.0142, kl_max=0.0317 | clipfrac_mean=0.025, logratio_std_mean=0.125, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.681 | pg_loss_mean=0.0023, v_loss_mean=0.0390, ent_mean=0.0312 | gn_bb_mean=0.979, gn_bb_max=1.854 | gn_v_mean=0.301, gn_v_max=0.703

  2%|▏         | 93/5000 [12:40<9:49:58,  7.21s/it]------------------ Training Record ------------------
Epoch: 93/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 5.581
Updated lambda_fail: 5.481
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1028, reward_valid_std=4.1844
[BatchDiag] adv_mean=0.0335, adv_std=0.3983, adv_abs_mean=0.2872 | ret_mean=8.9341, ret_std=0.5971 | val_mean=8.9007, val_std=0.4220 | explained_var=0.555024
[GradSplit pre-clip] backbone=0.838779, critic=0.371234
[Loss] pg_loss=0.026557, entropy_loss=0.000026, value_loss=0.019586
[EpochKL] epoch=0 mean_kl=0.00398 max_kl=0.00819
[EpochKL] epoch=1 mean_kl=0.00690 max_kl=0.01077
[EpochKL] epoch=2 mean_kl=0.00705 max_kl=0.01283
[Time] Env Create Time: 4.3982s |Rollout Collect Time: 1.6888s |Loss & Update :0.9531
[PPODiag] kl_mean=0.0060, kl_p90=0.0102, kl_max=0.0128 | clipfrac_mean=0.024, logratio_std_mean=0.116, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.679 | pg_loss_mean=0.0019, v_loss_mean=0.0382, ent_mean=0.0296 | gn_bb_mean=0.856, gn_bb_max=1.127 | gn_v_mean=0.271, gn_v_max=0.768

  2%|▏         | 94/5000 [12:47<9:45:36,  7.16s/it]------------------ Training Record ------------------
Epoch: 94/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 5.481
Updated lambda_fail: 5.381
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.0943, reward_valid_std=4.1773
[BatchDiag] adv_mean=0.0254, adv_std=0.4038, adv_abs_mean=0.2887 | ret_mean=8.9318, ret_std=0.6038 | val_mean=8.9064, val_std=0.4462 | explained_var=0.552800
[GradSplit pre-clip] backbone=0.643099, critic=0.568256
[Loss] pg_loss=-0.076406, entropy_loss=0.000022, value_loss=0.014000
[EpochKL] epoch=0 mean_kl=0.00320 max_kl=0.00877
[EpochKL] epoch=1 mean_kl=0.00761 max_kl=0.01688
[EpochKL] epoch=2 mean_kl=0.00726 max_kl=0.00965
[Time] Env Create Time: 4.3789s |Rollout Collect Time: 1.9220s |Loss & Update :1.0655
[PPODiag] kl_mean=0.0060, kl_p90=0.0094, kl_max=0.0169 | clipfrac_mean=0.023, logratio_std_mean=0.117, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.591, p10=0.586, min=0.585 | pg_loss_mean=0.0024, v_loss_mean=0.0394, ent_mean=0.0253 | gn_bb_mean=0.979, gn_bb_max=1.737 | gn_v_mean=0.385, gn_v_max=0.890

  2%|▏         | 95/5000 [12:54<9:50:30,  7.22s/it]------------------ Training Record ------------------
Epoch: 95/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 5.381
Updated lambda_fail: 5.281
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1062, reward_valid_std=4.1771
[BatchDiag] adv_mean=0.0175, adv_std=0.3998, adv_abs_mean=0.2814 | ret_mean=8.9419, ret_std=0.5928 | val_mean=8.9243, val_std=0.4571 | explained_var=0.545308
[GradSplit pre-clip] backbone=0.521660, critic=0.458074
[Loss] pg_loss=-0.071595, entropy_loss=0.000027, value_loss=0.017363
[EpochKL] epoch=0 mean_kl=0.00437 max_kl=0.00944
[EpochKL] epoch=1 mean_kl=0.00729 max_kl=0.01271
[EarlyStop] epoch=2 mean_kl=0.01260 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01260 max_kl=0.02477
[Time] Env Create Time: 4.3890s |Rollout Collect Time: 1.6934s |Loss & Update :0.9640
[PPODiag] kl_mean=0.0081, kl_p90=0.0137, kl_max=0.0248 | clipfrac_mean=0.024, logratio_std_mean=0.135, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.681 | pg_loss_mean=0.0030, v_loss_mean=0.0397, ent_mean=0.0279 | gn_bb_mean=0.943, gn_bb_max=1.817 | gn_v_mean=0.576, gn_v_max=1.080
[AttnScore] scale=1.0201, C=10.0

  2%|▏         | 96/5000 [13:01<9:46:03,  7.17s/it]------------------ Training Record ------------------
Epoch: 96/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 5.281
Updated lambda_fail: 5.181
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.0956, reward_valid_std=4.1758
[BatchDiag] adv_mean=0.0139, adv_std=0.4000, adv_abs_mean=0.2839 | ret_mean=8.9238, ret_std=0.5988 | val_mean=8.9099, val_std=0.4454 | explained_var=0.553793
[GradSplit pre-clip] backbone=0.877837, critic=0.344046
[Loss] pg_loss=-0.038924, entropy_loss=0.000025, value_loss=0.016025
[EpochKL] epoch=0 mean_kl=0.00309 max_kl=0.00664
[EarlyStop] epoch=1 mean_kl=0.01388 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01388 max_kl=0.02897
[Time] Env Create Time: 4.5737s |Rollout Collect Time: 1.9338s |Loss & Update :0.7337
[PPODiag] kl_mean=0.0085, kl_p90=0.0165, kl_max=0.0290 | clipfrac_mean=0.024, logratio_std_mean=0.128, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.591, p10=0.585, min=0.581 | pg_loss_mean=0.0037, v_loss_mean=0.0392, ent_mean=0.0256 | gn_bb_mean=0.960, gn_bb_max=1.797 | gn_v_mean=0.398, gn_v_max=0.719

  2%|▏         | 97/5000 [13:08<9:47:41,  7.19s/it]------------------ Training Record ------------------
Epoch: 97/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 5.181
Updated lambda_fail: 5.081
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0900, reward_valid_std=4.1794
[BatchDiag] adv_mean=0.0144, adv_std=0.4073, adv_abs_mean=0.2923 | ret_mean=8.9172, ret_std=0.6063 | val_mean=8.9028, val_std=0.4336 | explained_var=0.548635
[GradSplit pre-clip] backbone=0.812606, critic=0.442765
[Loss] pg_loss=-0.063955, entropy_loss=0.000028, value_loss=0.016776
[EpochKL] epoch=0 mean_kl=0.00908 max_kl=0.02248
[EarlyStop] epoch=1 mean_kl=0.01450 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01450 max_kl=0.02302
[Time] Env Create Time: 4.4081s |Rollout Collect Time: 1.6808s |Loss & Update :0.6603
[PPODiag] kl_mean=0.0118, kl_p90=0.0206, kl_max=0.0230 | clipfrac_mean=0.030, logratio_std_mean=0.167, ratio_p95_mean=1.012 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.681 | pg_loss_mean=0.0032, v_loss_mean=0.0394, ent_mean=0.0295 | gn_bb_mean=1.001, gn_bb_max=1.694 | gn_v_mean=0.322, gn_v_max=0.641

  2%|▏         | 98/5000 [13:15<9:36:43,  7.06s/it]------------------ Training Record ------------------
Epoch: 98/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 5.081
Updated lambda_fail: 4.981
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0890, reward_valid_std=4.1766
[BatchDiag] adv_mean=-0.0130, adv_std=0.4157, adv_abs_mean=0.2879 | ret_mean=8.9234, ret_std=0.6063 | val_mean=8.9364, val_std=0.4001 | explained_var=0.530021
[GradSplit pre-clip] backbone=0.824663, critic=0.140682
[Loss] pg_loss=-0.016509, entropy_loss=0.000025, value_loss=0.016064
[EpochKL] epoch=0 mean_kl=0.00625 max_kl=0.01050
[EarlyStop] epoch=1 mean_kl=0.01065 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01065 max_kl=0.01861
[Time] Env Create Time: 4.4023s |Rollout Collect Time: 1.6822s |Loss & Update :0.6458
[PPODiag] kl_mean=0.0084, kl_p90=0.0156, kl_max=0.0186 | clipfrac_mean=0.027, logratio_std_mean=0.135, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.691, p10=0.685, min=0.683 | pg_loss_mean=0.0035, v_loss_mean=0.0402, ent_mean=0.0297 | gn_bb_mean=1.068, gn_bb_max=1.689 | gn_v_mean=0.342, gn_v_max=0.644

  2%|▏         | 99/5000 [13:22<9:28:33,  6.96s/it]------------------ Training Record ------------------
Epoch: 99/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 4.981
Updated lambda_fail: 4.881
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.0989, reward_valid_std=4.1776
[BatchDiag] adv_mean=-0.0470, adv_std=0.3959, adv_abs_mean=0.2724 | ret_mean=8.9250, ret_std=0.5949 | val_mean=8.9720, val_std=0.4069 | explained_var=0.557214
[GradSplit pre-clip] backbone=0.634528, critic=0.229218
[Loss] pg_loss=-0.036983, entropy_loss=0.000022, value_loss=0.015233
[EpochKL] epoch=0 mean_kl=0.00322 max_kl=0.00555
[EpochKL] epoch=1 mean_kl=0.00630 max_kl=0.01028
[EarlyStop] epoch=2 mean_kl=0.01996 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01996 max_kl=0.03330
[Time] Env Create Time: 4.3878s |Rollout Collect Time: 1.7053s |Loss & Update :0.9609
[PPODiag] kl_mean=0.0098, kl_p90=0.0237, kl_max=0.0333 | clipfrac_mean=0.024, logratio_std_mean=0.156, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.679 | pg_loss_mean=0.0032, v_loss_mean=0.0375, ent_mean=0.0282 | gn_bb_mean=0.913, gn_bb_max=1.864 | gn_v_mean=0.376, gn_v_max=0.845

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.059, Step: 7, Avg Done Step: 6.63, #CS visited: 0.15
D->C5->C2->C3->D->C4->C1->D
Eval cost : 1.7910s
-----------------------------
  2%|▏         | 100/5000 [13:31<10:15:29,  7.54s/it]------------------ Training Record ------------------
Epoch: 100/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 4.881
Updated lambda_fail: 4.781
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0865, reward_valid_std=4.1745
[BatchDiag] adv_mean=0.0138, adv_std=0.4169, adv_abs_mean=0.2898 | ret_mean=8.9163, ret_std=0.6124 | val_mean=8.9025, val_std=0.4624 | explained_var=0.536570
[GradSplit pre-clip] backbone=0.659643, critic=0.496743
[Loss] pg_loss=-0.087061, entropy_loss=0.000023, value_loss=0.017358
[EpochKL] epoch=0 mean_kl=0.00403 max_kl=0.01226
[EpochKL] epoch=1 mean_kl=0.00761 max_kl=0.01329
[EpochKL] epoch=2 mean_kl=0.00876 max_kl=0.01173
[Time] Env Create Time: 4.3675s |Rollout Collect Time: 1.6871s |Loss & Update :0.9631
[PPODiag] kl_mean=0.0068, kl_p90=0.0121, kl_max=0.0133 | clipfrac_mean=0.023, logratio_std_mean=0.124, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.691, p10=0.687, min=0.682 | pg_loss_mean=0.0018, v_loss_mean=0.0407, ent_mean=0.0276 | gn_bb_mean=0.812, gn_bb_max=1.413 | gn_v_mean=0.335, gn_v_max=0.741
[AttnScore] scale=1.0210, C=10.0

  2%|▏         | 101/5000 [13:38<10:02:40,  7.38s/it]------------------ Training Record ------------------
Epoch: 101/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 4.781
Updated lambda_fail: 4.681
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0839, reward_valid_std=4.1743
[BatchDiag] adv_mean=0.0059, adv_std=0.3983, adv_abs_mean=0.2790 | ret_mean=8.9151, ret_std=0.6046 | val_mean=8.9092, val_std=0.4434 | explained_var=0.565985
[GradSplit pre-clip] backbone=0.651644, critic=0.569915
[Loss] pg_loss=-0.126796, entropy_loss=0.000022, value_loss=0.013887
[EpochKL] epoch=0 mean_kl=0.00309 max_kl=0.00553
[EpochKL] epoch=1 mean_kl=0.00571 max_kl=0.00950
[EpochKL] epoch=2 mean_kl=0.00844 max_kl=0.01233
[Time] Env Create Time: 4.3740s |Rollout Collect Time: 1.6866s |Loss & Update :0.9644
[PPODiag] kl_mean=0.0057, kl_p90=0.0097, kl_max=0.0123 | clipfrac_mean=0.021, logratio_std_mean=0.111, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.678 | pg_loss_mean=0.0015, v_loss_mean=0.0376, ent_mean=0.0285 | gn_bb_mean=0.788, gn_bb_max=1.624 | gn_v_mean=0.303, gn_v_max=0.893

  2%|▏         | 102/5000 [13:45<9:53:50,  7.27s/it] ------------------ Training Record ------------------
Epoch: 102/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 4.681
Updated lambda_fail: 4.581
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1004, reward_valid_std=4.1793
[BatchDiag] adv_mean=-0.0573, adv_std=0.3913, adv_abs_mean=0.2654 | ret_mean=8.9376, ret_std=0.5961 | val_mean=8.9949, val_std=0.4251 | explained_var=0.569231
[GradSplit pre-clip] backbone=0.886108, critic=0.277669
[Loss] pg_loss=-0.042426, entropy_loss=0.000026, value_loss=0.014682
[EpochKL] epoch=0 mean_kl=0.00222 max_kl=0.00402
[EpochKL] epoch=1 mean_kl=0.00604 max_kl=0.01732
[EarlyStop] epoch=2 mean_kl=0.02081 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02081 max_kl=0.04125
[Time] Env Create Time: 4.5841s |Rollout Collect Time: 1.6826s |Loss & Update :0.9641
[PPODiag] kl_mean=0.0097, kl_p90=0.0256, kl_max=0.0412 | clipfrac_mean=0.023, logratio_std_mean=0.138, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.679 | pg_loss_mean=0.0034, v_loss_mean=0.0369, ent_mean=0.0289 | gn_bb_mean=1.020, gn_bb_max=2.599 | gn_v_mean=0.349, gn_v_max=0.754

  2%|▏         | 103/5000 [13:52<9:52:39,  7.26s/it]------------------ Training Record ------------------
Epoch: 103/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 4.581
Updated lambda_fail: 4.481
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1017, reward_valid_std=4.1781
[BatchDiag] adv_mean=-0.0230, adv_std=0.3964, adv_abs_mean=0.2766 | ret_mean=8.9339, ret_std=0.5940 | val_mean=8.9569, val_std=0.3857 | explained_var=0.554556
[GradSplit pre-clip] backbone=1.285053, critic=0.141794
[Loss] pg_loss=-0.063222, entropy_loss=0.000029, value_loss=0.013178
[EpochKL] epoch=0 mean_kl=0.00573 max_kl=0.01510
[EpochKL] epoch=1 mean_kl=0.00818 max_kl=0.01325
[EarlyStop] epoch=2 mean_kl=0.01123 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01123 max_kl=0.01503
[Time] Env Create Time: 4.4211s |Rollout Collect Time: 1.6885s |Loss & Update :0.9602
[PPODiag] kl_mean=0.0084, kl_p90=0.0137, kl_max=0.0151 | clipfrac_mean=0.023, logratio_std_mean=0.158, ratio_p95_mean=1.016 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.681 | pg_loss_mean=0.0006, v_loss_mean=0.0354, ent_mean=0.0289 | gn_bb_mean=0.712, gn_bb_max=1.285 | gn_v_mean=0.225, gn_v_max=0.538

  2%|▏         | 104/5000 [13:59<9:47:51,  7.20s/it]------------------ Training Record ------------------
Epoch: 104/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 4.481
Updated lambda_fail: 4.381
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.0985, reward_valid_std=4.1825
[BatchDiag] adv_mean=-0.0012, adv_std=0.3828, adv_abs_mean=0.2631 | ret_mean=8.9232, ret_std=0.5988 | val_mean=8.9244, val_std=0.4329 | explained_var=0.591337
[GradSplit pre-clip] backbone=0.714870, critic=0.243545
[Loss] pg_loss=-0.062995, entropy_loss=0.000019, value_loss=0.011651
[EpochKL] epoch=0 mean_kl=0.00235 max_kl=0.00569
[EpochKL] epoch=1 mean_kl=0.00639 max_kl=0.01103
[EpochKL] epoch=2 mean_kl=0.00631 max_kl=0.01117
[Time] Env Create Time: 4.4122s |Rollout Collect Time: 1.9209s |Loss & Update :1.0687
[PPODiag] kl_mean=0.0050, kl_p90=0.0086, kl_max=0.0112 | clipfrac_mean=0.020, logratio_std_mean=0.101, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.589, p10=0.584, min=0.584 | pg_loss_mean=0.0001, v_loss_mean=0.0347, ent_mean=0.0224 | gn_bb_mean=0.635, gn_bb_max=1.055 | gn_v_mean=0.301, gn_v_max=0.694

  2%|▏         | 105/5000 [14:06<9:52:35,  7.26s/it]------------------ Training Record ------------------
Epoch: 105/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 4.381
Updated lambda_fail: 4.281
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1004, reward_valid_std=4.1818
[BatchDiag] adv_mean=0.0294, adv_std=0.3710, adv_abs_mean=0.2612 | ret_mean=8.9323, ret_std=0.5949 | val_mean=8.9029, val_std=0.4705 | explained_var=0.610976
[GradSplit pre-clip] backbone=0.784289, critic=0.300796
[Loss] pg_loss=0.003512, entropy_loss=0.000022, value_loss=0.012069
[EpochKL] epoch=0 mean_kl=0.00116 max_kl=0.00288
[EpochKL] epoch=1 mean_kl=0.00443 max_kl=0.00773
[EpochKL] epoch=2 mean_kl=0.00803 max_kl=0.01399
[Time] Env Create Time: 4.3866s |Rollout Collect Time: 1.9297s |Loss & Update :1.0760
[PPODiag] kl_mean=0.0045, kl_p90=0.0092, kl_max=0.0140 | clipfrac_mean=0.017, logratio_std_mean=0.100, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.589, p10=0.585, min=0.583 | pg_loss_mean=0.0014, v_loss_mean=0.0334, ent_mean=0.0220 | gn_bb_mean=0.795, gn_bb_max=1.472 | gn_v_mean=0.271, gn_v_max=0.725
[AttnScore] scale=1.0221, C=10.0

  2%|▏         | 106/5000 [14:14<9:55:37,  7.30s/it]------------------ Training Record ------------------
Epoch: 106/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 4.281
Updated lambda_fail: 4.181
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1088, reward_valid_std=4.1887
[BatchDiag] adv_mean=-0.0273, adv_std=0.3681, adv_abs_mean=0.2479 | ret_mean=8.9379, ret_std=0.5970 | val_mean=8.9653, val_std=0.4433 | explained_var=0.619797
[GradSplit pre-clip] backbone=0.570162, critic=0.105437
[Loss] pg_loss=-0.087580, entropy_loss=0.000020, value_loss=0.011521
[EpochKL] epoch=0 mean_kl=0.00484 max_kl=0.01139
[EpochKL] epoch=1 mean_kl=0.00603 max_kl=0.01472
[EpochKL] epoch=2 mean_kl=0.00538 max_kl=0.00775
[Time] Env Create Time: 4.3911s |Rollout Collect Time: 1.6899s |Loss & Update :0.9466
[PPODiag] kl_mean=0.0054, kl_p90=0.0084, kl_max=0.0147 | clipfrac_mean=0.019, logratio_std_mean=0.109, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.685, p10=0.680, min=0.678 | pg_loss_mean=0.0018, v_loss_mean=0.0323, ent_mean=0.0246 | gn_bb_mean=0.839, gn_bb_max=1.548 | gn_v_mean=0.330, gn_v_max=0.823

  2%|▏         | 107/5000 [14:21<9:48:47,  7.22s/it]------------------ Training Record ------------------
Epoch: 107/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 4.181
Updated lambda_fail: 4.081
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0887, reward_valid_std=4.1705
[BatchDiag] adv_mean=-0.0377, adv_std=0.3767, adv_abs_mean=0.2538 | ret_mean=8.9176, ret_std=0.5962 | val_mean=8.9553, val_std=0.4542 | explained_var=0.600760
[GradSplit pre-clip] backbone=0.559702, critic=0.055337
[Loss] pg_loss=-0.098613, entropy_loss=0.000024, value_loss=0.010134
[EpochKL] epoch=0 mean_kl=0.00154 max_kl=0.00370
[EpochKL] epoch=1 mean_kl=0.00556 max_kl=0.01057
[EpochKL] epoch=2 mean_kl=0.00684 max_kl=0.01451
[Time] Env Create Time: 4.3875s |Rollout Collect Time: 1.6962s |Loss & Update :0.9513
[PPODiag] kl_mean=0.0046, kl_p90=0.0098, kl_max=0.0145 | clipfrac_mean=0.018, logratio_std_mean=0.096, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.690, p10=0.683, min=0.681 | pg_loss_mean=0.0015, v_loss_mean=0.0340, ent_mean=0.0264 | gn_bb_mean=0.854, gn_bb_max=1.514 | gn_v_mean=0.287, gn_v_max=0.864

  2%|▏         | 108/5000 [14:28<9:44:09,  7.16s/it]------------------ Training Record ------------------
Epoch: 108/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 4.081
Updated lambda_fail: 3.981
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.587, reward_valid_mean=2.1103, reward_valid_std=4.1861
[BatchDiag] adv_mean=-0.0200, adv_std=0.3819, adv_abs_mean=0.2566 | ret_mean=8.9325, ret_std=0.5948 | val_mean=8.9525, val_std=0.4539 | explained_var=0.587699
[GradSplit pre-clip] backbone=0.335950, critic=0.122149
[Loss] pg_loss=0.003473, entropy_loss=0.000014, value_loss=0.015378
[EpochKL] epoch=0 mean_kl=0.00265 max_kl=0.00813
[EpochKL] epoch=1 mean_kl=0.00756 max_kl=0.01126
[EpochKL] epoch=2 mean_kl=0.00827 max_kl=0.01776
[Time] Env Create Time: 4.5838s |Rollout Collect Time: 1.9270s |Loss & Update :1.0625
[PPODiag] kl_mean=0.0062, kl_p90=0.0120, kl_max=0.0178 | clipfrac_mean=0.018, logratio_std_mean=0.115, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.587, p10=0.583, min=0.580 | pg_loss_mean=0.0023, v_loss_mean=0.0337, ent_mean=0.0205 | gn_bb_mean=0.827, gn_bb_max=1.817 | gn_v_mean=0.319, gn_v_max=0.793

  2%|▏         | 109/5000 [14:35<9:54:02,  7.29s/it]------------------ Training Record ------------------
Epoch: 109/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 3.981
Updated lambda_fail: 3.881
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1107, reward_valid_std=4.1782
[BatchDiag] adv_mean=-0.0246, adv_std=0.3638, adv_abs_mean=0.2493 | ret_mean=8.9483, ret_std=0.5843 | val_mean=8.9728, val_std=0.4477 | explained_var=0.612365
[GradSplit pre-clip] backbone=0.582876, critic=0.195017
[Loss] pg_loss=0.020070, entropy_loss=0.000021, value_loss=0.015106
[EpochKL] epoch=0 mean_kl=0.00220 max_kl=0.00530
[EpochKL] epoch=1 mean_kl=0.00565 max_kl=0.01028
[EarlyStop] epoch=2 mean_kl=0.01422 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01422 max_kl=0.04520
[Time] Env Create Time: 4.3987s |Rollout Collect Time: 1.6872s |Loss & Update :0.9603
[PPODiag] kl_mean=0.0074, kl_p90=0.0136, kl_max=0.0452 | clipfrac_mean=0.021, logratio_std_mean=0.129, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.680 | pg_loss_mean=0.0032, v_loss_mean=0.0319, ent_mean=0.0256 | gn_bb_mean=0.981, gn_bb_max=1.614 | gn_v_mean=0.186, gn_v_max=0.309

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.046, Step: 8, Avg Done Step: 6.61, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.9524s
-----------------------------
  2%|▏         | 110/5000 [14:44<10:37:01,  7.82s/it]------------------ Training Record ------------------
Epoch: 110/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 3.881
Updated lambda_fail: 3.781
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0967, reward_valid_std=4.1789
[BatchDiag] adv_mean=0.0033, adv_std=0.3747, adv_abs_mean=0.2624 | ret_mean=8.9314, ret_std=0.6008 | val_mean=8.9281, val_std=0.4490 | explained_var=0.611070
[GradSplit pre-clip] backbone=0.599483, critic=0.353467
[Loss] pg_loss=-0.084176, entropy_loss=0.000020, value_loss=0.012074
[EpochKL] epoch=0 mean_kl=0.00334 max_kl=0.00734
[EpochKL] epoch=1 mean_kl=0.00763 max_kl=0.01121
[EpochKL] epoch=2 mean_kl=0.00733 max_kl=0.00947
[Time] Env Create Time: 4.3884s |Rollout Collect Time: 1.6964s |Loss & Update :0.9593
[PPODiag] kl_mean=0.0061, kl_p90=0.0091, kl_max=0.0112 | clipfrac_mean=0.023, logratio_std_mean=0.117, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.682 | pg_loss_mean=0.0019, v_loss_mean=0.0335, ent_mean=0.0268 | gn_bb_mean=0.902, gn_bb_max=1.378 | gn_v_mean=0.257, gn_v_max=0.533
[AttnScore] scale=1.0229, C=10.0

  2%|▏         | 111/5000 [14:51<10:18:01,  7.58s/it]------------------ Training Record ------------------
Epoch: 111/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 3.781
Updated lambda_fail: 3.681
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0867, reward_valid_std=4.1700
[BatchDiag] adv_mean=0.0241, adv_std=0.3860, adv_abs_mean=0.2705 | ret_mean=8.9260, ret_std=0.6034 | val_mean=8.9019, val_std=0.4835 | explained_var=0.590675
[GradSplit pre-clip] backbone=1.120336, critic=0.324743
[Loss] pg_loss=-0.011927, entropy_loss=0.000029, value_loss=0.015652
[EpochKL] epoch=0 mean_kl=0.00580 max_kl=0.01309
[EpochKL] epoch=1 mean_kl=0.00884 max_kl=0.01513
[EpochKL] epoch=2 mean_kl=0.00605 max_kl=0.01243
[Time] Env Create Time: 4.3879s |Rollout Collect Time: 1.6826s |Loss & Update :0.9614
[PPODiag] kl_mean=0.0069, kl_p90=0.0129, kl_max=0.0151 | clipfrac_mean=0.021, logratio_std_mean=0.135, ratio_p95_mean=1.014 | valid_ratio_mb_mean=0.692, p10=0.689, min=0.684 | pg_loss_mean=0.0012, v_loss_mean=0.0357, ent_mean=0.0273 | gn_bb_mean=0.731, gn_bb_max=1.402 | gn_v_mean=0.311, gn_v_max=0.553

  2%|▏         | 112/5000 [14:59<10:04:24,  7.42s/it]------------------ Training Record ------------------
Epoch: 112/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 3.681
Updated lambda_fail: 3.581
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0904, reward_valid_std=4.1760
[BatchDiag] adv_mean=0.0186, adv_std=0.3839, adv_abs_mean=0.2658 | ret_mean=8.9109, ret_std=0.6123 | val_mean=8.8923, val_std=0.4659 | explained_var=0.606825
[GradSplit pre-clip] backbone=0.570210, critic=0.468320
[Loss] pg_loss=-0.059583, entropy_loss=0.000022, value_loss=0.014013
[EpochKL] epoch=0 mean_kl=0.00164 max_kl=0.00795
[EpochKL] epoch=1 mean_kl=0.00863 max_kl=0.01318
[EarlyStop] epoch=2 mean_kl=0.01363 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01363 max_kl=0.02713
[Time] Env Create Time: 4.3750s |Rollout Collect Time: 1.6826s |Loss & Update :0.9628
[PPODiag] kl_mean=0.0080, kl_p90=0.0142, kl_max=0.0271 | clipfrac_mean=0.022, logratio_std_mean=0.127, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.680 | pg_loss_mean=0.0029, v_loss_mean=0.0353, ent_mean=0.0269 | gn_bb_mean=0.983, gn_bb_max=2.755 | gn_v_mean=0.262, gn_v_max=0.528

  2%|▏         | 113/5000 [15:06<9:54:32,  7.30s/it] ------------------ Training Record ------------------
Epoch: 113/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 3.581
Updated lambda_fail: 3.481
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0844, reward_valid_std=4.1690
[BatchDiag] adv_mean=0.0012, adv_std=0.3832, adv_abs_mean=0.2689 | ret_mean=8.9227, ret_std=0.6034 | val_mean=8.9216, val_std=0.4582 | explained_var=0.596640
[GradSplit pre-clip] backbone=0.749523, critic=0.274474
[Loss] pg_loss=-0.052652, entropy_loss=0.000026, value_loss=0.013565
[EpochKL] epoch=0 mean_kl=0.00999 max_kl=0.02256
[EarlyStop] epoch=1 mean_kl=0.01015 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01015 max_kl=0.01937
[Time] Env Create Time: 4.6029s |Rollout Collect Time: 1.6860s |Loss & Update :0.6615
[PPODiag] kl_mean=0.0101, kl_p90=0.0185, kl_max=0.0226 | clipfrac_mean=0.026, logratio_std_mean=0.154, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.693, p10=0.686, min=0.685 | pg_loss_mean=0.0041, v_loss_mean=0.0353, ent_mean=0.0283 | gn_bb_mean=1.111, gn_bb_max=2.313 | gn_v_mean=0.261, gn_v_max=0.666

  2%|▏         | 114/5000 [15:13<9:45:54,  7.19s/it]------------------ Training Record ------------------
Epoch: 114/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 3.481
Updated lambda_fail: 3.381
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1048, reward_valid_std=4.1829
[BatchDiag] adv_mean=-0.0245, adv_std=0.3591, adv_abs_mean=0.2419 | ret_mean=8.9530, ret_std=0.5875 | val_mean=8.9775, val_std=0.4667 | explained_var=0.626275
[GradSplit pre-clip] backbone=0.498052, critic=0.265237
[Loss] pg_loss=0.038605, entropy_loss=0.000023, value_loss=0.013891
[EpochKL] epoch=0 mean_kl=0.00366 max_kl=0.01579
[EpochKL] epoch=1 mean_kl=0.00770 max_kl=0.02012
[EpochKL] epoch=2 mean_kl=0.00765 max_kl=0.01055
[Time] Env Create Time: 4.4136s |Rollout Collect Time: 1.9326s |Loss & Update :1.0812
[PPODiag] kl_mean=0.0063, kl_p90=0.0110, kl_max=0.0201 | clipfrac_mean=0.019, logratio_std_mean=0.117, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.590, p10=0.584, min=0.582 | pg_loss_mean=0.0014, v_loss_mean=0.0304, ent_mean=0.0222 | gn_bb_mean=0.793, gn_bb_max=1.672 | gn_v_mean=0.270, gn_v_max=0.464

  2%|▏         | 115/5000 [15:20<9:51:28,  7.26s/it]------------------ Training Record ------------------
Epoch: 115/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 3.381
Updated lambda_fail: 3.281
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.593, reward_valid_mean=2.0843, reward_valid_std=4.1734
[BatchDiag] adv_mean=-0.0165, adv_std=0.3896, adv_abs_mean=0.2581 | ret_mean=8.9213, ret_std=0.6201 | val_mean=8.9379, val_std=0.4882 | explained_var=0.605318
[GradSplit pre-clip] backbone=0.380091, critic=0.191133
[Loss] pg_loss=-0.058835, entropy_loss=0.000017, value_loss=0.013561
[EpochKL] epoch=0 mean_kl=0.00237 max_kl=0.00643
[EpochKL] epoch=1 mean_kl=0.00622 max_kl=0.00898
[EpochKL] epoch=2 mean_kl=0.00762 max_kl=0.01302
[Time] Env Create Time: 4.4105s |Rollout Collect Time: 1.9341s |Loss & Update :1.0837
[PPODiag] kl_mean=0.0054, kl_p90=0.0088, kl_max=0.0130 | clipfrac_mean=0.019, logratio_std_mean=0.108, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.593, p10=0.588, min=0.582 | pg_loss_mean=0.0023, v_loss_mean=0.0362, ent_mean=0.0218 | gn_bb_mean=0.870, gn_bb_max=2.079 | gn_v_mean=0.281, gn_v_max=0.612
[AttnScore] scale=1.0239, C=10.0

  2%|▏         | 116/5000 [15:27<9:55:21,  7.31s/it]------------------ Training Record ------------------
Epoch: 116/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 3.281
Updated lambda_fail: 3.181
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.0986, reward_valid_std=4.1768
[BatchDiag] adv_mean=0.0149, adv_std=0.3690, adv_abs_mean=0.2588 | ret_mean=8.9400, ret_std=0.5953 | val_mean=8.9251, val_std=0.4713 | explained_var=0.615793
[GradSplit pre-clip] backbone=1.043294, critic=0.329608
[Loss] pg_loss=-0.050670, entropy_loss=0.000024, value_loss=0.012592
[EpochKL] epoch=0 mean_kl=0.00364 max_kl=0.01221
[EpochKL] epoch=1 mean_kl=0.00598 max_kl=0.01135
[EarlyStop] epoch=2 mean_kl=0.01604 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01604 max_kl=0.02293
[Time] Env Create Time: 4.4012s |Rollout Collect Time: 1.9244s |Loss & Update :1.0619
[PPODiag] kl_mean=0.0086, kl_p90=0.0173, kl_max=0.0229 | clipfrac_mean=0.023, logratio_std_mean=0.145, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.591, p10=0.585, min=0.582 | pg_loss_mean=0.0026, v_loss_mean=0.0322, ent_mean=0.0230 | gn_bb_mean=0.921, gn_bb_max=1.442 | gn_v_mean=0.250, gn_v_max=0.627

  2%|▏         | 117/5000 [15:35<9:57:02,  7.34s/it]------------------ Training Record ------------------
Epoch: 117/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 3.181
Updated lambda_fail: 3.081
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.593, reward_valid_mean=2.0887, reward_valid_std=4.1733
[BatchDiag] adv_mean=-0.0602, adv_std=0.3804, adv_abs_mean=0.2493 | ret_mean=8.9329, ret_std=0.6140 | val_mean=8.9932, val_std=0.4569 | explained_var=0.616118
[GradSplit pre-clip] backbone=0.715532, critic=0.202623
[Loss] pg_loss=-0.088378, entropy_loss=0.000022, value_loss=0.012191
[EpochKL] epoch=0 mean_kl=0.00293 max_kl=0.00533
[EpochKL] epoch=1 mean_kl=0.00723 max_kl=0.01173
[EpochKL] epoch=2 mean_kl=0.00813 max_kl=0.01133
[Time] Env Create Time: 4.3905s |Rollout Collect Time: 1.9236s |Loss & Update :1.0715
[PPODiag] kl_mean=0.0061, kl_p90=0.0105, kl_max=0.0117 | clipfrac_mean=0.021, logratio_std_mean=0.119, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.593, p10=0.589, min=0.587 | pg_loss_mean=0.0031, v_loss_mean=0.0343, ent_mean=0.0223 | gn_bb_mean=0.952, gn_bb_max=1.910 | gn_v_mean=0.393, gn_v_max=0.941

  2%|▏         | 118/5000 [15:42<9:58:08,  7.35s/it]------------------ Training Record ------------------
Epoch: 118/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 3.081
Updated lambda_fail: 2.981
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0974, reward_valid_std=4.1802
[BatchDiag] adv_mean=-0.0024, adv_std=0.3640, adv_abs_mean=0.2496 | ret_mean=8.9405, ret_std=0.5987 | val_mean=8.9428, val_std=0.4656 | explained_var=0.630428
[GradSplit pre-clip] backbone=0.467892, critic=0.137073
[Loss] pg_loss=-0.018528, entropy_loss=0.000024, value_loss=0.012015
[EpochKL] epoch=0 mean_kl=0.00492 max_kl=0.00821
[EarlyStop] epoch=1 mean_kl=0.01402 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01402 max_kl=0.02102
[Time] Env Create Time: 4.3665s |Rollout Collect Time: 1.6989s |Loss & Update :0.6693
[PPODiag] kl_mean=0.0095, kl_p90=0.0180, kl_max=0.0210 | clipfrac_mean=0.024, logratio_std_mean=0.147, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.683 | pg_loss_mean=0.0046, v_loss_mean=0.0326, ent_mean=0.0270 | gn_bb_mean=1.014, gn_bb_max=1.932 | gn_v_mean=0.321, gn_v_max=0.713

  2%|▏         | 119/5000 [15:49<9:42:58,  7.17s/it]------------------ Training Record ------------------
Epoch: 119/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 2.981
Updated lambda_fail: 2.881
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1066, reward_valid_std=4.1840
[BatchDiag] adv_mean=0.0422, adv_std=0.3537, adv_abs_mean=0.2520 | ret_mean=8.9529, ret_std=0.5921 | val_mean=8.9106, val_std=0.4973 | explained_var=0.643213
[GradSplit pre-clip] backbone=0.620902, critic=0.433202
[Loss] pg_loss=-0.007894, entropy_loss=0.000026, value_loss=0.013163
[EpochKL] epoch=0 mean_kl=0.00835 max_kl=0.01656
[EarlyStop] epoch=1 mean_kl=0.01438 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01438 max_kl=0.03176
[Time] Env Create Time: 4.3692s |Rollout Collect Time: 1.6854s |Loss & Update :0.6569
[PPODiag] kl_mean=0.0114, kl_p90=0.0205, kl_max=0.0318 | clipfrac_mean=0.024, logratio_std_mean=0.168, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.676 | pg_loss_mean=0.0036, v_loss_mean=0.0318, ent_mean=0.0258 | gn_bb_mean=0.896, gn_bb_max=2.244 | gn_v_mean=0.363, gn_v_max=0.744

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.005, Step: 7, Avg Done Step: 6.63, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8010s
-----------------------------
  2%|▏         | 120/5000 [15:57<10:17:04,  7.59s/it]------------------ Training Record ------------------
Epoch: 120/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 2.881
Updated lambda_fail: 2.781
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.0992, reward_valid_std=4.1789
[BatchDiag] adv_mean=-0.0294, adv_std=0.3783, adv_abs_mean=0.2527 | ret_mean=8.9455, ret_std=0.5984 | val_mean=8.9749, val_std=0.5064 | explained_var=0.600192
[GradSplit pre-clip] backbone=0.719826, critic=0.281835
[Loss] pg_loss=0.009659, entropy_loss=0.000024, value_loss=0.015721
[EpochKL] epoch=0 mean_kl=0.00771 max_kl=0.01300
[EarlyStop] epoch=1 mean_kl=0.01346 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01346 max_kl=0.02415
[Time] Env Create Time: 4.6129s |Rollout Collect Time: 1.9198s |Loss & Update :0.7322
[PPODiag] kl_mean=0.0106, kl_p90=0.0154, kl_max=0.0242 | clipfrac_mean=0.026, logratio_std_mean=0.161, ratio_p95_mean=1.012 | valid_ratio_mb_mean=0.591, p10=0.587, min=0.585 | pg_loss_mean=0.0040, v_loss_mean=0.0347, ent_mean=0.0241 | gn_bb_mean=1.041, gn_bb_max=2.262 | gn_v_mean=0.386, gn_v_max=1.215
[AttnScore] scale=1.0246, C=10.0

  2%|▏         | 121/5000 [16:05<10:09:06,  7.49s/it]------------------ Training Record ------------------
Epoch: 121/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 2.781
Updated lambda_fail: 2.681
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0888, reward_valid_std=4.1742
[BatchDiag] adv_mean=-0.0993, adv_std=0.3811, adv_abs_mean=0.2676 | ret_mean=8.9434, ret_std=0.5943 | val_mean=9.0428, val_std=0.4282 | explained_var=0.588860
[GradSplit pre-clip] backbone=0.907006, critic=0.790238
[Loss] pg_loss=0.017418, entropy_loss=0.000036, value_loss=0.016929
[EpochKL] epoch=0 mean_kl=0.00336 max_kl=0.00752
[EpochKL] epoch=1 mean_kl=0.00975 max_kl=0.01392
[EpochKL] epoch=2 mean_kl=0.00877 max_kl=0.01455
[Time] Env Create Time: 4.4092s |Rollout Collect Time: 1.6824s |Loss & Update :0.9584
[PPODiag] kl_mean=0.0073, kl_p90=0.0128, kl_max=0.0146 | clipfrac_mean=0.023, logratio_std_mean=0.129, ratio_p95_mean=1.013 | valid_ratio_mb_mean=0.692, p10=0.687, min=0.685 | pg_loss_mean=0.0040, v_loss_mean=0.0352, ent_mean=0.0288 | gn_bb_mean=1.058, gn_bb_max=1.947 | gn_v_mean=0.411, gn_v_max=0.831

  2%|▏         | 122/5000 [16:12<9:58:14,  7.36s/it] ------------------ Training Record ------------------
Epoch: 122/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 2.681
Updated lambda_fail: 2.581
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0889, reward_valid_std=4.1726
[BatchDiag] adv_mean=-0.0305, adv_std=0.3611, adv_abs_mean=0.2523 | ret_mean=8.9370, ret_std=0.5887 | val_mean=8.9675, val_std=0.4304 | explained_var=0.623831
[GradSplit pre-clip] backbone=0.560731, critic=0.255852
[Loss] pg_loss=0.006696, entropy_loss=0.000028, value_loss=0.014754
[EpochKL] epoch=0 mean_kl=0.00516 max_kl=0.01146
[EarlyStop] epoch=1 mean_kl=0.01019 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01019 max_kl=0.01638
[Time] Env Create Time: 4.4156s |Rollout Collect Time: 1.6972s |Loss & Update :0.6532
[PPODiag] kl_mean=0.0077, kl_p90=0.0150, kl_max=0.0164 | clipfrac_mean=0.020, logratio_std_mean=0.143, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.692, p10=0.685, min=0.684 | pg_loss_mean=0.0018, v_loss_mean=0.0318, ent_mean=0.0267 | gn_bb_mean=0.821, gn_bb_max=1.423 | gn_v_mean=0.287, gn_v_max=0.465

  2%|▏         | 123/5000 [16:19<9:43:41,  7.18s/it]------------------ Training Record ------------------
Epoch: 123/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 2.581
Updated lambda_fail: 2.481
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0961, reward_valid_std=4.1828
[BatchDiag] adv_mean=0.0069, adv_std=0.3635, adv_abs_mean=0.2595 | ret_mean=8.9451, ret_std=0.5951 | val_mean=8.9381, val_std=0.4324 | explained_var=0.626905
[GradSplit pre-clip] backbone=0.514703, critic=0.180685
[Loss] pg_loss=0.068354, entropy_loss=0.000023, value_loss=0.015733
[EpochKL] epoch=0 mean_kl=0.00196 max_kl=0.00808
[EpochKL] epoch=1 mean_kl=0.00365 max_kl=0.00614
[EpochKL] epoch=2 mean_kl=0.00621 max_kl=0.01081
[Time] Env Create Time: 4.4010s |Rollout Collect Time: 1.6962s |Loss & Update :0.9657
[PPODiag] kl_mean=0.0039, kl_p90=0.0085, kl_max=0.0108 | clipfrac_mean=0.016, logratio_std_mean=0.091, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.690, p10=0.682, min=0.680 | pg_loss_mean=0.0014, v_loss_mean=0.0310, ent_mean=0.0243 | gn_bb_mean=0.818, gn_bb_max=1.681 | gn_v_mean=0.218, gn_v_max=0.473

  2%|▏         | 124/5000 [16:26<9:40:42,  7.15s/it]------------------ Training Record ------------------
Epoch: 124/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 2.481
Updated lambda_fail: 2.381
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1029, reward_valid_std=4.1815
[BatchDiag] adv_mean=0.0336, adv_std=0.3602, adv_abs_mean=0.2564 | ret_mean=8.9426, ret_std=0.5861 | val_mean=8.9090, val_std=0.5092 | explained_var=0.622268
[GradSplit pre-clip] backbone=0.577303, critic=0.548268
[Loss] pg_loss=-0.061472, entropy_loss=0.000022, value_loss=0.011703
[EpochKL] epoch=0 mean_kl=0.00363 max_kl=0.00695
[EarlyStop] epoch=1 mean_kl=0.01575 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01575 max_kl=0.03310
[Time] Env Create Time: 4.3834s |Rollout Collect Time: 1.7064s |Loss & Update :0.6619
[PPODiag] kl_mean=0.0097, kl_p90=0.0246, kl_max=0.0331 | clipfrac_mean=0.023, logratio_std_mean=0.148, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.682 | pg_loss_mean=0.0055, v_loss_mean=0.0312, ent_mean=0.0255 | gn_bb_mean=1.119, gn_bb_max=1.743 | gn_v_mean=0.389, gn_v_max=0.635

  2%|▎         | 125/5000 [16:32<9:30:59,  7.03s/it]------------------ Training Record ------------------
Epoch: 125/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 2.381
Updated lambda_fail: 2.281
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1053, reward_valid_std=4.1845
[BatchDiag] adv_mean=0.0077, adv_std=0.3585, adv_abs_mean=0.2452 | ret_mean=8.9473, ret_std=0.5934 | val_mean=8.9396, val_std=0.5102 | explained_var=0.635104
[GradSplit pre-clip] backbone=0.890695, critic=0.220308
[Loss] pg_loss=0.022278, entropy_loss=0.000020, value_loss=0.013314
[EpochKL] epoch=0 mean_kl=0.00505 max_kl=0.01513
[EpochKL] epoch=1 mean_kl=0.00900 max_kl=0.01310
[EpochKL] epoch=2 mean_kl=0.00870 max_kl=0.01303
[Time] Env Create Time: 4.3630s |Rollout Collect Time: 1.9240s |Loss & Update :1.0653
[PPODiag] kl_mean=0.0076, kl_p90=0.0130, kl_max=0.0151 | clipfrac_mean=0.021, logratio_std_mean=0.133, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.589, p10=0.586, min=0.584 | pg_loss_mean=0.0035, v_loss_mean=0.0304, ent_mean=0.0222 | gn_bb_mean=1.044, gn_bb_max=3.156 | gn_v_mean=0.246, gn_v_max=0.503
[AttnScore] scale=1.0256, C=10.0

  3%|▎         | 126/5000 [16:40<9:38:47,  7.13s/it]------------------ Training Record ------------------
Epoch: 126/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 2.281
Updated lambda_fail: 2.181
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1094, reward_valid_std=4.1839
[BatchDiag] adv_mean=-0.0286, adv_std=0.3554, adv_abs_mean=0.2410 | ret_mean=8.9535, ret_std=0.5882 | val_mean=8.9822, val_std=0.4590 | explained_var=0.635040
[GradSplit pre-clip] backbone=0.818906, critic=0.153582
[Loss] pg_loss=-0.051054, entropy_loss=0.000023, value_loss=0.012305
[EpochKL] epoch=0 mean_kl=0.00182 max_kl=0.00404
[EpochKL] epoch=1 mean_kl=0.00571 max_kl=0.01038
[EpochKL] epoch=2 mean_kl=0.00651 max_kl=0.01031
[Time] Env Create Time: 4.6031s |Rollout Collect Time: 1.7007s |Loss & Update :0.9619
[PPODiag] kl_mean=0.0047, kl_p90=0.0091, kl_max=0.0104 | clipfrac_mean=0.019, logratio_std_mean=0.103, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.677 | pg_loss_mean=0.0020, v_loss_mean=0.0298, ent_mean=0.0259 | gn_bb_mean=0.942, gn_bb_max=1.652 | gn_v_mean=0.263, gn_v_max=0.577

  3%|▎         | 127/5000 [16:47<9:42:06,  7.17s/it]------------------ Training Record ------------------
Epoch: 127/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 2.181
Updated lambda_fail: 2.081
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0988, reward_valid_std=4.1826
[BatchDiag] adv_mean=0.0402, adv_std=0.3566, adv_abs_mean=0.2515 | ret_mean=8.9507, ret_std=0.6043 | val_mean=8.9105, val_std=0.4671 | explained_var=0.651747
[GradSplit pre-clip] backbone=0.371893, critic=0.718892
[Loss] pg_loss=-0.098232, entropy_loss=0.000019, value_loss=0.011335
[EpochKL] epoch=0 mean_kl=0.00202 max_kl=0.00749
[EpochKL] epoch=1 mean_kl=0.00403 max_kl=0.00749
[EpochKL] epoch=2 mean_kl=0.00517 max_kl=0.00652
[Time] Env Create Time: 4.4093s |Rollout Collect Time: 1.9294s |Loss & Update :1.0658
[PPODiag] kl_mean=0.0037, kl_p90=0.0063, kl_max=0.0075 | clipfrac_mean=0.014, logratio_std_mean=0.089, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.592, p10=0.586, min=0.584 | pg_loss_mean=0.0019, v_loss_mean=0.0311, ent_mean=0.0201 | gn_bb_mean=0.856, gn_bb_max=1.855 | gn_v_mean=0.381, gn_v_max=0.787

  3%|▎         | 128/5000 [16:54<9:47:46,  7.24s/it]------------------ Training Record ------------------
Epoch: 128/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 2.081
Updated lambda_fail: 1.981
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0914, reward_valid_std=4.1757
[BatchDiag] adv_mean=0.0098, adv_std=0.3642, adv_abs_mean=0.2578 | ret_mean=8.9303, ret_std=0.5965 | val_mean=8.9205, val_std=0.4743 | explained_var=0.627212
[GradSplit pre-clip] backbone=0.567360, critic=0.238376
[Loss] pg_loss=0.019103, entropy_loss=0.000028, value_loss=0.014795
[EpochKL] epoch=0 mean_kl=0.00274 max_kl=0.00672
[EpochKL] epoch=1 mean_kl=0.00505 max_kl=0.00701
[EpochKL] epoch=2 mean_kl=0.00712 max_kl=0.01044
[Time] Env Create Time: 4.4135s |Rollout Collect Time: 1.6909s |Loss & Update :0.9613
[PPODiag] kl_mean=0.0050, kl_p90=0.0095, kl_max=0.0104 | clipfrac_mean=0.016, logratio_std_mean=0.105, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.683 | pg_loss_mean=0.0023, v_loss_mean=0.0315, ent_mean=0.0238 | gn_bb_mean=0.940, gn_bb_max=2.607 | gn_v_mean=0.283, gn_v_max=0.512

  3%|▎         | 129/5000 [17:01<9:43:27,  7.19s/it]------------------ Training Record ------------------
Epoch: 129/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 1.981
Updated lambda_fail: 1.881
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1052, reward_valid_std=4.1741
[BatchDiag] adv_mean=-0.0088, adv_std=0.3521, adv_abs_mean=0.2442 | ret_mean=8.9550, ret_std=0.5846 | val_mean=8.9638, val_std=0.4669 | explained_var=0.637211
[GradSplit pre-clip] backbone=0.453326, critic=0.186194
[Loss] pg_loss=-0.064190, entropy_loss=0.000024, value_loss=0.012201
[EpochKL] epoch=0 mean_kl=0.00621 max_kl=0.01108
[EpochKL] epoch=1 mean_kl=0.00986 max_kl=0.01760
[EpochKL] epoch=2 mean_kl=0.00935 max_kl=0.01655
[Time] Env Create Time: 4.3995s |Rollout Collect Time: 1.6933s |Loss & Update :0.9604
[PPODiag] kl_mean=0.0085, kl_p90=0.0154, kl_max=0.0176 | clipfrac_mean=0.023, logratio_std_mean=0.149, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.683 | pg_loss_mean=0.0035, v_loss_mean=0.0293, ent_mean=0.0229 | gn_bb_mean=0.889, gn_bb_max=2.071 | gn_v_mean=0.364, gn_v_max=0.935

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.994, Step: 7, Avg Done Step: 6.62, #CS visited: 0.12
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.7999s
-----------------------------
  3%|▎         | 130/5000 [17:10<10:25:23,  7.70s/it]------------------ Training Record ------------------
Epoch: 130/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 1.881
Updated lambda_fail: 1.781
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.593, reward_valid_mean=2.0892, reward_valid_std=4.1720
[BatchDiag] adv_mean=0.0128, adv_std=0.3636, adv_abs_mean=0.2473 | ret_mean=8.9309, ret_std=0.6078 | val_mean=8.9181, val_std=0.4996 | explained_var=0.642000
[GradSplit pre-clip] backbone=1.664968, critic=0.192194
[Loss] pg_loss=0.001906, entropy_loss=0.000018, value_loss=0.012842
[EpochKL] epoch=0 mean_kl=0.00313 max_kl=0.00742
[EarlyStop] epoch=1 mean_kl=0.01129 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01129 max_kl=0.02134
[Time] Env Create Time: 4.3781s |Rollout Collect Time: 2.1221s |Loss & Update :0.7314
[PPODiag] kl_mean=0.0072, kl_p90=0.0131, kl_max=0.0213 | clipfrac_mean=0.019, logratio_std_mean=0.122, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.593, p10=0.587, min=0.579 | pg_loss_mean=0.0033, v_loss_mean=0.0324, ent_mean=0.0198 | gn_bb_mean=1.082, gn_bb_max=1.665 | gn_v_mean=0.356, gn_v_max=1.014
[AttnScore] scale=1.0268, C=10.0

  3%|▎         | 131/5000 [17:18<10:13:44,  7.56s/it]------------------ Training Record ------------------
Epoch: 131/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 1.781
Updated lambda_fail: 1.681
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1043, reward_valid_std=4.1772
[BatchDiag] adv_mean=0.0074, adv_std=0.3477, adv_abs_mean=0.2375 | ret_mean=8.9524, ret_std=0.5876 | val_mean=8.9450, val_std=0.5242 | explained_var=0.649815
[GradSplit pre-clip] backbone=0.530883, critic=0.296465
[Loss] pg_loss=-0.055893, entropy_loss=0.000021, value_loss=0.011043
[EpochKL] epoch=0 mean_kl=0.00235 max_kl=0.00504
[EpochKL] epoch=1 mean_kl=0.00662 max_kl=0.01191
[EpochKL] epoch=2 mean_kl=0.00630 max_kl=0.00962
[Time] Env Create Time: 4.4215s |Rollout Collect Time: 1.6852s |Loss & Update :0.9615
[PPODiag] kl_mean=0.0051, kl_p90=0.0090, kl_max=0.0119 | clipfrac_mean=0.019, logratio_std_mean=0.106, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.682 | pg_loss_mean=0.0018, v_loss_mean=0.0289, ent_mean=0.0224 | gn_bb_mean=0.820, gn_bb_max=1.579 | gn_v_mean=0.358, gn_v_max=0.671

  3%|▎         | 132/5000 [17:25<10:01:34,  7.41s/it]------------------ Training Record ------------------
Epoch: 132/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 1.681
Updated lambda_fail: 1.581
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0904, reward_valid_std=4.1729
[BatchDiag] adv_mean=-0.0270, adv_std=0.3461, adv_abs_mean=0.2341 | ret_mean=8.9429, ret_std=0.5945 | val_mean=8.9699, val_std=0.4853 | explained_var=0.661017
[GradSplit pre-clip] backbone=0.438921, critic=0.096841
[Loss] pg_loss=-0.091367, entropy_loss=0.000020, value_loss=0.009359
[EpochKL] epoch=0 mean_kl=0.00298 max_kl=0.00545
[EpochKL] epoch=1 mean_kl=0.00517 max_kl=0.00982
[EarlyStop] epoch=2 mean_kl=0.01393 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01393 max_kl=0.02773
[Time] Env Create Time: 4.4032s |Rollout Collect Time: 1.6803s |Loss & Update :0.9550
[PPODiag] kl_mean=0.0074, kl_p90=0.0155, kl_max=0.0277 | clipfrac_mean=0.020, logratio_std_mean=0.128, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.692, p10=0.686, min=0.684 | pg_loss_mean=0.0023, v_loss_mean=0.0289, ent_mean=0.0228 | gn_bb_mean=0.932, gn_bb_max=1.734 | gn_v_mean=0.200, gn_v_max=0.616

  3%|▎         | 133/5000 [17:32<9:52:18,  7.30s/it] ------------------ Training Record ------------------
Epoch: 133/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 1.581
Updated lambda_fail: 1.481
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0926, reward_valid_std=4.1763
[BatchDiag] adv_mean=0.0380, adv_std=0.3546, adv_abs_mean=0.2475 | ret_mean=8.9373, ret_std=0.5987 | val_mean=8.8993, val_std=0.5179 | explained_var=0.649227
[GradSplit pre-clip] backbone=0.585521, critic=0.397017
[Loss] pg_loss=0.015139, entropy_loss=0.000023, value_loss=0.014026
[EpochKL] epoch=0 mean_kl=0.00366 max_kl=0.00722
[EpochKL] epoch=1 mean_kl=0.00597 max_kl=0.00866
[EpochKL] epoch=2 mean_kl=0.00728 max_kl=0.01047
[Time] Env Create Time: 4.3743s |Rollout Collect Time: 1.7026s |Loss & Update :0.9566
[PPODiag] kl_mean=0.0056, kl_p90=0.0090, kl_max=0.0105 | clipfrac_mean=0.017, logratio_std_mean=0.114, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.678 | pg_loss_mean=0.0015, v_loss_mean=0.0303, ent_mean=0.0220 | gn_bb_mean=0.740, gn_bb_max=1.633 | gn_v_mean=0.213, gn_v_max=0.471

  3%|▎         | 134/5000 [17:39<9:45:40,  7.22s/it]------------------ Training Record ------------------
Epoch: 134/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 1.481
Updated lambda_fail: 1.381
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0969, reward_valid_std=4.1747
[BatchDiag] adv_mean=-0.0023, adv_std=0.3518, adv_abs_mean=0.2431 | ret_mean=8.9367, ret_std=0.5969 | val_mean=8.9389, val_std=0.4510 | explained_var=0.652532
[GradSplit pre-clip] backbone=1.139007, critic=0.155050
[Loss] pg_loss=0.002812, entropy_loss=0.000025, value_loss=0.012742
[EarlyStop] epoch=0 mean_kl=0.01366 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01366 max_kl=0.03561
[Time] Env Create Time: 4.4030s |Rollout Collect Time: 1.6906s |Loss & Update :0.3497
[PPODiag] kl_mean=0.0137, kl_p90=0.0228, kl_max=0.0356 | clipfrac_mean=0.025, logratio_std_mean=0.175, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.690, p10=0.687, min=0.684 | pg_loss_mean=0.0051, v_loss_mean=0.0305, ent_mean=0.0234 | gn_bb_mean=0.985, gn_bb_max=1.671 | gn_v_mean=0.280, gn_v_max=0.558

  3%|▎         | 135/5000 [17:45<9:26:37,  6.99s/it]------------------ Training Record ------------------
Epoch: 135/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 1.381
Updated lambda_fail: 1.281
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.0961, reward_valid_std=4.1774
[BatchDiag] adv_mean=-0.0075, adv_std=0.3601, adv_abs_mean=0.2399 | ret_mean=8.9426, ret_std=0.5991 | val_mean=8.9501, val_std=0.5139 | explained_var=0.638781
[GradSplit pre-clip] backbone=0.663547, critic=0.176161
[Loss] pg_loss=0.062173, entropy_loss=0.000018, value_loss=0.016700
[EpochKL] epoch=0 mean_kl=0.00240 max_kl=0.00743
[EpochKL] epoch=1 mean_kl=0.00814 max_kl=0.01920
[EarlyStop] epoch=2 mean_kl=0.01563 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01563 max_kl=0.02678
[Time] Env Create Time: 4.3922s |Rollout Collect Time: 1.9359s |Loss & Update :1.0745
[PPODiag] kl_mean=0.0087, kl_p90=0.0186, kl_max=0.0268 | clipfrac_mean=0.020, logratio_std_mean=0.149, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.591, p10=0.586, min=0.585 | pg_loss_mean=0.0018, v_loss_mean=0.0304, ent_mean=0.0193 | gn_bb_mean=0.691, gn_bb_max=1.917 | gn_v_mean=0.354, gn_v_max=0.756
[AttnScore] scale=1.0274, C=10.0

  3%|▎         | 136/5000 [17:53<9:36:36,  7.11s/it]------------------ Training Record ------------------
Epoch: 136/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 1.281
Updated lambda_fail: 1.181
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0857, reward_valid_std=4.1697
[BatchDiag] adv_mean=0.0265, adv_std=0.3795, adv_abs_mean=0.2681 | ret_mean=8.9249, ret_std=0.6157 | val_mean=8.8983, val_std=0.4828 | explained_var=0.620156
[GradSplit pre-clip] backbone=0.571661, critic=0.370765
[Loss] pg_loss=0.017404, entropy_loss=0.000022, value_loss=0.017531
[EpochKL] epoch=0 mean_kl=0.00458 max_kl=0.01180
[EpochKL] epoch=1 mean_kl=0.00794 max_kl=0.01358
[EpochKL] epoch=2 mean_kl=0.00886 max_kl=0.01069
[Time] Env Create Time: 4.6041s |Rollout Collect Time: 1.6959s |Loss & Update :0.9541
[PPODiag] kl_mean=0.0071, kl_p90=0.0111, kl_max=0.0136 | clipfrac_mean=0.020, logratio_std_mean=0.134, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.693, p10=0.686, min=0.683 | pg_loss_mean=0.0021, v_loss_mean=0.0345, ent_mean=0.0240 | gn_bb_mean=0.832, gn_bb_max=1.577 | gn_v_mean=0.278, gn_v_max=0.624

  3%|▎         | 137/5000 [18:00<9:39:55,  7.16s/it]------------------ Training Record ------------------
Epoch: 137/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 1.181
Updated lambda_fail: 1.081
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0893, reward_valid_std=4.1693
[BatchDiag] adv_mean=0.0208, adv_std=0.3698, adv_abs_mean=0.2568 | ret_mean=8.9251, ret_std=0.6018 | val_mean=8.9042, val_std=0.5035 | explained_var=0.622314
[GradSplit pre-clip] backbone=1.091208, critic=0.176631
[Loss] pg_loss=0.051138, entropy_loss=0.000027, value_loss=0.016021
[EpochKL] epoch=0 mean_kl=0.00468 max_kl=0.00977
[EpochKL] epoch=1 mean_kl=0.00966 max_kl=0.01374
[EarlyStop] epoch=2 mean_kl=0.01441 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01441 max_kl=0.02649
[Time] Env Create Time: 4.4206s |Rollout Collect Time: 1.6858s |Loss & Update :0.9537
[PPODiag] kl_mean=0.0096, kl_p90=0.0173, kl_max=0.0265 | clipfrac_mean=0.025, logratio_std_mean=0.155, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.692, p10=0.686, min=0.685 | pg_loss_mean=0.0031, v_loss_mean=0.0327, ent_mean=0.0278 | gn_bb_mean=0.974, gn_bb_max=1.569 | gn_v_mean=0.223, gn_v_max=0.549

  3%|▎         | 138/5000 [18:07<9:37:30,  7.13s/it]------------------ Training Record ------------------
Epoch: 138/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 1.081
Updated lambda_fail: 0.981
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0943, reward_valid_std=4.1732
[BatchDiag] adv_mean=0.0008, adv_std=0.3532, adv_abs_mean=0.2461 | ret_mean=8.9431, ret_std=0.5917 | val_mean=8.9423, val_std=0.4815 | explained_var=0.643554
[GradSplit pre-clip] backbone=0.899750, critic=0.146609
[Loss] pg_loss=-0.003259, entropy_loss=0.000024, value_loss=0.014556
[EpochKL] epoch=0 mean_kl=0.00757 max_kl=0.01282
[EpochKL] epoch=1 mean_kl=0.00574 max_kl=0.00805
[EarlyStop] epoch=2 mean_kl=0.01156 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01156 max_kl=0.02206
[Time] Env Create Time: 4.4179s |Rollout Collect Time: 1.6788s |Loss & Update :0.9583
[PPODiag] kl_mean=0.0083, kl_p90=0.0141, kl_max=0.0221 | clipfrac_mean=0.022, logratio_std_mean=0.148, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.691, p10=0.685, min=0.683 | pg_loss_mean=0.0036, v_loss_mean=0.0309, ent_mean=0.0264 | gn_bb_mean=1.049, gn_bb_max=2.190 | gn_v_mean=0.267, gn_v_max=0.587

  3%|▎         | 139/5000 [18:14<9:35:39,  7.11s/it]------------------ Training Record ------------------
Epoch: 139/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.981
Updated lambda_fail: 0.881
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0882, reward_valid_std=4.1756
[BatchDiag] adv_mean=-0.0218, adv_std=0.3719, adv_abs_mean=0.2497 | ret_mean=8.9396, ret_std=0.6059 | val_mean=8.9615, val_std=0.4552 | explained_var=0.623131
[GradSplit pre-clip] backbone=0.820516, critic=0.169460
[Loss] pg_loss=0.032754, entropy_loss=0.000026, value_loss=0.016214
[EpochKL] epoch=0 mean_kl=0.00300 max_kl=0.00697
[EpochKL] epoch=1 mean_kl=0.00588 max_kl=0.00741
[EpochKL] epoch=2 mean_kl=0.00966 max_kl=0.01366
[Time] Env Create Time: 4.4017s |Rollout Collect Time: 1.6947s |Loss & Update :0.9548
[PPODiag] kl_mean=0.0062, kl_p90=0.0109, kl_max=0.0137 | clipfrac_mean=0.021, logratio_std_mean=0.117, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.692, p10=0.686, min=0.684 | pg_loss_mean=0.0020, v_loss_mean=0.0330, ent_mean=0.0264 | gn_bb_mean=0.940, gn_bb_max=1.639 | gn_v_mean=0.249, gn_v_max=0.581

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.988, Step: 7, Avg Done Step: 6.63, #CS visited: 0.12
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8009s
-----------------------------
  3%|▎         | 140/5000 [18:23<10:19:15,  7.65s/it]------------------ Training Record ------------------
Epoch: 140/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.881
Updated lambda_fail: 0.781
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0903, reward_valid_std=4.1765
[BatchDiag] adv_mean=-0.0184, adv_std=0.3728, adv_abs_mean=0.2507 | ret_mean=8.9293, ret_std=0.6082 | val_mean=8.9478, val_std=0.4586 | explained_var=0.624382
[GradSplit pre-clip] backbone=0.310343, critic=0.243861
[Loss] pg_loss=-0.086392, entropy_loss=0.000022, value_loss=0.011951
[EpochKL] epoch=0 mean_kl=0.00114 max_kl=0.00208
[EpochKL] epoch=1 mean_kl=0.00593 max_kl=0.00964
[EarlyStop] epoch=2 mean_kl=0.01579 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01579 max_kl=0.04086
[Time] Env Create Time: 4.3693s |Rollout Collect Time: 1.6860s |Loss & Update :0.9559
[PPODiag] kl_mean=0.0076, kl_p90=0.0181, kl_max=0.0409 | clipfrac_mean=0.019, logratio_std_mean=0.125, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.680 | pg_loss_mean=0.0033, v_loss_mean=0.0329, ent_mean=0.0263 | gn_bb_mean=1.144, gn_bb_max=3.881 | gn_v_mean=0.195, gn_v_max=0.338
[AttnScore] scale=1.0282, C=10.0

  3%|▎         | 141/5000 [18:30<10:03:44,  7.46s/it]------------------ Training Record ------------------
Epoch: 141/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.781
Updated lambda_fail: 0.681
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0901, reward_valid_std=4.1752
[BatchDiag] adv_mean=-0.0224, adv_std=0.3798, adv_abs_mean=0.2635 | ret_mean=8.9400, ret_std=0.6076 | val_mean=8.9624, val_std=0.4591 | explained_var=0.609345
[GradSplit pre-clip] backbone=0.888468, critic=0.284383
[Loss] pg_loss=-0.126895, entropy_loss=0.000027, value_loss=0.011501
[EpochKL] epoch=0 mean_kl=0.00295 max_kl=0.00792
[EarlyStop] epoch=1 mean_kl=0.01877 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01877 max_kl=0.03230
[Time] Env Create Time: 4.3774s |Rollout Collect Time: 1.6835s |Loss & Update :0.6523
[PPODiag] kl_mean=0.0109, kl_p90=0.0249, kl_max=0.0323 | clipfrac_mean=0.024, logratio_std_mean=0.157, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.692, p10=0.684, min=0.684 | pg_loss_mean=0.0037, v_loss_mean=0.0351, ent_mean=0.0272 | gn_bb_mean=1.239, gn_bb_max=4.966 | gn_v_mean=0.342, gn_v_max=0.838

  3%|▎         | 142/5000 [18:37<9:45:36,  7.23s/it] ------------------ Training Record ------------------
Epoch: 142/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.681
Updated lambda_fail: 0.581
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.696, reward_valid_mean=2.0716, reward_valid_std=4.1643
[BatchDiag] adv_mean=-0.0535, adv_std=0.3959, adv_abs_mean=0.2770 | ret_mean=8.9266, ret_std=0.6093 | val_mean=8.9801, val_std=0.4261 | explained_var=0.577938
[GradSplit pre-clip] backbone=0.704815, critic=0.357167
[Loss] pg_loss=-0.025973, entropy_loss=0.000027, value_loss=0.015498
[EarlyStop] epoch=0 mean_kl=0.01198 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01198 max_kl=0.02824
[Time] Env Create Time: 4.5726s |Rollout Collect Time: 1.6756s |Loss & Update :0.3669
[PPODiag] kl_mean=0.0120, kl_p90=0.0210, kl_max=0.0282 | clipfrac_mean=0.026, logratio_std_mean=0.173, ratio_p95_mean=1.014 | valid_ratio_mb_mean=0.696, p10=0.689, min=0.689 | pg_loss_mean=0.0023, v_loss_mean=0.0369, ent_mean=0.0251 | gn_bb_mean=1.070, gn_bb_max=1.376 | gn_v_mean=0.294, gn_v_max=0.427

  3%|▎         | 143/5000 [18:43<9:30:30,  7.05s/it]------------------ Training Record ------------------
Epoch: 143/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.581
Updated lambda_fail: 0.481
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0895, reward_valid_std=4.1704
[BatchDiag] adv_mean=0.0108, adv_std=0.3797, adv_abs_mean=0.2610 | ret_mean=8.9240, ret_std=0.6034 | val_mean=8.9132, val_std=0.4723 | explained_var=0.603905
[GradSplit pre-clip] backbone=0.939052, critic=0.322732
[Loss] pg_loss=-0.048604, entropy_loss=0.000023, value_loss=0.012899
[EarlyStop] epoch=0 mean_kl=0.01021 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01021 max_kl=0.02669
[Time] Env Create Time: 4.4085s |Rollout Collect Time: 1.6887s |Loss & Update :0.3627
[PPODiag] kl_mean=0.0102, kl_p90=0.0218, kl_max=0.0267 | clipfrac_mean=0.020, logratio_std_mean=0.157, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.691, p10=0.687, min=0.687 | pg_loss_mean=0.0027, v_loss_mean=0.0351, ent_mean=0.0252 | gn_bb_mean=1.151, gn_bb_max=2.624 | gn_v_mean=0.369, gn_v_max=0.535

  3%|▎         | 144/5000 [18:50<9:16:07,  6.87s/it]------------------ Training Record ------------------
Epoch: 144/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.481
Updated lambda_fail: 0.381
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1073, reward_valid_std=4.1824
[BatchDiag] adv_mean=-0.0187, adv_std=0.3393, adv_abs_mean=0.2352 | ret_mean=8.9541, ret_std=0.5818 | val_mean=8.9728, val_std=0.4422 | explained_var=0.659940
[GradSplit pre-clip] backbone=0.765430, critic=0.088349
[Loss] pg_loss=-0.054127, entropy_loss=0.000021, value_loss=0.011631
[EpochKL] epoch=0 mean_kl=0.00425 max_kl=0.01338
[EarlyStop] epoch=1 mean_kl=0.01314 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01314 max_kl=0.01889
[Time] Env Create Time: 4.3787s |Rollout Collect Time: 1.6832s |Loss & Update :0.6659
[PPODiag] kl_mean=0.0087, kl_p90=0.0177, kl_max=0.0189 | clipfrac_mean=0.019, logratio_std_mean=0.141, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.678 | pg_loss_mean=0.0042, v_loss_mean=0.0284, ent_mean=0.0220 | gn_bb_mean=0.988, gn_bb_max=2.489 | gn_v_mean=0.236, gn_v_max=0.425

  3%|▎         | 145/5000 [18:56<9:12:32,  6.83s/it]------------------ Training Record ------------------
Epoch: 145/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.381
Updated lambda_fail: 0.281
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1076, reward_valid_std=4.1867
[BatchDiag] adv_mean=-0.0302, adv_std=0.3543, adv_abs_mean=0.2371 | ret_mean=8.9515, ret_std=0.5971 | val_mean=8.9817, val_std=0.4551 | explained_var=0.647892
[GradSplit pre-clip] backbone=0.716554, critic=0.093056
[Loss] pg_loss=-0.067861, entropy_loss=0.000019, value_loss=0.011947
[EpochKL] epoch=0 mean_kl=0.00786 max_kl=0.01683
[EpochKL] epoch=1 mean_kl=0.00634 max_kl=0.01402
[EpochKL] epoch=2 mean_kl=0.00811 max_kl=0.01330
[Time] Env Create Time: 4.3968s |Rollout Collect Time: 1.6910s |Loss & Update :0.9549
[PPODiag] kl_mean=0.0074, kl_p90=0.0138, kl_max=0.0168 | clipfrac_mean=0.020, logratio_std_mean=0.135, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.678 | pg_loss_mean=0.0022, v_loss_mean=0.0305, ent_mean=0.0218 | gn_bb_mean=0.831, gn_bb_max=1.619 | gn_v_mean=0.313, gn_v_max=0.758
[AttnScore] scale=1.0287, C=10.0

  3%|▎         | 146/5000 [19:03<9:17:38,  6.89s/it]------------------ Training Record ------------------
Epoch: 146/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.281
Updated lambda_fail: 0.181
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1016, reward_valid_std=4.1851
[BatchDiag] adv_mean=-0.0016, adv_std=0.3613, adv_abs_mean=0.2412 | ret_mean=8.9397, ret_std=0.6025 | val_mean=8.9413, val_std=0.4962 | explained_var=0.640399
[GradSplit pre-clip] backbone=1.247026, critic=0.221104
[Loss] pg_loss=-0.031017, entropy_loss=0.000018, value_loss=0.012960
[EpochKL] epoch=0 mean_kl=0.00455 max_kl=0.00774
[EpochKL] epoch=1 mean_kl=0.00703 max_kl=0.01075
[EarlyStop] epoch=2 mean_kl=0.01995 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01995 max_kl=0.05747
[Time] Env Create Time: 4.3958s |Rollout Collect Time: 1.9214s |Loss & Update :1.0906
[PPODiag] kl_mean=0.0105, kl_p90=0.0205, kl_max=0.0575 | clipfrac_mean=0.023, logratio_std_mean=0.154, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.589, p10=0.583, min=0.581 | pg_loss_mean=0.0037, v_loss_mean=0.0314, ent_mean=0.0194 | gn_bb_mean=1.012, gn_bb_max=1.851 | gn_v_mean=0.352, gn_v_max=0.759

  3%|▎         | 147/5000 [19:11<9:30:01,  7.05s/it]------------------ Training Record ------------------
Epoch: 147/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.181
Updated lambda_fail: 0.081
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0896, reward_valid_std=4.1739
[BatchDiag] adv_mean=0.0160, adv_std=0.3620, adv_abs_mean=0.2580 | ret_mean=8.9334, ret_std=0.6003 | val_mean=8.9174, val_std=0.4672 | explained_var=0.636318
[GradSplit pre-clip] backbone=0.805188, critic=0.141976
[Loss] pg_loss=0.048324, entropy_loss=0.000019, value_loss=0.016685
[EpochKL] epoch=0 mean_kl=0.00320 max_kl=0.00660
[EpochKL] epoch=1 mean_kl=0.00593 max_kl=0.00976
[EpochKL] epoch=2 mean_kl=0.00549 max_kl=0.00927
[Time] Env Create Time: 4.3690s |Rollout Collect Time: 1.6918s |Loss & Update :0.9622
[PPODiag] kl_mean=0.0049, kl_p90=0.0080, kl_max=0.0098 | clipfrac_mean=0.017, logratio_std_mean=0.104, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.692, p10=0.685, min=0.681 | pg_loss_mean=0.0020, v_loss_mean=0.0314, ent_mean=0.0221 | gn_bb_mean=0.826, gn_bb_max=1.336 | gn_v_mean=0.284, gn_v_max=0.552

  3%|▎         | 148/5000 [19:18<9:29:19,  7.04s/it]------------------ Training Record ------------------
Epoch: 148/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.081
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0935, reward_valid_std=4.1773
[BatchDiag] adv_mean=0.0225, adv_std=0.3512, adv_abs_mean=0.2477 | ret_mean=8.9399, ret_std=0.6019 | val_mean=8.9174, val_std=0.4778 | explained_var=0.659494
[GradSplit pre-clip] backbone=0.445512, critic=0.498626
[Loss] pg_loss=-0.081512, entropy_loss=0.000018, value_loss=0.012113
[EpochKL] epoch=0 mean_kl=0.00291 max_kl=0.00572
[EpochKL] epoch=1 mean_kl=0.00626 max_kl=0.01031
[EarlyStop] epoch=2 mean_kl=0.01028 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01028 max_kl=0.02550
[Time] Env Create Time: 4.5814s |Rollout Collect Time: 1.6827s |Loss & Update :0.9641
[PPODiag] kl_mean=0.0065, kl_p90=0.0109, kl_max=0.0255 | clipfrac_mean=0.018, logratio_std_mean=0.125, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.691, p10=0.687, min=0.680 | pg_loss_mean=0.0015, v_loss_mean=0.0298, ent_mean=0.0216 | gn_bb_mean=0.709, gn_bb_max=1.335 | gn_v_mean=0.350, gn_v_max=0.702

  3%|▎         | 149/5000 [19:25<9:33:46,  7.10s/it]------------------ Training Record ------------------
Epoch: 149/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0996, reward_valid_std=4.1788
[BatchDiag] adv_mean=-0.0535, adv_std=0.3565, adv_abs_mean=0.2438 | ret_mean=8.9459, ret_std=0.5931 | val_mean=8.9993, val_std=0.4772 | explained_var=0.638660
[GradSplit pre-clip] backbone=0.434269, critic=0.272066
[Loss] pg_loss=-0.044010, entropy_loss=0.000018, value_loss=0.015184
[EpochKL] epoch=0 mean_kl=0.00659 max_kl=0.01648
[EarlyStop] epoch=1 mean_kl=0.02079 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02079 max_kl=0.02854
[Time] Env Create Time: 4.3957s |Rollout Collect Time: 1.6916s |Loss & Update :0.6588
[PPODiag] kl_mean=0.0137, kl_p90=0.0253, kl_max=0.0285 | clipfrac_mean=0.023, logratio_std_mean=0.184, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.684 | pg_loss_mean=0.0050, v_loss_mean=0.0319, ent_mean=0.0223 | gn_bb_mean=0.889, gn_bb_max=1.939 | gn_v_mean=0.385, gn_v_max=0.728

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.016, Step: 7, Avg Done Step: 6.62, #CS visited: 0.12
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8227s
-----------------------------
  3%|▎         | 150/5000 [19:34<10:09:47,  7.54s/it]------------------ Training Record ------------------
Epoch: 150/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0953, reward_valid_std=4.1793
[BatchDiag] adv_mean=-0.0452, adv_std=0.3536, adv_abs_mean=0.2522 | ret_mean=8.9425, ret_std=0.5916 | val_mean=8.9876, val_std=0.4557 | explained_var=0.642728
[GradSplit pre-clip] backbone=0.497470, critic=0.460940
[Loss] pg_loss=0.029999, entropy_loss=0.000022, value_loss=0.014822
[EpochKL] epoch=0 mean_kl=0.00549 max_kl=0.01036
[EarlyStop] epoch=1 mean_kl=0.01528 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01528 max_kl=0.03122
[Time] Env Create Time: 4.3654s |Rollout Collect Time: 1.6869s |Loss & Update :0.6726
[PPODiag] kl_mean=0.0104, kl_p90=0.0211, kl_max=0.0312 | clipfrac_mean=0.022, logratio_std_mean=0.165, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.690, p10=0.681, min=0.676 | pg_loss_mean=0.0032, v_loss_mean=0.0304, ent_mean=0.0216 | gn_bb_mean=0.864, gn_bb_max=1.406 | gn_v_mean=0.331, gn_v_max=0.755
[AttnScore] scale=1.0293, C=10.0

  3%|▎         | 151/5000 [19:40<9:49:49,  7.30s/it] ------------------ Training Record ------------------
Epoch: 151/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1022, reward_valid_std=4.1815
[BatchDiag] adv_mean=-0.0647, adv_std=0.3674, adv_abs_mean=0.2417 | ret_mean=8.9525, ret_std=0.5999 | val_mean=9.0173, val_std=0.4733 | explained_var=0.625024
[GradSplit pre-clip] backbone=0.877822, critic=0.284480
[Loss] pg_loss=-0.077941, entropy_loss=0.000022, value_loss=0.012197
[EpochKL] epoch=0 mean_kl=0.00686 max_kl=0.01974
[EarlyStop] epoch=1 mean_kl=0.03188 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03188 max_kl=0.05609
[Time] Env Create Time: 4.3747s |Rollout Collect Time: 1.6767s |Loss & Update :0.6591
[PPODiag] kl_mean=0.0194, kl_p90=0.0404, kl_max=0.0561 | clipfrac_mean=0.029, logratio_std_mean=0.223, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.681 | pg_loss_mean=0.0074, v_loss_mean=0.0338, ent_mean=0.0249 | gn_bb_mean=1.166, gn_bb_max=2.118 | gn_v_mean=0.633, gn_v_max=1.218

  3%|▎         | 152/5000 [19:47<9:35:27,  7.12s/it]------------------ Training Record ------------------
Epoch: 152/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.594, reward_valid_mean=2.0874, reward_valid_std=4.1710
[BatchDiag] adv_mean=-0.0967, adv_std=0.3744, adv_abs_mean=0.2540 | ret_mean=8.9395, ret_std=0.6019 | val_mean=9.0362, val_std=0.4219 | explained_var=0.613115
[GradSplit pre-clip] backbone=0.532983, critic=0.666449
[Loss] pg_loss=-0.011579, entropy_loss=0.000021, value_loss=0.016270
[EarlyStop] epoch=0 mean_kl=0.01549 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01549 max_kl=0.03800
[Time] Env Create Time: 4.4166s |Rollout Collect Time: 1.9385s |Loss & Update :0.3982
[PPODiag] kl_mean=0.0155, kl_p90=0.0330, kl_max=0.0380 | clipfrac_mean=0.030, logratio_std_mean=0.188, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.594, p10=0.592, min=0.592 | pg_loss_mean=0.0060, v_loss_mean=0.0370, ent_mean=0.0234 | gn_bb_mean=1.053, gn_bb_max=1.882 | gn_v_mean=0.504, gn_v_max=1.025

  3%|▎         | 153/5000 [19:54<9:26:24,  7.01s/it]------------------ Training Record ------------------
Epoch: 153/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1016, reward_valid_std=4.1850
[BatchDiag] adv_mean=-0.0152, adv_std=0.3610, adv_abs_mean=0.2447 | ret_mean=8.9364, ret_std=0.5976 | val_mean=8.9517, val_std=0.4578 | explained_var=0.635077
[GradSplit pre-clip] backbone=1.283522, critic=0.166766
[Loss] pg_loss=-0.065989, entropy_loss=0.000023, value_loss=0.012053
[EpochKL] epoch=0 mean_kl=0.00197 max_kl=0.00596
[EpochKL] epoch=1 mean_kl=0.00745 max_kl=0.01107
[EpochKL] epoch=2 mean_kl=0.00654 max_kl=0.01116
[Time] Env Create Time: 4.5968s |Rollout Collect Time: 1.6858s |Loss & Update :0.9600
[PPODiag] kl_mean=0.0053, kl_p90=0.0098, kl_max=0.0112 | clipfrac_mean=0.018, logratio_std_mean=0.107, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.679 | pg_loss_mean=0.0017, v_loss_mean=0.0306, ent_mean=0.0222 | gn_bb_mean=0.820, gn_bb_max=1.973 | gn_v_mean=0.510, gn_v_max=0.837

  3%|▎         | 154/5000 [20:01<9:31:54,  7.08s/it]------------------ Training Record ------------------
Epoch: 154/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0974, reward_valid_std=4.1811
[BatchDiag] adv_mean=-0.0179, adv_std=0.3504, adv_abs_mean=0.2356 | ret_mean=8.9409, ret_std=0.5982 | val_mean=8.9588, val_std=0.4816 | explained_var=0.656895
[GradSplit pre-clip] backbone=0.471745, critic=0.279624
[Loss] pg_loss=-0.122527, entropy_loss=0.000019, value_loss=0.009662
[EpochKL] epoch=0 mean_kl=0.00418 max_kl=0.01219
[EpochKL] epoch=1 mean_kl=0.00906 max_kl=0.01767
[EpochKL] epoch=2 mean_kl=0.00741 max_kl=0.01149
[Time] Env Create Time: 4.4132s |Rollout Collect Time: 1.6853s |Loss & Update :0.9590
[PPODiag] kl_mean=0.0069, kl_p90=0.0120, kl_max=0.0177 | clipfrac_mean=0.020, logratio_std_mean=0.129, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.690, p10=0.682, min=0.678 | pg_loss_mean=0.0008, v_loss_mean=0.0303, ent_mean=0.0232 | gn_bb_mean=0.702, gn_bb_max=1.581 | gn_v_mean=0.421, gn_v_max=0.867

  3%|▎         | 155/5000 [20:08<9:31:14,  7.07s/it]------------------ Training Record ------------------
Epoch: 155/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0823, reward_valid_std=4.1767
[BatchDiag] adv_mean=-0.0591, adv_std=0.3629, adv_abs_mean=0.2449 | ret_mean=8.9321, ret_std=0.6058 | val_mean=8.9912, val_std=0.4515 | explained_var=0.641197
[GradSplit pre-clip] backbone=0.875887, critic=0.267733
[Loss] pg_loss=-0.050378, entropy_loss=0.000026, value_loss=0.013920
[EpochKL] epoch=0 mean_kl=0.00847 max_kl=0.02747
[EarlyStop] epoch=1 mean_kl=0.02422 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02422 max_kl=0.04448
[Time] Env Create Time: 4.4189s |Rollout Collect Time: 1.6935s |Loss & Update :0.6511
[PPODiag] kl_mean=0.0163, kl_p90=0.0355, kl_max=0.0445 | clipfrac_mean=0.028, logratio_std_mean=0.207, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.693, p10=0.687, min=0.682 | pg_loss_mean=0.0077, v_loss_mean=0.0321, ent_mean=0.0259 | gn_bb_mean=2.268, gn_bb_max=19.799 | gn_v_mean=0.324, gn_v_max=0.626
[AttnScore] scale=1.0300, C=10.0

  3%|▎         | 156/5000 [20:15<9:23:36,  6.98s/it]------------------ Training Record ------------------
Epoch: 156/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1019, reward_valid_std=4.1801
[BatchDiag] adv_mean=-0.0243, adv_std=0.3578, adv_abs_mean=0.2439 | ret_mean=8.9318, ret_std=0.6025 | val_mean=8.9561, val_std=0.4438 | explained_var=0.647217
[GradSplit pre-clip] backbone=1.013378, critic=0.228706
[Loss] pg_loss=0.014136, entropy_loss=0.000016, value_loss=0.011625
[EarlyStop] epoch=0 mean_kl=0.01388 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01388 max_kl=0.03091
[Time] Env Create Time: 4.4149s |Rollout Collect Time: 1.9317s |Loss & Update :0.3927
[PPODiag] kl_mean=0.0139, kl_p90=0.0263, kl_max=0.0309 | clipfrac_mean=0.022, logratio_std_mean=0.185, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.589, p10=0.585, min=0.584 | pg_loss_mean=0.0024, v_loss_mean=0.0303, ent_mean=0.0186 | gn_bb_mean=0.771, gn_bb_max=1.284 | gn_v_mean=0.357, gn_v_max=0.526

  3%|▎         | 157/5000 [20:22<9:17:38,  6.91s/it]------------------ Training Record ------------------
Epoch: 157/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1097, reward_valid_std=4.1848
[BatchDiag] adv_mean=-0.0067, adv_std=0.3293, adv_abs_mean=0.2255 | ret_mean=8.9453, ret_std=0.5809 | val_mean=8.9520, val_std=0.4911 | explained_var=0.678579
[GradSplit pre-clip] backbone=0.553552, critic=0.351788
[Loss] pg_loss=-0.123769, entropy_loss=0.000022, value_loss=0.010471
[EpochKL] epoch=0 mean_kl=0.00332 max_kl=0.00779
[EpochKL] epoch=1 mean_kl=0.00627 max_kl=0.00990
[EpochKL] epoch=2 mean_kl=0.00702 max_kl=0.01159
[Time] Env Create Time: 4.4013s |Rollout Collect Time: 1.6904s |Loss & Update :0.9538
[PPODiag] kl_mean=0.0055, kl_p90=0.0095, kl_max=0.0116 | clipfrac_mean=0.017, logratio_std_mean=0.113, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.677 | pg_loss_mean=0.0016, v_loss_mean=0.0268, ent_mean=0.0207 | gn_bb_mean=0.727, gn_bb_max=1.359 | gn_v_mean=0.291, gn_v_max=0.647

  3%|▎         | 158/5000 [20:29<9:20:51,  6.95s/it]------------------ Training Record ------------------
Epoch: 158/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1007, reward_valid_std=4.1822
[BatchDiag] adv_mean=0.0219, adv_std=0.3461, adv_abs_mean=0.2408 | ret_mean=8.9377, ret_std=0.5956 | val_mean=8.9159, val_std=0.5050 | explained_var=0.662251
[GradSplit pre-clip] backbone=0.395490, critic=0.571386
[Loss] pg_loss=-0.111768, entropy_loss=0.000016, value_loss=0.009223
[EpochKL] epoch=0 mean_kl=0.00508 max_kl=0.02102
[EpochKL] epoch=1 mean_kl=0.00836 max_kl=0.01852
[EpochKL] epoch=2 mean_kl=0.00680 max_kl=0.01372
[Time] Env Create Time: 4.3946s |Rollout Collect Time: 1.6960s |Loss & Update :0.9480
[PPODiag] kl_mean=0.0067, kl_p90=0.0128, kl_max=0.0210 | clipfrac_mean=0.018, logratio_std_mean=0.119, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.681, min=0.679 | pg_loss_mean=0.0022, v_loss_mean=0.0286, ent_mean=0.0198 | gn_bb_mean=0.827, gn_bb_max=1.890 | gn_v_mean=0.301, gn_v_max=0.571

  3%|▎         | 159/5000 [20:36<9:22:53,  6.98s/it]------------------ Training Record ------------------
Epoch: 159/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1041, reward_valid_std=4.1827
[BatchDiag] adv_mean=-0.0171, adv_std=0.3410, adv_abs_mean=0.2269 | ret_mean=8.9461, ret_std=0.5902 | val_mean=8.9632, val_std=0.4871 | explained_var=0.666269
[GradSplit pre-clip] backbone=0.732857, critic=0.127298
[Loss] pg_loss=-0.046935, entropy_loss=0.000015, value_loss=0.012176
[EpochKL] epoch=0 mean_kl=0.00236 max_kl=0.00463
[EpochKL] epoch=1 mean_kl=0.00536 max_kl=0.01339
[EpochKL] epoch=2 mean_kl=0.00635 max_kl=0.01033
[Time] Env Create Time: 4.3682s |Rollout Collect Time: 1.6856s |Loss & Update :0.9577
[PPODiag] kl_mean=0.0047, kl_p90=0.0085, kl_max=0.0134 | clipfrac_mean=0.014, logratio_std_mean=0.101, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.680 | pg_loss_mean=0.0015, v_loss_mean=0.0284, ent_mean=0.0195 | gn_bb_mean=0.766, gn_bb_max=1.586 | gn_v_mean=0.254, gn_v_max=0.470

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.005, Step: 7, Avg Done Step: 6.61, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8034s
-----------------------------
  3%|▎         | 160/5000 [20:45<10:08:02,  7.54s/it]------------------ Training Record ------------------
Epoch: 160/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.588, reward_valid_mean=2.1090, reward_valid_std=4.1859
[BatchDiag] adv_mean=-0.0193, adv_std=0.3428, adv_abs_mean=0.2298 | ret_mean=8.9431, ret_std=0.5894 | val_mean=8.9625, val_std=0.4753 | explained_var=0.661701
[GradSplit pre-clip] backbone=0.606352, critic=0.119582
[Loss] pg_loss=-0.032236, entropy_loss=0.000020, value_loss=0.010562
[EpochKL] epoch=0 mean_kl=0.00293 max_kl=0.00665
[EpochKL] epoch=1 mean_kl=0.00579 max_kl=0.01546
[EpochKL] epoch=2 mean_kl=0.00668 max_kl=0.00953
[Time] Env Create Time: 4.5990s |Rollout Collect Time: 1.9208s |Loss & Update :1.0850
[PPODiag] kl_mean=0.0051, kl_p90=0.0077, kl_max=0.0155 | clipfrac_mean=0.017, logratio_std_mean=0.116, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.588, p10=0.584, min=0.583 | pg_loss_mean=0.0014, v_loss_mean=0.0278, ent_mean=0.0197 | gn_bb_mean=0.745, gn_bb_max=1.420 | gn_v_mean=0.253, gn_v_max=0.718
[AttnScore] scale=1.0311, C=10.0

  3%|▎         | 161/5000 [20:52<10:09:33,  7.56s/it]------------------ Training Record ------------------
Epoch: 161/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0977, reward_valid_std=4.1783
[BatchDiag] adv_mean=-0.0140, adv_std=0.3329, adv_abs_mean=0.2250 | ret_mean=8.9401, ret_std=0.5952 | val_mean=8.9540, val_std=0.4801 | explained_var=0.687068
[GradSplit pre-clip] backbone=1.128058, critic=0.083352
[Loss] pg_loss=-0.013811, entropy_loss=0.000025, value_loss=0.011124
[EpochKL] epoch=0 mean_kl=0.00314 max_kl=0.00889
[EpochKL] epoch=1 mean_kl=0.00790 max_kl=0.01471
[EarlyStop] epoch=2 mean_kl=0.02076 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02076 max_kl=0.03937
[Time] Env Create Time: 4.4017s |Rollout Collect Time: 1.6867s |Loss & Update :0.9579
[PPODiag] kl_mean=0.0106, kl_p90=0.0223, kl_max=0.0394 | clipfrac_mean=0.023, logratio_std_mean=0.163, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.680 | pg_loss_mean=0.0039, v_loss_mean=0.0266, ent_mean=0.0227 | gn_bb_mean=0.997, gn_bb_max=1.583 | gn_v_mean=0.223, gn_v_max=0.651

  3%|▎         | 162/5000 [20:59<9:57:03,  7.40s/it] ------------------ Training Record ------------------
Epoch: 162/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0977, reward_valid_std=4.1815
[BatchDiag] adv_mean=-0.0436, adv_std=0.3364, adv_abs_mean=0.2257 | ret_mean=8.9396, ret_std=0.5866 | val_mean=8.9832, val_std=0.4705 | explained_var=0.671145
[GradSplit pre-clip] backbone=0.640284, critic=0.336647
[Loss] pg_loss=-0.001253, entropy_loss=0.000022, value_loss=0.010879
[EpochKL] epoch=0 mean_kl=0.00453 max_kl=0.01020
[EpochKL] epoch=1 mean_kl=0.00748 max_kl=0.01139
[EarlyStop] epoch=2 mean_kl=0.01465 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01465 max_kl=0.03213
[Time] Env Create Time: 4.3938s |Rollout Collect Time: 1.6853s |Loss & Update :0.9588
[PPODiag] kl_mean=0.0089, kl_p90=0.0170, kl_max=0.0321 | clipfrac_mean=0.023, logratio_std_mean=0.144, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.682 | pg_loss_mean=0.0045, v_loss_mean=0.0276, ent_mean=0.0244 | gn_bb_mean=1.123, gn_bb_max=2.862 | gn_v_mean=0.307, gn_v_max=0.556

  3%|▎         | 163/5000 [21:06<9:48:04,  7.29s/it]------------------ Training Record ------------------
Epoch: 163/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0870, reward_valid_std=4.1770
[BatchDiag] adv_mean=-0.0287, adv_std=0.3555, adv_abs_mean=0.2411 | ret_mean=8.9283, ret_std=0.6047 | val_mean=8.9570, val_std=0.4889 | explained_var=0.654259
[GradSplit pre-clip] backbone=0.784202, critic=0.138864
[Loss] pg_loss=-0.043443, entropy_loss=0.000020, value_loss=0.013440
[EpochKL] epoch=0 mean_kl=0.00653 max_kl=0.01224
[EarlyStop] epoch=1 mean_kl=0.01473 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01473 max_kl=0.02088
[Time] Env Create Time: 4.3773s |Rollout Collect Time: 1.6986s |Loss & Update :0.6566
[PPODiag] kl_mean=0.0106, kl_p90=0.0180, kl_max=0.0209 | clipfrac_mean=0.023, logratio_std_mean=0.166, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.691, p10=0.687, min=0.685 | pg_loss_mean=0.0040, v_loss_mean=0.0302, ent_mean=0.0229 | gn_bb_mean=1.102, gn_bb_max=2.128 | gn_v_mean=0.339, gn_v_max=0.724

  3%|▎         | 164/5000 [21:13<9:34:22,  7.13s/it]------------------ Training Record ------------------
Epoch: 164/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0937, reward_valid_std=4.1752
[BatchDiag] adv_mean=0.0059, adv_std=0.3468, adv_abs_mean=0.2381 | ret_mean=8.9361, ret_std=0.5919 | val_mean=8.9302, val_std=0.4864 | explained_var=0.656820
[GradSplit pre-clip] backbone=0.547252, critic=0.235434
[Loss] pg_loss=-0.029565, entropy_loss=0.000018, value_loss=0.013303
[EpochKL] epoch=0 mean_kl=0.00593 max_kl=0.01371
[EpochKL] epoch=1 mean_kl=0.00985 max_kl=0.01906
[EarlyStop] epoch=2 mean_kl=0.01155 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01155 max_kl=0.02077
[Time] Env Create Time: 4.3768s |Rollout Collect Time: 1.7041s |Loss & Update :0.9788
[PPODiag] kl_mean=0.0091, kl_p90=0.0177, kl_max=0.0208 | clipfrac_mean=0.022, logratio_std_mean=0.157, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.691, p10=0.685, min=0.680 | pg_loss_mean=0.0035, v_loss_mean=0.0299, ent_mean=0.0225 | gn_bb_mean=0.903, gn_bb_max=1.794 | gn_v_mean=0.392, gn_v_max=0.745

  3%|▎         | 165/5000 [21:20<9:32:39,  7.11s/it]------------------ Training Record ------------------
Epoch: 165/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1054, reward_valid_std=4.1770
[BatchDiag] adv_mean=0.0618, adv_std=0.3397, adv_abs_mean=0.2519 | ret_mean=8.9460, ret_std=0.5898 | val_mean=8.8842, val_std=0.4731 | explained_var=0.668297
[GradSplit pre-clip] backbone=0.459357, critic=0.741308
[Loss] pg_loss=-0.051006, entropy_loss=0.000020, value_loss=0.012439
[EpochKL] epoch=0 mean_kl=0.00175 max_kl=0.00316
[EpochKL] epoch=1 mean_kl=0.00728 max_kl=0.01351
[EarlyStop] epoch=2 mean_kl=0.01078 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01078 max_kl=0.01699
[Time] Env Create Time: 4.3706s |Rollout Collect Time: 1.6852s |Loss & Update :0.9757
[PPODiag] kl_mean=0.0066, kl_p90=0.0149, kl_max=0.0170 | clipfrac_mean=0.019, logratio_std_mean=0.126, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.682 | pg_loss_mean=0.0024, v_loss_mean=0.0281, ent_mean=0.0217 | gn_bb_mean=0.820, gn_bb_max=1.530 | gn_v_mean=0.361, gn_v_max=0.741
[AttnScore] scale=1.0317, C=10.0

  3%|▎         | 166/5000 [21:27<9:30:44,  7.08s/it]------------------ Training Record ------------------
Epoch: 166/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.593, reward_valid_mean=2.0925, reward_valid_std=4.1704
[BatchDiag] adv_mean=0.0525, adv_std=0.3446, adv_abs_mean=0.2433 | ret_mean=8.9366, ret_std=0.5943 | val_mean=8.8841, val_std=0.5163 | explained_var=0.663668
[GradSplit pre-clip] backbone=0.439334, critic=0.613950
[Loss] pg_loss=-0.023974, entropy_loss=0.000016, value_loss=0.013631
[EpochKL] epoch=0 mean_kl=0.00312 max_kl=0.00929
[EpochKL] epoch=1 mean_kl=0.00700 max_kl=0.01587
[EpochKL] epoch=2 mean_kl=0.00899 max_kl=0.01248
[Time] Env Create Time: 4.5983s |Rollout Collect Time: 1.9383s |Loss & Update :1.0822
[PPODiag] kl_mean=0.0064, kl_p90=0.0117, kl_max=0.0159 | clipfrac_mean=0.018, logratio_std_mean=0.125, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.593, p10=0.587, min=0.585 | pg_loss_mean=0.0012, v_loss_mean=0.0293, ent_mean=0.0179 | gn_bb_mean=0.754, gn_bb_max=1.411 | gn_v_mean=0.437, gn_v_max=1.027

  3%|▎         | 167/5000 [21:35<9:43:33,  7.24s/it]------------------ Training Record ------------------
Epoch: 167/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.694, reward_valid_mean=2.0783, reward_valid_std=4.1635
[BatchDiag] adv_mean=-0.0451, adv_std=0.3658, adv_abs_mean=0.2417 | ret_mean=8.9176, ret_std=0.6109 | val_mean=8.9627, val_std=0.4758 | explained_var=0.641552
[GradSplit pre-clip] backbone=0.666877, critic=0.224295
[Loss] pg_loss=-0.022066, entropy_loss=0.000020, value_loss=0.013623
[EpochKL] epoch=0 mean_kl=0.00420 max_kl=0.00742
[EpochKL] epoch=1 mean_kl=0.00836 max_kl=0.01334
[EpochKL] epoch=2 mean_kl=0.00837 max_kl=0.01553
[Time] Env Create Time: 4.4188s |Rollout Collect Time: 1.7043s |Loss & Update :0.9588
[PPODiag] kl_mean=0.0070, kl_p90=0.0107, kl_max=0.0155 | clipfrac_mean=0.020, logratio_std_mean=0.133, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.694, p10=0.687, min=0.686 | pg_loss_mean=0.0025, v_loss_mean=0.0330, ent_mean=0.0239 | gn_bb_mean=0.951, gn_bb_max=2.231 | gn_v_mean=0.372, gn_v_max=0.759

  3%|▎         | 168/5000 [21:42<9:39:30,  7.20s/it]------------------ Training Record ------------------
Epoch: 168/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1001, reward_valid_std=4.1803
[BatchDiag] adv_mean=0.0237, adv_std=0.3448, adv_abs_mean=0.2351 | ret_mean=8.9416, ret_std=0.6001 | val_mean=8.9180, val_std=0.5132 | explained_var=0.669922
[GradSplit pre-clip] backbone=0.506759, critic=0.421595
[Loss] pg_loss=-0.056145, entropy_loss=0.000021, value_loss=0.012318
[EpochKL] epoch=0 mean_kl=0.00342 max_kl=0.00614
[EarlyStop] epoch=1 mean_kl=0.01408 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01408 max_kl=0.02853
[Time] Env Create Time: 4.4241s |Rollout Collect Time: 1.6881s |Loss & Update :0.6600
[PPODiag] kl_mean=0.0087, kl_p90=0.0202, kl_max=0.0285 | clipfrac_mean=0.017, logratio_std_mean=0.159, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.680 | pg_loss_mean=0.0023, v_loss_mean=0.0285, ent_mean=0.0208 | gn_bb_mean=0.833, gn_bb_max=1.696 | gn_v_mean=0.249, gn_v_max=0.599

  3%|▎         | 169/5000 [21:49<9:29:10,  7.07s/it]------------------ Training Record ------------------
Epoch: 169/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0935, reward_valid_std=4.1737
[BatchDiag] adv_mean=0.0232, adv_std=0.3459, adv_abs_mean=0.2413 | ret_mean=8.9299, ret_std=0.5976 | val_mean=8.9067, val_std=0.4860 | explained_var=0.665035
[GradSplit pre-clip] backbone=0.675956, critic=0.380884
[Loss] pg_loss=-0.019816, entropy_loss=0.000017, value_loss=0.013635
[EpochKL] epoch=0 mean_kl=0.00440 max_kl=0.01062
[EpochKL] epoch=1 mean_kl=0.00982 max_kl=0.01906
[EarlyStop] epoch=2 mean_kl=0.01986 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01986 max_kl=0.04006
[Time] Env Create Time: 4.3862s |Rollout Collect Time: 1.9127s |Loss & Update :1.0874
[PPODiag] kl_mean=0.0114, kl_p90=0.0242, kl_max=0.0401 | clipfrac_mean=0.023, logratio_std_mean=0.162, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.592, p10=0.588, min=0.584 | pg_loss_mean=0.0048, v_loss_mean=0.0296, ent_mean=0.0192 | gn_bb_mean=1.084, gn_bb_max=1.852 | gn_v_mean=0.282, gn_v_max=0.853

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.986, Step: 8, Avg Done Step: 6.66, #CS visited: 0.11
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.9372s
-----------------------------
  3%|▎         | 170/5000 [21:58<10:24:40,  7.76s/it]------------------ Training Record ------------------
Epoch: 170/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0951, reward_valid_std=4.1727
[BatchDiag] adv_mean=-0.0470, adv_std=0.3437, adv_abs_mean=0.2346 | ret_mean=8.9461, ret_std=0.5862 | val_mean=8.9931, val_std=0.4617 | explained_var=0.656203
[GradSplit pre-clip] backbone=0.438039, critic=0.399621
[Loss] pg_loss=0.017739, entropy_loss=0.000022, value_loss=0.012953
[EpochKL] epoch=0 mean_kl=0.00282 max_kl=0.00544
[EpochKL] epoch=1 mean_kl=0.00994 max_kl=0.01513
[EarlyStop] epoch=2 mean_kl=0.01818 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01818 max_kl=0.04569
[Time] Env Create Time: 4.3708s |Rollout Collect Time: 1.8696s |Loss & Update :0.9675
[PPODiag] kl_mean=0.0103, kl_p90=0.0186, kl_max=0.0457 | clipfrac_mean=0.022, logratio_std_mean=0.157, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.691, p10=0.685, min=0.683 | pg_loss_mean=0.0034, v_loss_mean=0.0292, ent_mean=0.0235 | gn_bb_mean=1.178, gn_bb_max=5.277 | gn_v_mean=0.345, gn_v_max=0.916
[AttnScore] scale=1.0321, C=10.0

  3%|▎         | 171/5000 [22:05<10:11:14,  7.59s/it]------------------ Training Record ------------------
Epoch: 171/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1112, reward_valid_std=4.1813
[BatchDiag] adv_mean=0.0365, adv_std=0.3376, adv_abs_mean=0.2401 | ret_mean=8.9468, ret_std=0.5837 | val_mean=8.9103, val_std=0.4811 | explained_var=0.665487
[GradSplit pre-clip] backbone=0.687962, critic=0.645255
[Loss] pg_loss=-0.097505, entropy_loss=0.000020, value_loss=0.010281
[EpochKL] epoch=0 mean_kl=0.00207 max_kl=0.00595
[EpochKL] epoch=1 mean_kl=0.00662 max_kl=0.01614
[EarlyStop] epoch=2 mean_kl=0.01195 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01195 max_kl=0.02832
[Time] Env Create Time: 4.3831s |Rollout Collect Time: 1.6814s |Loss & Update :0.9674
[PPODiag] kl_mean=0.0069, kl_p90=0.0140, kl_max=0.0283 | clipfrac_mean=0.018, logratio_std_mean=0.129, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.686, p10=0.682, min=0.679 | pg_loss_mean=0.0008, v_loss_mean=0.0269, ent_mean=0.0209 | gn_bb_mean=0.647, gn_bb_max=1.373 | gn_v_mean=0.238, gn_v_max=0.645

  3%|▎         | 172/5000 [22:12<9:57:32,  7.43s/it] ------------------ Training Record ------------------
Epoch: 172/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0880, reward_valid_std=4.1728
[BatchDiag] adv_mean=-0.0230, adv_std=0.3672, adv_abs_mean=0.2488 | ret_mean=8.9242, ret_std=0.6024 | val_mean=8.9473, val_std=0.4866 | explained_var=0.628456
[GradSplit pre-clip] backbone=0.669928, critic=0.166018
[Loss] pg_loss=-0.037481, entropy_loss=0.000021, value_loss=0.014106
[EpochKL] epoch=0 mean_kl=0.00292 max_kl=0.00916
[EarlyStop] epoch=1 mean_kl=0.03786 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03786 max_kl=0.08304
[Time] Env Create Time: 4.4045s |Rollout Collect Time: 1.6951s |Loss & Update :0.6613
[PPODiag] kl_mean=0.0204, kl_p90=0.0508, kl_max=0.0830 | clipfrac_mean=0.023, logratio_std_mean=0.207, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.691, p10=0.685, min=0.679 | pg_loss_mean=0.0053, v_loss_mean=0.0321, ent_mean=0.0218 | gn_bb_mean=0.939, gn_bb_max=1.998 | gn_v_mean=0.251, gn_v_max=0.541

  3%|▎         | 173/5000 [22:19<9:41:22,  7.23s/it]------------------ Training Record ------------------
Epoch: 173/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1009, reward_valid_std=4.1781
[BatchDiag] adv_mean=0.0175, adv_std=0.3472, adv_abs_mean=0.2373 | ret_mean=8.9370, ret_std=0.5960 | val_mean=8.9195, val_std=0.4836 | explained_var=0.660606
[GradSplit pre-clip] backbone=0.817657, critic=0.587216
[Loss] pg_loss=-0.131036, entropy_loss=0.000022, value_loss=0.009380
[EpochKL] epoch=0 mean_kl=0.00414 max_kl=0.00990
[EarlyStop] epoch=1 mean_kl=0.01484 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01484 max_kl=0.02521
[Time] Env Create Time: 4.3901s |Rollout Collect Time: 1.6904s |Loss & Update :0.6537
[PPODiag] kl_mean=0.0095, kl_p90=0.0215, kl_max=0.0252 | clipfrac_mean=0.021, logratio_std_mean=0.148, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.680 | pg_loss_mean=0.0029, v_loss_mean=0.0296, ent_mean=0.0219 | gn_bb_mean=0.919, gn_bb_max=1.743 | gn_v_mean=0.364, gn_v_max=0.626

  3%|▎         | 174/5000 [22:26<9:29:22,  7.08s/it]------------------ Training Record ------------------
Epoch: 174/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0876, reward_valid_std=4.1725
[BatchDiag] adv_mean=-0.0063, adv_std=0.3646, adv_abs_mean=0.2441 | ret_mean=8.9283, ret_std=0.6122 | val_mean=8.9345, val_std=0.4977 | explained_var=0.645287
[GradSplit pre-clip] backbone=0.610730, critic=0.158773
[Loss] pg_loss=0.041701, entropy_loss=0.000024, value_loss=0.016056
[EpochKL] epoch=0 mean_kl=0.00749 max_kl=0.02267
[EpochKL] epoch=1 mean_kl=0.00996 max_kl=0.01692
[EarlyStop] epoch=2 mean_kl=0.01247 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01247 max_kl=0.02051
[Time] Env Create Time: 4.3845s |Rollout Collect Time: 1.6823s |Loss & Update :0.9674
[PPODiag] kl_mean=0.0100, kl_p90=0.0168, kl_max=0.0227 | clipfrac_mean=0.026, logratio_std_mean=0.158, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.692, p10=0.686, min=0.683 | pg_loss_mean=0.0031, v_loss_mean=0.0308, ent_mean=0.0231 | gn_bb_mean=0.848, gn_bb_max=1.802 | gn_v_mean=0.259, gn_v_max=0.637

  4%|▎         | 175/5000 [22:33<9:28:11,  7.07s/it]------------------ Training Record ------------------
Epoch: 175/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0951, reward_valid_std=4.1749
[BatchDiag] adv_mean=0.0514, adv_std=0.3463, adv_abs_mean=0.2466 | ret_mean=8.9362, ret_std=0.6001 | val_mean=8.8847, val_std=0.5025 | explained_var=0.667019
[GradSplit pre-clip] backbone=0.661133, critic=0.578889
[Loss] pg_loss=-0.018958, entropy_loss=0.000023, value_loss=0.012733
[EpochKL] epoch=0 mean_kl=0.00473 max_kl=0.01187
[EarlyStop] epoch=1 mean_kl=0.02065 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02065 max_kl=0.05199
[Time] Env Create Time: 4.3829s |Rollout Collect Time: 1.9258s |Loss & Update :0.7367
[PPODiag] kl_mean=0.0127, kl_p90=0.0258, kl_max=0.0520 | clipfrac_mean=0.024, logratio_std_mean=0.189, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.592, p10=0.585, min=0.582 | pg_loss_mean=0.0034, v_loss_mean=0.0295, ent_mean=0.0208 | gn_bb_mean=1.111, gn_bb_max=1.851 | gn_v_mean=0.466, gn_v_max=0.827
[AttnScore] scale=1.0326, C=10.0

  4%|▎         | 176/5000 [22:40<9:27:36,  7.06s/it]------------------ Training Record ------------------
Epoch: 176/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0859, reward_valid_std=4.1705
[BatchDiag] adv_mean=0.0555, adv_std=0.3705, adv_abs_mean=0.2662 | ret_mean=8.9223, ret_std=0.6094 | val_mean=8.8668, val_std=0.5098 | explained_var=0.630410
[GradSplit pre-clip] backbone=0.927531, critic=0.831260
[Loss] pg_loss=-0.095754, entropy_loss=0.000024, value_loss=0.012555
[EpochKL] epoch=0 mean_kl=0.00244 max_kl=0.00520
[EpochKL] epoch=1 mean_kl=0.00944 max_kl=0.02046
[EarlyStop] epoch=2 mean_kl=0.01045 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01045 max_kl=0.02092
[Time] Env Create Time: 4.5826s |Rollout Collect Time: 1.6866s |Loss & Update :0.9651
[PPODiag] kl_mean=0.0074, kl_p90=0.0157, kl_max=0.0209 | clipfrac_mean=0.021, logratio_std_mean=0.138, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.693, p10=0.687, min=0.686 | pg_loss_mean=0.0015, v_loss_mean=0.0326, ent_mean=0.0223 | gn_bb_mean=0.848, gn_bb_max=1.800 | gn_v_mean=0.343, gn_v_max=0.831

  4%|▎         | 177/5000 [22:47<9:31:42,  7.11s/it]------------------ Training Record ------------------
Epoch: 177/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1050, reward_valid_std=4.1841
[BatchDiag] adv_mean=0.0062, adv_std=0.3233, adv_abs_mean=0.2230 | ret_mean=8.9531, ret_std=0.5809 | val_mean=8.9470, val_std=0.4946 | explained_var=0.690327
[GradSplit pre-clip] backbone=0.809172, critic=0.281774
[Loss] pg_loss=-0.054766, entropy_loss=0.000021, value_loss=0.010315
[EpochKL] epoch=0 mean_kl=0.00621 max_kl=0.02490
[EarlyStop] epoch=1 mean_kl=0.01734 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01734 max_kl=0.02607
[Time] Env Create Time: 4.3977s |Rollout Collect Time: 1.6953s |Loss & Update :0.6607
[PPODiag] kl_mean=0.0118, kl_p90=0.0248, kl_max=0.0261 | clipfrac_mean=0.022, logratio_std_mean=0.173, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.679 | pg_loss_mean=0.0036, v_loss_mean=0.0258, ent_mean=0.0205 | gn_bb_mean=1.056, gn_bb_max=2.575 | gn_v_mean=0.269, gn_v_max=0.669

  4%|▎         | 178/5000 [22:54<9:22:57,  7.00s/it]------------------ Training Record ------------------
Epoch: 178/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1061, reward_valid_std=4.1780
[BatchDiag] adv_mean=0.0043, adv_std=0.3392, adv_abs_mean=0.2288 | ret_mean=8.9446, ret_std=0.5927 | val_mean=8.9403, val_std=0.5141 | explained_var=0.672588
[GradSplit pre-clip] backbone=1.254313, critic=0.265528
[Loss] pg_loss=-0.006676, entropy_loss=0.000019, value_loss=0.012159
[EpochKL] epoch=0 mean_kl=0.00680 max_kl=0.01446
[EarlyStop] epoch=1 mean_kl=0.01174 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01174 max_kl=0.02085
[Time] Env Create Time: 4.3888s |Rollout Collect Time: 1.6825s |Loss & Update :0.6530
[PPODiag] kl_mean=0.0093, kl_p90=0.0153, kl_max=0.0209 | clipfrac_mean=0.020, logratio_std_mean=0.147, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.680 | pg_loss_mean=0.0034, v_loss_mean=0.0276, ent_mean=0.0194 | gn_bb_mean=1.102, gn_bb_max=2.815 | gn_v_mean=0.246, gn_v_max=0.489

  4%|▎         | 179/5000 [23:00<9:16:05,  6.92s/it]------------------ Training Record ------------------
Epoch: 179/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0972, reward_valid_std=4.1756
[BatchDiag] adv_mean=-0.0122, adv_std=0.3585, adv_abs_mean=0.2371 | ret_mean=8.9244, ret_std=0.6020 | val_mean=8.9366, val_std=0.5031 | explained_var=0.645378
[GradSplit pre-clip] backbone=0.460735, critic=0.220056
[Loss] pg_loss=-0.058920, entropy_loss=0.000018, value_loss=0.011516
[EpochKL] epoch=0 mean_kl=0.00364 max_kl=0.00859
[EpochKL] epoch=1 mean_kl=0.00724 max_kl=0.01395
[EarlyStop] epoch=2 mean_kl=0.01240 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01240 max_kl=0.01979
[Time] Env Create Time: 4.3938s |Rollout Collect Time: 1.7023s |Loss & Update :0.9608
[PPODiag] kl_mean=0.0078, kl_p90=0.0140, kl_max=0.0198 | clipfrac_mean=0.019, logratio_std_mean=0.135, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.680 | pg_loss_mean=0.0020, v_loss_mean=0.0302, ent_mean=0.0202 | gn_bb_mean=0.833, gn_bb_max=1.411 | gn_v_mean=0.295, gn_v_max=0.535

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.008, Step: 8, Avg Done Step: 6.59, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.9384s
-----------------------------
  4%|▎         | 180/5000 [23:10<10:06:43,  7.55s/it]------------------ Training Record ------------------
Epoch: 180/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1070, reward_valid_std=4.1836
[BatchDiag] adv_mean=0.0090, adv_std=0.3377, adv_abs_mean=0.2310 | ret_mean=8.9398, ret_std=0.5946 | val_mean=8.9307, val_std=0.4778 | explained_var=0.677356
[GradSplit pre-clip] backbone=0.726899, critic=0.238367
[Loss] pg_loss=-0.020355, entropy_loss=0.000017, value_loss=0.010506
[EpochKL] epoch=0 mean_kl=0.00466 max_kl=0.01615
[EpochKL] epoch=1 mean_kl=0.00866 max_kl=0.01428
[EarlyStop] epoch=2 mean_kl=0.01229 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01229 max_kl=0.02270
[Time] Env Create Time: 4.3865s |Rollout Collect Time: 1.9227s |Loss & Update :1.0786
[PPODiag] kl_mean=0.0085, kl_p90=0.0156, kl_max=0.0227 | clipfrac_mean=0.018, logratio_std_mean=0.149, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.589, p10=0.584, min=0.581 | pg_loss_mean=0.0033, v_loss_mean=0.0283, ent_mean=0.0171 | gn_bb_mean=0.951, gn_bb_max=2.313 | gn_v_mean=0.243, gn_v_max=0.522
[AttnScore] scale=1.0332, C=10.0

  4%|▎         | 181/5000 [23:17<10:02:38,  7.50s/it]------------------ Training Record ------------------
Epoch: 181/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1098, reward_valid_std=4.1801
[BatchDiag] adv_mean=-0.0008, adv_std=0.3367, adv_abs_mean=0.2293 | ret_mean=8.9361, ret_std=0.5894 | val_mean=8.9370, val_std=0.4936 | explained_var=0.673666
[GradSplit pre-clip] backbone=0.965503, critic=0.216302
[Loss] pg_loss=-0.044130, entropy_loss=0.000020, value_loss=0.011705
[EpochKL] epoch=0 mean_kl=0.00565 max_kl=0.01518
[EarlyStop] epoch=1 mean_kl=0.01007 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01007 max_kl=0.02788
[Time] Env Create Time: 4.3735s |Rollout Collect Time: 1.6871s |Loss & Update :0.6504
[PPODiag] kl_mean=0.0079, kl_p90=0.0144, kl_max=0.0279 | clipfrac_mean=0.017, logratio_std_mean=0.133, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.681 | pg_loss_mean=0.0043, v_loss_mean=0.0277, ent_mean=0.0196 | gn_bb_mean=1.885, gn_bb_max=17.627 | gn_v_mean=0.318, gn_v_max=0.862

  4%|▎         | 182/5000 [23:24<9:43:26,  7.27s/it] ------------------ Training Record ------------------
Epoch: 182/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1050, reward_valid_std=4.1808
[BatchDiag] adv_mean=0.0452, adv_std=0.3383, adv_abs_mean=0.2379 | ret_mean=8.9376, ret_std=0.5957 | val_mean=8.8924, val_std=0.5100 | explained_var=0.677610
[GradSplit pre-clip] backbone=0.544432, critic=0.691558
[Loss] pg_loss=-0.083677, entropy_loss=0.000023, value_loss=0.011040
[EpochKL] epoch=0 mean_kl=0.00255 max_kl=0.00701
[EpochKL] epoch=1 mean_kl=0.00520 max_kl=0.00798
[EarlyStop] epoch=2 mean_kl=0.01871 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01871 max_kl=0.03197
[Time] Env Create Time: 4.5768s |Rollout Collect Time: 1.6927s |Loss & Update :0.9677
[PPODiag] kl_mean=0.0088, kl_p90=0.0227, kl_max=0.0320 | clipfrac_mean=0.021, logratio_std_mean=0.147, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.681 | pg_loss_mean=0.0024, v_loss_mean=0.0279, ent_mean=0.0227 | gn_bb_mean=0.932, gn_bb_max=2.245 | gn_v_mean=0.334, gn_v_max=0.801

  4%|▎         | 183/5000 [23:31<9:42:38,  7.26s/it]------------------ Training Record ------------------
Epoch: 183/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.594, reward_valid_mean=2.0895, reward_valid_std=4.1684
[BatchDiag] adv_mean=-0.0232, adv_std=0.3654, adv_abs_mean=0.2521 | ret_mean=8.9338, ret_std=0.5971 | val_mean=8.9570, val_std=0.4740 | explained_var=0.625467
[GradSplit pre-clip] backbone=1.210646, critic=0.206803
[Loss] pg_loss=-0.056573, entropy_loss=0.000025, value_loss=0.012045
[EpochKL] epoch=0 mean_kl=0.00995 max_kl=0.02165
[EarlyStop] epoch=1 mean_kl=0.03853 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03853 max_kl=0.06937
[Time] Env Create Time: 4.4043s |Rollout Collect Time: 1.9282s |Loss & Update :0.7321
[PPODiag] kl_mean=0.0242, kl_p90=0.0517, kl_max=0.0694 | clipfrac_mean=0.033, logratio_std_mean=0.289, ratio_p95_mean=1.022 | valid_ratio_mb_mean=0.594, p10=0.589, min=0.588 | pg_loss_mean=0.0067, v_loss_mean=0.0323, ent_mean=0.0207 | gn_bb_mean=1.921, gn_bb_max=7.073 | gn_v_mean=0.325, gn_v_max=0.585

  4%|▎         | 184/5000 [23:38<9:37:53,  7.20s/it]------------------ Training Record ------------------
Epoch: 184/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0909, reward_valid_std=4.1766
[BatchDiag] adv_mean=-0.0288, adv_std=0.3609, adv_abs_mean=0.2447 | ret_mean=8.9268, ret_std=0.5993 | val_mean=8.9556, val_std=0.4639 | explained_var=0.637471
[GradSplit pre-clip] backbone=0.969678, critic=0.183158
[Loss] pg_loss=-0.027273, entropy_loss=0.000020, value_loss=0.012219
[EpochKL] epoch=0 mean_kl=0.00472 max_kl=0.01425
[EarlyStop] epoch=1 mean_kl=0.01020 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01020 max_kl=0.02040
[Time] Env Create Time: 4.3810s |Rollout Collect Time: 1.6812s |Loss & Update :0.6612
[PPODiag] kl_mean=0.0075, kl_p90=0.0159, kl_max=0.0204 | clipfrac_mean=0.022, logratio_std_mean=0.125, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.691, p10=0.687, min=0.686 | pg_loss_mean=0.0035, v_loss_mean=0.0310, ent_mean=0.0244 | gn_bb_mean=1.031, gn_bb_max=1.742 | gn_v_mean=0.336, gn_v_max=0.641

  4%|▎         | 185/5000 [23:45<9:26:19,  7.06s/it]------------------ Training Record ------------------
Epoch: 185/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1090, reward_valid_std=4.1805
[BatchDiag] adv_mean=-0.0018, adv_std=0.3401, adv_abs_mean=0.2252 | ret_mean=8.9506, ret_std=0.5939 | val_mean=8.9525, val_std=0.4904 | explained_var=0.672085
[GradSplit pre-clip] backbone=0.911834, critic=0.195306
[Loss] pg_loss=-0.035154, entropy_loss=0.000022, value_loss=0.011573
[EpochKL] epoch=0 mean_kl=0.00262 max_kl=0.00842
[EarlyStop] epoch=1 mean_kl=0.01704 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01704 max_kl=0.02984
[Time] Env Create Time: 4.4040s |Rollout Collect Time: 1.6989s |Loss & Update :0.6707
[PPODiag] kl_mean=0.0098, kl_p90=0.0222, kl_max=0.0298 | clipfrac_mean=0.018, logratio_std_mean=0.158, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.679 | pg_loss_mean=0.0021, v_loss_mean=0.0275, ent_mean=0.0212 | gn_bb_mean=0.856, gn_bb_max=1.477 | gn_v_mean=0.233, gn_v_max=0.382
[AttnScore] scale=1.0336, C=10.0

  4%|▎         | 186/5000 [23:51<9:19:23,  6.97s/it]------------------ Training Record ------------------
Epoch: 186/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1033, reward_valid_std=4.1802
[BatchDiag] adv_mean=-0.0183, adv_std=0.3445, adv_abs_mean=0.2331 | ret_mean=8.9478, ret_std=0.5985 | val_mean=8.9660, val_std=0.4788 | explained_var=0.668777
[GradSplit pre-clip] backbone=1.151606, critic=0.195798
[Loss] pg_loss=-0.061868, entropy_loss=0.000019, value_loss=0.010239
[EpochKL] epoch=0 mean_kl=0.00230 max_kl=0.00454
[EpochKL] epoch=1 mean_kl=0.00552 max_kl=0.00954
[EarlyStop] epoch=2 mean_kl=0.02098 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02098 max_kl=0.04855
[Time] Env Create Time: 4.3889s |Rollout Collect Time: 1.6842s |Loss & Update :0.9593
[PPODiag] kl_mean=0.0096, kl_p90=0.0251, kl_max=0.0486 | clipfrac_mean=0.019, logratio_std_mean=0.144, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.679 | pg_loss_mean=0.0031, v_loss_mean=0.0274, ent_mean=0.0212 | gn_bb_mean=0.969, gn_bb_max=2.076 | gn_v_mean=0.205, gn_v_max=0.568

  4%|▎         | 187/5000 [23:58<9:20:44,  6.99s/it]------------------ Training Record ------------------
Epoch: 187/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.595, reward_valid_mean=2.0831, reward_valid_std=4.1663
[BatchDiag] adv_mean=-0.0310, adv_std=0.3675, adv_abs_mean=0.2441 | ret_mean=8.9364, ret_std=0.6112 | val_mean=8.9674, val_std=0.4815 | explained_var=0.638545
[GradSplit pre-clip] backbone=1.425693, critic=0.127746
[Loss] pg_loss=-0.059750, entropy_loss=0.000020, value_loss=0.010988
[EpochKL] epoch=0 mean_kl=0.00900 max_kl=0.02257
[EarlyStop] epoch=1 mean_kl=0.04175 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.04175 max_kl=0.05928
[Time] Env Create Time: 4.3882s |Rollout Collect Time: 1.9271s |Loss & Update :0.7309
[PPODiag] kl_mean=0.0254, kl_p90=0.0536, kl_max=0.0593 | clipfrac_mean=0.037, logratio_std_mean=0.279, ratio_p95_mean=1.013 | valid_ratio_mb_mean=0.595, p10=0.591, min=0.590 | pg_loss_mean=0.0091, v_loss_mean=0.0337, ent_mean=0.0239 | gn_bb_mean=1.453, gn_bb_max=2.507 | gn_v_mean=0.281, gn_v_max=0.669

  4%|▍         | 188/5000 [24:05<9:21:58,  7.01s/it]------------------ Training Record ------------------
Epoch: 188/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.696, reward_valid_mean=2.0790, reward_valid_std=4.1630
[BatchDiag] adv_mean=-0.0104, adv_std=0.3883, adv_abs_mean=0.2685 | ret_mean=8.9322, ret_std=0.6141 | val_mean=8.9426, val_std=0.4855 | explained_var=0.600282
[GradSplit pre-clip] backbone=0.876862, critic=0.182753
[Loss] pg_loss=-0.013799, entropy_loss=0.000026, value_loss=0.016324
[EpochKL] epoch=0 mean_kl=0.00986 max_kl=0.02092
[EarlyStop] epoch=1 mean_kl=0.01627 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01627 max_kl=0.02737
[Time] Env Create Time: 4.5848s |Rollout Collect Time: 1.6865s |Loss & Update :0.6577
[PPODiag] kl_mean=0.0131, kl_p90=0.0242, kl_max=0.0274 | clipfrac_mean=0.025, logratio_std_mean=0.200, ratio_p95_mean=1.014 | valid_ratio_mb_mean=0.696, p10=0.691, min=0.687 | pg_loss_mean=0.0016, v_loss_mean=0.0352, ent_mean=0.0258 | gn_bb_mean=0.834, gn_bb_max=1.371 | gn_v_mean=0.299, gn_v_max=0.888

  4%|▍         | 189/5000 [24:12<9:19:59,  6.98s/it]------------------ Training Record ------------------
Epoch: 189/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.595, reward_valid_mean=2.0867, reward_valid_std=4.1665
[BatchDiag] adv_mean=0.0530, adv_std=0.3571, adv_abs_mean=0.2590 | ret_mean=8.9376, ret_std=0.5866 | val_mean=8.8846, val_std=0.4850 | explained_var=0.629541
[GradSplit pre-clip] backbone=0.668542, critic=0.601895
[Loss] pg_loss=-0.031967, entropy_loss=0.000020, value_loss=0.012378
[EpochKL] epoch=0 mean_kl=0.00654 max_kl=0.01988
[EarlyStop] epoch=1 mean_kl=0.01237 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01237 max_kl=0.02465
[Time] Env Create Time: 4.4101s |Rollout Collect Time: 1.9286s |Loss & Update :0.7396
[PPODiag] kl_mean=0.0095, kl_p90=0.0188, kl_max=0.0246 | clipfrac_mean=0.023, logratio_std_mean=0.145, ratio_p95_mean=1.010 | valid_ratio_mb_mean=0.595, p10=0.590, min=0.587 | pg_loss_mean=0.0042, v_loss_mean=0.0308, ent_mean=0.0220 | gn_bb_mean=1.346, gn_bb_max=3.096 | gn_v_mean=0.354, gn_v_max=0.602

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.002, Step: 8, Avg Done Step: 6.63, #CS visited: 0.12
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.9589s
-----------------------------
  4%|▍         | 190/5000 [24:21<10:09:53,  7.61s/it]------------------ Training Record ------------------
Epoch: 190/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0920, reward_valid_std=4.1745
[BatchDiag] adv_mean=0.0041, adv_std=0.3390, adv_abs_mean=0.2303 | ret_mean=8.9397, ret_std=0.5902 | val_mean=8.9356, val_std=0.4703 | explained_var=0.669970
[GradSplit pre-clip] backbone=1.303796, critic=0.301753
[Loss] pg_loss=-0.073307, entropy_loss=0.000020, value_loss=0.009678
[EpochKL] epoch=0 mean_kl=0.00621 max_kl=0.01392
[EarlyStop] epoch=1 mean_kl=0.01239 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01239 max_kl=0.01915
[Time] Env Create Time: 4.3746s |Rollout Collect Time: 1.6863s |Loss & Update :0.6696
[PPODiag] kl_mean=0.0093, kl_p90=0.0141, kl_max=0.0192 | clipfrac_mean=0.023, logratio_std_mean=0.142, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.683 | pg_loss_mean=0.0047, v_loss_mean=0.0277, ent_mean=0.0239 | gn_bb_mean=1.443, gn_bb_max=9.069 | gn_v_mean=0.221, gn_v_max=0.444
[AttnScore] scale=1.0340, C=10.0

  4%|▍         | 191/5000 [24:28<9:48:40,  7.34s/it] ------------------ Training Record ------------------
Epoch: 191/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0929, reward_valid_std=4.1733
[BatchDiag] adv_mean=-0.0124, adv_std=0.3511, adv_abs_mean=0.2352 | ret_mean=8.9290, ret_std=0.5975 | val_mean=8.9413, val_std=0.4710 | explained_var=0.654784
[GradSplit pre-clip] backbone=0.741407, critic=0.326935
[Loss] pg_loss=-0.135208, entropy_loss=0.000016, value_loss=0.009382
[EpochKL] epoch=0 mean_kl=0.00422 max_kl=0.00783
[EpochKL] epoch=1 mean_kl=0.00786 max_kl=0.01519
[EarlyStop] epoch=2 mean_kl=0.02470 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02470 max_kl=0.03955
[Time] Env Create Time: 4.3999s |Rollout Collect Time: 1.9269s |Loss & Update :1.0668
[PPODiag] kl_mean=0.0123, kl_p90=0.0266, kl_max=0.0396 | clipfrac_mean=0.021, logratio_std_mean=0.194, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.592, p10=0.586, min=0.585 | pg_loss_mean=0.0018, v_loss_mean=0.0291, ent_mean=0.0169 | gn_bb_mean=0.791, gn_bb_max=1.334 | gn_v_mean=0.219, gn_v_max=0.548

  4%|▍         | 192/5000 [24:36<9:49:44,  7.36s/it]------------------ Training Record ------------------
Epoch: 192/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0896, reward_valid_std=4.1735
[BatchDiag] adv_mean=-0.0287, adv_std=0.3666, adv_abs_mean=0.2478 | ret_mean=8.9285, ret_std=0.6078 | val_mean=8.9572, val_std=0.4557 | explained_var=0.636249
[GradSplit pre-clip] backbone=0.600846, critic=0.265544
[Loss] pg_loss=-0.059362, entropy_loss=0.000021, value_loss=0.012507
[EpochKL] epoch=0 mean_kl=0.00398 max_kl=0.00811
[EpochKL] epoch=1 mean_kl=0.00891 max_kl=0.01559
[EpochKL] epoch=2 mean_kl=0.00703 max_kl=0.01006
[Time] Env Create Time: 4.3840s |Rollout Collect Time: 1.6838s |Loss & Update :0.9676
[PPODiag] kl_mean=0.0066, kl_p90=0.0092, kl_max=0.0156 | clipfrac_mean=0.019, logratio_std_mean=0.132, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.691, p10=0.684, min=0.681 | pg_loss_mean=0.0015, v_loss_mean=0.0307, ent_mean=0.0204 | gn_bb_mean=0.736, gn_bb_max=1.432 | gn_v_mean=0.266, gn_v_max=0.493

  4%|▍         | 193/5000 [24:43<9:41:50,  7.26s/it]------------------ Training Record ------------------
Epoch: 193/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0951, reward_valid_std=4.1748
[BatchDiag] adv_mean=-0.0096, adv_std=0.3353, adv_abs_mean=0.2229 | ret_mean=8.9299, ret_std=0.5936 | val_mean=8.9395, val_std=0.4901 | explained_var=0.681040
[GradSplit pre-clip] backbone=0.921696, critic=0.126057
[Loss] pg_loss=-0.006803, entropy_loss=0.000020, value_loss=0.011254
[EpochKL] epoch=0 mean_kl=0.00313 max_kl=0.00624
[EpochKL] epoch=1 mean_kl=0.00935 max_kl=0.01698
[EarlyStop] epoch=2 mean_kl=0.01783 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01783 max_kl=0.02558
[Time] Env Create Time: 4.5973s |Rollout Collect Time: 1.6879s |Loss & Update :0.9650
[PPODiag] kl_mean=0.0101, kl_p90=0.0223, kl_max=0.0256 | clipfrac_mean=0.021, logratio_std_mean=0.167, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.681 | pg_loss_mean=0.0030, v_loss_mean=0.0271, ent_mean=0.0204 | gn_bb_mean=0.975, gn_bb_max=1.802 | gn_v_mean=0.223, gn_v_max=0.566

  4%|▍         | 194/5000 [24:50<9:41:26,  7.26s/it]------------------ Training Record ------------------
Epoch: 194/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1026, reward_valid_std=4.1760
[BatchDiag] adv_mean=-0.0275, adv_std=0.3369, adv_abs_mean=0.2230 | ret_mean=8.9408, ret_std=0.5906 | val_mean=8.9683, val_std=0.4553 | explained_var=0.674577
[GradSplit pre-clip] backbone=0.833762, critic=0.134345
[Loss] pg_loss=-0.082003, entropy_loss=0.000024, value_loss=0.010558
[EarlyStop] epoch=0 mean_kl=0.01105 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01105 max_kl=0.02231
[Time] Env Create Time: 4.4162s |Rollout Collect Time: 1.6876s |Loss & Update :0.3585
[PPODiag] kl_mean=0.0110, kl_p90=0.0197, kl_max=0.0223 | clipfrac_mean=0.022, logratio_std_mean=0.168, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.681 | pg_loss_mean=0.0049, v_loss_mean=0.0273, ent_mean=0.0228 | gn_bb_mean=1.076, gn_bb_max=3.416 | gn_v_mean=0.181, gn_v_max=0.367

  4%|▍         | 195/5000 [24:56<9:22:11,  7.02s/it]------------------ Training Record ------------------
Epoch: 195/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0944, reward_valid_std=4.1756
[BatchDiag] adv_mean=-0.0050, adv_std=0.3388, adv_abs_mean=0.2249 | ret_mean=8.9314, ret_std=0.5949 | val_mean=8.9364, val_std=0.5028 | explained_var=0.675659
[GradSplit pre-clip] backbone=0.364334, critic=0.401037
[Loss] pg_loss=-0.142465, entropy_loss=0.000016, value_loss=0.008111
[EpochKL] epoch=0 mean_kl=0.00291 max_kl=0.00628
[EarlyStop] epoch=1 mean_kl=0.01073 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01073 max_kl=0.02668
[Time] Env Create Time: 4.4015s |Rollout Collect Time: 1.6944s |Loss & Update :0.6542
[PPODiag] kl_mean=0.0068, kl_p90=0.0122, kl_max=0.0267 | clipfrac_mean=0.017, logratio_std_mean=0.123, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.690, p10=0.683, min=0.681 | pg_loss_mean=0.0031, v_loss_mean=0.0272, ent_mean=0.0193 | gn_bb_mean=1.021, gn_bb_max=2.263 | gn_v_mean=0.194, gn_v_max=0.401
[AttnScore] scale=1.0347, C=10.0

  4%|▍         | 196/5000 [25:03<9:15:35,  6.94s/it]------------------ Training Record ------------------
Epoch: 196/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1048, reward_valid_std=4.1829
[BatchDiag] adv_mean=0.0045, adv_std=0.3203, adv_abs_mean=0.2181 | ret_mean=8.9478, ret_std=0.5888 | val_mean=8.9433, val_std=0.4746 | explained_var=0.704128
[GradSplit pre-clip] backbone=0.697436, critic=0.406554
[Loss] pg_loss=-0.123867, entropy_loss=0.000019, value_loss=0.008351
[EpochKL] epoch=0 mean_kl=0.00880 max_kl=0.01561
[EarlyStop] epoch=1 mean_kl=0.01247 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01247 max_kl=0.03531
[Time] Env Create Time: 4.3839s |Rollout Collect Time: 1.6933s |Loss & Update :0.6687
[PPODiag] kl_mean=0.0106, kl_p90=0.0158, kl_max=0.0353 | clipfrac_mean=0.023, logratio_std_mean=0.162, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.680 | pg_loss_mean=0.0039, v_loss_mean=0.0251, ent_mean=0.0206 | gn_bb_mean=0.960, gn_bb_max=1.541 | gn_v_mean=0.188, gn_v_max=0.407

  4%|▍         | 197/5000 [25:10<9:10:50,  6.88s/it]------------------ Training Record ------------------
Epoch: 197/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0875, reward_valid_std=4.1735
[BatchDiag] adv_mean=-0.0168, adv_std=0.3545, adv_abs_mean=0.2350 | ret_mean=8.9271, ret_std=0.6105 | val_mean=8.9439, val_std=0.4824 | explained_var=0.662871
[GradSplit pre-clip] backbone=0.629505, critic=0.379060
[Loss] pg_loss=-0.150618, entropy_loss=0.000019, value_loss=0.009443
[EpochKL] epoch=0 mean_kl=0.00640 max_kl=0.01349
[EarlyStop] epoch=1 mean_kl=0.01302 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01302 max_kl=0.02269
[Time] Env Create Time: 4.3803s |Rollout Collect Time: 1.6833s |Loss & Update :0.6549
[PPODiag] kl_mean=0.0097, kl_p90=0.0186, kl_max=0.0227 | clipfrac_mean=0.020, logratio_std_mean=0.167, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.692, p10=0.683, min=0.681 | pg_loss_mean=0.0034, v_loss_mean=0.0306, ent_mean=0.0201 | gn_bb_mean=0.798, gn_bb_max=1.257 | gn_v_mean=0.320, gn_v_max=0.569

  4%|▍         | 198/5000 [25:17<9:06:50,  6.83s/it]------------------ Training Record ------------------
Epoch: 198/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0931, reward_valid_std=4.1737
[BatchDiag] adv_mean=-0.0249, adv_std=0.3528, adv_abs_mean=0.2288 | ret_mean=8.9336, ret_std=0.6013 | val_mean=8.9586, val_std=0.4994 | explained_var=0.655794
[GradSplit pre-clip] backbone=0.362035, critic=0.294180
[Loss] pg_loss=0.053828, entropy_loss=0.000018, value_loss=0.015018
[EpochKL] epoch=0 mean_kl=0.00724 max_kl=0.01942
[EpochKL] epoch=1 mean_kl=0.00869 max_kl=0.01497
[EarlyStop] epoch=2 mean_kl=0.01720 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01720 max_kl=0.03611
[Time] Env Create Time: 4.3791s |Rollout Collect Time: 1.6961s |Loss & Update :0.9682
[PPODiag] kl_mean=0.0110, kl_p90=0.0218, kl_max=0.0361 | clipfrac_mean=0.021, logratio_std_mean=0.158, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.691, p10=0.684, min=0.681 | pg_loss_mean=0.0033, v_loss_mean=0.0300, ent_mean=0.0202 | gn_bb_mean=0.889, gn_bb_max=1.578 | gn_v_mean=0.286, gn_v_max=0.700

  4%|▍         | 199/5000 [25:24<9:11:47,  6.90s/it]------------------ Training Record ------------------
Epoch: 199/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0856, reward_valid_std=4.1690
[BatchDiag] adv_mean=-0.0429, adv_std=0.3471, adv_abs_mean=0.2275 | ret_mean=8.9342, ret_std=0.6021 | val_mean=8.9771, val_std=0.4948 | explained_var=0.667670
[GradSplit pre-clip] backbone=0.667337, critic=0.175815
[Loss] pg_loss=-0.048125, entropy_loss=0.000021, value_loss=0.011832
[EpochKL] epoch=0 mean_kl=0.00378 max_kl=0.01028
[EarlyStop] epoch=1 mean_kl=0.02501 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02501 max_kl=0.03393
[Time] Env Create Time: 4.3655s |Rollout Collect Time: 1.6886s |Loss & Update :0.6569
[PPODiag] kl_mean=0.0144, kl_p90=0.0303, kl_max=0.0339 | clipfrac_mean=0.023, logratio_std_mean=0.191, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.693, p10=0.686, min=0.679 | pg_loss_mean=0.0043, v_loss_mean=0.0298, ent_mean=0.0224 | gn_bb_mean=0.988, gn_bb_max=1.860 | gn_v_mean=0.226, gn_v_max=0.397

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.987, Step: 8, Avg Done Step: 6.63, #CS visited: 0.11
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.9338s
-----------------------------
  4%|▍         | 200/5000 [25:32<9:54:19,  7.43s/it]------------------ Training Record ------------------
Epoch: 200/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0852, reward_valid_std=4.1717
[BatchDiag] adv_mean=0.0025, adv_std=0.3611, adv_abs_mean=0.2516 | ret_mean=8.9334, ret_std=0.5980 | val_mean=8.9309, val_std=0.4843 | explained_var=0.635368
[GradSplit pre-clip] backbone=0.707384, critic=0.379084
[Loss] pg_loss=-0.074150, entropy_loss=0.000023, value_loss=0.012609
[EpochKL] epoch=0 mean_kl=0.00534 max_kl=0.01111
[EpochKL] epoch=1 mean_kl=0.00943 max_kl=0.01797
[EarlyStop] epoch=2 mean_kl=0.01538 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01538 max_kl=0.02653
[Time] Env Create Time: 4.5927s |Rollout Collect Time: 1.6879s |Loss & Update :0.9685
[PPODiag] kl_mean=0.0101, kl_p90=0.0193, kl_max=0.0265 | clipfrac_mean=0.021, logratio_std_mean=0.176, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.693, p10=0.688, min=0.685 | pg_loss_mean=0.0034, v_loss_mean=0.0301, ent_mean=0.0205 | gn_bb_mean=0.810, gn_bb_max=1.566 | gn_v_mean=0.266, gn_v_max=0.509
[AttnScore] scale=1.0351, C=10.0

  4%|▍         | 201/5000 [25:40<9:49:53,  7.38s/it]------------------ Training Record ------------------
Epoch: 201/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0950, reward_valid_std=4.1742
[BatchDiag] adv_mean=0.0139, adv_std=0.3463, adv_abs_mean=0.2404 | ret_mean=8.9485, ret_std=0.5932 | val_mean=8.9346, val_std=0.4939 | explained_var=0.659144
[GradSplit pre-clip] backbone=0.816663, critic=0.372201
[Loss] pg_loss=-0.028701, entropy_loss=0.000020, value_loss=0.014417
[EpochKL] epoch=0 mean_kl=0.00901 max_kl=0.02954
[EarlyStop] epoch=1 mean_kl=0.01445 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01445 max_kl=0.02236
[Time] Env Create Time: 4.4092s |Rollout Collect Time: 1.6809s |Loss & Update :0.6635
[PPODiag] kl_mean=0.0117, kl_p90=0.0220, kl_max=0.0295 | clipfrac_mean=0.023, logratio_std_mean=0.189, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.692, p10=0.687, min=0.683 | pg_loss_mean=0.0039, v_loss_mean=0.0290, ent_mean=0.0229 | gn_bb_mean=1.002, gn_bb_max=2.003 | gn_v_mean=0.432, gn_v_max=0.819

  4%|▍         | 202/5000 [25:46<9:34:52,  7.19s/it]------------------ Training Record ------------------
Epoch: 202/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0907, reward_valid_std=4.1718
[BatchDiag] adv_mean=0.0463, adv_std=0.3410, adv_abs_mean=0.2397 | ret_mean=8.9350, ret_std=0.5979 | val_mean=8.8888, val_std=0.5223 | explained_var=0.674620
[GradSplit pre-clip] backbone=0.529145, critic=0.440497
[Loss] pg_loss=0.042348, entropy_loss=0.000019, value_loss=0.015247
[EpochKL] epoch=0 mean_kl=0.00586 max_kl=0.01191
[EarlyStop] epoch=1 mean_kl=0.01874 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01874 max_kl=0.04689
[Time] Env Create Time: 4.3907s |Rollout Collect Time: 1.6881s |Loss & Update :0.6491
[PPODiag] kl_mean=0.0123, kl_p90=0.0251, kl_max=0.0469 | clipfrac_mean=0.022, logratio_std_mean=0.168, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.692, p10=0.687, min=0.684 | pg_loss_mean=0.0048, v_loss_mean=0.0285, ent_mean=0.0221 | gn_bb_mean=1.063, gn_bb_max=2.110 | gn_v_mean=0.334, gn_v_max=0.732

  4%|▍         | 203/5000 [25:53<9:23:42,  7.05s/it]------------------ Training Record ------------------
Epoch: 203/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0968, reward_valid_std=4.1757
[BatchDiag] adv_mean=0.0117, adv_std=0.3457, adv_abs_mean=0.2396 | ret_mean=8.9349, ret_std=0.5990 | val_mean=8.9232, val_std=0.4811 | explained_var=0.666862
[GradSplit pre-clip] backbone=1.128024, critic=0.445715
[Loss] pg_loss=-0.100032, entropy_loss=0.000017, value_loss=0.009113
[EpochKL] epoch=0 mean_kl=0.00751 max_kl=0.01812
[EarlyStop] epoch=1 mean_kl=0.02998 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02998 max_kl=0.05123
[Time] Env Create Time: 4.3894s |Rollout Collect Time: 1.6916s |Loss & Update :0.6645
[PPODiag] kl_mean=0.0187, kl_p90=0.0377, kl_max=0.0512 | clipfrac_mean=0.023, logratio_std_mean=0.251, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.683 | pg_loss_mean=0.0034, v_loss_mean=0.0289, ent_mean=0.0184 | gn_bb_mean=0.779, gn_bb_max=1.128 | gn_v_mean=0.251, gn_v_max=0.523

  4%|▍         | 204/5000 [26:00<9:16:16,  6.96s/it]------------------ Training Record ------------------
Epoch: 204/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1005, reward_valid_std=4.1831
[BatchDiag] adv_mean=0.0427, adv_std=0.3407, adv_abs_mean=0.2422 | ret_mean=8.9400, ret_std=0.5995 | val_mean=8.8973, val_std=0.4917 | explained_var=0.677014
[GradSplit pre-clip] backbone=0.617924, critic=0.415576
[Loss] pg_loss=0.009069, entropy_loss=0.000021, value_loss=0.010593
[EarlyStop] epoch=0 mean_kl=0.01057 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01057 max_kl=0.02044
[Time] Env Create Time: 4.3766s |Rollout Collect Time: 1.9221s |Loss & Update :0.3904
[PPODiag] kl_mean=0.0106, kl_p90=0.0197, kl_max=0.0204 | clipfrac_mean=0.021, logratio_std_mean=0.151, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.587, min=0.584 | pg_loss_mean=0.0055, v_loss_mean=0.0284, ent_mean=0.0185 | gn_bb_mean=1.227, gn_bb_max=2.260 | gn_v_mean=0.370, gn_v_max=0.543

  4%|▍         | 205/5000 [26:06<9:09:41,  6.88s/it]------------------ Training Record ------------------
Epoch: 205/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0990, reward_valid_std=4.1740
[BatchDiag] adv_mean=-0.0561, adv_std=0.3424, adv_abs_mean=0.2223 | ret_mean=8.9484, ret_std=0.5951 | val_mean=9.0045, val_std=0.4901 | explained_var=0.668980
[GradSplit pre-clip] backbone=0.705889, critic=0.383589
[Loss] pg_loss=-0.010729, entropy_loss=0.000019, value_loss=0.011637
[EarlyStop] epoch=0 mean_kl=0.01239 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01239 max_kl=0.03380
[Time] Env Create Time: 4.3600s |Rollout Collect Time: 1.9305s |Loss & Update :0.4022
[PPODiag] kl_mean=0.0124, kl_p90=0.0259, kl_max=0.0338 | clipfrac_mean=0.021, logratio_std_mean=0.182, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.592, p10=0.585, min=0.583 | pg_loss_mean=0.0040, v_loss_mean=0.0282, ent_mean=0.0178 | gn_bb_mean=0.799, gn_bb_max=1.341 | gn_v_mean=0.292, gn_v_max=0.532
[AttnScore] scale=1.0352, C=10.0

  4%|▍         | 206/5000 [26:13<9:05:08,  6.82s/it]------------------ Training Record ------------------
Epoch: 206/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0898, reward_valid_std=4.1751
[BatchDiag] adv_mean=0.0061, adv_std=0.3507, adv_abs_mean=0.2392 | ret_mean=8.9283, ret_std=0.6039 | val_mean=8.9222, val_std=0.4668 | explained_var=0.662785
[GradSplit pre-clip] backbone=0.485273, critic=0.369441
[Loss] pg_loss=-0.070083, entropy_loss=0.000019, value_loss=0.011254
[EarlyStop] epoch=0 mean_kl=0.01340 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01340 max_kl=0.02581
[Time] Env Create Time: 4.5786s |Rollout Collect Time: 1.7021s |Loss & Update :0.3572
[PPODiag] kl_mean=0.0134, kl_p90=0.0230, kl_max=0.0258 | clipfrac_mean=0.020, logratio_std_mean=0.181, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.692, p10=0.686, min=0.686 | pg_loss_mean=0.0027, v_loss_mean=0.0296, ent_mean=0.0214 | gn_bb_mean=1.051, gn_bb_max=3.178 | gn_v_mean=0.269, gn_v_max=0.451

  4%|▍         | 207/5000 [26:20<9:00:36,  6.77s/it]------------------ Training Record ------------------
Epoch: 207/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1097, reward_valid_std=4.1857
[BatchDiag] adv_mean=0.0002, adv_std=0.3252, adv_abs_mean=0.2162 | ret_mean=8.9487, ret_std=0.5877 | val_mean=8.9485, val_std=0.5048 | explained_var=0.693826
[GradSplit pre-clip] backbone=0.428743, critic=0.121699
[Loss] pg_loss=0.037042, entropy_loss=0.000013, value_loss=0.012096
[EpochKL] epoch=0 mean_kl=0.00328 max_kl=0.00950
[EpochKL] epoch=1 mean_kl=0.00889 max_kl=0.01783
[EarlyStop] epoch=2 mean_kl=0.01616 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01616 max_kl=0.02946
[Time] Env Create Time: 4.3988s |Rollout Collect Time: 1.9168s |Loss & Update :1.0741
[PPODiag] kl_mean=0.0094, kl_p90=0.0183, kl_max=0.0295 | clipfrac_mean=0.019, logratio_std_mean=0.155, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.589, p10=0.584, min=0.582 | pg_loss_mean=0.0032, v_loss_mean=0.0255, ent_mean=0.0161 | gn_bb_mean=0.916, gn_bb_max=2.261 | gn_v_mean=0.218, gn_v_max=0.382

  4%|▍         | 208/5000 [26:27<9:15:24,  6.95s/it]------------------ Training Record ------------------
Epoch: 208/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0976, reward_valid_std=4.1764
[BatchDiag] adv_mean=-0.0387, adv_std=0.3308, adv_abs_mean=0.2214 | ret_mean=8.9462, ret_std=0.5903 | val_mean=8.9849, val_std=0.4666 | explained_var=0.685903
[GradSplit pre-clip] backbone=0.693453, critic=0.199692
[Loss] pg_loss=-0.045017, entropy_loss=0.000020, value_loss=0.010752
[EpochKL] epoch=0 mean_kl=0.00417 max_kl=0.01055
[EarlyStop] epoch=1 mean_kl=0.01110 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01110 max_kl=0.01618
[Time] Env Create Time: 4.4021s |Rollout Collect Time: 1.6795s |Loss & Update :0.6640
[PPODiag] kl_mean=0.0076, kl_p90=0.0148, kl_max=0.0162 | clipfrac_mean=0.020, logratio_std_mean=0.129, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.683 | pg_loss_mean=0.0036, v_loss_mean=0.0269, ent_mean=0.0230 | gn_bb_mean=1.033, gn_bb_max=1.706 | gn_v_mean=0.278, gn_v_max=0.663

  4%|▍         | 209/5000 [26:34<9:10:18,  6.89s/it]------------------ Training Record ------------------
Epoch: 209/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1040, reward_valid_std=4.1816
[BatchDiag] adv_mean=-0.0368, adv_std=0.3351, adv_abs_mean=0.2213 | ret_mean=8.9489, ret_std=0.5915 | val_mean=8.9857, val_std=0.4905 | explained_var=0.679026
[GradSplit pre-clip] backbone=0.827875, critic=0.263913
[Loss] pg_loss=-0.012303, entropy_loss=0.000016, value_loss=0.011567
[EpochKL] epoch=0 mean_kl=0.00492 max_kl=0.01663
[EarlyStop] epoch=1 mean_kl=0.01072 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01072 max_kl=0.01906
[Time] Env Create Time: 4.3966s |Rollout Collect Time: 1.9240s |Loss & Update :0.7440
[PPODiag] kl_mean=0.0078, kl_p90=0.0148, kl_max=0.0191 | clipfrac_mean=0.020, logratio_std_mean=0.134, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.590, p10=0.586, min=0.583 | pg_loss_mean=0.0039, v_loss_mean=0.0271, ent_mean=0.0175 | gn_bb_mean=1.258, gn_bb_max=4.477 | gn_v_mean=0.385, gn_v_max=0.715

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.994, Step: 8, Avg Done Step: 6.62, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.9449s
-----------------------------
  4%|▍         | 210/5000 [26:43<10:01:35,  7.54s/it]------------------ Training Record ------------------
Epoch: 210/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1032, reward_valid_std=4.1812
[BatchDiag] adv_mean=-0.0541, adv_std=0.3346, adv_abs_mean=0.2239 | ret_mean=8.9479, ret_std=0.5931 | val_mean=9.0020, val_std=0.4752 | explained_var=0.681813
[GradSplit pre-clip] backbone=0.544028, critic=0.286179
[Loss] pg_loss=-0.065156, entropy_loss=0.000019, value_loss=0.010042
[EpochKL] epoch=0 mean_kl=0.00291 max_kl=0.00717
[EarlyStop] epoch=1 mean_kl=0.01637 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01637 max_kl=0.02418
[Time] Env Create Time: 4.3828s |Rollout Collect Time: 1.8738s |Loss & Update :0.6540
[PPODiag] kl_mean=0.0096, kl_p90=0.0222, kl_max=0.0242 | clipfrac_mean=0.019, logratio_std_mean=0.159, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.679 | pg_loss_mean=0.0023, v_loss_mean=0.0271, ent_mean=0.0216 | gn_bb_mean=1.093, gn_bb_max=2.974 | gn_v_mean=0.251, gn_v_max=0.448
[AttnScore] scale=1.0359, C=10.0

  4%|▍         | 211/5000 [26:50<9:46:30,  7.35s/it] ------------------ Training Record ------------------
Epoch: 211/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1170, reward_valid_std=4.1828
[BatchDiag] adv_mean=-0.0249, adv_std=0.3259, adv_abs_mean=0.2185 | ret_mean=8.9594, ret_std=0.5842 | val_mean=8.9843, val_std=0.4819 | explained_var=0.688871
[GradSplit pre-clip] backbone=0.962312, critic=0.183104
[Loss] pg_loss=-0.023810, entropy_loss=0.000019, value_loss=0.011398
[EpochKL] epoch=0 mean_kl=0.00383 max_kl=0.00894
[EpochKL] epoch=1 mean_kl=0.00756 max_kl=0.01165
[EarlyStop] epoch=2 mean_kl=0.01136 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01136 max_kl=0.01844
[Time] Env Create Time: 4.4091s |Rollout Collect Time: 1.6842s |Loss & Update :0.9681
[PPODiag] kl_mean=0.0076, kl_p90=0.0126, kl_max=0.0184 | clipfrac_mean=0.018, logratio_std_mean=0.142, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.685, p10=0.681, min=0.676 | pg_loss_mean=0.0016, v_loss_mean=0.0248, ent_mean=0.0193 | gn_bb_mean=0.806, gn_bb_max=2.915 | gn_v_mean=0.225, gn_v_max=0.485

  4%|▍         | 212/5000 [26:57<9:39:31,  7.26s/it]------------------ Training Record ------------------
Epoch: 212/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1033, reward_valid_std=4.1819
[BatchDiag] adv_mean=-0.0105, adv_std=0.3260, adv_abs_mean=0.2195 | ret_mean=8.9522, ret_std=0.5887 | val_mean=8.9627, val_std=0.4865 | explained_var=0.693252
[GradSplit pre-clip] backbone=0.448970, critic=0.238474
[Loss] pg_loss=-0.104712, entropy_loss=0.000017, value_loss=0.009038
[EpochKL] epoch=0 mean_kl=0.00391 max_kl=0.00944
[EpochKL] epoch=1 mean_kl=0.00716 max_kl=0.01415
[EpochKL] epoch=2 mean_kl=0.00565 max_kl=0.01051
[Time] Env Create Time: 4.4025s |Rollout Collect Time: 1.6911s |Loss & Update :0.9670
[PPODiag] kl_mean=0.0056, kl_p90=0.0102, kl_max=0.0142 | clipfrac_mean=0.016, logratio_std_mean=0.117, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.680 | pg_loss_mean=0.0010, v_loss_mean=0.0255, ent_mean=0.0186 | gn_bb_mean=0.774, gn_bb_max=1.665 | gn_v_mean=0.262, gn_v_max=0.495

  4%|▍         | 213/5000 [27:04<9:34:35,  7.20s/it]------------------ Training Record ------------------
Epoch: 213/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1102, reward_valid_std=4.1869
[BatchDiag] adv_mean=0.0134, adv_std=0.3311, adv_abs_mean=0.2210 | ret_mean=8.9422, ret_std=0.6008 | val_mean=8.9288, val_std=0.5051 | explained_var=0.696303
[GradSplit pre-clip] backbone=0.438939, critic=0.168668
[Loss] pg_loss=0.022377, entropy_loss=0.000013, value_loss=0.011261
[EpochKL] epoch=0 mean_kl=0.00502 max_kl=0.02100
[EpochKL] epoch=1 mean_kl=0.00489 max_kl=0.00935
[EpochKL] epoch=2 mean_kl=0.00623 max_kl=0.01086
[Time] Env Create Time: 4.3862s |Rollout Collect Time: 1.6930s |Loss & Update :0.9674
[PPODiag] kl_mean=0.0054, kl_p90=0.0103, kl_max=0.0210 | clipfrac_mean=0.015, logratio_std_mean=0.108, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.680, min=0.678 | pg_loss_mean=0.0005, v_loss_mean=0.0262, ent_mean=0.0170 | gn_bb_mean=0.665, gn_bb_max=1.441 | gn_v_mean=0.227, gn_v_max=0.537

  4%|▍         | 214/5000 [27:11<9:30:46,  7.16s/it]------------------ Training Record ------------------
Epoch: 214/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0969, reward_valid_std=4.1830
[BatchDiag] adv_mean=0.0041, adv_std=0.3326, adv_abs_mean=0.2224 | ret_mean=8.9372, ret_std=0.6024 | val_mean=8.9331, val_std=0.5079 | explained_var=0.695260
[GradSplit pre-clip] backbone=0.527578, critic=0.319540
[Loss] pg_loss=-0.080281, entropy_loss=0.000014, value_loss=0.010031
[EpochKL] epoch=0 mean_kl=0.00318 max_kl=0.00811
[EarlyStop] epoch=1 mean_kl=0.02660 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02660 max_kl=0.06818
[Time] Env Create Time: 4.3729s |Rollout Collect Time: 1.6826s |Loss & Update :0.6663
[PPODiag] kl_mean=0.0149, kl_p90=0.0357, kl_max=0.0682 | clipfrac_mean=0.020, logratio_std_mean=0.178, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.682 | pg_loss_mean=0.0076, v_loss_mean=0.0269, ent_mean=0.0182 | gn_bb_mean=1.901, gn_bb_max=11.533 | gn_v_mean=0.217, gn_v_max=0.413

  4%|▍         | 215/5000 [27:18<9:20:17,  7.03s/it]------------------ Training Record ------------------
Epoch: 215/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0938, reward_valid_std=4.1814
[BatchDiag] adv_mean=-0.0417, adv_std=0.3473, adv_abs_mean=0.2322 | ret_mean=8.9324, ret_std=0.6057 | val_mean=8.9742, val_std=0.5015 | explained_var=0.671167
[GradSplit pre-clip] backbone=0.705824, critic=0.163466
[Loss] pg_loss=-0.076136, entropy_loss=0.000020, value_loss=0.010620
[EpochKL] epoch=0 mean_kl=0.00610 max_kl=0.01332
[EarlyStop] epoch=1 mean_kl=0.01666 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01666 max_kl=0.02200
[Time] Env Create Time: 4.3836s |Rollout Collect Time: 1.6836s |Loss & Update :0.6535
[PPODiag] kl_mean=0.0114, kl_p90=0.0191, kl_max=0.0220 | clipfrac_mean=0.023, logratio_std_mean=0.174, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.684 | pg_loss_mean=0.0021, v_loss_mean=0.0291, ent_mean=0.0183 | gn_bb_mean=0.851, gn_bb_max=1.738 | gn_v_mean=0.283, gn_v_max=0.589
[AttnScore] scale=1.0365, C=10.0

  4%|▍         | 216/5000 [27:24<9:12:53,  6.93s/it]------------------ Training Record ------------------
Epoch: 216/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1001, reward_valid_std=4.1831
[BatchDiag] adv_mean=-0.0008, adv_std=0.3291, adv_abs_mean=0.2268 | ret_mean=8.9453, ret_std=0.5921 | val_mean=8.9460, val_std=0.4932 | explained_var=0.691082
[GradSplit pre-clip] backbone=0.882545, critic=0.249253
[Loss] pg_loss=-0.030632, entropy_loss=0.000016, value_loss=0.011909
[EpochKL] epoch=0 mean_kl=0.00300 max_kl=0.00902
[EpochKL] epoch=1 mean_kl=0.00630 max_kl=0.01019
[EarlyStop] epoch=2 mean_kl=0.01164 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01164 max_kl=0.01763
[Time] Env Create Time: 4.5768s |Rollout Collect Time: 1.6904s |Loss & Update :0.9739
[PPODiag] kl_mean=0.0070, kl_p90=0.0132, kl_max=0.0176 | clipfrac_mean=0.017, logratio_std_mean=0.126, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.681 | pg_loss_mean=0.0011, v_loss_mean=0.0257, ent_mean=0.0178 | gn_bb_mean=0.770, gn_bb_max=1.273 | gn_v_mean=0.193, gn_v_max=0.415

  4%|▍         | 217/5000 [27:32<9:20:07,  7.03s/it]------------------ Training Record ------------------
Epoch: 217/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1113, reward_valid_std=4.1815
[BatchDiag] adv_mean=0.0170, adv_std=0.3205, adv_abs_mean=0.2158 | ret_mean=8.9573, ret_std=0.5855 | val_mean=8.9403, val_std=0.5059 | explained_var=0.700388
[GradSplit pre-clip] backbone=0.299662, critic=0.362866
[Loss] pg_loss=-0.056669, entropy_loss=0.000011, value_loss=0.010036
[EpochKL] epoch=0 mean_kl=0.00302 max_kl=0.00888
[EpochKL] epoch=1 mean_kl=0.00720 max_kl=0.00866
[EpochKL] epoch=2 mean_kl=0.00696 max_kl=0.01180
[Time] Env Create Time: 4.4284s |Rollout Collect Time: 1.6833s |Loss & Update :0.9731
[PPODiag] kl_mean=0.0057, kl_p90=0.0090, kl_max=0.0118 | clipfrac_mean=0.015, logratio_std_mean=0.116, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.682 | pg_loss_mean=0.0015, v_loss_mean=0.0244, ent_mean=0.0170 | gn_bb_mean=0.719, gn_bb_max=1.191 | gn_v_mean=0.249, gn_v_max=0.587

  4%|▍         | 218/5000 [27:39<9:21:24,  7.04s/it]------------------ Training Record ------------------
Epoch: 218/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0955, reward_valid_std=4.1750
[BatchDiag] adv_mean=-0.0079, adv_std=0.3393, adv_abs_mean=0.2243 | ret_mean=8.9484, ret_std=0.6036 | val_mean=8.9563, val_std=0.4863 | explained_var=0.684046
[GradSplit pre-clip] backbone=0.575965, critic=0.208323
[Loss] pg_loss=-0.063291, entropy_loss=0.000015, value_loss=0.010910
[EpochKL] epoch=0 mean_kl=0.00297 max_kl=0.00529
[EpochKL] epoch=1 mean_kl=0.00538 max_kl=0.00936
[EpochKL] epoch=2 mean_kl=0.00839 max_kl=0.01344
[Time] Env Create Time: 4.4111s |Rollout Collect Time: 1.6942s |Loss & Update :0.9651
[PPODiag] kl_mean=0.0056, kl_p90=0.0105, kl_max=0.0134 | clipfrac_mean=0.017, logratio_std_mean=0.121, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.692, p10=0.686, min=0.682 | pg_loss_mean=0.0022, v_loss_mean=0.0273, ent_mean=0.0196 | gn_bb_mean=0.818, gn_bb_max=1.987 | gn_v_mean=0.261, gn_v_max=0.568

  4%|▍         | 219/5000 [27:46<9:21:56,  7.05s/it]------------------ Training Record ------------------
Epoch: 219/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0885, reward_valid_std=4.1740
[BatchDiag] adv_mean=-0.0173, adv_std=0.3419, adv_abs_mean=0.2281 | ret_mean=8.9337, ret_std=0.6004 | val_mean=8.9510, val_std=0.5138 | explained_var=0.675828
[GradSplit pre-clip] backbone=0.396844, critic=0.394358
[Loss] pg_loss=-0.169251, entropy_loss=0.000014, value_loss=0.007148
[EpochKL] epoch=0 mean_kl=0.00140 max_kl=0.00295
[EpochKL] epoch=1 mean_kl=0.00568 max_kl=0.01142
[EpochKL] epoch=2 mean_kl=0.00919 max_kl=0.02044
[Time] Env Create Time: 4.3974s |Rollout Collect Time: 1.7048s |Loss & Update :0.9622
[PPODiag] kl_mean=0.0054, kl_p90=0.0114, kl_max=0.0204 | clipfrac_mean=0.015, logratio_std_mean=0.112, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.692, p10=0.685, min=0.680 | pg_loss_mean=0.0004, v_loss_mean=0.0279, ent_mean=0.0188 | gn_bb_mean=0.674, gn_bb_max=1.192 | gn_v_mean=0.236, gn_v_max=0.455

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.000, Step: 7, Avg Done Step: 6.60, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8096s
-----------------------------
  4%|▍         | 220/5000 [27:55<10:06:13,  7.61s/it]------------------ Training Record ------------------
Epoch: 220/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1125, reward_valid_std=4.1839
[BatchDiag] adv_mean=-0.0202, adv_std=0.3101, adv_abs_mean=0.2084 | ret_mean=8.9550, ret_std=0.5770 | val_mean=8.9752, val_std=0.4870 | explained_var=0.711146
[GradSplit pre-clip] backbone=0.442564, critic=0.335266
[Loss] pg_loss=-0.179515, entropy_loss=0.000015, value_loss=0.006659
[EpochKL] epoch=0 mean_kl=0.00238 max_kl=0.00684
[EarlyStop] epoch=1 mean_kl=0.01145 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01145 max_kl=0.02105
[Time] Env Create Time: 4.3852s |Rollout Collect Time: 1.6930s |Loss & Update :0.6518
[PPODiag] kl_mean=0.0069, kl_p90=0.0138, kl_max=0.0211 | clipfrac_mean=0.017, logratio_std_mean=0.123, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.682, min=0.678 | pg_loss_mean=0.0032, v_loss_mean=0.0232, ent_mean=0.0184 | gn_bb_mean=1.074, gn_bb_max=1.855 | gn_v_mean=0.216, gn_v_max=0.376
[AttnScore] scale=1.0369, C=10.0

  4%|▍         | 221/5000 [28:02<9:45:05,  7.35s/it] ------------------ Training Record ------------------
Epoch: 221/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.0996, reward_valid_std=4.1768
[BatchDiag] adv_mean=-0.0293, adv_std=0.3280, adv_abs_mean=0.2133 | ret_mean=8.9472, ret_std=0.5953 | val_mean=8.9765, val_std=0.5047 | explained_var=0.696311
[GradSplit pre-clip] backbone=0.566171, critic=0.081933
[Loss] pg_loss=-0.071556, entropy_loss=0.000013, value_loss=0.009451
[EpochKL] epoch=0 mean_kl=0.00642 max_kl=0.01100
[EarlyStop] epoch=1 mean_kl=0.02189 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02189 max_kl=0.04259
[Time] Env Create Time: 4.3667s |Rollout Collect Time: 1.9363s |Loss & Update :0.7379
[PPODiag] kl_mean=0.0142, kl_p90=0.0318, kl_max=0.0426 | clipfrac_mean=0.021, logratio_std_mean=0.191, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.591, p10=0.588, min=0.588 | pg_loss_mean=0.0045, v_loss_mean=0.0266, ent_mean=0.0160 | gn_bb_mean=1.014, gn_bb_max=2.392 | gn_v_mean=0.271, gn_v_max=0.630

  4%|▍         | 222/5000 [28:09<9:37:41,  7.25s/it]------------------ Training Record ------------------
Epoch: 222/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1029, reward_valid_std=4.1845
[BatchDiag] adv_mean=-0.0136, adv_std=0.3370, adv_abs_mean=0.2243 | ret_mean=8.9466, ret_std=0.6008 | val_mean=8.9603, val_std=0.4936 | explained_var=0.685304
[GradSplit pre-clip] backbone=0.904015, critic=0.124926
[Loss] pg_loss=-0.048040, entropy_loss=0.000021, value_loss=0.010739
[EpochKL] epoch=0 mean_kl=0.00270 max_kl=0.00597
[EpochKL] epoch=1 mean_kl=0.00791 max_kl=0.01177
[EarlyStop] epoch=2 mean_kl=0.01074 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01074 max_kl=0.02478
[Time] Env Create Time: 4.5839s |Rollout Collect Time: 1.6883s |Loss & Update :0.9698
[PPODiag] kl_mean=0.0071, kl_p90=0.0125, kl_max=0.0248 | clipfrac_mean=0.017, logratio_std_mean=0.126, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.680 | pg_loss_mean=0.0019, v_loss_mean=0.0273, ent_mean=0.0178 | gn_bb_mean=0.746, gn_bb_max=1.761 | gn_v_mean=0.236, gn_v_max=0.468

  4%|▍         | 223/5000 [28:16<9:37:17,  7.25s/it]------------------ Training Record ------------------
Epoch: 223/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.0966, reward_valid_std=4.1861
[BatchDiag] adv_mean=0.0120, adv_std=0.3263, adv_abs_mean=0.2239 | ret_mean=8.9383, ret_std=0.6057 | val_mean=8.9263, val_std=0.4968 | explained_var=0.709842
[GradSplit pre-clip] backbone=0.599855, critic=0.399000
[Loss] pg_loss=-0.071173, entropy_loss=0.000016, value_loss=0.011162
[EpochKL] epoch=0 mean_kl=0.00304 max_kl=0.00506
[EarlyStop] epoch=1 mean_kl=0.01138 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01138 max_kl=0.01798
[Time] Env Create Time: 4.4116s |Rollout Collect Time: 1.9420s |Loss & Update :0.7342
[PPODiag] kl_mean=0.0072, kl_p90=0.0155, kl_max=0.0180 | clipfrac_mean=0.020, logratio_std_mean=0.130, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.584, min=0.584 | pg_loss_mean=0.0029, v_loss_mean=0.0257, ent_mean=0.0170 | gn_bb_mean=1.008, gn_bb_max=2.254 | gn_v_mean=0.222, gn_v_max=0.612

  4%|▍         | 224/5000 [28:23<9:33:16,  7.20s/it]------------------ Training Record ------------------
Epoch: 224/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1034, reward_valid_std=4.1860
[BatchDiag] adv_mean=-0.0189, adv_std=0.3287, adv_abs_mean=0.2192 | ret_mean=8.9469, ret_std=0.5975 | val_mean=8.9658, val_std=0.4895 | explained_var=0.697328
[GradSplit pre-clip] backbone=0.717618, critic=0.183242
[Loss] pg_loss=0.014312, entropy_loss=0.000023, value_loss=0.012541
[EpochKL] epoch=0 mean_kl=0.00711 max_kl=0.01362
[EarlyStop] epoch=1 mean_kl=0.01775 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01775 max_kl=0.03814
[Time] Env Create Time: 4.4018s |Rollout Collect Time: 1.6930s |Loss & Update :0.6577
[PPODiag] kl_mean=0.0124, kl_p90=0.0256, kl_max=0.0381 | clipfrac_mean=0.022, logratio_std_mean=0.188, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.679 | pg_loss_mean=0.0038, v_loss_mean=0.0259, ent_mean=0.0200 | gn_bb_mean=0.915, gn_bb_max=2.705 | gn_v_mean=0.220, gn_v_max=0.497

  4%|▍         | 225/5000 [28:30<9:22:26,  7.07s/it]------------------ Training Record ------------------
Epoch: 225/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1114, reward_valid_std=4.1849
[BatchDiag] adv_mean=-0.0098, adv_std=0.3231, adv_abs_mean=0.2141 | ret_mean=8.9493, ret_std=0.5957 | val_mean=8.9591, val_std=0.4701 | explained_var=0.705736
[GradSplit pre-clip] backbone=0.646494, critic=0.172321
[Loss] pg_loss=-0.052485, entropy_loss=0.000019, value_loss=0.011942
[EpochKL] epoch=0 mean_kl=0.00438 max_kl=0.01192
[EarlyStop] epoch=1 mean_kl=0.01058 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01058 max_kl=0.01776
[Time] Env Create Time: 4.4054s |Rollout Collect Time: 1.6935s |Loss & Update :0.6681
[PPODiag] kl_mean=0.0075, kl_p90=0.0138, kl_max=0.0178 | clipfrac_mean=0.019, logratio_std_mean=0.128, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.678 | pg_loss_mean=0.0031, v_loss_mean=0.0251, ent_mean=0.0195 | gn_bb_mean=1.192, gn_bb_max=5.137 | gn_v_mean=0.217, gn_v_max=0.414
[AttnScore] scale=1.0374, C=10.0

  5%|▍         | 226/5000 [28:36<9:15:10,  6.98s/it]------------------ Training Record ------------------
Epoch: 226/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1110, reward_valid_std=4.1834
[BatchDiag] adv_mean=-0.0071, adv_std=0.3276, adv_abs_mean=0.2179 | ret_mean=8.9419, ret_std=0.5924 | val_mean=8.9490, val_std=0.4983 | explained_var=0.694175
[GradSplit pre-clip] backbone=1.026892, critic=0.171630
[Loss] pg_loss=-0.039003, entropy_loss=0.000019, value_loss=0.011714
[EpochKL] epoch=0 mean_kl=0.00843 max_kl=0.01858
[EarlyStop] epoch=1 mean_kl=0.01486 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01486 max_kl=0.02593
[Time] Env Create Time: 4.3885s |Rollout Collect Time: 1.6937s |Loss & Update :0.6550
[PPODiag] kl_mean=0.0116, kl_p90=0.0181, kl_max=0.0259 | clipfrac_mean=0.022, logratio_std_mean=0.187, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.685, p10=0.681, min=0.676 | pg_loss_mean=0.0053, v_loss_mean=0.0262, ent_mean=0.0185 | gn_bb_mean=1.281, gn_bb_max=3.451 | gn_v_mean=0.224, gn_v_max=0.486

  5%|▍         | 227/5000 [28:43<9:09:19,  6.91s/it]------------------ Training Record ------------------
Epoch: 227/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0954, reward_valid_std=4.1779
[BatchDiag] adv_mean=-0.0178, adv_std=0.3405, adv_abs_mean=0.2271 | ret_mean=8.9316, ret_std=0.5990 | val_mean=8.9495, val_std=0.4958 | explained_var=0.676895
[GradSplit pre-clip] backbone=0.506430, critic=0.108901
[Loss] pg_loss=-0.045653, entropy_loss=0.000022, value_loss=0.011209
[EarlyStop] epoch=0 mean_kl=0.02244 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02244 max_kl=0.03718
[Time] Env Create Time: 4.3704s |Rollout Collect Time: 1.7051s |Loss & Update :0.3631
[PPODiag] kl_mean=0.0224, kl_p90=0.0332, kl_max=0.0372 | clipfrac_mean=0.028, logratio_std_mean=0.252, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.690, p10=0.686, min=0.686 | pg_loss_mean=0.0088, v_loss_mean=0.0289, ent_mean=0.0221 | gn_bb_mean=1.732, gn_bb_max=4.275 | gn_v_mean=0.238, gn_v_max=0.386

  5%|▍         | 228/5000 [28:50<8:58:05,  6.77s/it]------------------ Training Record ------------------
Epoch: 228/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1085, reward_valid_std=4.1839
[BatchDiag] adv_mean=0.0016, adv_std=0.3365, adv_abs_mean=0.2235 | ret_mean=8.9441, ret_std=0.6025 | val_mean=8.9425, val_std=0.5136 | explained_var=0.687989
[GradSplit pre-clip] backbone=1.083517, critic=0.185610
[Loss] pg_loss=-0.017153, entropy_loss=0.000020, value_loss=0.012195
[EpochKL] epoch=0 mean_kl=0.00782 max_kl=0.01977
[EarlyStop] epoch=1 mean_kl=0.01683 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01683 max_kl=0.02744
[Time] Env Create Time: 4.5728s |Rollout Collect Time: 1.6900s |Loss & Update :0.6658
[PPODiag] kl_mean=0.0123, kl_p90=0.0241, kl_max=0.0274 | clipfrac_mean=0.020, logratio_std_mean=0.195, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.676 | pg_loss_mean=0.0011, v_loss_mean=0.0272, ent_mean=0.0179 | gn_bb_mean=0.759, gn_bb_max=1.472 | gn_v_mean=0.223, gn_v_max=0.467

  5%|▍         | 229/5000 [28:57<9:01:52,  6.81s/it]------------------ Training Record ------------------
Epoch: 229/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1102, reward_valid_std=4.1832
[BatchDiag] adv_mean=0.0084, adv_std=0.3337, adv_abs_mean=0.2259 | ret_mean=8.9509, ret_std=0.5994 | val_mean=8.9425, val_std=0.4893 | explained_var=0.690083
[GradSplit pre-clip] backbone=0.502762, critic=0.351061
[Loss] pg_loss=-0.070816, entropy_loss=0.000015, value_loss=0.010047
[EpochKL] epoch=0 mean_kl=0.00280 max_kl=0.00623
[EarlyStop] epoch=1 mean_kl=0.01248 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01248 max_kl=0.02075
[Time] Env Create Time: 4.4192s |Rollout Collect Time: 1.6948s |Loss & Update :0.6551
[PPODiag] kl_mean=0.0076, kl_p90=0.0148, kl_max=0.0207 | clipfrac_mean=0.018, logratio_std_mean=0.134, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.683 | pg_loss_mean=0.0019, v_loss_mean=0.0268, ent_mean=0.0183 | gn_bb_mean=0.804, gn_bb_max=1.255 | gn_v_mean=0.250, gn_v_max=0.445

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.000, Step: 7, Avg Done Step: 6.61, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8306s
-----------------------------
  5%|▍         | 230/5000 [29:05<9:45:11,  7.36s/it]------------------ Training Record ------------------
Epoch: 230/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1146, reward_valid_std=4.1831
[BatchDiag] adv_mean=0.0020, adv_std=0.3064, adv_abs_mean=0.2087 | ret_mean=8.9571, ret_std=0.5711 | val_mean=8.9551, val_std=0.4711 | explained_var=0.712123
[GradSplit pre-clip] backbone=0.822041, critic=0.440437
[Loss] pg_loss=-0.150861, entropy_loss=0.000019, value_loss=0.006416
[EpochKL] epoch=0 mean_kl=0.00368 max_kl=0.01218
[EpochKL] epoch=1 mean_kl=0.00714 max_kl=0.01524
[EpochKL] epoch=2 mean_kl=0.00616 max_kl=0.01048
[Time] Env Create Time: 4.3924s |Rollout Collect Time: 1.6861s |Loss & Update :0.9565
[PPODiag] kl_mean=0.0057, kl_p90=0.0117, kl_max=0.0152 | clipfrac_mean=0.015, logratio_std_mean=0.118, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.677 | pg_loss_mean=0.0021, v_loss_mean=0.0231, ent_mean=0.0188 | gn_bb_mean=0.820, gn_bb_max=1.732 | gn_v_mean=0.262, gn_v_max=0.632
[AttnScore] scale=1.0377, C=10.0

  5%|▍         | 231/5000 [29:12<9:37:18,  7.26s/it]------------------ Training Record ------------------
Epoch: 231/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1226, reward_valid_std=4.1882
[BatchDiag] adv_mean=0.0284, adv_std=0.3024, adv_abs_mean=0.2097 | ret_mean=8.9697, ret_std=0.5786 | val_mean=8.9413, val_std=0.4844 | explained_var=0.726801
[GradSplit pre-clip] backbone=0.647939, critic=0.404105
[Loss] pg_loss=-0.040147, entropy_loss=0.000014, value_loss=0.009338
[EpochKL] epoch=0 mean_kl=0.00282 max_kl=0.01144
[EpochKL] epoch=1 mean_kl=0.00629 max_kl=0.01474
[EarlyStop] epoch=2 mean_kl=0.01000 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01000 max_kl=0.02217
[Time] Env Create Time: 4.3837s |Rollout Collect Time: 1.6910s |Loss & Update :0.9575
[PPODiag] kl_mean=0.0064, kl_p90=0.0132, kl_max=0.0222 | clipfrac_mean=0.014, logratio_std_mean=0.137, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.681, min=0.675 | pg_loss_mean=0.0012, v_loss_mean=0.0227, ent_mean=0.0187 | gn_bb_mean=0.688, gn_bb_max=1.559 | gn_v_mean=0.236, gn_v_max=0.515

  5%|▍         | 232/5000 [29:19<9:31:41,  7.19s/it]------------------ Training Record ------------------
Epoch: 232/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1097, reward_valid_std=4.1858
[BatchDiag] adv_mean=0.0170, adv_std=0.3293, adv_abs_mean=0.2236 | ret_mean=8.9524, ret_std=0.5986 | val_mean=8.9354, val_std=0.4927 | explained_var=0.697365
[GradSplit pre-clip] backbone=0.805530, critic=0.379663
[Loss] pg_loss=-0.057284, entropy_loss=0.000016, value_loss=0.011308
[EpochKL] epoch=0 mean_kl=0.00393 max_kl=0.01240
[EpochKL] epoch=1 mean_kl=0.00858 max_kl=0.02106
[EarlyStop] epoch=2 mean_kl=0.01002 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01002 max_kl=0.01837
[Time] Env Create Time: 4.3775s |Rollout Collect Time: 1.6986s |Loss & Update :0.9600
[PPODiag] kl_mean=0.0075, kl_p90=0.0137, kl_max=0.0211 | clipfrac_mean=0.016, logratio_std_mean=0.136, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.678 | pg_loss_mean=0.0022, v_loss_mean=0.0263, ent_mean=0.0185 | gn_bb_mean=0.860, gn_bb_max=1.448 | gn_v_mean=0.199, gn_v_max=0.437

  5%|▍         | 233/5000 [29:26<9:27:48,  7.15s/it]------------------ Training Record ------------------
Epoch: 233/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0936, reward_valid_std=4.1758
[BatchDiag] adv_mean=-0.0091, adv_std=0.3350, adv_abs_mean=0.2247 | ret_mean=8.9323, ret_std=0.6019 | val_mean=8.9414, val_std=0.4911 | explained_var=0.690287
[GradSplit pre-clip] backbone=0.436657, critic=0.154804
[Loss] pg_loss=-0.058906, entropy_loss=0.000018, value_loss=0.009824
[EpochKL] epoch=0 mean_kl=0.00376 max_kl=0.00883
[EarlyStop] epoch=1 mean_kl=0.01119 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01119 max_kl=0.03009
[Time] Env Create Time: 4.5940s |Rollout Collect Time: 1.6832s |Loss & Update :0.6577
[PPODiag] kl_mean=0.0075, kl_p90=0.0128, kl_max=0.0301 | clipfrac_mean=0.016, logratio_std_mean=0.144, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.678 | pg_loss_mean=0.0027, v_loss_mean=0.0277, ent_mean=0.0191 | gn_bb_mean=0.872, gn_bb_max=2.053 | gn_v_mean=0.335, gn_v_max=0.682

  5%|▍         | 234/5000 [29:33<9:22:39,  7.08s/it]------------------ Training Record ------------------
Epoch: 234/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1056, reward_valid_std=4.1847
[BatchDiag] adv_mean=0.0275, adv_std=0.3252, adv_abs_mean=0.2277 | ret_mean=8.9405, ret_std=0.5952 | val_mean=8.9130, val_std=0.4909 | explained_var=0.701593
[GradSplit pre-clip] backbone=0.518632, critic=0.194217
[Loss] pg_loss=0.062309, entropy_loss=0.000017, value_loss=0.013467
[EpochKL] epoch=0 mean_kl=0.00218 max_kl=0.00404
[EpochKL] epoch=1 mean_kl=0.00728 max_kl=0.01101
[EarlyStop] epoch=2 mean_kl=0.01855 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01855 max_kl=0.04037
[Time] Env Create Time: 4.4149s |Rollout Collect Time: 1.6910s |Loss & Update :0.9712
[PPODiag] kl_mean=0.0093, kl_p90=0.0213, kl_max=0.0404 | clipfrac_mean=0.017, logratio_std_mean=0.141, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.681, min=0.678 | pg_loss_mean=0.0029, v_loss_mean=0.0268, ent_mean=0.0182 | gn_bb_mean=1.070, gn_bb_max=2.834 | gn_v_mean=0.396, gn_v_max=0.824

  5%|▍         | 235/5000 [29:40<9:22:24,  7.08s/it]------------------ Training Record ------------------
Epoch: 235/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0971, reward_valid_std=4.1707
[BatchDiag] adv_mean=-0.0603, adv_std=0.3613, adv_abs_mean=0.2465 | ret_mean=8.9348, ret_std=0.5953 | val_mean=8.9951, val_std=0.4817 | explained_var=0.631534
[GradSplit pre-clip] backbone=0.931170, critic=0.283128
[Loss] pg_loss=-0.085522, entropy_loss=0.000025, value_loss=0.012935
[EpochKL] epoch=0 mean_kl=0.00569 max_kl=0.01785
[EarlyStop] epoch=1 mean_kl=0.01232 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01232 max_kl=0.01961
[Time] Env Create Time: 4.4158s |Rollout Collect Time: 1.6947s |Loss & Update :0.6611
[PPODiag] kl_mean=0.0090, kl_p90=0.0184, kl_max=0.0196 | clipfrac_mean=0.021, logratio_std_mean=0.158, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.680 | pg_loss_mean=0.0020, v_loss_mean=0.0310, ent_mean=0.0221 | gn_bb_mean=0.802, gn_bb_max=1.613 | gn_v_mean=0.421, gn_v_max=0.882
[AttnScore] scale=1.0390, C=10.0

  5%|▍         | 236/5000 [29:47<9:14:54,  6.99s/it]------------------ Training Record ------------------
Epoch: 236/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0984, reward_valid_std=4.1747
[BatchDiag] adv_mean=-0.0130, adv_std=0.3563, adv_abs_mean=0.2385 | ret_mean=8.9383, ret_std=0.6001 | val_mean=8.9513, val_std=0.4725 | explained_var=0.647457
[GradSplit pre-clip] backbone=0.592672, critic=0.144491
[Loss] pg_loss=-0.021471, entropy_loss=0.000018, value_loss=0.012933
[EpochKL] epoch=0 mean_kl=0.00436 max_kl=0.00955
[EarlyStop] epoch=1 mean_kl=0.01302 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01302 max_kl=0.03331
[Time] Env Create Time: 4.4092s |Rollout Collect Time: 1.6865s |Loss & Update :0.6726
[PPODiag] kl_mean=0.0087, kl_p90=0.0156, kl_max=0.0333 | clipfrac_mean=0.017, logratio_std_mean=0.163, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.690, p10=0.687, min=0.685 | pg_loss_mean=0.0014, v_loss_mean=0.0300, ent_mean=0.0190 | gn_bb_mean=0.756, gn_bb_max=1.547 | gn_v_mean=0.250, gn_v_max=0.634

  5%|▍         | 237/5000 [29:54<9:09:33,  6.92s/it]------------------ Training Record ------------------
Epoch: 237/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1029, reward_valid_std=4.1792
[BatchDiag] adv_mean=0.0017, adv_std=0.3362, adv_abs_mean=0.2294 | ret_mean=8.9405, ret_std=0.5933 | val_mean=8.9388, val_std=0.4685 | explained_var=0.678846
[GradSplit pre-clip] backbone=1.135694, critic=0.305042
[Loss] pg_loss=-0.077769, entropy_loss=0.000019, value_loss=0.009700
[EpochKL] epoch=0 mean_kl=0.00505 max_kl=0.01292
[EarlyStop] epoch=1 mean_kl=0.01779 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01779 max_kl=0.03878
[Time] Env Create Time: 4.3831s |Rollout Collect Time: 1.6991s |Loss & Update :0.6549
[PPODiag] kl_mean=0.0114, kl_p90=0.0193, kl_max=0.0388 | clipfrac_mean=0.022, logratio_std_mean=0.167, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.680 | pg_loss_mean=0.0042, v_loss_mean=0.0280, ent_mean=0.0219 | gn_bb_mean=1.089, gn_bb_max=3.100 | gn_v_mean=0.232, gn_v_max=0.355

  5%|▍         | 238/5000 [30:01<9:05:01,  6.87s/it]------------------ Training Record ------------------
Epoch: 238/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.588, reward_valid_mean=2.1076, reward_valid_std=4.1824
[BatchDiag] adv_mean=0.0147, adv_std=0.3400, adv_abs_mean=0.2333 | ret_mean=8.9323, ret_std=0.5898 | val_mean=8.9176, val_std=0.4742 | explained_var=0.667734
[GradSplit pre-clip] backbone=1.086458, critic=0.298277
[Loss] pg_loss=-0.034309, entropy_loss=0.000017, value_loss=0.011632
[EpochKL] epoch=0 mean_kl=0.00533 max_kl=0.01033
[EarlyStop] epoch=1 mean_kl=0.01039 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01039 max_kl=0.01571
[Time] Env Create Time: 4.3784s |Rollout Collect Time: 1.9462s |Loss & Update :0.7411
[PPODiag] kl_mean=0.0079, kl_p90=0.0131, kl_max=0.0157 | clipfrac_mean=0.018, logratio_std_mean=0.143, ratio_p95_mean=1.008 | valid_ratio_mb_mean=0.588, p10=0.582, min=0.581 | pg_loss_mean=0.0015, v_loss_mean=0.0271, ent_mean=0.0166 | gn_bb_mean=0.831, gn_bb_max=1.363 | gn_v_mean=0.265, gn_v_max=0.527

  5%|▍         | 239/5000 [30:08<9:09:38,  6.93s/it]------------------ Training Record ------------------
Epoch: 239/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1090, reward_valid_std=4.1829
[BatchDiag] adv_mean=0.0429, adv_std=0.3231, adv_abs_mean=0.2270 | ret_mean=8.9532, ret_std=0.5837 | val_mean=8.9103, val_std=0.4867 | explained_var=0.693654
[GradSplit pre-clip] backbone=0.329213, critic=0.446297
[Loss] pg_loss=-0.002000, entropy_loss=0.000017, value_loss=0.012010
[EpochKL] epoch=0 mean_kl=0.00441 max_kl=0.01317
[EarlyStop] epoch=1 mean_kl=0.03240 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03240 max_kl=0.05664
[Time] Env Create Time: 4.3629s |Rollout Collect Time: 1.6867s |Loss & Update :0.6693
[PPODiag] kl_mean=0.0184, kl_p90=0.0481, kl_max=0.0566 | clipfrac_mean=0.025, logratio_std_mean=0.228, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.679 | pg_loss_mean=0.0056, v_loss_mean=0.0262, ent_mean=0.0200 | gn_bb_mean=1.161, gn_bb_max=2.496 | gn_v_mean=0.344, gn_v_max=0.618

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.001, Step: 7, Avg Done Step: 6.63, #CS visited: 0.12
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8177s
-----------------------------
  5%|▍         | 240/5000 [30:16<9:48:33,  7.42s/it]------------------ Training Record ------------------
Epoch: 240/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0969, reward_valid_std=4.1740
[BatchDiag] adv_mean=-0.0193, adv_std=0.3450, adv_abs_mean=0.2267 | ret_mean=8.9447, ret_std=0.5922 | val_mean=8.9640, val_std=0.4959 | explained_var=0.660608
[GradSplit pre-clip] backbone=0.592446, critic=0.172445
[Loss] pg_loss=-0.023225, entropy_loss=0.000018, value_loss=0.012339
[EarlyStop] epoch=0 mean_kl=0.01636 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01636 max_kl=0.02870
[Time] Env Create Time: 4.6017s |Rollout Collect Time: 1.6858s |Loss & Update :0.3468
[PPODiag] kl_mean=0.0164, kl_p90=0.0241, kl_max=0.0287 | clipfrac_mean=0.028, logratio_std_mean=0.219, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.684 | pg_loss_mean=0.0072, v_loss_mean=0.0289, ent_mean=0.0217 | gn_bb_mean=1.279, gn_bb_max=2.884 | gn_v_mean=0.227, gn_v_max=0.325
[AttnScore] scale=1.0393, C=10.0

  5%|▍         | 241/5000 [30:23<9:29:47,  7.18s/it]------------------ Training Record ------------------
Epoch: 241/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1026, reward_valid_std=4.1789
[BatchDiag] adv_mean=-0.0207, adv_std=0.3386, adv_abs_mean=0.2250 | ret_mean=8.9461, ret_std=0.5998 | val_mean=8.9668, val_std=0.4829 | explained_var=0.681394
[GradSplit pre-clip] backbone=0.901196, critic=0.326581
[Loss] pg_loss=0.087304, entropy_loss=0.000022, value_loss=0.014847
[EpochKL] epoch=0 mean_kl=0.00878 max_kl=0.01823
[EarlyStop] epoch=1 mean_kl=0.02666 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02666 max_kl=0.05222
[Time] Env Create Time: 4.4183s |Rollout Collect Time: 1.7028s |Loss & Update :0.6701
[PPODiag] kl_mean=0.0177, kl_p90=0.0421, kl_max=0.0522 | clipfrac_mean=0.026, logratio_std_mean=0.234, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.681 | pg_loss_mean=0.0037, v_loss_mean=0.0284, ent_mean=0.0213 | gn_bb_mean=0.917, gn_bb_max=1.905 | gn_v_mean=0.349, gn_v_max=0.525

  5%|▍         | 242/5000 [30:30<9:20:20,  7.07s/it]------------------ Training Record ------------------
Epoch: 242/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1024, reward_valid_std=4.1821
[BatchDiag] adv_mean=-0.0054, adv_std=0.3403, adv_abs_mean=0.2306 | ret_mean=8.9416, ret_std=0.5964 | val_mean=8.9471, val_std=0.5011 | explained_var=0.674399
[GradSplit pre-clip] backbone=0.636809, critic=0.176582
[Loss] pg_loss=-0.022063, entropy_loss=0.000017, value_loss=0.012994
[EpochKL] epoch=0 mean_kl=0.00515 max_kl=0.01273
[EarlyStop] epoch=1 mean_kl=0.01196 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01196 max_kl=0.02307
[Time] Env Create Time: 4.4106s |Rollout Collect Time: 1.6967s |Loss & Update :0.6487
[PPODiag] kl_mean=0.0086, kl_p90=0.0175, kl_max=0.0231 | clipfrac_mean=0.018, logratio_std_mean=0.147, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.681 | pg_loss_mean=0.0025, v_loss_mean=0.0271, ent_mean=0.0194 | gn_bb_mean=0.908, gn_bb_max=2.117 | gn_v_mean=0.216, gn_v_max=0.451

  5%|▍         | 243/5000 [30:36<9:12:51,  6.97s/it]------------------ Training Record ------------------
Epoch: 243/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1052, reward_valid_std=4.1888
[BatchDiag] adv_mean=-0.0184, adv_std=0.3314, adv_abs_mean=0.2196 | ret_mean=8.9435, ret_std=0.6031 | val_mean=8.9619, val_std=0.4756 | explained_var=0.697951
[GradSplit pre-clip] backbone=1.532336, critic=0.232366
[Loss] pg_loss=0.048618, entropy_loss=0.000018, value_loss=0.013849
[EarlyStop] epoch=0 mean_kl=0.01282 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01282 max_kl=0.03318
[Time] Env Create Time: 4.4060s |Rollout Collect Time: 1.7021s |Loss & Update :0.3593
[PPODiag] kl_mean=0.0128, kl_p90=0.0290, kl_max=0.0332 | clipfrac_mean=0.020, logratio_std_mean=0.162, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.681 | pg_loss_mean=0.0030, v_loss_mean=0.0269, ent_mean=0.0205 | gn_bb_mean=1.061, gn_bb_max=1.630 | gn_v_mean=0.211, gn_v_max=0.279

  5%|▍         | 244/5000 [30:43<9:00:43,  6.82s/it]------------------ Training Record ------------------
Epoch: 244/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1015, reward_valid_std=4.1850
[BatchDiag] adv_mean=-0.0114, adv_std=0.3373, adv_abs_mean=0.2243 | ret_mean=8.9365, ret_std=0.6030 | val_mean=8.9478, val_std=0.4869 | explained_var=0.687059
[GradSplit pre-clip] backbone=0.833946, critic=0.111098
[Loss] pg_loss=-0.015237, entropy_loss=0.000017, value_loss=0.013162
[EpochKL] epoch=0 mean_kl=0.00354 max_kl=0.00805
[EarlyStop] epoch=1 mean_kl=0.01039 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01039 max_kl=0.01974
[Time] Env Create Time: 4.3912s |Rollout Collect Time: 1.7068s |Loss & Update :0.6602
[PPODiag] kl_mean=0.0070, kl_p90=0.0138, kl_max=0.0197 | clipfrac_mean=0.016, logratio_std_mean=0.122, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.681 | pg_loss_mean=0.0017, v_loss_mean=0.0275, ent_mean=0.0194 | gn_bb_mean=0.829, gn_bb_max=2.285 | gn_v_mean=0.233, gn_v_max=0.516

  5%|▍         | 245/5000 [30:50<8:59:06,  6.80s/it]------------------ Training Record ------------------
Epoch: 245/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1025, reward_valid_std=4.1793
[BatchDiag] adv_mean=-0.0033, adv_std=0.3403, adv_abs_mean=0.2298 | ret_mean=8.9418, ret_std=0.6000 | val_mean=8.9451, val_std=0.4861 | explained_var=0.678288
[GradSplit pre-clip] backbone=0.335093, critic=0.342396
[Loss] pg_loss=-0.113040, entropy_loss=0.000013, value_loss=0.009395
[EpochKL] epoch=0 mean_kl=0.00312 max_kl=0.00690
[EpochKL] epoch=1 mean_kl=0.00738 max_kl=0.01183
[EpochKL] epoch=2 mean_kl=0.00804 max_kl=0.01417
[Time] Env Create Time: 4.3804s |Rollout Collect Time: 1.6893s |Loss & Update :0.9654
[PPODiag] kl_mean=0.0062, kl_p90=0.0117, kl_max=0.0142 | clipfrac_mean=0.016, logratio_std_mean=0.126, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.681 | pg_loss_mean=0.0018, v_loss_mean=0.0277, ent_mean=0.0192 | gn_bb_mean=0.856, gn_bb_max=1.701 | gn_v_mean=0.253, gn_v_max=0.555
[AttnScore] scale=1.0392, C=10.0

  5%|▍         | 246/5000 [30:57<9:04:32,  6.87s/it]------------------ Training Record ------------------
Epoch: 246/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1076, reward_valid_std=4.1849
[BatchDiag] adv_mean=0.0067, adv_std=0.3185, adv_abs_mean=0.2204 | ret_mean=8.9516, ret_std=0.5863 | val_mean=8.9449, val_std=0.4935 | explained_var=0.704768
[GradSplit pre-clip] backbone=0.775336, critic=0.291803
[Loss] pg_loss=-0.064985, entropy_loss=0.000015, value_loss=0.007827
[EpochKL] epoch=0 mean_kl=0.00657 max_kl=0.02102
[EarlyStop] epoch=1 mean_kl=0.01008 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01008 max_kl=0.02619
[Time] Env Create Time: 4.6180s |Rollout Collect Time: 1.6943s |Loss & Update :0.6623
[PPODiag] kl_mean=0.0083, kl_p90=0.0168, kl_max=0.0262 | clipfrac_mean=0.018, logratio_std_mean=0.140, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.687, p10=0.680, min=0.679 | pg_loss_mean=0.0018, v_loss_mean=0.0242, ent_mean=0.0179 | gn_bb_mean=0.737, gn_bb_max=1.166 | gn_v_mean=0.262, gn_v_max=0.488

  5%|▍         | 247/5000 [31:04<9:06:51,  6.90s/it]------------------ Training Record ------------------
Epoch: 247/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1116, reward_valid_std=4.1862
[BatchDiag] adv_mean=0.0263, adv_std=0.3177, adv_abs_mean=0.2207 | ret_mean=8.9424, ret_std=0.5925 | val_mean=8.9162, val_std=0.4841 | explained_var=0.712465
[GradSplit pre-clip] backbone=0.614461, critic=0.597344
[Loss] pg_loss=-0.115703, entropy_loss=0.000011, value_loss=0.007759
[EpochKL] epoch=0 mean_kl=0.00311 max_kl=0.00719
[EpochKL] epoch=1 mean_kl=0.00504 max_kl=0.00787
[EarlyStop] epoch=2 mean_kl=0.01079 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01079 max_kl=0.02001
[Time] Env Create Time: 4.4256s |Rollout Collect Time: 1.6971s |Loss & Update :0.9570
[PPODiag] kl_mean=0.0063, kl_p90=0.0111, kl_max=0.0200 | clipfrac_mean=0.016, logratio_std_mean=0.126, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.685, p10=0.680, min=0.675 | pg_loss_mean=0.0016, v_loss_mean=0.0246, ent_mean=0.0164 | gn_bb_mean=0.776, gn_bb_max=1.357 | gn_v_mean=0.256, gn_v_max=0.597

  5%|▍         | 248/5000 [31:11<9:10:56,  6.96s/it]------------------ Training Record ------------------
Epoch: 248/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0942, reward_valid_std=4.1811
[BatchDiag] adv_mean=0.0084, adv_std=0.3301, adv_abs_mean=0.2248 | ret_mean=8.9397, ret_std=0.5981 | val_mean=8.9313, val_std=0.5045 | explained_var=0.695452
[GradSplit pre-clip] backbone=0.269524, critic=0.257057
[Loss] pg_loss=-0.044198, entropy_loss=0.000013, value_loss=0.009104
[EpochKL] epoch=0 mean_kl=0.00721 max_kl=0.01778
[EarlyStop] epoch=1 mean_kl=0.01858 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01858 max_kl=0.03968
[Time] Env Create Time: 4.4256s |Rollout Collect Time: 1.6887s |Loss & Update :0.6700
[PPODiag] kl_mean=0.0129, kl_p90=0.0277, kl_max=0.0397 | clipfrac_mean=0.021, logratio_std_mean=0.179, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.678 | pg_loss_mean=0.0044, v_loss_mean=0.0273, ent_mean=0.0202 | gn_bb_mean=1.179, gn_bb_max=2.532 | gn_v_mean=0.398, gn_v_max=0.773

  5%|▍         | 249/5000 [31:17<9:06:44,  6.90s/it]------------------ Training Record ------------------
Epoch: 249/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.588, reward_valid_mean=2.1081, reward_valid_std=4.1860
[BatchDiag] adv_mean=0.0000, adv_std=0.3262, adv_abs_mean=0.2224 | ret_mean=8.9398, ret_std=0.5905 | val_mean=8.9397, val_std=0.4822 | explained_var=0.694789
[GradSplit pre-clip] backbone=1.452505, critic=0.133365
[Loss] pg_loss=0.020509, entropy_loss=0.000013, value_loss=0.011271
[EpochKL] epoch=0 mean_kl=0.00522 max_kl=0.01202
[EpochKL] epoch=1 mean_kl=0.00703 max_kl=0.01557
[EarlyStop] epoch=2 mean_kl=0.02727 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02727 max_kl=0.04094
[Time] Env Create Time: 4.4129s |Rollout Collect Time: 1.9368s |Loss & Update :1.0879
[PPODiag] kl_mean=0.0132, kl_p90=0.0338, kl_max=0.0409 | clipfrac_mean=0.021, logratio_std_mean=0.184, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.588, p10=0.582, min=0.581 | pg_loss_mean=0.0034, v_loss_mean=0.0261, ent_mean=0.0159 | gn_bb_mean=1.001, gn_bb_max=3.772 | gn_v_mean=0.430, gn_v_max=0.712

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.035, Step: 7, Avg Done Step: 6.58, #CS visited: 0.15
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8191s
-----------------------------
  5%|▌         | 250/5000 [31:27<10:03:20,  7.62s/it]------------------ Training Record ------------------
Epoch: 250/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1036, reward_valid_std=4.1882
[BatchDiag] adv_mean=0.0113, adv_std=0.3385, adv_abs_mean=0.2330 | ret_mean=8.9386, ret_std=0.6136 | val_mean=8.9273, val_std=0.4695 | explained_var=0.695600
[GradSplit pre-clip] backbone=0.806257, critic=0.435560
[Loss] pg_loss=-0.063357, entropy_loss=0.000013, value_loss=0.012020
[EpochKL] epoch=0 mean_kl=0.00399 max_kl=0.01033
[EarlyStop] epoch=1 mean_kl=0.01709 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01709 max_kl=0.04038
[Time] Env Create Time: 4.4150s |Rollout Collect Time: 1.8823s |Loss & Update :0.6573
[PPODiag] kl_mean=0.0105, kl_p90=0.0232, kl_max=0.0404 | clipfrac_mean=0.021, logratio_std_mean=0.158, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.677 | pg_loss_mean=0.0035, v_loss_mean=0.0278, ent_mean=0.0183 | gn_bb_mean=0.954, gn_bb_max=1.948 | gn_v_mean=0.293, gn_v_max=0.807
[AttnScore] scale=1.0395, C=10.0

  5%|▌         | 251/5000 [31:34<9:47:24,  7.42s/it] ------------------ Training Record ------------------
Epoch: 251/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1074, reward_valid_std=4.1859
[BatchDiag] adv_mean=0.0050, adv_std=0.3367, adv_abs_mean=0.2271 | ret_mean=8.9428, ret_std=0.6055 | val_mean=8.9378, val_std=0.4711 | explained_var=0.690815
[GradSplit pre-clip] backbone=1.008293, critic=0.132903
[Loss] pg_loss=0.050006, entropy_loss=0.000020, value_loss=0.012289
[EpochKL] epoch=0 mean_kl=0.00548 max_kl=0.01054
[EarlyStop] epoch=1 mean_kl=0.01774 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01774 max_kl=0.02674
[Time] Env Create Time: 4.4008s |Rollout Collect Time: 1.6888s |Loss & Update :0.6605
[PPODiag] kl_mean=0.0116, kl_p90=0.0213, kl_max=0.0267 | clipfrac_mean=0.020, logratio_std_mean=0.188, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.680 | pg_loss_mean=0.0013, v_loss_mean=0.0268, ent_mean=0.0167 | gn_bb_mean=0.686, gn_bb_max=1.322 | gn_v_mean=0.371, gn_v_max=0.703

  5%|▌         | 252/5000 [31:40<9:31:21,  7.22s/it]------------------ Training Record ------------------
Epoch: 252/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.0993, reward_valid_std=4.1855
[BatchDiag] adv_mean=0.0136, adv_std=0.3258, adv_abs_mean=0.2212 | ret_mean=8.9294, ret_std=0.6026 | val_mean=8.9158, val_std=0.5003 | explained_var=0.707777
[GradSplit pre-clip] backbone=0.429138, critic=0.532965
[Loss] pg_loss=-0.131023, entropy_loss=0.000013, value_loss=0.007627
[EpochKL] epoch=0 mean_kl=0.00292 max_kl=0.00534
[EarlyStop] epoch=1 mean_kl=0.01042 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01042 max_kl=0.01519
[Time] Env Create Time: 4.3975s |Rollout Collect Time: 1.6878s |Loss & Update :0.6640
[PPODiag] kl_mean=0.0067, kl_p90=0.0118, kl_max=0.0152 | clipfrac_mean=0.013, logratio_std_mean=0.131, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.680, min=0.678 | pg_loss_mean=0.0007, v_loss_mean=0.0256, ent_mean=0.0153 | gn_bb_mean=0.612, gn_bb_max=0.992 | gn_v_mean=0.348, gn_v_max=0.602

  5%|▌         | 253/5000 [31:47<9:20:03,  7.08s/it]------------------ Training Record ------------------
Epoch: 253/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1091, reward_valid_std=4.1851
[BatchDiag] adv_mean=-0.0082, adv_std=0.3248, adv_abs_mean=0.2188 | ret_mean=8.9404, ret_std=0.5954 | val_mean=8.9487, val_std=0.5077 | explained_var=0.702508
[GradSplit pre-clip] backbone=0.834291, critic=0.288780
[Loss] pg_loss=-0.104381, entropy_loss=0.000014, value_loss=0.009450
[EpochKL] epoch=0 mean_kl=0.00181 max_kl=0.00473
[EpochKL] epoch=1 mean_kl=0.00658 max_kl=0.01104
[EpochKL] epoch=2 mean_kl=0.00556 max_kl=0.01011
[Time] Env Create Time: 4.4027s |Rollout Collect Time: 1.6923s |Loss & Update :0.9565
[PPODiag] kl_mean=0.0047, kl_p90=0.0087, kl_max=0.0110 | clipfrac_mean=0.013, logratio_std_mean=0.105, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.679 | pg_loss_mean=0.0001, v_loss_mean=0.0255, ent_mean=0.0150 | gn_bb_mean=0.587, gn_bb_max=0.963 | gn_v_mean=0.326, gn_v_max=0.644

  5%|▌         | 254/5000 [31:54<9:19:18,  7.07s/it]------------------ Training Record ------------------
Epoch: 254/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1029, reward_valid_std=4.1859
[BatchDiag] adv_mean=-0.0510, adv_std=0.3289, adv_abs_mean=0.2139 | ret_mean=8.9377, ret_std=0.6004 | val_mean=8.9887, val_std=0.5113 | explained_var=0.700011
[GradSplit pre-clip] backbone=0.799436, critic=0.295172
[Loss] pg_loss=-0.050699, entropy_loss=0.000013, value_loss=0.009576
[EpochKL] epoch=0 mean_kl=0.00627 max_kl=0.02135
[EpochKL] epoch=1 mean_kl=0.00873 max_kl=0.01096
[EpochKL] epoch=2 mean_kl=0.00787 max_kl=0.01264
[Time] Env Create Time: 4.4176s |Rollout Collect Time: 1.6909s |Loss & Update :0.9581
[PPODiag] kl_mean=0.0076, kl_p90=0.0119, kl_max=0.0213 | clipfrac_mean=0.020, logratio_std_mean=0.135, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.676 | pg_loss_mean=0.0015, v_loss_mean=0.0260, ent_mean=0.0169 | gn_bb_mean=0.722, gn_bb_max=1.328 | gn_v_mean=0.390, gn_v_max=0.875

  5%|▌         | 255/5000 [32:01<9:19:05,  7.07s/it]------------------ Training Record ------------------
Epoch: 255/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1044, reward_valid_std=4.1817
[BatchDiag] adv_mean=-0.0607, adv_std=0.3149, adv_abs_mean=0.2105 | ret_mean=8.9496, ret_std=0.5803 | val_mean=9.0103, val_std=0.4992 | explained_var=0.705597
[GradSplit pre-clip] backbone=0.559462, critic=0.502434
[Loss] pg_loss=0.009008, entropy_loss=0.000015, value_loss=0.011097
[EpochKL] epoch=0 mean_kl=0.00412 max_kl=0.00744
[EarlyStop] epoch=1 mean_kl=0.01488 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01488 max_kl=0.02727
[Time] Env Create Time: 4.4159s |Rollout Collect Time: 1.6992s |Loss & Update :0.6517
[PPODiag] kl_mean=0.0095, kl_p90=0.0215, kl_max=0.0273 | clipfrac_mean=0.018, logratio_std_mean=0.145, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.682 | pg_loss_mean=0.0030, v_loss_mean=0.0241, ent_mean=0.0188 | gn_bb_mean=0.906, gn_bb_max=2.243 | gn_v_mean=0.312, gn_v_max=0.502
[AttnScore] scale=1.0396, C=10.0

  5%|▌         | 256/5000 [32:08<9:11:48,  6.98s/it]------------------ Training Record ------------------
Epoch: 256/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1119, reward_valid_std=4.1830
[BatchDiag] adv_mean=-0.0154, adv_std=0.3003, adv_abs_mean=0.2052 | ret_mean=8.9560, ret_std=0.5817 | val_mean=8.9714, val_std=0.4850 | explained_var=0.733516
[GradSplit pre-clip] backbone=0.305289, critic=0.147289
[Loss] pg_loss=-0.078843, entropy_loss=0.000014, value_loss=0.007157
[EarlyStop] epoch=0 mean_kl=0.02362 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02362 max_kl=0.06124
[Time] Env Create Time: 4.6030s |Rollout Collect Time: 1.6924s |Loss & Update :0.3597
[PPODiag] kl_mean=0.0236, kl_p90=0.0507, kl_max=0.0612 | clipfrac_mean=0.022, logratio_std_mean=0.289, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.681 | pg_loss_mean=0.0062, v_loss_mean=0.0235, ent_mean=0.0179 | gn_bb_mean=0.802, gn_bb_max=1.097 | gn_v_mean=0.210, gn_v_max=0.475

  5%|▌         | 257/5000 [32:15<9:04:01,  6.88s/it]------------------ Training Record ------------------
Epoch: 257/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1108, reward_valid_std=4.1822
[BatchDiag] adv_mean=-0.0240, adv_std=0.3219, adv_abs_mean=0.2135 | ret_mean=8.9660, ret_std=0.5844 | val_mean=8.9900, val_std=0.4688 | explained_var=0.696581
[GradSplit pre-clip] backbone=0.505045, critic=0.153439
[Loss] pg_loss=-0.023399, entropy_loss=0.000016, value_loss=0.011510
[EpochKL] epoch=0 mean_kl=0.00806 max_kl=0.03032
[EpochKL] epoch=1 mean_kl=0.00556 max_kl=0.00797
[EarlyStop] epoch=2 mean_kl=0.01430 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01430 max_kl=0.02573
[Time] Env Create Time: 4.4514s |Rollout Collect Time: 1.7052s |Loss & Update :0.9552
[PPODiag] kl_mean=0.0093, kl_p90=0.0195, kl_max=0.0303 | clipfrac_mean=0.018, logratio_std_mean=0.150, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.681 | pg_loss_mean=0.0017, v_loss_mean=0.0244, ent_mean=0.0174 | gn_bb_mean=0.850, gn_bb_max=3.787 | gn_v_mean=0.209, gn_v_max=0.430

  5%|▌         | 258/5000 [32:22<9:09:21,  6.95s/it]------------------ Training Record ------------------
Epoch: 258/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0930, reward_valid_std=4.1802
[BatchDiag] adv_mean=-0.0445, adv_std=0.3187, adv_abs_mean=0.2083 | ret_mean=8.9446, ret_std=0.5995 | val_mean=8.9891, val_std=0.4806 | explained_var=0.717404
[GradSplit pre-clip] backbone=0.374850, critic=0.302996
[Loss] pg_loss=-0.019589, entropy_loss=0.000015, value_loss=0.010055
[EpochKL] epoch=0 mean_kl=0.00209 max_kl=0.00445
[EarlyStop] epoch=1 mean_kl=0.01284 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01284 max_kl=0.02360
[Time] Env Create Time: 4.5006s |Rollout Collect Time: 1.9307s |Loss & Update :0.7340
[PPODiag] kl_mean=0.0075, kl_p90=0.0212, kl_max=0.0236 | clipfrac_mean=0.015, logratio_std_mean=0.123, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.592, p10=0.589, min=0.587 | pg_loss_mean=0.0033, v_loss_mean=0.0248, ent_mean=0.0161 | gn_bb_mean=1.115, gn_bb_max=2.965 | gn_v_mean=0.262, gn_v_max=0.579

  5%|▌         | 259/5000 [32:29<9:14:20,  7.02s/it]------------------ Training Record ------------------
Epoch: 259/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1087, reward_valid_std=4.1802
[BatchDiag] adv_mean=-0.0107, adv_std=0.3075, adv_abs_mean=0.2049 | ret_mean=8.9524, ret_std=0.5903 | val_mean=8.9631, val_std=0.5011 | explained_var=0.728600
[GradSplit pre-clip] backbone=0.974450, critic=0.291802
[Loss] pg_loss=-0.131296, entropy_loss=0.000017, value_loss=0.007696
[EpochKL] epoch=0 mean_kl=0.00579 max_kl=0.01457
[EpochKL] epoch=1 mean_kl=0.00581 max_kl=0.00967
[EpochKL] epoch=2 mean_kl=0.00948 max_kl=0.01572
[Time] Env Create Time: 4.4307s |Rollout Collect Time: 1.7107s |Loss & Update :0.9616
[PPODiag] kl_mean=0.0070, kl_p90=0.0126, kl_max=0.0157 | clipfrac_mean=0.017, logratio_std_mean=0.130, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.682 | pg_loss_mean=0.0028, v_loss_mean=0.0235, ent_mean=0.0174 | gn_bb_mean=0.830, gn_bb_max=2.640 | gn_v_mean=0.223, gn_v_max=0.336

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.980, Step: 7, Avg Done Step: 6.61, #CS visited: 0.12
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8222s
-----------------------------
  5%|▌         | 260/5000 [32:38<10:00:54,  7.61s/it]------------------ Training Record ------------------
Epoch: 260/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1090, reward_valid_std=4.1753
[BatchDiag] adv_mean=0.0144, adv_std=0.3105, adv_abs_mean=0.2156 | ret_mean=8.9505, ret_std=0.5852 | val_mean=8.9361, val_std=0.4938 | explained_var=0.718485
[GradSplit pre-clip] backbone=0.258399, critic=0.271843
[Loss] pg_loss=0.017693, entropy_loss=0.000014, value_loss=0.010083
[EpochKL] epoch=0 mean_kl=0.00229 max_kl=0.00743
[EpochKL] epoch=1 mean_kl=0.00501 max_kl=0.01056
[EpochKL] epoch=2 mean_kl=0.00684 max_kl=0.00837
[Time] Env Create Time: 4.4246s |Rollout Collect Time: 1.6929s |Loss & Update :0.9687
[PPODiag] kl_mean=0.0047, kl_p90=0.0081, kl_max=0.0106 | clipfrac_mean=0.014, logratio_std_mean=0.107, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.682 | pg_loss_mean=0.0015, v_loss_mean=0.0231, ent_mean=0.0172 | gn_bb_mean=0.700, gn_bb_max=1.375 | gn_v_mean=0.263, gn_v_max=0.566
[AttnScore] scale=1.0400, C=10.0

  5%|▌         | 261/5000 [32:45<9:48:27,  7.45s/it] ------------------ Training Record ------------------
Epoch: 261/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1118, reward_valid_std=4.1822
[BatchDiag] adv_mean=-0.0147, adv_std=0.3058, adv_abs_mean=0.1970 | ret_mean=8.9503, ret_std=0.5788 | val_mean=8.9650, val_std=0.4930 | explained_var=0.720844
[GradSplit pre-clip] backbone=2.656678, critic=0.203441
[Loss] pg_loss=-0.097402, entropy_loss=0.000013, value_loss=0.008974
[EpochKL] epoch=0 mean_kl=0.00844 max_kl=0.02696
[EarlyStop] epoch=1 mean_kl=0.02740 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02740 max_kl=0.06143
[Time] Env Create Time: 4.4062s |Rollout Collect Time: 1.6948s |Loss & Update :0.6607
[PPODiag] kl_mean=0.0179, kl_p90=0.0331, kl_max=0.0614 | clipfrac_mean=0.022, logratio_std_mean=0.235, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.682, min=0.680 | pg_loss_mean=0.0057, v_loss_mean=0.0241, ent_mean=0.0187 | gn_bb_mean=1.267, gn_bb_max=2.783 | gn_v_mean=0.386, gn_v_max=0.809

  5%|▌         | 262/5000 [32:52<9:32:01,  7.24s/it]------------------ Training Record ------------------
Epoch: 262/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1014, reward_valid_std=4.1790
[BatchDiag] adv_mean=-0.0122, adv_std=0.3297, adv_abs_mean=0.2198 | ret_mean=8.9387, ret_std=0.5953 | val_mean=8.9508, val_std=0.5020 | explained_var=0.693288
[GradSplit pre-clip] backbone=0.403696, critic=0.217159
[Loss] pg_loss=-0.073528, entropy_loss=0.000017, value_loss=0.009594
[EpochKL] epoch=0 mean_kl=0.00250 max_kl=0.00526
[EpochKL] epoch=1 mean_kl=0.00851 max_kl=0.01698
[EarlyStop] epoch=2 mean_kl=0.01135 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01135 max_kl=0.02083
[Time] Env Create Time: 4.6898s |Rollout Collect Time: 1.7470s |Loss & Update :0.9591
[PPODiag] kl_mean=0.0075, kl_p90=0.0169, kl_max=0.0208 | clipfrac_mean=0.017, logratio_std_mean=0.134, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.681 | pg_loss_mean=0.0028, v_loss_mean=0.0260, ent_mean=0.0187 | gn_bb_mean=0.888, gn_bb_max=1.736 | gn_v_mean=0.341, gn_v_max=0.607

  5%|▌         | 263/5000 [32:59<9:35:31,  7.29s/it]------------------ Training Record ------------------
Epoch: 263/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1047, reward_valid_std=4.1849
[BatchDiag] adv_mean=-0.0120, adv_std=0.3248, adv_abs_mean=0.2135 | ret_mean=8.9503, ret_std=0.5872 | val_mean=8.9623, val_std=0.5174 | explained_var=0.694015
[GradSplit pre-clip] backbone=0.379679, critic=0.195969
[Loss] pg_loss=-0.058166, entropy_loss=0.000013, value_loss=0.009515
[EpochKL] epoch=0 mean_kl=0.00184 max_kl=0.00324
[EpochKL] epoch=1 mean_kl=0.00584 max_kl=0.00969
[EpochKL] epoch=2 mean_kl=0.00529 max_kl=0.01151
[Time] Env Create Time: 4.4534s |Rollout Collect Time: 1.7030s |Loss & Update :0.9668
[PPODiag] kl_mean=0.0043, kl_p90=0.0078, kl_max=0.0115 | clipfrac_mean=0.013, logratio_std_mean=0.105, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.682 | pg_loss_mean=0.0010, v_loss_mean=0.0245, ent_mean=0.0162 | gn_bb_mean=0.707, gn_bb_max=1.821 | gn_v_mean=0.264, gn_v_max=0.524

  5%|▌         | 264/5000 [33:06<9:31:28,  7.24s/it]------------------ Training Record ------------------
Epoch: 264/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1004, reward_valid_std=4.1783
[BatchDiag] adv_mean=-0.0249, adv_std=0.3140, adv_abs_mean=0.2093 | ret_mean=8.9457, ret_std=0.5812 | val_mean=8.9705, val_std=0.5035 | explained_var=0.707990
[GradSplit pre-clip] backbone=0.640481, critic=0.233357
[Loss] pg_loss=-0.008437, entropy_loss=0.000017, value_loss=0.011029
[EpochKL] epoch=0 mean_kl=0.00162 max_kl=0.00279
[EpochKL] epoch=1 mean_kl=0.00857 max_kl=0.01301
[EarlyStop] epoch=2 mean_kl=0.02647 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02647 max_kl=0.04780
[Time] Env Create Time: 4.4110s |Rollout Collect Time: 1.7064s |Loss & Update :0.9630
[PPODiag] kl_mean=0.0122, kl_p90=0.0377, kl_max=0.0478 | clipfrac_mean=0.021, logratio_std_mean=0.179, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.683 | pg_loss_mean=0.0038, v_loss_mean=0.0240, ent_mean=0.0184 | gn_bb_mean=1.051, gn_bb_max=1.913 | gn_v_mean=0.288, gn_v_max=0.481

  5%|▌         | 265/5000 [33:13<9:27:35,  7.19s/it]------------------ Training Record ------------------
Epoch: 265/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1036, reward_valid_std=4.1797
[BatchDiag] adv_mean=-0.0362, adv_std=0.3223, adv_abs_mean=0.2124 | ret_mean=8.9588, ret_std=0.5920 | val_mean=8.9950, val_std=0.5073 | explained_var=0.703561
[GradSplit pre-clip] backbone=0.356253, critic=0.225630
[Loss] pg_loss=-0.062166, entropy_loss=0.000014, value_loss=0.008386
[EpochKL] epoch=0 mean_kl=0.00338 max_kl=0.00633
[EpochKL] epoch=1 mean_kl=0.00947 max_kl=0.01639
[EarlyStop] epoch=2 mean_kl=0.02883 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02883 max_kl=0.05180
[Time] Env Create Time: 4.4112s |Rollout Collect Time: 1.7107s |Loss & Update :0.9555
[PPODiag] kl_mean=0.0139, kl_p90=0.0326, kl_max=0.0518 | clipfrac_mean=0.022, logratio_std_mean=0.201, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.679 | pg_loss_mean=0.0042, v_loss_mean=0.0250, ent_mean=0.0176 | gn_bb_mean=0.943, gn_bb_max=1.666 | gn_v_mean=0.230, gn_v_max=0.450
[AttnScore] scale=1.0413, C=10.0

  5%|▌         | 266/5000 [33:21<9:24:45,  7.16s/it]------------------ Training Record ------------------
Epoch: 266/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.1013, reward_valid_std=4.1711
[BatchDiag] adv_mean=0.0255, adv_std=0.3174, adv_abs_mean=0.2222 | ret_mean=8.9602, ret_std=0.5785 | val_mean=8.9347, val_std=0.5010 | explained_var=0.698982
[GradSplit pre-clip] backbone=0.328995, critic=0.289970
[Loss] pg_loss=0.000654, entropy_loss=0.000016, value_loss=0.010329
[EarlyStop] epoch=0 mean_kl=0.01237 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01237 max_kl=0.03028
[Time] Env Create Time: 4.4031s |Rollout Collect Time: 1.6864s |Loss & Update :0.3531
[PPODiag] kl_mean=0.0124, kl_p90=0.0295, kl_max=0.0303 | clipfrac_mean=0.021, logratio_std_mean=0.182, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.691, p10=0.687, min=0.686 | pg_loss_mean=0.0035, v_loss_mean=0.0255, ent_mean=0.0196 | gn_bb_mean=1.077, gn_bb_max=1.535 | gn_v_mean=0.340, gn_v_max=0.713

  5%|▌         | 267/5000 [33:27<9:07:43,  6.94s/it]------------------ Training Record ------------------
Epoch: 267/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.0987, reward_valid_std=4.1767
[BatchDiag] adv_mean=-0.0023, adv_std=0.3391, adv_abs_mean=0.2284 | ret_mean=8.9383, ret_std=0.6019 | val_mean=8.9406, val_std=0.4986 | explained_var=0.682570
[GradSplit pre-clip] backbone=0.737331, critic=0.396111
[Loss] pg_loss=-0.104130, entropy_loss=0.000012, value_loss=0.010098
[EpochKL] epoch=0 mean_kl=0.00290 max_kl=0.00703
[EarlyStop] epoch=1 mean_kl=0.01309 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01309 max_kl=0.02153
[Time] Env Create Time: 4.4069s |Rollout Collect Time: 1.9314s |Loss & Update :0.7309
[PPODiag] kl_mean=0.0080, kl_p90=0.0153, kl_max=0.0215 | clipfrac_mean=0.017, logratio_std_mean=0.125, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.588, min=0.587 | pg_loss_mean=0.0044, v_loss_mean=0.0270, ent_mean=0.0147 | gn_bb_mean=1.282, gn_bb_max=2.732 | gn_v_mean=0.295, gn_v_max=0.510

  5%|▌         | 268/5000 [33:34<9:10:35,  6.98s/it]------------------ Training Record ------------------
Epoch: 268/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0943, reward_valid_std=4.1690
[BatchDiag] adv_mean=-0.0323, adv_std=0.3237, adv_abs_mean=0.2143 | ret_mean=8.9385, ret_std=0.5862 | val_mean=8.9708, val_std=0.4736 | explained_var=0.695175
[GradSplit pre-clip] backbone=0.588314, critic=0.189862
[Loss] pg_loss=-0.034576, entropy_loss=0.000020, value_loss=0.010793
[EpochKL] epoch=0 mean_kl=0.00930 max_kl=0.01719
[EarlyStop] epoch=1 mean_kl=0.02889 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02889 max_kl=0.05689
[Time] Env Create Time: 4.6027s |Rollout Collect Time: 1.6930s |Loss & Update :0.6509
[PPODiag] kl_mean=0.0191, kl_p90=0.0403, kl_max=0.0569 | clipfrac_mean=0.024, logratio_std_mean=0.253, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.691, p10=0.687, min=0.686 | pg_loss_mean=0.0058, v_loss_mean=0.0260, ent_mean=0.0203 | gn_bb_mean=1.043, gn_bb_max=3.175 | gn_v_mean=0.311, gn_v_max=0.688

  5%|▌         | 269/5000 [33:41<9:09:40,  6.97s/it]------------------ Training Record ------------------
Epoch: 269/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1030, reward_valid_std=4.1817
[BatchDiag] adv_mean=-0.0023, adv_std=0.3195, adv_abs_mean=0.2172 | ret_mean=8.9522, ret_std=0.5973 | val_mean=8.9545, val_std=0.4967 | explained_var=0.713913
[GradSplit pre-clip] backbone=0.557059, critic=0.194803
[Loss] pg_loss=-0.005618, entropy_loss=0.000016, value_loss=0.014290
[EpochKL] epoch=0 mean_kl=0.00571 max_kl=0.01903
[EpochKL] epoch=1 mean_kl=0.00549 max_kl=0.01082
[EpochKL] epoch=2 mean_kl=0.00988 max_kl=0.01732
[Time] Env Create Time: 4.4226s |Rollout Collect Time: 1.6874s |Loss & Update :0.9660
[PPODiag] kl_mean=0.0070, kl_p90=0.0122, kl_max=0.0190 | clipfrac_mean=0.018, logratio_std_mean=0.137, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.683 | pg_loss_mean=0.0011, v_loss_mean=0.0244, ent_mean=0.0186 | gn_bb_mean=0.751, gn_bb_max=1.687 | gn_v_mean=0.223, gn_v_max=0.373

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.980, Step: 7, Avg Done Step: 6.61, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8449s
-----------------------------
  5%|▌         | 270/5000 [33:50<9:57:05,  7.57s/it]------------------ Training Record ------------------
Epoch: 270/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1058, reward_valid_std=4.1803
[BatchDiag] adv_mean=-0.0355, adv_std=0.3086, adv_abs_mean=0.2039 | ret_mean=8.9533, ret_std=0.5868 | val_mean=8.9888, val_std=0.4996 | explained_var=0.723492
[GradSplit pre-clip] backbone=0.369966, critic=0.223696
[Loss] pg_loss=-0.027874, entropy_loss=0.000012, value_loss=0.010661
[EpochKL] epoch=0 mean_kl=0.00273 max_kl=0.00884
[EpochKL] epoch=1 mean_kl=0.00774 max_kl=0.01300
[EpochKL] epoch=2 mean_kl=0.00766 max_kl=0.01352
[Time] Env Create Time: 4.3962s |Rollout Collect Time: 1.6953s |Loss & Update :0.9753
[PPODiag] kl_mean=0.0060, kl_p90=0.0127, kl_max=0.0135 | clipfrac_mean=0.016, logratio_std_mean=0.118, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.682 | pg_loss_mean=0.0025, v_loss_mean=0.0234, ent_mean=0.0173 | gn_bb_mean=0.777, gn_bb_max=1.318 | gn_v_mean=0.289, gn_v_max=0.512
[AttnScore] scale=1.0417, C=10.0

  5%|▌         | 271/5000 [33:57<9:44:58,  7.42s/it]------------------ Training Record ------------------
Epoch: 271/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1061, reward_valid_std=4.1790
[BatchDiag] adv_mean=-0.0396, adv_std=0.3084, adv_abs_mean=0.2023 | ret_mean=8.9564, ret_std=0.5859 | val_mean=8.9960, val_std=0.5099 | explained_var=0.723010
[GradSplit pre-clip] backbone=0.750447, critic=0.254544
[Loss] pg_loss=-0.049353, entropy_loss=0.000017, value_loss=0.010619
[EpochKL] epoch=0 mean_kl=0.00294 max_kl=0.00955
[EarlyStop] epoch=1 mean_kl=0.01085 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01085 max_kl=0.02717
[Time] Env Create Time: 4.4130s |Rollout Collect Time: 1.6920s |Loss & Update :0.6660
[PPODiag] kl_mean=0.0069, kl_p90=0.0142, kl_max=0.0272 | clipfrac_mean=0.015, logratio_std_mean=0.135, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.682 | pg_loss_mean=0.0020, v_loss_mean=0.0231, ent_mean=0.0178 | gn_bb_mean=0.774, gn_bb_max=1.372 | gn_v_mean=0.293, gn_v_max=0.596

  5%|▌         | 272/5000 [34:04<9:29:28,  7.23s/it]------------------ Training Record ------------------
Epoch: 272/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.593, reward_valid_mean=2.0951, reward_valid_std=4.1739
[BatchDiag] adv_mean=0.0092, adv_std=0.3080, adv_abs_mean=0.2120 | ret_mean=8.9521, ret_std=0.5834 | val_mean=8.9429, val_std=0.5200 | explained_var=0.721301
[GradSplit pre-clip] backbone=0.777411, critic=0.269441
[Loss] pg_loss=-0.054391, entropy_loss=0.000014, value_loss=0.009323
[EpochKL] epoch=0 mean_kl=0.00558 max_kl=0.01347
[EarlyStop] epoch=1 mean_kl=0.01912 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01912 max_kl=0.02822
[Time] Env Create Time: 4.4010s |Rollout Collect Time: 1.9224s |Loss & Update :0.7445
[PPODiag] kl_mean=0.0123, kl_p90=0.0244, kl_max=0.0282 | clipfrac_mean=0.022, logratio_std_mean=0.184, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.593, p10=0.586, min=0.584 | pg_loss_mean=0.0024, v_loss_mean=0.0230, ent_mean=0.0161 | gn_bb_mean=1.079, gn_bb_max=2.781 | gn_v_mean=0.217, gn_v_max=0.437

  5%|▌         | 273/5000 [34:11<9:25:36,  7.18s/it]------------------ Training Record ------------------
Epoch: 273/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1093, reward_valid_std=4.1768
[BatchDiag] adv_mean=-0.0025, adv_std=0.3141, adv_abs_mean=0.2150 | ret_mean=8.9539, ret_std=0.5817 | val_mean=8.9564, val_std=0.4864 | explained_var=0.708436
[GradSplit pre-clip] backbone=0.353507, critic=0.150628
[Loss] pg_loss=-0.023169, entropy_loss=0.000016, value_loss=0.009384
[EpochKL] epoch=0 mean_kl=0.00507 max_kl=0.01396
[EarlyStop] epoch=1 mean_kl=0.02032 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02032 max_kl=0.04322
[Time] Env Create Time: 4.6288s |Rollout Collect Time: 1.6933s |Loss & Update :0.6676
[PPODiag] kl_mean=0.0127, kl_p90=0.0285, kl_max=0.0432 | clipfrac_mean=0.020, logratio_std_mean=0.167, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.680 | pg_loss_mean=0.0054, v_loss_mean=0.0234, ent_mean=0.0185 | gn_bb_mean=1.560, gn_bb_max=6.391 | gn_v_mean=0.178, gn_v_max=0.312

  5%|▌         | 274/5000 [34:18<9:21:01,  7.12s/it]------------------ Training Record ------------------
Epoch: 274/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0873, reward_valid_std=4.1770
[BatchDiag] adv_mean=-0.0219, adv_std=0.3328, adv_abs_mean=0.2250 | ret_mean=8.9464, ret_std=0.6075 | val_mean=8.9683, val_std=0.4935 | explained_var=0.699876
[GradSplit pre-clip] backbone=0.900613, critic=0.165915
[Loss] pg_loss=-0.056145, entropy_loss=0.000019, value_loss=0.010134
[EarlyStop] epoch=0 mean_kl=0.01119 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01119 max_kl=0.03332
[Time] Env Create Time: 4.4418s |Rollout Collect Time: 1.6950s |Loss & Update :0.3596
[PPODiag] kl_mean=0.0112, kl_p90=0.0207, kl_max=0.0333 | clipfrac_mean=0.021, logratio_std_mean=0.143, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.693, p10=0.686, min=0.681 | pg_loss_mean=0.0031, v_loss_mean=0.0264, ent_mean=0.0192 | gn_bb_mean=0.974, gn_bb_max=1.681 | gn_v_mean=0.265, gn_v_max=0.432

  6%|▌         | 275/5000 [34:24<9:06:07,  6.93s/it]------------------ Training Record ------------------
Epoch: 275/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0966, reward_valid_std=4.1776
[BatchDiag] adv_mean=0.0432, adv_std=0.3237, adv_abs_mean=0.2298 | ret_mean=8.9535, ret_std=0.6051 | val_mean=8.9103, val_std=0.5102 | explained_var=0.713802
[GradSplit pre-clip] backbone=0.876794, critic=0.556831
[Loss] pg_loss=-0.046005, entropy_loss=0.000018, value_loss=0.009587
[EpochKL] epoch=0 mean_kl=0.00382 max_kl=0.00942
[EarlyStop] epoch=1 mean_kl=0.01017 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01017 max_kl=0.01974
[Time] Env Create Time: 4.4231s |Rollout Collect Time: 1.7009s |Loss & Update :0.6667
[PPODiag] kl_mean=0.0070, kl_p90=0.0127, kl_max=0.0197 | clipfrac_mean=0.016, logratio_std_mean=0.128, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.692, p10=0.686, min=0.678 | pg_loss_mean=0.0025, v_loss_mean=0.0253, ent_mean=0.0178 | gn_bb_mean=0.806, gn_bb_max=1.793 | gn_v_mean=0.362, gn_v_max=0.674
[AttnScore] scale=1.0421, C=10.0

  6%|▌         | 276/5000 [34:31<9:02:36,  6.89s/it]------------------ Training Record ------------------
Epoch: 276/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1014, reward_valid_std=4.1725
[BatchDiag] adv_mean=-0.0129, adv_std=0.3196, adv_abs_mean=0.2134 | ret_mean=8.9515, ret_std=0.5907 | val_mean=8.9644, val_std=0.4965 | explained_var=0.707233
[GradSplit pre-clip] backbone=0.482627, critic=0.245025
[Loss] pg_loss=-0.118474, entropy_loss=0.000020, value_loss=0.007392
[EpochKL] epoch=0 mean_kl=0.00368 max_kl=0.00807
[EpochKL] epoch=1 mean_kl=0.00830 max_kl=0.02191
[EarlyStop] epoch=2 mean_kl=0.01527 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01527 max_kl=0.03103
[Time] Env Create Time: 4.4148s |Rollout Collect Time: 1.6938s |Loss & Update :0.9664
[PPODiag] kl_mean=0.0091, kl_p90=0.0183, kl_max=0.0310 | clipfrac_mean=0.019, logratio_std_mean=0.162, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.681 | pg_loss_mean=0.0018, v_loss_mean=0.0248, ent_mean=0.0192 | gn_bb_mean=0.772, gn_bb_max=1.680 | gn_v_mean=0.390, gn_v_max=0.912

  6%|▌         | 277/5000 [34:38<9:06:49,  6.95s/it]------------------ Training Record ------------------
Epoch: 277/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1046, reward_valid_std=4.1800
[BatchDiag] adv_mean=0.0222, adv_std=0.2989, adv_abs_mean=0.2079 | ret_mean=8.9492, ret_std=0.5850 | val_mean=8.9270, val_std=0.5110 | explained_var=0.739020
[GradSplit pre-clip] backbone=0.629638, critic=0.227636
[Loss] pg_loss=0.033276, entropy_loss=0.000013, value_loss=0.011667
[EpochKL] epoch=0 mean_kl=0.00397 max_kl=0.00926
[EarlyStop] epoch=1 mean_kl=0.02382 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02382 max_kl=0.05205
[Time] Env Create Time: 4.4152s |Rollout Collect Time: 1.6946s |Loss & Update :0.6664
[PPODiag] kl_mean=0.0139, kl_p90=0.0366, kl_max=0.0520 | clipfrac_mean=0.021, logratio_std_mean=0.181, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.680 | pg_loss_mean=0.0056, v_loss_mean=0.0221, ent_mean=0.0190 | gn_bb_mean=1.557, gn_bb_max=7.348 | gn_v_mean=0.315, gn_v_max=0.678

  6%|▌         | 278/5000 [34:45<9:02:41,  6.90s/it]------------------ Training Record ------------------
Epoch: 278/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1024, reward_valid_std=4.1797
[BatchDiag] adv_mean=0.0189, adv_std=0.3052, adv_abs_mean=0.2116 | ret_mean=8.9488, ret_std=0.5774 | val_mean=8.9300, val_std=0.5027 | explained_var=0.720608
[GradSplit pre-clip] backbone=0.920470, critic=0.393636
[Loss] pg_loss=-0.059931, entropy_loss=0.000015, value_loss=0.008688
[EpochKL] epoch=0 mean_kl=0.00566 max_kl=0.01656
[EarlyStop] epoch=1 mean_kl=0.01231 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01231 max_kl=0.02268
[Time] Env Create Time: 4.4085s |Rollout Collect Time: 1.7117s |Loss & Update :0.6563
[PPODiag] kl_mean=0.0090, kl_p90=0.0160, kl_max=0.0227 | clipfrac_mean=0.020, logratio_std_mean=0.149, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.680 | pg_loss_mean=0.0021, v_loss_mean=0.0227, ent_mean=0.0181 | gn_bb_mean=0.894, gn_bb_max=2.062 | gn_v_mean=0.294, gn_v_max=0.633

  6%|▌         | 279/5000 [34:52<8:59:46,  6.86s/it]------------------ Training Record ------------------
Epoch: 279/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=8, valid_ratio=0.518, reward_valid_mean=2.0919, reward_valid_std=4.1810
[BatchDiag] adv_mean=0.0007, adv_std=0.3266, adv_abs_mean=0.2150 | ret_mean=8.9392, ret_std=0.6034 | val_mean=8.9385, val_std=0.5217 | explained_var=0.707044
[GradSplit pre-clip] backbone=0.509920, critic=0.467910
[Loss] pg_loss=-0.145965, entropy_loss=0.000010, value_loss=0.008146
[EpochKL] epoch=0 mean_kl=0.00512 max_kl=0.01376
[EpochKL] epoch=1 mean_kl=0.00634 max_kl=0.00774
[EpochKL] epoch=2 mean_kl=0.00955 max_kl=0.01642
[Time] Env Create Time: 4.3878s |Rollout Collect Time: 2.1788s |Loss & Update :1.1762
[PPODiag] kl_mean=0.0070, kl_p90=0.0144, kl_max=0.0164 | clipfrac_mean=0.016, logratio_std_mean=0.138, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.518, p10=0.514, min=0.512 | pg_loss_mean=0.0016, v_loss_mean=0.0257, ent_mean=0.0132 | gn_bb_mean=0.684, gn_bb_max=1.640 | gn_v_mean=0.243, gn_v_max=0.468

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.980, Step: 7, Avg Done Step: 6.63, #CS visited: 0.13
D->C5->C2->C3->D->C4->C1->D
Eval cost : 1.8161s
-----------------------------
  6%|▌         | 280/5000 [35:01<10:04:03,  7.68s/it]------------------ Training Record ------------------
Epoch: 280/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1012, reward_valid_std=4.1770
[BatchDiag] adv_mean=0.0155, adv_std=0.3135, adv_abs_mean=0.2162 | ret_mean=8.9480, ret_std=0.5898 | val_mean=8.9324, val_std=0.5054 | explained_var=0.717472
[GradSplit pre-clip] backbone=0.489524, critic=0.310791
[Loss] pg_loss=-0.037273, entropy_loss=0.000019, value_loss=0.011404
[EpochKL] epoch=0 mean_kl=0.00220 max_kl=0.00524
[EarlyStop] epoch=1 mean_kl=0.01063 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01063 max_kl=0.01898
[Time] Env Create Time: 4.6108s |Rollout Collect Time: 1.6993s |Loss & Update :0.6633
[PPODiag] kl_mean=0.0064, kl_p90=0.0144, kl_max=0.0190 | clipfrac_mean=0.015, logratio_std_mean=0.114, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.681 | pg_loss_mean=0.0019, v_loss_mean=0.0244, ent_mean=0.0180 | gn_bb_mean=0.790, gn_bb_max=1.384 | gn_v_mean=0.219, gn_v_max=0.316
[AttnScore] scale=1.0427, C=10.0

  6%|▌         | 281/5000 [35:08<9:47:18,  7.47s/it] ------------------ Training Record ------------------
Epoch: 281/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0930, reward_valid_std=4.1735
[BatchDiag] adv_mean=-0.0451, adv_std=0.3382, adv_abs_mean=0.2195 | ret_mean=8.9356, ret_std=0.6041 | val_mean=8.9806, val_std=0.5130 | explained_var=0.686502
[GradSplit pre-clip] backbone=0.733562, critic=0.142392
[Loss] pg_loss=-0.101597, entropy_loss=0.000015, value_loss=0.010195
[EpochKL] epoch=0 mean_kl=0.00238 max_kl=0.00433
[EarlyStop] epoch=1 mean_kl=0.02041 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02041 max_kl=0.04000
[Time] Env Create Time: 4.4304s |Rollout Collect Time: 1.9295s |Loss & Update :0.7409
[PPODiag] kl_mean=0.0114, kl_p90=0.0255, kl_max=0.0400 | clipfrac_mean=0.019, logratio_std_mean=0.157, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.592, p10=0.587, min=0.583 | pg_loss_mean=0.0043, v_loss_mean=0.0278, ent_mean=0.0155 | gn_bb_mean=1.571, gn_bb_max=9.849 | gn_v_mean=0.241, gn_v_max=0.627

  6%|▌         | 282/5000 [35:15<9:38:32,  7.36s/it]------------------ Training Record ------------------
Epoch: 282/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0998, reward_valid_std=4.1765
[BatchDiag] adv_mean=0.0022, adv_std=0.3230, adv_abs_mean=0.2200 | ret_mean=8.9545, ret_std=0.5944 | val_mean=8.9523, val_std=0.4935 | explained_var=0.704834
[GradSplit pre-clip] backbone=0.605537, critic=0.210390
[Loss] pg_loss=-0.039508, entropy_loss=0.000016, value_loss=0.010163
[EpochKL] epoch=0 mean_kl=0.00606 max_kl=0.02323
[EarlyStop] epoch=1 mean_kl=0.02906 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02906 max_kl=0.05189
[Time] Env Create Time: 4.4307s |Rollout Collect Time: 1.6948s |Loss & Update :0.6615
[PPODiag] kl_mean=0.0176, kl_p90=0.0348, kl_max=0.0519 | clipfrac_mean=0.019, logratio_std_mean=0.263, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.682 | pg_loss_mean=0.0040, v_loss_mean=0.0253, ent_mean=0.0186 | gn_bb_mean=1.050, gn_bb_max=1.986 | gn_v_mean=0.261, gn_v_max=0.512

  6%|▌         | 283/5000 [35:22<9:24:58,  7.19s/it]------------------ Training Record ------------------
Epoch: 283/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1070, reward_valid_std=4.1773
[BatchDiag] adv_mean=-0.0062, adv_std=0.3216, adv_abs_mean=0.2132 | ret_mean=8.9614, ret_std=0.5836 | val_mean=8.9676, val_std=0.4905 | explained_var=0.696259
[GradSplit pre-clip] backbone=1.096156, critic=0.162442
[Loss] pg_loss=-0.062492, entropy_loss=0.000019, value_loss=0.008969
[EpochKL] epoch=0 mean_kl=0.00865 max_kl=0.01730
[EarlyStop] epoch=1 mean_kl=0.01649 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01649 max_kl=0.04923
[Time] Env Create Time: 4.4074s |Rollout Collect Time: 1.6981s |Loss & Update :0.6563
[PPODiag] kl_mean=0.0126, kl_p90=0.0212, kl_max=0.0492 | clipfrac_mean=0.020, logratio_std_mean=0.196, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.681 | pg_loss_mean=0.0033, v_loss_mean=0.0255, ent_mean=0.0168 | gn_bb_mean=0.914, gn_bb_max=1.627 | gn_v_mean=0.230, gn_v_max=0.335

  6%|▌         | 284/5000 [35:29<9:14:51,  7.06s/it]------------------ Training Record ------------------
Epoch: 284/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1156, reward_valid_std=4.1818
[BatchDiag] adv_mean=-0.0209, adv_std=0.2984, adv_abs_mean=0.2004 | ret_mean=8.9735, ret_std=0.5742 | val_mean=8.9944, val_std=0.4758 | explained_var=0.729956
[GradSplit pre-clip] backbone=0.631786, critic=0.147551
[Loss] pg_loss=-0.081765, entropy_loss=0.000014, value_loss=0.007665
[EpochKL] epoch=0 mean_kl=0.00250 max_kl=0.00535
[EpochKL] epoch=1 mean_kl=0.00816 max_kl=0.01820
[EpochKL] epoch=2 mean_kl=0.00997 max_kl=0.01667
[Time] Env Create Time: 4.3950s |Rollout Collect Time: 1.9412s |Loss & Update :1.0661
[PPODiag] kl_mean=0.0069, kl_p90=0.0127, kl_max=0.0182 | clipfrac_mean=0.015, logratio_std_mean=0.127, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.589, p10=0.584, min=0.581 | pg_loss_mean=0.0026, v_loss_mean=0.0217, ent_mean=0.0142 | gn_bb_mean=0.732, gn_bb_max=1.232 | gn_v_mean=0.245, gn_v_max=0.576

  6%|▌         | 285/5000 [35:36<9:22:50,  7.16s/it]------------------ Training Record ------------------
Epoch: 285/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1078, reward_valid_std=4.1766
[BatchDiag] adv_mean=-0.0063, adv_std=0.3014, adv_abs_mean=0.2010 | ret_mean=8.9674, ret_std=0.5710 | val_mean=8.9737, val_std=0.5076 | explained_var=0.721390
[GradSplit pre-clip] backbone=0.558227, critic=0.150871
[Loss] pg_loss=-0.058925, entropy_loss=0.000017, value_loss=0.008521
[EpochKL] epoch=0 mean_kl=0.00227 max_kl=0.00331
[EarlyStop] epoch=1 mean_kl=0.01512 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01512 max_kl=0.02975
[Time] Env Create Time: 4.3799s |Rollout Collect Time: 1.7030s |Loss & Update :0.6620
[PPODiag] kl_mean=0.0087, kl_p90=0.0161, kl_max=0.0297 | clipfrac_mean=0.016, logratio_std_mean=0.153, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.681 | pg_loss_mean=0.0027, v_loss_mean=0.0223, ent_mean=0.0179 | gn_bb_mean=0.997, gn_bb_max=2.478 | gn_v_mean=0.250, gn_v_max=0.532
[AttnScore] scale=1.0434, C=10.0

  6%|▌         | 286/5000 [35:43<9:12:53,  7.04s/it]------------------ Training Record ------------------
Epoch: 286/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0920, reward_valid_std=4.1735
[BatchDiag] adv_mean=0.0074, adv_std=0.3324, adv_abs_mean=0.2255 | ret_mean=8.9320, ret_std=0.5970 | val_mean=8.9246, val_std=0.4903 | explained_var=0.690030
[GradSplit pre-clip] backbone=1.825511, critic=0.366517
[Loss] pg_loss=-0.079607, entropy_loss=0.000020, value_loss=0.010736
[EpochKL] epoch=0 mean_kl=0.00848 max_kl=0.01851
[EarlyStop] epoch=1 mean_kl=0.01852 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01852 max_kl=0.02616
[Time] Env Create Time: 4.6058s |Rollout Collect Time: 1.7096s |Loss & Update :0.6659
[PPODiag] kl_mean=0.0135, kl_p90=0.0249, kl_max=0.0262 | clipfrac_mean=0.023, logratio_std_mean=0.204, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.691, p10=0.684, min=0.681 | pg_loss_mean=0.0020, v_loss_mean=0.0270, ent_mean=0.0200 | gn_bb_mean=1.104, gn_bb_max=3.410 | gn_v_mean=0.328, gn_v_max=0.616

  6%|▌         | 287/5000 [35:50<9:11:28,  7.02s/it]------------------ Training Record ------------------
Epoch: 287/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0993, reward_valid_std=4.1717
[BatchDiag] adv_mean=-0.0441, adv_std=0.3278, adv_abs_mean=0.2095 | ret_mean=8.9458, ret_std=0.5989 | val_mean=8.9899, val_std=0.4856 | explained_var=0.700374
[GradSplit pre-clip] backbone=0.692929, critic=0.106565
[Loss] pg_loss=-0.109949, entropy_loss=0.000020, value_loss=0.008179
[EpochKL] epoch=0 mean_kl=0.00460 max_kl=0.00800
[EarlyStop] epoch=1 mean_kl=0.01404 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01404 max_kl=0.03628
[Time] Env Create Time: 4.4378s |Rollout Collect Time: 1.6906s |Loss & Update :0.6542
[PPODiag] kl_mean=0.0093, kl_p90=0.0207, kl_max=0.0363 | clipfrac_mean=0.018, logratio_std_mean=0.149, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.690, p10=0.683, min=0.681 | pg_loss_mean=0.0033, v_loss_mean=0.0258, ent_mean=0.0191 | gn_bb_mean=1.036, gn_bb_max=2.248 | gn_v_mean=0.322, gn_v_max=0.614

  6%|▌         | 288/5000 [35:57<9:05:45,  6.95s/it]------------------ Training Record ------------------
Epoch: 288/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1016, reward_valid_std=4.1768
[BatchDiag] adv_mean=-0.0168, adv_std=0.3100, adv_abs_mean=0.2076 | ret_mean=8.9344, ret_std=0.5916 | val_mean=8.9513, val_std=0.4717 | explained_var=0.725500
[GradSplit pre-clip] backbone=0.986674, critic=0.174060
[Loss] pg_loss=-0.038346, entropy_loss=0.000021, value_loss=0.010754
[EpochKL] epoch=0 mean_kl=0.00556 max_kl=0.01187
[EarlyStop] epoch=1 mean_kl=0.01402 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01402 max_kl=0.02871
[Time] Env Create Time: 4.4569s |Rollout Collect Time: 1.7043s |Loss & Update :0.6593
[PPODiag] kl_mean=0.0098, kl_p90=0.0248, kl_max=0.0287 | clipfrac_mean=0.016, logratio_std_mean=0.155, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.681 | pg_loss_mean=0.0035, v_loss_mean=0.0232, ent_mean=0.0172 | gn_bb_mean=0.984, gn_bb_max=1.784 | gn_v_mean=0.243, gn_v_max=0.501

  6%|▌         | 289/5000 [36:04<9:02:36,  6.91s/it]------------------ Training Record ------------------
Epoch: 289/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0910, reward_valid_std=4.1723
[BatchDiag] adv_mean=-0.0168, adv_std=0.3286, adv_abs_mean=0.2189 | ret_mean=8.9380, ret_std=0.6045 | val_mean=8.9549, val_std=0.4816 | explained_var=0.704400
[GradSplit pre-clip] backbone=0.352530, critic=0.198741
[Loss] pg_loss=-0.068065, entropy_loss=0.000015, value_loss=0.009921
[EpochKL] epoch=0 mean_kl=0.00448 max_kl=0.00824
[EarlyStop] epoch=1 mean_kl=0.01120 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01120 max_kl=0.03098
[Time] Env Create Time: 4.4422s |Rollout Collect Time: 1.6938s |Loss & Update :0.6624
[PPODiag] kl_mean=0.0078, kl_p90=0.0184, kl_max=0.0310 | clipfrac_mean=0.017, logratio_std_mean=0.137, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.692, p10=0.684, min=0.678 | pg_loss_mean=0.0025, v_loss_mean=0.0260, ent_mean=0.0184 | gn_bb_mean=1.074, gn_bb_max=2.569 | gn_v_mean=0.220, gn_v_max=0.472

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.966, Step: 8, Avg Done Step: 6.61, #CS visited: 0.13
D->C5->C2->C3->D->C4->C1->D
Eval cost : 1.9503s
-----------------------------
  6%|▌         | 290/5000 [36:13<9:47:23,  7.48s/it]------------------ Training Record ------------------
Epoch: 290/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0997, reward_valid_std=4.1732
[BatchDiag] adv_mean=0.0042, adv_std=0.3178, adv_abs_mean=0.2153 | ret_mean=8.9558, ret_std=0.5906 | val_mean=8.9516, val_std=0.5047 | explained_var=0.710348
[GradSplit pre-clip] backbone=1.106544, critic=0.272229
[Loss] pg_loss=-0.052457, entropy_loss=0.000021, value_loss=0.010522
[EpochKL] epoch=0 mean_kl=0.00362 max_kl=0.00766
[EarlyStop] epoch=1 mean_kl=0.02689 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02689 max_kl=0.04668
[Time] Env Create Time: 4.4235s |Rollout Collect Time: 1.8889s |Loss & Update :0.6651
[PPODiag] kl_mean=0.0153, kl_p90=0.0362, kl_max=0.0467 | clipfrac_mean=0.022, logratio_std_mean=0.207, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.691, p10=0.684, min=0.683 | pg_loss_mean=0.0050, v_loss_mean=0.0246, ent_mean=0.0203 | gn_bb_mean=1.097, gn_bb_max=1.816 | gn_v_mean=0.207, gn_v_max=0.447
[AttnScore] scale=1.0440, C=10.0

  6%|▌         | 291/5000 [36:20<9:35:23,  7.33s/it]------------------ Training Record ------------------
Epoch: 291/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1036, reward_valid_std=4.1764
[BatchDiag] adv_mean=0.0233, adv_std=0.3088, adv_abs_mean=0.2124 | ret_mean=8.9561, ret_std=0.5875 | val_mean=8.9329, val_std=0.5209 | explained_var=0.723802
[GradSplit pre-clip] backbone=0.597627, critic=0.409216
[Loss] pg_loss=-0.062100, entropy_loss=0.000017, value_loss=0.007876
[EpochKL] epoch=0 mean_kl=0.00350 max_kl=0.00913
[EarlyStop] epoch=1 mean_kl=0.01063 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01063 max_kl=0.01367
[Time] Env Create Time: 4.4201s |Rollout Collect Time: 1.6966s |Loss & Update :0.6455
[PPODiag] kl_mean=0.0071, kl_p90=0.0134, kl_max=0.0137 | clipfrac_mean=0.017, logratio_std_mean=0.130, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.682, min=0.682 | pg_loss_mean=0.0020, v_loss_mean=0.0235, ent_mean=0.0178 | gn_bb_mean=0.901, gn_bb_max=1.859 | gn_v_mean=0.274, gn_v_max=0.451

  6%|▌         | 292/5000 [36:26<9:21:52,  7.16s/it]------------------ Training Record ------------------
Epoch: 292/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1020, reward_valid_std=4.1796
[BatchDiag] adv_mean=-0.0279, adv_std=0.3217, adv_abs_mean=0.2129 | ret_mean=8.9478, ret_std=0.6034 | val_mean=8.9757, val_std=0.5085 | explained_var=0.715681
[GradSplit pre-clip] backbone=0.365881, critic=0.136236
[Loss] pg_loss=-0.057689, entropy_loss=0.000010, value_loss=0.009510
[EpochKL] epoch=0 mean_kl=0.00394 max_kl=0.01295
[EarlyStop] epoch=1 mean_kl=0.02328 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02328 max_kl=0.04018
[Time] Env Create Time: 4.4115s |Rollout Collect Time: 1.6950s |Loss & Update :0.6587
[PPODiag] kl_mean=0.0136, kl_p90=0.0320, kl_max=0.0402 | clipfrac_mean=0.018, logratio_std_mean=0.187, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.681 | pg_loss_mean=0.0041, v_loss_mean=0.0257, ent_mean=0.0173 | gn_bb_mean=1.076, gn_bb_max=2.178 | gn_v_mean=0.278, gn_v_max=0.541

  6%|▌         | 293/5000 [36:33<9:12:27,  7.04s/it]------------------ Training Record ------------------
Epoch: 293/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0966, reward_valid_std=4.1782
[BatchDiag] adv_mean=-0.0032, adv_std=0.3279, adv_abs_mean=0.2198 | ret_mean=8.9344, ret_std=0.5964 | val_mean=8.9376, val_std=0.4859 | explained_var=0.697803
[GradSplit pre-clip] backbone=0.941362, critic=0.210202
[Loss] pg_loss=-0.037929, entropy_loss=0.000019, value_loss=0.011840
[EpochKL] epoch=0 mean_kl=0.00637 max_kl=0.01471
[EarlyStop] epoch=1 mean_kl=0.02553 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02553 max_kl=0.04744
[Time] Env Create Time: 4.4169s |Rollout Collect Time: 1.6963s |Loss & Update :0.6651
[PPODiag] kl_mean=0.0160, kl_p90=0.0308, kl_max=0.0474 | clipfrac_mean=0.022, logratio_std_mean=0.213, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.681 | pg_loss_mean=0.0047, v_loss_mean=0.0262, ent_mean=0.0181 | gn_bb_mean=1.112, gn_bb_max=2.138 | gn_v_mean=0.295, gn_v_max=0.730

  6%|▌         | 294/5000 [36:40<9:06:08,  6.96s/it]------------------ Training Record ------------------
Epoch: 294/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1105, reward_valid_std=4.1824
[BatchDiag] adv_mean=-0.0125, adv_std=0.3221, adv_abs_mean=0.2178 | ret_mean=8.9489, ret_std=0.5825 | val_mean=8.9614, val_std=0.4873 | explained_var=0.694116
[GradSplit pre-clip] backbone=0.633286, critic=0.193190
[Loss] pg_loss=-0.040280, entropy_loss=0.000021, value_loss=0.008843
[EpochKL] epoch=0 mean_kl=0.00327 max_kl=0.00926
[EarlyStop] epoch=1 mean_kl=0.01626 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01626 max_kl=0.02401
[Time] Env Create Time: 4.4185s |Rollout Collect Time: 1.6977s |Loss & Update :0.6477
[PPODiag] kl_mean=0.0098, kl_p90=0.0202, kl_max=0.0240 | clipfrac_mean=0.021, logratio_std_mean=0.151, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.687, p10=0.680, min=0.679 | pg_loss_mean=0.0033, v_loss_mean=0.0246, ent_mean=0.0191 | gn_bb_mean=0.988, gn_bb_max=2.678 | gn_v_mean=0.220, gn_v_max=0.430

  6%|▌         | 295/5000 [36:47<9:01:21,  6.90s/it]------------------ Training Record ------------------
Epoch: 295/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1044, reward_valid_std=4.1788
[BatchDiag] adv_mean=-0.0158, adv_std=0.3251, adv_abs_mean=0.2190 | ret_mean=8.9448, ret_std=0.5922 | val_mean=8.9606, val_std=0.4817 | explained_var=0.698572
[GradSplit pre-clip] backbone=1.000821, critic=0.136398
[Loss] pg_loss=-0.016430, entropy_loss=0.000022, value_loss=0.011770
[EpochKL] epoch=0 mean_kl=0.00520 max_kl=0.00757
[EarlyStop] epoch=1 mean_kl=0.01393 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01393 max_kl=0.02688
[Time] Env Create Time: 4.4060s |Rollout Collect Time: 1.6970s |Loss & Update :0.6582
[PPODiag] kl_mean=0.0096, kl_p90=0.0169, kl_max=0.0269 | clipfrac_mean=0.023, logratio_std_mean=0.163, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.677 | pg_loss_mean=0.0039, v_loss_mean=0.0259, ent_mean=0.0217 | gn_bb_mean=1.611, gn_bb_max=5.454 | gn_v_mean=0.215, gn_v_max=0.351
[AttnScore] scale=1.0443, C=10.0

  6%|▌         | 296/5000 [36:53<8:57:54,  6.86s/it]------------------ Training Record ------------------
Epoch: 296/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1090, reward_valid_std=4.1849
[BatchDiag] adv_mean=-0.0134, adv_std=0.3181, adv_abs_mean=0.2097 | ret_mean=8.9556, ret_std=0.5788 | val_mean=8.9690, val_std=0.5018 | explained_var=0.698041
[GradSplit pre-clip] backbone=0.561827, critic=0.208176
[Loss] pg_loss=-0.096377, entropy_loss=0.000018, value_loss=0.008326
[EpochKL] epoch=0 mean_kl=0.00178 max_kl=0.00425
[EpochKL] epoch=1 mean_kl=0.00480 max_kl=0.00874
[EpochKL] epoch=2 mean_kl=0.00411 max_kl=0.00575
[Time] Env Create Time: 4.6089s |Rollout Collect Time: 1.7056s |Loss & Update :0.9751
[PPODiag] kl_mean=0.0036, kl_p90=0.0057, kl_max=0.0087 | clipfrac_mean=0.013, logratio_std_mean=0.091, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.681 | pg_loss_mean=0.0005, v_loss_mean=0.0243, ent_mean=0.0179 | gn_bb_mean=0.607, gn_bb_max=1.176 | gn_v_mean=0.225, gn_v_max=0.495

  6%|▌         | 297/5000 [37:01<9:07:52,  6.99s/it]------------------ Training Record ------------------
Epoch: 297/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1037, reward_valid_std=4.1817
[BatchDiag] adv_mean=-0.0183, adv_std=0.3220, adv_abs_mean=0.2122 | ret_mean=8.9513, ret_std=0.5950 | val_mean=8.9696, val_std=0.4967 | explained_var=0.707176
[GradSplit pre-clip] backbone=0.466733, critic=0.100355
[Loss] pg_loss=-0.047384, entropy_loss=0.000017, value_loss=0.008663
[EpochKL] epoch=0 mean_kl=0.00107 max_kl=0.00224
[EpochKL] epoch=1 mean_kl=0.00824 max_kl=0.02472
[EarlyStop] epoch=2 mean_kl=0.01118 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01118 max_kl=0.01576
[Time] Env Create Time: 4.4861s |Rollout Collect Time: 1.7046s |Loss & Update :0.9585
[PPODiag] kl_mean=0.0068, kl_p90=0.0143, kl_max=0.0247 | clipfrac_mean=0.015, logratio_std_mean=0.124, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.681 | pg_loss_mean=0.0021, v_loss_mean=0.0252, ent_mean=0.0170 | gn_bb_mean=0.933, gn_bb_max=2.595 | gn_v_mean=0.247, gn_v_max=0.647

  6%|▌         | 298/5000 [37:08<9:11:31,  7.04s/it]------------------ Training Record ------------------
Epoch: 298/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0980, reward_valid_std=4.1744
[BatchDiag] adv_mean=-0.0322, adv_std=0.3190, adv_abs_mean=0.2157 | ret_mean=8.9528, ret_std=0.5890 | val_mean=8.9850, val_std=0.5058 | explained_var=0.706727
[GradSplit pre-clip] backbone=1.679307, critic=0.159560
[Loss] pg_loss=-0.053360, entropy_loss=0.000018, value_loss=0.010919
[EpochKL] epoch=0 mean_kl=0.00711 max_kl=0.01425
[EarlyStop] epoch=1 mean_kl=0.01490 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01490 max_kl=0.02152
[Time] Env Create Time: 4.4325s |Rollout Collect Time: 1.6963s |Loss & Update :0.6496
[PPODiag] kl_mean=0.0110, kl_p90=0.0180, kl_max=0.0215 | clipfrac_mean=0.023, logratio_std_mean=0.179, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.684 | pg_loss_mean=0.0041, v_loss_mean=0.0253, ent_mean=0.0211 | gn_bb_mean=1.117, gn_bb_max=2.003 | gn_v_mean=0.282, gn_v_max=0.452

  6%|▌         | 299/5000 [37:15<9:05:19,  6.96s/it]------------------ Training Record ------------------
Epoch: 299/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1097, reward_valid_std=4.1775
[BatchDiag] adv_mean=-0.0055, adv_std=0.3182, adv_abs_mean=0.2157 | ret_mean=8.9610, ret_std=0.5715 | val_mean=8.9665, val_std=0.4688 | explained_var=0.690035
[GradSplit pre-clip] backbone=0.568000, critic=0.169187
[Loss] pg_loss=-0.031077, entropy_loss=0.000024, value_loss=0.010404
[EpochKL] epoch=0 mean_kl=0.00755 max_kl=0.01225
[EarlyStop] epoch=1 mean_kl=0.02079 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02079 max_kl=0.03784
[Time] Env Create Time: 4.4298s |Rollout Collect Time: 1.7043s |Loss & Update :0.6518
[PPODiag] kl_mean=0.0142, kl_p90=0.0313, kl_max=0.0378 | clipfrac_mean=0.024, logratio_std_mean=0.210, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.679 | pg_loss_mean=0.0058, v_loss_mean=0.0248, ent_mean=0.0214 | gn_bb_mean=2.135, gn_bb_max=15.617 | gn_v_mean=0.317, gn_v_max=0.543

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.977, Step: 7, Avg Done Step: 6.64, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8318s
-----------------------------
  6%|▌         | 300/5000 [37:23<9:45:00,  7.47s/it]------------------ Training Record ------------------
Epoch: 300/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0879, reward_valid_std=4.1692
[BatchDiag] adv_mean=-0.0647, adv_std=0.3373, adv_abs_mean=0.2189 | ret_mean=8.9481, ret_std=0.6011 | val_mean=9.0128, val_std=0.4895 | explained_var=0.685052
[GradSplit pre-clip] backbone=0.865106, critic=0.535725
[Loss] pg_loss=0.009605, entropy_loss=0.000018, value_loss=0.012590
[EpochKL] epoch=0 mean_kl=0.00403 max_kl=0.01081
[EpochKL] epoch=1 mean_kl=0.00878 max_kl=0.02196
[EarlyStop] epoch=2 mean_kl=0.04013 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.04013 max_kl=0.05893
[Time] Env Create Time: 4.4154s |Rollout Collect Time: 1.6933s |Loss & Update :0.9680
[PPODiag] kl_mean=0.0176, kl_p90=0.0528, kl_max=0.0589 | clipfrac_mean=0.022, logratio_std_mean=0.227, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.693, p10=0.689, min=0.685 | pg_loss_mean=0.0036, v_loss_mean=0.0278, ent_mean=0.0196 | gn_bb_mean=0.965, gn_bb_max=2.479 | gn_v_mean=0.251, gn_v_max=0.544
[AttnScore] scale=1.0445, C=10.0

  6%|▌         | 301/5000 [37:30<9:35:41,  7.35s/it]------------------ Training Record ------------------
Epoch: 301/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0972, reward_valid_std=4.1739
[BatchDiag] adv_mean=-0.0328, adv_std=0.3316, adv_abs_mean=0.2268 | ret_mean=8.9590, ret_std=0.5860 | val_mean=8.9918, val_std=0.4931 | explained_var=0.679837
[GradSplit pre-clip] backbone=0.764361, critic=0.206464
[Loss] pg_loss=-0.008774, entropy_loss=0.000022, value_loss=0.013339
[EpochKL] epoch=0 mean_kl=0.00674 max_kl=0.01549
[EarlyStop] epoch=1 mean_kl=0.01270 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01270 max_kl=0.02355
[Time] Env Create Time: 4.4023s |Rollout Collect Time: 1.6874s |Loss & Update :0.6560
[PPODiag] kl_mean=0.0097, kl_p90=0.0158, kl_max=0.0236 | clipfrac_mean=0.023, logratio_std_mean=0.163, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.692, p10=0.684, min=0.682 | pg_loss_mean=0.0025, v_loss_mean=0.0260, ent_mean=0.0215 | gn_bb_mean=0.930, gn_bb_max=1.765 | gn_v_mean=0.208, gn_v_max=0.374

  6%|▌         | 302/5000 [37:37<9:21:22,  7.17s/it]------------------ Training Record ------------------
Epoch: 302/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0955, reward_valid_std=4.1770
[BatchDiag] adv_mean=0.0078, adv_std=0.3182, adv_abs_mean=0.2216 | ret_mean=8.9567, ret_std=0.5914 | val_mean=8.9488, val_std=0.4909 | explained_var=0.710627
[GradSplit pre-clip] backbone=0.860589, critic=0.192958
[Loss] pg_loss=-0.025202, entropy_loss=0.000022, value_loss=0.009043
[EpochKL] epoch=0 mean_kl=0.00977 max_kl=0.03096
[EarlyStop] epoch=1 mean_kl=0.02061 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02061 max_kl=0.06441
[Time] Env Create Time: 4.6263s |Rollout Collect Time: 1.7013s |Loss & Update :0.6623
[PPODiag] kl_mean=0.0152, kl_p90=0.0263, kl_max=0.0644 | clipfrac_mean=0.023, logratio_std_mean=0.200, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.692, p10=0.684, min=0.683 | pg_loss_mean=0.0054, v_loss_mean=0.0247, ent_mean=0.0209 | gn_bb_mean=1.338, gn_bb_max=3.276 | gn_v_mean=0.219, gn_v_max=0.554

  6%|▌         | 303/5000 [37:44<9:17:02,  7.12s/it]------------------ Training Record ------------------
Epoch: 303/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1005, reward_valid_std=4.1803
[BatchDiag] adv_mean=-0.0200, adv_std=0.3191, adv_abs_mean=0.2177 | ret_mean=8.9526, ret_std=0.5886 | val_mean=8.9726, val_std=0.4726 | explained_var=0.706067
[GradSplit pre-clip] backbone=0.384865, critic=0.127258
[Loss] pg_loss=-0.012985, entropy_loss=0.000017, value_loss=0.010955
[EpochKL] epoch=0 mean_kl=0.00399 max_kl=0.01095
[EarlyStop] epoch=1 mean_kl=0.02402 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02402 max_kl=0.05520
[Time] Env Create Time: 4.4314s |Rollout Collect Time: 1.7024s |Loss & Update :0.6687
[PPODiag] kl_mean=0.0140, kl_p90=0.0351, kl_max=0.0552 | clipfrac_mean=0.022, logratio_std_mean=0.210, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.679 | pg_loss_mean=0.0044, v_loss_mean=0.0251, ent_mean=0.0215 | gn_bb_mean=1.321, gn_bb_max=2.677 | gn_v_mean=0.222, gn_v_max=0.570

  6%|▌         | 304/5000 [37:51<9:09:34,  7.02s/it]------------------ Training Record ------------------
Epoch: 304/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1051, reward_valid_std=4.1813
[BatchDiag] adv_mean=0.0082, adv_std=0.3111, adv_abs_mean=0.2142 | ret_mean=8.9579, ret_std=0.5813 | val_mean=8.9497, val_std=0.4934 | explained_var=0.713690
[GradSplit pre-clip] backbone=0.626231, critic=0.140127
[Loss] pg_loss=0.013097, entropy_loss=0.000019, value_loss=0.009672
[EarlyStop] epoch=0 mean_kl=0.01784 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01784 max_kl=0.03880
[Time] Env Create Time: 4.4096s |Rollout Collect Time: 1.6873s |Loss & Update :0.3483
[PPODiag] kl_mean=0.0178, kl_p90=0.0386, kl_max=0.0388 | clipfrac_mean=0.021, logratio_std_mean=0.247, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.683 | pg_loss_mean=0.0054, v_loss_mean=0.0244, ent_mean=0.0166 | gn_bb_mean=0.791, gn_bb_max=1.259 | gn_v_mean=0.285, gn_v_max=0.522

  6%|▌         | 305/5000 [37:57<8:55:56,  6.85s/it]------------------ Training Record ------------------
Epoch: 305/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.695, reward_valid_mean=2.0876, reward_valid_std=4.1677
[BatchDiag] adv_mean=-0.0316, adv_std=0.3349, adv_abs_mean=0.2233 | ret_mean=8.9549, ret_std=0.5995 | val_mean=8.9865, val_std=0.4669 | explained_var=0.687883
[GradSplit pre-clip] backbone=1.195072, critic=0.203938
[Loss] pg_loss=-0.036735, entropy_loss=0.000019, value_loss=0.009146
[EpochKL] epoch=0 mean_kl=0.00757 max_kl=0.02073
[EarlyStop] epoch=1 mean_kl=0.02331 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02331 max_kl=0.06488
[Time] Env Create Time: 4.4121s |Rollout Collect Time: 1.6984s |Loss & Update :0.6555
[PPODiag] kl_mean=0.0154, kl_p90=0.0222, kl_max=0.0649 | clipfrac_mean=0.023, logratio_std_mean=0.204, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.695, p10=0.685, min=0.683 | pg_loss_mean=0.0044, v_loss_mean=0.0270, ent_mean=0.0222 | gn_bb_mean=1.374, gn_bb_max=3.140 | gn_v_mean=0.255, gn_v_max=0.641
[AttnScore] scale=1.0448, C=10.0

  6%|▌         | 306/5000 [38:04<8:53:53,  6.82s/it]------------------ Training Record ------------------
Epoch: 306/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1027, reward_valid_std=4.1818
[BatchDiag] adv_mean=0.0247, adv_std=0.3172, adv_abs_mean=0.2237 | ret_mean=8.9561, ret_std=0.5838 | val_mean=8.9315, val_std=0.4958 | explained_var=0.704811
[GradSplit pre-clip] backbone=1.085464, critic=0.396968
[Loss] pg_loss=-0.041229, entropy_loss=0.000023, value_loss=0.009825
[EpochKL] epoch=0 mean_kl=0.00698 max_kl=0.01794
[EarlyStop] epoch=1 mean_kl=0.01087 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01087 max_kl=0.01544
[Time] Env Create Time: 4.4098s |Rollout Collect Time: 1.6930s |Loss & Update :0.6604
[PPODiag] kl_mean=0.0089, kl_p90=0.0146, kl_max=0.0179 | clipfrac_mean=0.023, logratio_std_mean=0.149, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.679 | pg_loss_mean=0.0039, v_loss_mean=0.0243, ent_mean=0.0215 | gn_bb_mean=1.220, gn_bb_max=3.456 | gn_v_mean=0.320, gn_v_max=0.619

  6%|▌         | 307/5000 [38:11<8:52:21,  6.81s/it]------------------ Training Record ------------------
Epoch: 307/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1036, reward_valid_std=4.1816
[BatchDiag] adv_mean=-0.0018, adv_std=0.3166, adv_abs_mean=0.2158 | ret_mean=8.9610, ret_std=0.5903 | val_mean=8.9628, val_std=0.5272 | explained_var=0.712273
[GradSplit pre-clip] backbone=0.701231, critic=0.292400
[Loss] pg_loss=-0.076520, entropy_loss=0.000019, value_loss=0.009614
[EpochKL] epoch=0 mean_kl=0.00176 max_kl=0.00331
[EpochKL] epoch=1 mean_kl=0.00581 max_kl=0.01192
[EpochKL] epoch=2 mean_kl=0.00898 max_kl=0.01273
[Time] Env Create Time: 4.3922s |Rollout Collect Time: 1.7070s |Loss & Update :0.9707
[PPODiag] kl_mean=0.0055, kl_p90=0.0113, kl_max=0.0127 | clipfrac_mean=0.015, logratio_std_mean=0.114, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.679 | pg_loss_mean=0.0012, v_loss_mean=0.0239, ent_mean=0.0189 | gn_bb_mean=0.769, gn_bb_max=1.690 | gn_v_mean=0.239, gn_v_max=0.470

  6%|▌         | 308/5000 [38:18<8:58:26,  6.89s/it]------------------ Training Record ------------------
Epoch: 308/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0906, reward_valid_std=4.1764
[BatchDiag] adv_mean=-0.0200, adv_std=0.3249, adv_abs_mean=0.2183 | ret_mean=8.9481, ret_std=0.5975 | val_mean=8.9680, val_std=0.4992 | explained_var=0.704257
[GradSplit pre-clip] backbone=0.465128, critic=0.153933
[Loss] pg_loss=-0.090605, entropy_loss=0.000019, value_loss=0.008747
[EpochKL] epoch=0 mean_kl=0.00252 max_kl=0.00638
[EpochKL] epoch=1 mean_kl=0.00851 max_kl=0.01853
[EpochKL] epoch=2 mean_kl=0.00744 max_kl=0.01094
[Time] Env Create Time: 4.6095s |Rollout Collect Time: 1.6955s |Loss & Update :0.9689
[PPODiag] kl_mean=0.0062, kl_p90=0.0108, kl_max=0.0185 | clipfrac_mean=0.017, logratio_std_mean=0.125, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.692, p10=0.687, min=0.683 | pg_loss_mean=0.0021, v_loss_mean=0.0253, ent_mean=0.0201 | gn_bb_mean=0.896, gn_bb_max=2.114 | gn_v_mean=0.260, gn_v_max=0.524

  6%|▌         | 309/5000 [38:25<9:07:26,  7.00s/it]------------------ Training Record ------------------
Epoch: 309/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0914, reward_valid_std=4.1768
[BatchDiag] adv_mean=-0.0233, adv_std=0.3274, adv_abs_mean=0.2202 | ret_mean=8.9559, ret_std=0.6000 | val_mean=8.9792, val_std=0.5065 | explained_var=0.702269
[GradSplit pre-clip] backbone=0.473651, critic=0.119519
[Loss] pg_loss=-0.084975, entropy_loss=0.000013, value_loss=0.009983
[EpochKL] epoch=0 mean_kl=0.00663 max_kl=0.01831
[EarlyStop] epoch=1 mean_kl=0.03236 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03236 max_kl=0.06158
[Time] Env Create Time: 4.4201s |Rollout Collect Time: 1.6906s |Loss & Update :0.6583
[PPODiag] kl_mean=0.0195, kl_p90=0.0452, kl_max=0.0616 | clipfrac_mean=0.023, logratio_std_mean=0.257, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.693, p10=0.687, min=0.685 | pg_loss_mean=0.0067, v_loss_mean=0.0262, ent_mean=0.0201 | gn_bb_mean=1.426, gn_bb_max=2.995 | gn_v_mean=0.299, gn_v_max=0.634

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.992, Step: 8, Avg Done Step: 6.67, #CS visited: 0.12
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.9837s
-----------------------------
  6%|▌         | 310/5000 [38:34<9:49:13,  7.54s/it]------------------ Training Record ------------------
Epoch: 310/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0924, reward_valid_std=4.1746
[BatchDiag] adv_mean=-0.0020, adv_std=0.3420, adv_abs_mean=0.2276 | ret_mean=8.9360, ret_std=0.6056 | val_mean=8.9380, val_std=0.4905 | explained_var=0.681064
[GradSplit pre-clip] backbone=1.239476, critic=0.520270
[Loss] pg_loss=-0.165022, entropy_loss=0.000021, value_loss=0.008204
[EpochKL] epoch=0 mean_kl=0.00544 max_kl=0.01164
[EarlyStop] epoch=1 mean_kl=0.01181 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01181 max_kl=0.02839
[Time] Env Create Time: 4.4035s |Rollout Collect Time: 1.6923s |Loss & Update :0.6667
[PPODiag] kl_mean=0.0086, kl_p90=0.0145, kl_max=0.0284 | clipfrac_mean=0.017, logratio_std_mean=0.175, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.691, p10=0.684, min=0.680 | pg_loss_mean=0.0012, v_loss_mean=0.0275, ent_mean=0.0188 | gn_bb_mean=0.688, gn_bb_max=1.239 | gn_v_mean=0.308, gn_v_max=0.538
[AttnScore] scale=1.0459, C=10.0

  6%|▌         | 311/5000 [38:41<9:30:55,  7.31s/it]------------------ Training Record ------------------
Epoch: 311/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1048, reward_valid_std=4.1782
[BatchDiag] adv_mean=-0.0295, adv_std=0.3196, adv_abs_mean=0.2090 | ret_mean=8.9556, ret_std=0.5925 | val_mean=8.9851, val_std=0.5071 | explained_var=0.709132
[GradSplit pre-clip] backbone=0.420118, critic=0.324564
[Loss] pg_loss=0.021528, entropy_loss=0.000015, value_loss=0.011153
[EpochKL] epoch=0 mean_kl=0.00327 max_kl=0.00712
[EpochKL] epoch=1 mean_kl=0.00988 max_kl=0.02247
[EarlyStop] epoch=2 mean_kl=0.01599 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01599 max_kl=0.04024
[Time] Env Create Time: 4.4105s |Rollout Collect Time: 1.6862s |Loss & Update :0.9542
[PPODiag] kl_mean=0.0097, kl_p90=0.0221, kl_max=0.0402 | clipfrac_mean=0.018, logratio_std_mean=0.150, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.680 | pg_loss_mean=0.0021, v_loss_mean=0.0245, ent_mean=0.0180 | gn_bb_mean=0.981, gn_bb_max=3.061 | gn_v_mean=0.241, gn_v_max=0.498

  6%|▌         | 312/5000 [38:48<9:24:50,  7.23s/it]------------------ Training Record ------------------
Epoch: 312/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0990, reward_valid_std=4.1829
[BatchDiag] adv_mean=-0.0070, adv_std=0.3228, adv_abs_mean=0.2162 | ret_mean=8.9554, ret_std=0.5938 | val_mean=8.9624, val_std=0.4885 | explained_var=0.704428
[GradSplit pre-clip] backbone=0.574026, critic=0.123935
[Loss] pg_loss=0.029431, entropy_loss=0.000016, value_loss=0.011966
[EpochKL] epoch=0 mean_kl=0.00267 max_kl=0.00748
[EpochKL] epoch=1 mean_kl=0.00518 max_kl=0.00845
[EpochKL] epoch=2 mean_kl=0.00799 max_kl=0.01445
[Time] Env Create Time: 4.4013s |Rollout Collect Time: 1.6865s |Loss & Update :0.9475
[PPODiag] kl_mean=0.0053, kl_p90=0.0098, kl_max=0.0145 | clipfrac_mean=0.016, logratio_std_mean=0.112, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.682 | pg_loss_mean=0.0015, v_loss_mean=0.0246, ent_mean=0.0176 | gn_bb_mean=0.762, gn_bb_max=1.580 | gn_v_mean=0.285, gn_v_max=0.681

  6%|▋         | 313/5000 [38:55<9:20:11,  7.17s/it]------------------ Training Record ------------------
Epoch: 313/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0901, reward_valid_std=4.1773
[BatchDiag] adv_mean=-0.0227, adv_std=0.3208, adv_abs_mean=0.2150 | ret_mean=8.9489, ret_std=0.5969 | val_mean=8.9715, val_std=0.4789 | explained_var=0.711043
[GradSplit pre-clip] backbone=0.836671, critic=0.089991
[Loss] pg_loss=-0.068971, entropy_loss=0.000014, value_loss=0.009276
[EpochKL] epoch=0 mean_kl=0.00387 max_kl=0.00980
[EarlyStop] epoch=1 mean_kl=0.01292 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01292 max_kl=0.02697
[Time] Env Create Time: 4.6135s |Rollout Collect Time: 1.6927s |Loss & Update :0.6504
[PPODiag] kl_mean=0.0084, kl_p90=0.0163, kl_max=0.0270 | clipfrac_mean=0.018, logratio_std_mean=0.148, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.692, p10=0.688, min=0.685 | pg_loss_mean=0.0026, v_loss_mean=0.0251, ent_mean=0.0183 | gn_bb_mean=1.049, gn_bb_max=2.610 | gn_v_mean=0.216, gn_v_max=0.456

  6%|▋         | 314/5000 [39:02<9:15:03,  7.11s/it]------------------ Training Record ------------------
Epoch: 314/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0924, reward_valid_std=4.1769
[BatchDiag] adv_mean=-0.0073, adv_std=0.3219, adv_abs_mean=0.2176 | ret_mean=8.9484, ret_std=0.5921 | val_mean=8.9557, val_std=0.5040 | explained_var=0.704481
[GradSplit pre-clip] backbone=0.845320, critic=0.152013
[Loss] pg_loss=-0.039634, entropy_loss=0.000024, value_loss=0.009330
[EarlyStop] epoch=0 mean_kl=0.02721 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02721 max_kl=0.09079
[Time] Env Create Time: 4.4329s |Rollout Collect Time: 1.6954s |Loss & Update :0.3548
[PPODiag] kl_mean=0.0272, kl_p90=0.0561, kl_max=0.0908 | clipfrac_mean=0.026, logratio_std_mean=0.246, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.692, p10=0.686, min=0.685 | pg_loss_mean=0.0237, v_loss_mean=0.0257, ent_mean=0.0187 | gn_bb_mean=4.822, gn_bb_max=25.612 | gn_v_mean=0.262, gn_v_max=0.474

  6%|▋         | 315/5000 [39:08<9:00:19,  6.92s/it]------------------ Training Record ------------------
Epoch: 315/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0878, reward_valid_std=4.1733
[BatchDiag] adv_mean=0.0205, adv_std=0.3336, adv_abs_mean=0.2329 | ret_mean=8.9437, ret_std=0.6009 | val_mean=8.9231, val_std=0.4833 | explained_var=0.691706
[GradSplit pre-clip] backbone=1.271278, critic=0.545228
[Loss] pg_loss=-0.081813, entropy_loss=0.000016, value_loss=0.010008
[EpochKL] epoch=0 mean_kl=0.00604 max_kl=0.02091
[EarlyStop] epoch=1 mean_kl=0.01135 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01135 max_kl=0.02716
[Time] Env Create Time: 4.4204s |Rollout Collect Time: 1.6986s |Loss & Update :0.6496
[PPODiag] kl_mean=0.0087, kl_p90=0.0174, kl_max=0.0272 | clipfrac_mean=0.018, logratio_std_mean=0.152, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.693, p10=0.685, min=0.682 | pg_loss_mean=0.0004, v_loss_mean=0.0268, ent_mean=0.0192 | gn_bb_mean=0.894, gn_bb_max=1.912 | gn_v_mean=0.317, gn_v_max=0.589
[AttnScore] scale=1.0461, C=10.0

  6%|▋         | 316/5000 [39:15<8:56:41,  6.87s/it]------------------ Training Record ------------------
Epoch: 316/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0992, reward_valid_std=4.1783
[BatchDiag] adv_mean=0.0001, adv_std=0.3345, adv_abs_mean=0.2246 | ret_mean=8.9451, ret_std=0.6021 | val_mean=8.9449, val_std=0.5102 | explained_var=0.691251
[GradSplit pre-clip] backbone=0.387895, critic=0.230251
[Loss] pg_loss=-0.043245, entropy_loss=0.000013, value_loss=0.011980
[EpochKL] epoch=0 mean_kl=0.00677 max_kl=0.01453
[EarlyStop] epoch=1 mean_kl=0.02101 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02101 max_kl=0.06308
[Time] Env Create Time: 4.4114s |Rollout Collect Time: 1.7074s |Loss & Update :0.6598
[PPODiag] kl_mean=0.0139, kl_p90=0.0207, kl_max=0.0631 | clipfrac_mean=0.020, logratio_std_mean=0.183, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.683 | pg_loss_mean=0.0049, v_loss_mean=0.0268, ent_mean=0.0183 | gn_bb_mean=1.778, gn_bb_max=10.598 | gn_v_mean=0.264, gn_v_max=0.441

  6%|▋         | 317/5000 [39:22<8:54:19,  6.85s/it]------------------ Training Record ------------------
Epoch: 317/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0903, reward_valid_std=4.1746
[BatchDiag] adv_mean=-0.0173, adv_std=0.3312, adv_abs_mean=0.2196 | ret_mean=8.9423, ret_std=0.6007 | val_mean=8.9596, val_std=0.5025 | explained_var=0.696025
[GradSplit pre-clip] backbone=0.306247, critic=0.265629
[Loss] pg_loss=-0.132076, entropy_loss=0.000016, value_loss=0.008262
[EarlyStop] epoch=0 mean_kl=0.02865 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02865 max_kl=0.10467
[Time] Env Create Time: 4.3947s |Rollout Collect Time: 1.7002s |Loss & Update :0.3677
[PPODiag] kl_mean=0.0287, kl_p90=0.0582, kl_max=0.1047 | clipfrac_mean=0.019, logratio_std_mean=0.343, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.692, p10=0.688, min=0.682 | pg_loss_mean=0.0029, v_loss_mean=0.0273, ent_mean=0.0182 | gn_bb_mean=0.803, gn_bb_max=1.628 | gn_v_mean=0.295, gn_v_max=0.496

  6%|▋         | 318/5000 [39:28<8:45:15,  6.73s/it]------------------ Training Record ------------------
Epoch: 318/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.1012, reward_valid_std=4.1771
[BatchDiag] adv_mean=0.0431, adv_std=0.3222, adv_abs_mean=0.2288 | ret_mean=8.9519, ret_std=0.5922 | val_mean=8.9088, val_std=0.4760 | explained_var=0.703960
[GradSplit pre-clip] backbone=0.953607, critic=0.508392
[Loss] pg_loss=0.010883, entropy_loss=0.000011, value_loss=0.012878
[EpochKL] epoch=0 mean_kl=0.00530 max_kl=0.01335
[EarlyStop] epoch=1 mean_kl=0.01405 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01405 max_kl=0.02161
[Time] Env Create Time: 4.3870s |Rollout Collect Time: 1.9421s |Loss & Update :0.7396
[PPODiag] kl_mean=0.0097, kl_p90=0.0163, kl_max=0.0216 | clipfrac_mean=0.018, logratio_std_mean=0.157, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.592, p10=0.585, min=0.583 | pg_loss_mean=0.0035, v_loss_mean=0.0251, ent_mean=0.0149 | gn_bb_mean=0.895, gn_bb_max=1.515 | gn_v_mean=0.273, gn_v_max=0.524

  6%|▋         | 319/5000 [39:35<8:53:03,  6.83s/it]------------------ Training Record ------------------
Epoch: 319/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1084, reward_valid_std=4.1805
[BatchDiag] adv_mean=-0.0215, adv_std=0.3238, adv_abs_mean=0.2104 | ret_mean=8.9566, ret_std=0.5860 | val_mean=8.9780, val_std=0.5142 | explained_var=0.694600
[GradSplit pre-clip] backbone=0.690532, critic=0.255492
[Loss] pg_loss=-0.120747, entropy_loss=0.000015, value_loss=0.008039
[EpochKL] epoch=0 mean_kl=0.00205 max_kl=0.00602
[EpochKL] epoch=1 mean_kl=0.00734 max_kl=0.01150
[EpochKL] epoch=2 mean_kl=0.00826 max_kl=0.01771
[Time] Env Create Time: 4.3775s |Rollout Collect Time: 1.6979s |Loss & Update :0.9675
[PPODiag] kl_mean=0.0059, kl_p90=0.0110, kl_max=0.0177 | clipfrac_mean=0.015, logratio_std_mean=0.116, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.678 | pg_loss_mean=0.0018, v_loss_mean=0.0247, ent_mean=0.0180 | gn_bb_mean=0.811, gn_bb_max=1.523 | gn_v_mean=0.321, gn_v_max=0.653

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.974, Step: 7, Avg Done Step: 6.63, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8247s
-----------------------------
  6%|▋         | 320/5000 [39:44<9:41:13,  7.45s/it]------------------ Training Record ------------------
Epoch: 320/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0952, reward_valid_std=4.1755
[BatchDiag] adv_mean=-0.0513, adv_std=0.3279, adv_abs_mean=0.2102 | ret_mean=8.9451, ret_std=0.5961 | val_mean=8.9964, val_std=0.4904 | explained_var=0.697292
[GradSplit pre-clip] backbone=0.570812, critic=0.307387
[Loss] pg_loss=-0.047262, entropy_loss=0.000020, value_loss=0.012007
[EpochKL] epoch=0 mean_kl=0.00263 max_kl=0.00578
[EpochKL] epoch=1 mean_kl=0.00833 max_kl=0.01421
[EpochKL] epoch=2 mean_kl=0.00543 max_kl=0.00834
[Time] Env Create Time: 4.6029s |Rollout Collect Time: 1.6880s |Loss & Update :0.9615
[PPODiag] kl_mean=0.0055, kl_p90=0.0095, kl_max=0.0142 | clipfrac_mean=0.015, logratio_std_mean=0.114, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.685 | pg_loss_mean=0.0009, v_loss_mean=0.0256, ent_mean=0.0173 | gn_bb_mean=0.729, gn_bb_max=2.206 | gn_v_mean=0.253, gn_v_max=0.579
[AttnScore] scale=1.0465, C=10.0

  6%|▋         | 321/5000 [39:51<9:36:27,  7.39s/it]------------------ Training Record ------------------
Epoch: 321/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1100, reward_valid_std=4.1822
[BatchDiag] adv_mean=-0.0021, adv_std=0.3011, adv_abs_mean=0.2034 | ret_mean=8.9575, ret_std=0.5840 | val_mean=8.9596, val_std=0.4799 | explained_var=0.734117
[GradSplit pre-clip] backbone=0.490304, critic=0.229916
[Loss] pg_loss=-0.055959, entropy_loss=0.000017, value_loss=0.008949
[EpochKL] epoch=0 mean_kl=0.00427 max_kl=0.01115
[EarlyStop] epoch=1 mean_kl=0.01148 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01148 max_kl=0.01653
[Time] Env Create Time: 4.4327s |Rollout Collect Time: 1.6980s |Loss & Update :0.6491
[PPODiag] kl_mean=0.0079, kl_p90=0.0152, kl_max=0.0165 | clipfrac_mean=0.016, logratio_std_mean=0.149, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.682 | pg_loss_mean=0.0035, v_loss_mean=0.0221, ent_mean=0.0186 | gn_bb_mean=1.130, gn_bb_max=3.099 | gn_v_mean=0.206, gn_v_max=0.322

  6%|▋         | 322/5000 [39:58<9:22:01,  7.21s/it]------------------ Training Record ------------------
Epoch: 322/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1114, reward_valid_std=4.1813
[BatchDiag] adv_mean=-0.0246, adv_std=0.3158, adv_abs_mean=0.2053 | ret_mean=8.9548, ret_std=0.5919 | val_mean=8.9794, val_std=0.4906 | explained_var=0.715369
[GradSplit pre-clip] backbone=0.682664, critic=0.116689
[Loss] pg_loss=-0.045135, entropy_loss=0.000018, value_loss=0.010560
[EpochKL] epoch=0 mean_kl=0.00507 max_kl=0.00903
[EpochKL] epoch=1 mean_kl=0.00885 max_kl=0.01439
[EarlyStop] epoch=2 mean_kl=0.02028 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02028 max_kl=0.03621
[Time] Env Create Time: 4.4206s |Rollout Collect Time: 1.6936s |Loss & Update :0.9637
[PPODiag] kl_mean=0.0114, kl_p90=0.0194, kl_max=0.0362 | clipfrac_mean=0.021, logratio_std_mean=0.179, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.680 | pg_loss_mean=0.0032, v_loss_mean=0.0241, ent_mean=0.0184 | gn_bb_mean=1.252, gn_bb_max=8.404 | gn_v_mean=0.274, gn_v_max=0.490

  6%|▋         | 323/5000 [40:05<9:18:51,  7.17s/it]------------------ Training Record ------------------
Epoch: 323/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1055, reward_valid_std=4.1841
[BatchDiag] adv_mean=-0.0495, adv_std=0.3087, adv_abs_mean=0.1981 | ret_mean=8.9567, ret_std=0.5885 | val_mean=9.0062, val_std=0.4783 | explained_var=0.724761
[GradSplit pre-clip] backbone=1.917393, critic=0.219009
[Loss] pg_loss=-0.083971, entropy_loss=0.000014, value_loss=0.008533
[EarlyStop] epoch=0 mean_kl=0.01104 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01104 max_kl=0.02202
[Time] Env Create Time: 4.3972s |Rollout Collect Time: 1.6964s |Loss & Update :0.3534
[PPODiag] kl_mean=0.0110, kl_p90=0.0179, kl_max=0.0220 | clipfrac_mean=0.021, logratio_std_mean=0.165, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.684 | pg_loss_mean=0.0035, v_loss_mean=0.0230, ent_mean=0.0187 | gn_bb_mean=1.139, gn_bb_max=1.917 | gn_v_mean=0.333, gn_v_max=0.560

  6%|▋         | 324/5000 [40:12<9:01:51,  6.95s/it]------------------ Training Record ------------------
Epoch: 324/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1118, reward_valid_std=4.1848
[BatchDiag] adv_mean=0.0044, adv_std=0.3104, adv_abs_mean=0.2044 | ret_mean=8.9531, ret_std=0.5904 | val_mean=8.9487, val_std=0.4894 | explained_var=0.723661
[GradSplit pre-clip] backbone=0.993099, critic=0.101337
[Loss] pg_loss=0.023543, entropy_loss=0.000014, value_loss=0.010174
[EpochKL] epoch=0 mean_kl=0.00462 max_kl=0.01124
[EpochKL] epoch=1 mean_kl=0.00685 max_kl=0.01155
[EpochKL] epoch=2 mean_kl=0.00978 max_kl=0.01753
[Time] Env Create Time: 4.3934s |Rollout Collect Time: 1.7070s |Loss & Update :0.9567
[PPODiag] kl_mean=0.0071, kl_p90=0.0115, kl_max=0.0175 | clipfrac_mean=0.016, logratio_std_mean=0.140, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.682, min=0.679 | pg_loss_mean=0.0016, v_loss_mean=0.0227, ent_mean=0.0154 | gn_bb_mean=0.905, gn_bb_max=3.066 | gn_v_mean=0.202, gn_v_max=0.447

  6%|▋         | 325/5000 [40:19<9:04:11,  6.98s/it]------------------ Training Record ------------------
Epoch: 325/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0930, reward_valid_std=4.1759
[BatchDiag] adv_mean=0.0006, adv_std=0.3221, adv_abs_mean=0.2124 | ret_mean=8.9373, ret_std=0.5991 | val_mean=8.9368, val_std=0.5048 | explained_var=0.711060
[GradSplit pre-clip] backbone=0.529667, critic=0.352475
[Loss] pg_loss=-0.105275, entropy_loss=0.000013, value_loss=0.009138
[EpochKL] epoch=0 mean_kl=0.00426 max_kl=0.01599
[EpochKL] epoch=1 mean_kl=0.00745 max_kl=0.01936
[EpochKL] epoch=2 mean_kl=0.00808 max_kl=0.01166
[Time] Env Create Time: 4.3728s |Rollout Collect Time: 1.6904s |Loss & Update :0.9590
[PPODiag] kl_mean=0.0066, kl_p90=0.0113, kl_max=0.0194 | clipfrac_mean=0.015, logratio_std_mean=0.128, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.678 | pg_loss_mean=0.0011, v_loss_mean=0.0251, ent_mean=0.0171 | gn_bb_mean=0.798, gn_bb_max=1.837 | gn_v_mean=0.326, gn_v_max=0.578
[AttnScore] scale=1.0473, C=10.0

  7%|▋         | 326/5000 [40:26<9:04:58,  7.00s/it]------------------ Training Record ------------------
Epoch: 326/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1023, reward_valid_std=4.1788
[BatchDiag] adv_mean=-0.0495, adv_std=0.3130, adv_abs_mean=0.1996 | ret_mean=8.9492, ret_std=0.5930 | val_mean=8.9987, val_std=0.5271 | explained_var=0.721422
[GradSplit pre-clip] backbone=0.569024, critic=0.338931
[Loss] pg_loss=-0.046498, entropy_loss=0.000017, value_loss=0.010660
[EpochKL] epoch=0 mean_kl=0.00723 max_kl=0.02032
[EarlyStop] epoch=1 mean_kl=0.03009 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03009 max_kl=0.04775
[Time] Env Create Time: 4.6106s |Rollout Collect Time: 1.6917s |Loss & Update :0.6544
[PPODiag] kl_mean=0.0187, kl_p90=0.0338, kl_max=0.0478 | clipfrac_mean=0.024, logratio_std_mean=0.241, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.679 | pg_loss_mean=0.0059, v_loss_mean=0.0239, ent_mean=0.0190 | gn_bb_mean=1.247, gn_bb_max=2.741 | gn_v_mean=0.293, gn_v_max=0.742

  7%|▋         | 327/5000 [40:33<9:03:57,  6.98s/it]------------------ Training Record ------------------
Epoch: 327/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1117, reward_valid_std=4.1821
[BatchDiag] adv_mean=-0.0084, adv_std=0.2995, adv_abs_mean=0.2027 | ret_mean=8.9526, ret_std=0.5782 | val_mean=8.9610, val_std=0.4691 | explained_var=0.731626
[GradSplit pre-clip] backbone=0.834184, critic=0.255794
[Loss] pg_loss=-0.053834, entropy_loss=0.000017, value_loss=0.009655
[EpochKL] epoch=0 mean_kl=0.00945 max_kl=0.02215
[EarlyStop] epoch=1 mean_kl=0.01086 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01086 max_kl=0.02127
[Time] Env Create Time: 4.4159s |Rollout Collect Time: 1.6921s |Loss & Update :0.6638
[PPODiag] kl_mean=0.0102, kl_p90=0.0205, kl_max=0.0221 | clipfrac_mean=0.018, logratio_std_mean=0.165, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.683, min=0.678 | pg_loss_mean=0.0060, v_loss_mean=0.0216, ent_mean=0.0178 | gn_bb_mean=1.205, gn_bb_max=3.484 | gn_v_mean=0.212, gn_v_max=0.346

  7%|▋         | 328/5000 [40:40<8:58:52,  6.92s/it]------------------ Training Record ------------------
Epoch: 328/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1117, reward_valid_std=4.1915
[BatchDiag] adv_mean=-0.0346, adv_std=0.3054, adv_abs_mean=0.2001 | ret_mean=8.9585, ret_std=0.5826 | val_mean=8.9931, val_std=0.5006 | explained_var=0.725267
[GradSplit pre-clip] backbone=0.454106, critic=0.324178
[Loss] pg_loss=0.012931, entropy_loss=0.000016, value_loss=0.012315
[EpochKL] epoch=0 mean_kl=0.00279 max_kl=0.00516
[EarlyStop] epoch=1 mean_kl=0.01620 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01620 max_kl=0.02883
[Time] Env Create Time: 4.4159s |Rollout Collect Time: 1.6840s |Loss & Update :0.6568
[PPODiag] kl_mean=0.0095, kl_p90=0.0225, kl_max=0.0288 | clipfrac_mean=0.016, logratio_std_mean=0.158, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.679 | pg_loss_mean=0.0027, v_loss_mean=0.0224, ent_mean=0.0172 | gn_bb_mean=0.910, gn_bb_max=2.308 | gn_v_mean=0.216, gn_v_max=0.364

  7%|▋         | 329/5000 [40:46<8:54:57,  6.87s/it]------------------ Training Record ------------------
Epoch: 329/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1099, reward_valid_std=4.1845
[BatchDiag] adv_mean=0.0007, adv_std=0.3020, adv_abs_mean=0.2007 | ret_mean=8.9510, ret_std=0.5831 | val_mean=8.9503, val_std=0.4924 | explained_var=0.731816
[GradSplit pre-clip] backbone=0.493125, critic=0.238983
[Loss] pg_loss=-0.061433, entropy_loss=0.000016, value_loss=0.007414
[EpochKL] epoch=0 mean_kl=0.00586 max_kl=0.01413
[EarlyStop] epoch=1 mean_kl=0.02145 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02145 max_kl=0.05861
[Time] Env Create Time: 4.4154s |Rollout Collect Time: 1.6966s |Loss & Update :0.6527
[PPODiag] kl_mean=0.0137, kl_p90=0.0224, kl_max=0.0586 | clipfrac_mean=0.018, logratio_std_mean=0.212, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.676 | pg_loss_mean=0.0032, v_loss_mean=0.0220, ent_mean=0.0176 | gn_bb_mean=0.848, gn_bb_max=1.768 | gn_v_mean=0.209, gn_v_max=0.452

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.977, Step: 7, Avg Done Step: 6.62, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8175s
-----------------------------
  7%|▋         | 330/5000 [40:55<9:35:37,  7.40s/it]------------------ Training Record ------------------
Epoch: 330/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1051, reward_valid_std=4.1802
[BatchDiag] adv_mean=-0.0302, adv_std=0.3076, adv_abs_mean=0.2022 | ret_mean=8.9517, ret_std=0.5819 | val_mean=8.9819, val_std=0.4929 | explained_var=0.720516
[GradSplit pre-clip] backbone=0.734159, critic=0.182901
[Loss] pg_loss=-0.028863, entropy_loss=0.000017, value_loss=0.010545
[EpochKL] epoch=0 mean_kl=0.00935 max_kl=0.02500
[EarlyStop] epoch=1 mean_kl=0.01420 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01420 max_kl=0.02921
[Time] Env Create Time: 4.3941s |Rollout Collect Time: 1.8811s |Loss & Update :0.6656
[PPODiag] kl_mean=0.0118, kl_p90=0.0248, kl_max=0.0292 | clipfrac_mean=0.021, logratio_std_mean=0.182, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.680 | pg_loss_mean=0.0042, v_loss_mean=0.0237, ent_mean=0.0204 | gn_bb_mean=1.062, gn_bb_max=3.378 | gn_v_mean=0.258, gn_v_max=0.402
[AttnScore] scale=1.0474, C=10.0

  7%|▋         | 331/5000 [41:02<9:24:53,  7.26s/it]------------------ Training Record ------------------
Epoch: 331/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1051, reward_valid_std=4.1821
[BatchDiag] adv_mean=-0.0282, adv_std=0.3194, adv_abs_mean=0.2072 | ret_mean=8.9566, ret_std=0.5995 | val_mean=8.9848, val_std=0.4896 | explained_var=0.716224
[GradSplit pre-clip] backbone=0.437876, critic=0.146427
[Loss] pg_loss=-0.083206, entropy_loss=0.000015, value_loss=0.008314
[EpochKL] epoch=0 mean_kl=0.00296 max_kl=0.00931
[EarlyStop] epoch=1 mean_kl=0.01235 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01235 max_kl=0.03280
[Time] Env Create Time: 4.4159s |Rollout Collect Time: 1.6952s |Loss & Update :0.6660
[PPODiag] kl_mean=0.0077, kl_p90=0.0130, kl_max=0.0328 | clipfrac_mean=0.015, logratio_std_mean=0.138, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.682 | pg_loss_mean=0.0017, v_loss_mean=0.0240, ent_mean=0.0167 | gn_bb_mean=0.977, gn_bb_max=2.358 | gn_v_mean=0.210, gn_v_max=0.431

  7%|▋         | 332/5000 [41:09<9:13:31,  7.11s/it]------------------ Training Record ------------------
Epoch: 332/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1040, reward_valid_std=4.1783
[BatchDiag] adv_mean=0.0029, adv_std=0.2995, adv_abs_mean=0.2040 | ret_mean=8.9518, ret_std=0.5811 | val_mean=8.9489, val_std=0.4832 | explained_var=0.734342
[GradSplit pre-clip] backbone=0.631828, critic=0.350370
[Loss] pg_loss=-0.101381, entropy_loss=0.000019, value_loss=0.008450
[EpochKL] epoch=0 mean_kl=0.00442 max_kl=0.01020
[EpochKL] epoch=1 mean_kl=0.00435 max_kl=0.00909
[EarlyStop] epoch=2 mean_kl=0.01011 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01011 max_kl=0.01718
[Time] Env Create Time: 4.4182s |Rollout Collect Time: 1.6977s |Loss & Update :0.9585
[PPODiag] kl_mean=0.0063, kl_p90=0.0115, kl_max=0.0172 | clipfrac_mean=0.014, logratio_std_mean=0.123, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.682 | pg_loss_mean=0.0023, v_loss_mean=0.0219, ent_mean=0.0171 | gn_bb_mean=0.900, gn_bb_max=2.098 | gn_v_mean=0.222, gn_v_max=0.378

  7%|▋         | 333/5000 [41:16<9:12:28,  7.10s/it]------------------ Training Record ------------------
Epoch: 333/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1164, reward_valid_std=4.1878
[BatchDiag] adv_mean=-0.0037, adv_std=0.3001, adv_abs_mean=0.1964 | ret_mean=8.9541, ret_std=0.5797 | val_mean=8.9578, val_std=0.5037 | explained_var=0.731984
[GradSplit pre-clip] backbone=0.644744, critic=0.180649
[Loss] pg_loss=-0.035519, entropy_loss=0.000015, value_loss=0.009271
[EpochKL] epoch=0 mean_kl=0.00317 max_kl=0.00709
[EpochKL] epoch=1 mean_kl=0.00563 max_kl=0.00757
[EarlyStop] epoch=2 mean_kl=0.01105 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01105 max_kl=0.02068
[Time] Env Create Time: 4.4142s |Rollout Collect Time: 1.6946s |Loss & Update :0.9553
[PPODiag] kl_mean=0.0066, kl_p90=0.0128, kl_max=0.0207 | clipfrac_mean=0.017, logratio_std_mean=0.126, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.685, p10=0.681, min=0.676 | pg_loss_mean=0.0020, v_loss_mean=0.0217, ent_mean=0.0182 | gn_bb_mean=0.975, gn_bb_max=1.949 | gn_v_mean=0.257, gn_v_max=0.522

  7%|▋         | 334/5000 [41:23<9:11:28,  7.09s/it]------------------ Training Record ------------------
Epoch: 334/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1159, reward_valid_std=4.1801
[BatchDiag] adv_mean=-0.0083, adv_std=0.2999, adv_abs_mean=0.1992 | ret_mean=8.9630, ret_std=0.5786 | val_mean=8.9713, val_std=0.4862 | explained_var=0.731272
[GradSplit pre-clip] backbone=0.823965, critic=0.237254
[Loss] pg_loss=-0.092373, entropy_loss=0.000016, value_loss=0.007111
[EpochKL] epoch=0 mean_kl=0.00446 max_kl=0.01419
[EpochKL] epoch=1 mean_kl=0.00868 max_kl=0.02017
[EarlyStop] epoch=2 mean_kl=0.02300 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02300 max_kl=0.05325
[Time] Env Create Time: 4.4139s |Rollout Collect Time: 1.6916s |Loss & Update :0.9632
[PPODiag] kl_mean=0.0120, kl_p90=0.0278, kl_max=0.0533 | clipfrac_mean=0.019, logratio_std_mean=0.197, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.687, p10=0.679, min=0.678 | pg_loss_mean=0.0037, v_loss_mean=0.0225, ent_mean=0.0187 | gn_bb_mean=1.265, gn_bb_max=3.383 | gn_v_mean=0.379, gn_v_max=0.753

  7%|▋         | 335/5000 [41:30<9:10:49,  7.08s/it]------------------ Training Record ------------------
Epoch: 335/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1044, reward_valid_std=4.1802
[BatchDiag] adv_mean=-0.0320, adv_std=0.3095, adv_abs_mean=0.2029 | ret_mean=8.9504, ret_std=0.5855 | val_mean=8.9824, val_std=0.5048 | explained_var=0.720557
[GradSplit pre-clip] backbone=1.350358, critic=0.206624
[Loss] pg_loss=-0.065661, entropy_loss=0.000016, value_loss=0.009859
[EpochKL] epoch=0 mean_kl=0.00869 max_kl=0.02571
[EarlyStop] epoch=1 mean_kl=0.02476 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02476 max_kl=0.04587
[Time] Env Create Time: 4.4046s |Rollout Collect Time: 1.6998s |Loss & Update :0.6733
[PPODiag] kl_mean=0.0167, kl_p90=0.0326, kl_max=0.0459 | clipfrac_mean=0.023, logratio_std_mean=0.246, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.679 | pg_loss_mean=0.0033, v_loss_mean=0.0239, ent_mean=0.0185 | gn_bb_mean=1.024, gn_bb_max=1.673 | gn_v_mean=0.338, gn_v_max=0.549
[AttnScore] scale=1.0483, C=10.0

  7%|▋         | 336/5000 [41:37<9:03:34,  6.99s/it]------------------ Training Record ------------------
Epoch: 336/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.684, reward_valid_mean=2.1203, reward_valid_std=4.1878
[BatchDiag] adv_mean=-0.0495, adv_std=0.2833, adv_abs_mean=0.1913 | ret_mean=8.9581, ret_std=0.5716 | val_mean=9.0076, val_std=0.4895 | explained_var=0.754279
[GradSplit pre-clip] backbone=0.795635, critic=0.437816
[Loss] pg_loss=-0.006598, entropy_loss=0.000017, value_loss=0.007876
[EarlyStop] epoch=0 mean_kl=0.01538 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01538 max_kl=0.04860
[Time] Env Create Time: 4.6193s |Rollout Collect Time: 1.6932s |Loss & Update :0.3488
[PPODiag] kl_mean=0.0154, kl_p90=0.0375, kl_max=0.0486 | clipfrac_mean=0.017, logratio_std_mean=0.169, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.684, p10=0.679, min=0.677 | pg_loss_mean=0.0033, v_loss_mean=0.0205, ent_mean=0.0186 | gn_bb_mean=0.856, gn_bb_max=1.988 | gn_v_mean=0.336, gn_v_max=0.605

  7%|▋         | 337/5000 [41:43<8:55:44,  6.89s/it]------------------ Training Record ------------------
Epoch: 337/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1114, reward_valid_std=4.1794
[BatchDiag] adv_mean=-0.0239, adv_std=0.3136, adv_abs_mean=0.2038 | ret_mean=8.9560, ret_std=0.5816 | val_mean=8.9799, val_std=0.4999 | explained_var=0.709252
[GradSplit pre-clip] backbone=0.680856, critic=0.199066
[Loss] pg_loss=-0.042088, entropy_loss=0.000017, value_loss=0.010192
[EpochKL] epoch=0 mean_kl=0.00640 max_kl=0.01463
[EarlyStop] epoch=1 mean_kl=0.01155 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01155 max_kl=0.02757
[Time] Env Create Time: 4.4199s |Rollout Collect Time: 1.6979s |Loss & Update :0.6637
[PPODiag] kl_mean=0.0090, kl_p90=0.0142, kl_max=0.0276 | clipfrac_mean=0.019, logratio_std_mean=0.158, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.680 | pg_loss_mean=0.0033, v_loss_mean=0.0232, ent_mean=0.0178 | gn_bb_mean=1.207, gn_bb_max=2.462 | gn_v_mean=0.261, gn_v_max=0.460

  7%|▋         | 338/5000 [41:50<8:53:01,  6.86s/it]------------------ Training Record ------------------
Epoch: 338/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1091, reward_valid_std=4.1817
[BatchDiag] adv_mean=-0.0007, adv_std=0.3248, adv_abs_mean=0.2204 | ret_mean=8.9535, ret_std=0.5909 | val_mean=8.9542, val_std=0.4954 | explained_var=0.697861
[GradSplit pre-clip] backbone=0.256757, critic=0.212305
[Loss] pg_loss=-0.006553, entropy_loss=0.000016, value_loss=0.011896
[EpochKL] epoch=0 mean_kl=0.00347 max_kl=0.00631
[EarlyStop] epoch=1 mean_kl=0.01250 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01250 max_kl=0.02017
[Time] Env Create Time: 4.4239s |Rollout Collect Time: 1.6855s |Loss & Update :0.6561
[PPODiag] kl_mean=0.0080, kl_p90=0.0187, kl_max=0.0202 | clipfrac_mean=0.014, logratio_std_mean=0.147, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.680, min=0.676 | pg_loss_mean=0.0018, v_loss_mean=0.0246, ent_mean=0.0166 | gn_bb_mean=1.172, gn_bb_max=5.937 | gn_v_mean=0.256, gn_v_max=0.489

  7%|▋         | 339/5000 [41:57<8:50:42,  6.83s/it]------------------ Training Record ------------------
Epoch: 339/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1164, reward_valid_std=4.1854
[BatchDiag] adv_mean=-0.0333, adv_std=0.2969, adv_abs_mean=0.1994 | ret_mean=8.9699, ret_std=0.5762 | val_mean=9.0033, val_std=0.4915 | explained_var=0.734534
[GradSplit pre-clip] backbone=0.584101, critic=0.364791
[Loss] pg_loss=0.041067, entropy_loss=0.000017, value_loss=0.010855
[EpochKL] epoch=0 mean_kl=0.00352 max_kl=0.01073
[EarlyStop] epoch=1 mean_kl=0.01898 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01898 max_kl=0.03353
[Time] Env Create Time: 4.4173s |Rollout Collect Time: 1.7107s |Loss & Update :0.6636
[PPODiag] kl_mean=0.0113, kl_p90=0.0221, kl_max=0.0335 | clipfrac_mean=0.017, logratio_std_mean=0.164, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.682 | pg_loss_mean=0.0042, v_loss_mean=0.0213, ent_mean=0.0170 | gn_bb_mean=1.143, gn_bb_max=2.442 | gn_v_mean=0.267, gn_v_max=0.510

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.999, Step: 7, Avg Done Step: 6.60, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8294s
-----------------------------
  7%|▋         | 340/5000 [42:06<9:33:08,  7.38s/it]------------------ Training Record ------------------
Epoch: 340/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1128, reward_valid_std=4.1825
[BatchDiag] adv_mean=0.0093, adv_std=0.2874, adv_abs_mean=0.1941 | ret_mean=8.9572, ret_std=0.5861 | val_mean=8.9479, val_std=0.5038 | explained_var=0.759605
[GradSplit pre-clip] backbone=0.587066, critic=0.291431
[Loss] pg_loss=-0.051186, entropy_loss=0.000012, value_loss=0.009441
[EpochKL] epoch=0 mean_kl=0.00429 max_kl=0.00911
[EarlyStop] epoch=1 mean_kl=0.01276 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01276 max_kl=0.03357
[Time] Env Create Time: 4.4117s |Rollout Collect Time: 1.6936s |Loss & Update :0.6649
[PPODiag] kl_mean=0.0085, kl_p90=0.0171, kl_max=0.0336 | clipfrac_mean=0.018, logratio_std_mean=0.153, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.679 | pg_loss_mean=0.0030, v_loss_mean=0.0201, ent_mean=0.0176 | gn_bb_mean=0.942, gn_bb_max=1.916 | gn_v_mean=0.245, gn_v_max=0.513
[AttnScore] scale=1.0494, C=10.0

  7%|▋         | 341/5000 [42:12<9:18:49,  7.20s/it]------------------ Training Record ------------------
Epoch: 341/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1136, reward_valid_std=4.1903
[BatchDiag] adv_mean=0.0075, adv_std=0.2878, adv_abs_mean=0.1958 | ret_mean=8.9551, ret_std=0.5813 | val_mean=8.9477, val_std=0.5018 | explained_var=0.754921
[GradSplit pre-clip] backbone=0.991649, critic=0.274871
[Loss] pg_loss=-0.047554, entropy_loss=0.000013, value_loss=0.009141
[EpochKL] epoch=0 mean_kl=0.00563 max_kl=0.01503
[EpochKL] epoch=1 mean_kl=0.00381 max_kl=0.00894
[EarlyStop] epoch=2 mean_kl=0.01464 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01464 max_kl=0.02389
[Time] Env Create Time: 4.3913s |Rollout Collect Time: 1.6882s |Loss & Update :0.9533
[PPODiag] kl_mean=0.0080, kl_p90=0.0170, kl_max=0.0239 | clipfrac_mean=0.016, logratio_std_mean=0.140, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.681, min=0.678 | pg_loss_mean=0.0015, v_loss_mean=0.0197, ent_mean=0.0153 | gn_bb_mean=0.799, gn_bb_max=1.750 | gn_v_mean=0.235, gn_v_max=0.466

  7%|▋         | 342/5000 [42:19<9:14:54,  7.15s/it]------------------ Training Record ------------------
Epoch: 342/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1164, reward_valid_std=4.1929
[BatchDiag] adv_mean=-0.0134, adv_std=0.2949, adv_abs_mean=0.1981 | ret_mean=8.9608, ret_std=0.5818 | val_mean=8.9742, val_std=0.5019 | explained_var=0.742962
[GradSplit pre-clip] backbone=1.484319, critic=0.446061
[Loss] pg_loss=-0.195701, entropy_loss=0.000015, value_loss=0.006624
[EpochKL] epoch=0 mean_kl=0.00439 max_kl=0.01195
[EarlyStop] epoch=1 mean_kl=0.02558 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02558 max_kl=0.06423
[Time] Env Create Time: 4.6064s |Rollout Collect Time: 1.6764s |Loss & Update :0.6514
[PPODiag] kl_mean=0.0150, kl_p90=0.0315, kl_max=0.0642 | clipfrac_mean=0.018, logratio_std_mean=0.202, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.685, p10=0.678, min=0.677 | pg_loss_mean=0.0025, v_loss_mean=0.0213, ent_mean=0.0173 | gn_bb_mean=0.956, gn_bb_max=2.322 | gn_v_mean=0.328, gn_v_max=0.744

  7%|▋         | 343/5000 [42:26<9:09:49,  7.08s/it]------------------ Training Record ------------------
Epoch: 343/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1059, reward_valid_std=4.1747
[BatchDiag] adv_mean=-0.0420, adv_std=0.3124, adv_abs_mean=0.2024 | ret_mean=8.9491, ret_std=0.5907 | val_mean=8.9911, val_std=0.4663 | explained_var=0.720403
[GradSplit pre-clip] backbone=0.702239, critic=0.260929
[Loss] pg_loss=-0.008009, entropy_loss=0.000014, value_loss=0.010762
[EpochKL] epoch=0 mean_kl=0.00665 max_kl=0.02011
[EpochKL] epoch=1 mean_kl=0.00845 max_kl=0.01980
[EpochKL] epoch=2 mean_kl=0.00722 max_kl=0.01525
[Time] Env Create Time: 4.4115s |Rollout Collect Time: 1.6854s |Loss & Update :0.9671
[PPODiag] kl_mean=0.0074, kl_p90=0.0171, kl_max=0.0201 | clipfrac_mean=0.017, logratio_std_mean=0.142, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.678 | pg_loss_mean=0.0022, v_loss_mean=0.0232, ent_mean=0.0179 | gn_bb_mean=0.908, gn_bb_max=4.807 | gn_v_mean=0.295, gn_v_max=0.633

  7%|▋         | 344/5000 [42:33<9:09:15,  7.08s/it]------------------ Training Record ------------------
Epoch: 344/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1035, reward_valid_std=4.1792
[BatchDiag] adv_mean=-0.0056, adv_std=0.2991, adv_abs_mean=0.1988 | ret_mean=8.9571, ret_std=0.5888 | val_mean=8.9627, val_std=0.4995 | explained_var=0.741927
[GradSplit pre-clip] backbone=0.703403, critic=0.184229
[Loss] pg_loss=-0.051758, entropy_loss=0.000016, value_loss=0.008225
[EpochKL] epoch=0 mean_kl=0.00268 max_kl=0.00699
[EpochKL] epoch=1 mean_kl=0.00859 max_kl=0.02730
[EarlyStop] epoch=2 mean_kl=0.01870 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01870 max_kl=0.03156
[Time] Env Create Time: 4.3916s |Rollout Collect Time: 1.6814s |Loss & Update :0.9683
[PPODiag] kl_mean=0.0100, kl_p90=0.0262, kl_max=0.0316 | clipfrac_mean=0.015, logratio_std_mean=0.184, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.682 | pg_loss_mean=0.0026, v_loss_mean=0.0219, ent_mean=0.0167 | gn_bb_mean=0.893, gn_bb_max=3.323 | gn_v_mean=0.240, gn_v_max=0.562

  7%|▋         | 345/5000 [42:40<9:08:17,  7.07s/it]------------------ Training Record ------------------
Epoch: 345/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1000, reward_valid_std=4.1814
[BatchDiag] adv_mean=-0.0123, adv_std=0.3115, adv_abs_mean=0.2078 | ret_mean=8.9378, ret_std=0.6011 | val_mean=8.9501, val_std=0.4947 | explained_var=0.731354
[GradSplit pre-clip] backbone=0.822830, critic=0.293496
[Loss] pg_loss=-0.103138, entropy_loss=0.000013, value_loss=0.008532
[EpochKL] epoch=0 mean_kl=0.00361 max_kl=0.01218
[EpochKL] epoch=1 mean_kl=0.00678 max_kl=0.01468
[EpochKL] epoch=2 mean_kl=0.00960 max_kl=0.01720
[Time] Env Create Time: 4.3921s |Rollout Collect Time: 1.6940s |Loss & Update :0.9659
[PPODiag] kl_mean=0.0067, kl_p90=0.0133, kl_max=0.0172 | clipfrac_mean=0.015, logratio_std_mean=0.142, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.681 | pg_loss_mean=0.0014, v_loss_mean=0.0234, ent_mean=0.0162 | gn_bb_mean=0.771, gn_bb_max=1.312 | gn_v_mean=0.238, gn_v_max=0.383
[AttnScore] scale=1.0502, C=10.0

  7%|▋         | 346/5000 [42:47<9:07:50,  7.06s/it]------------------ Training Record ------------------
Epoch: 346/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1104, reward_valid_std=4.1782
[BatchDiag] adv_mean=0.0002, adv_std=0.3032, adv_abs_mean=0.2028 | ret_mean=8.9529, ret_std=0.5865 | val_mean=8.9528, val_std=0.4941 | explained_var=0.732686
[GradSplit pre-clip] backbone=1.253400, critic=0.204115
[Loss] pg_loss=0.001120, entropy_loss=0.000014, value_loss=0.009353
[EpochKL] epoch=0 mean_kl=0.00481 max_kl=0.01115
[EarlyStop] epoch=1 mean_kl=0.03414 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03414 max_kl=0.06509
[Time] Env Create Time: 4.4120s |Rollout Collect Time: 1.9332s |Loss & Update :0.7313
[PPODiag] kl_mean=0.0195, kl_p90=0.0475, kl_max=0.0651 | clipfrac_mean=0.022, logratio_std_mean=0.255, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.589, p10=0.584, min=0.582 | pg_loss_mean=0.0043, v_loss_mean=0.0221, ent_mean=0.0147 | gn_bb_mean=1.137, gn_bb_max=3.034 | gn_v_mean=0.326, gn_v_max=0.635

  7%|▋         | 347/5000 [42:55<9:08:07,  7.07s/it]------------------ Training Record ------------------
Epoch: 347/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1001, reward_valid_std=4.1716
[BatchDiag] adv_mean=-0.0030, adv_std=0.3211, adv_abs_mean=0.2059 | ret_mean=8.9391, ret_std=0.5985 | val_mean=8.9421, val_std=0.5021 | explained_var=0.712035
[GradSplit pre-clip] backbone=1.061150, critic=0.113695
[Loss] pg_loss=0.016448, entropy_loss=0.000013, value_loss=0.011157
[EarlyStop] epoch=0 mean_kl=0.02307 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02307 max_kl=0.06739
[Time] Env Create Time: 4.3994s |Rollout Collect Time: 1.9363s |Loss & Update :0.3867
[PPODiag] kl_mean=0.0231, kl_p90=0.0435, kl_max=0.0674 | clipfrac_mean=0.025, logratio_std_mean=0.269, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.591, p10=0.585, min=0.585 | pg_loss_mean=0.0053, v_loss_mean=0.0255, ent_mean=0.0171 | gn_bb_mean=1.395, gn_bb_max=4.059 | gn_v_mean=0.321, gn_v_max=0.524

  7%|▋         | 348/5000 [43:01<8:59:58,  6.96s/it]------------------ Training Record ------------------
Epoch: 348/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.695, reward_valid_mean=2.0819, reward_valid_std=4.1612
[BatchDiag] adv_mean=-0.0365, adv_std=0.3407, adv_abs_mean=0.2213 | ret_mean=8.9253, ret_std=0.6057 | val_mean=8.9618, val_std=0.4875 | explained_var=0.683535
[GradSplit pre-clip] backbone=1.348940, critic=0.179540
[Loss] pg_loss=-0.133392, entropy_loss=0.000027, value_loss=0.008849
[EarlyStop] epoch=0 mean_kl=0.02015 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02015 max_kl=0.09976
[Time] Env Create Time: 4.5916s |Rollout Collect Time: 1.6914s |Loss & Update :0.3646
[PPODiag] kl_mean=0.0202, kl_p90=0.0445, kl_max=0.0998 | clipfrac_mean=0.019, logratio_std_mean=0.190, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.695, p10=0.688, min=0.685 | pg_loss_mean=0.0016, v_loss_mean=0.0284, ent_mean=0.0234 | gn_bb_mean=1.240, gn_bb_max=1.871 | gn_v_mean=0.321, gn_v_max=0.853

  7%|▋         | 349/5000 [43:08<8:52:29,  6.87s/it]------------------ Training Record ------------------
Epoch: 349/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1020, reward_valid_std=4.1773
[BatchDiag] adv_mean=0.0409, adv_std=0.3293, adv_abs_mean=0.2275 | ret_mean=8.9324, ret_std=0.6058 | val_mean=8.8914, val_std=0.4902 | explained_var=0.704524
[GradSplit pre-clip] backbone=0.806655, critic=0.694715
[Loss] pg_loss=-0.086967, entropy_loss=0.000010, value_loss=0.008975
[EpochKL] epoch=0 mean_kl=0.00488 max_kl=0.00976
[EarlyStop] epoch=1 mean_kl=0.02195 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02195 max_kl=0.05751
[Time] Env Create Time: 4.4007s |Rollout Collect Time: 1.6917s |Loss & Update :0.6638
[PPODiag] kl_mean=0.0134, kl_p90=0.0239, kl_max=0.0575 | clipfrac_mean=0.020, logratio_std_mean=0.197, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.681 | pg_loss_mean=0.0030, v_loss_mean=0.0264, ent_mean=0.0187 | gn_bb_mean=1.594, gn_bb_max=10.589 | gn_v_mean=0.472, gn_v_max=0.904

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.000, Step: 7, Avg Done Step: 6.61, #CS visited: 0.14
D->C5->C2->C3->D->C4->C1->D
Eval cost : 1.8376s
-----------------------------
  7%|▋         | 350/5000 [43:17<9:33:07,  7.40s/it]------------------ Training Record ------------------
Epoch: 350/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1027, reward_valid_std=4.1814
[BatchDiag] adv_mean=0.0091, adv_std=0.3177, adv_abs_mean=0.2144 | ret_mean=8.9420, ret_std=0.5975 | val_mean=8.9329, val_std=0.4732 | explained_var=0.717305
[GradSplit pre-clip] backbone=0.292796, critic=0.499870
[Loss] pg_loss=-0.074406, entropy_loss=0.000012, value_loss=0.010845
[EpochKL] epoch=0 mean_kl=0.00870 max_kl=0.02400
[EarlyStop] epoch=1 mean_kl=0.03342 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03342 max_kl=0.06501
[Time] Env Create Time: 4.3924s |Rollout Collect Time: 1.6962s |Loss & Update :0.6708
[PPODiag] kl_mean=0.0211, kl_p90=0.0450, kl_max=0.0650 | clipfrac_mean=0.023, logratio_std_mean=0.266, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.680 | pg_loss_mean=0.0056, v_loss_mean=0.0249, ent_mean=0.0178 | gn_bb_mean=0.760, gn_bb_max=1.858 | gn_v_mean=0.418, gn_v_max=0.703
[AttnScore] scale=1.0504, C=10.0

  7%|▋         | 351/5000 [43:23<9:18:14,  7.20s/it]------------------ Training Record ------------------
Epoch: 351/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0969, reward_valid_std=4.1767
[BatchDiag] adv_mean=-0.0153, adv_std=0.3396, adv_abs_mean=0.2277 | ret_mean=8.9278, ret_std=0.6101 | val_mean=8.9431, val_std=0.4695 | explained_var=0.690219
[GradSplit pre-clip] backbone=0.674837, critic=0.296254
[Loss] pg_loss=-0.079562, entropy_loss=0.000017, value_loss=0.008104
[EpochKL] epoch=0 mean_kl=0.00263 max_kl=0.00858
[EpochKL] epoch=1 mean_kl=0.00913 max_kl=0.01936
[EarlyStop] epoch=2 mean_kl=0.01640 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01640 max_kl=0.02716
[Time] Env Create Time: 4.3920s |Rollout Collect Time: 1.6875s |Loss & Update :0.9585
[PPODiag] kl_mean=0.0094, kl_p90=0.0193, kl_max=0.0272 | clipfrac_mean=0.017, logratio_std_mean=0.156, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.678 | pg_loss_mean=0.0006, v_loss_mean=0.0268, ent_mean=0.0167 | gn_bb_mean=0.730, gn_bb_max=2.334 | gn_v_mean=0.328, gn_v_max=0.860

  7%|▋         | 352/5000 [43:30<9:14:15,  7.15s/it]------------------ Training Record ------------------
Epoch: 352/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0922, reward_valid_std=4.1786
[BatchDiag] adv_mean=0.0015, adv_std=0.3384, adv_abs_mean=0.2195 | ret_mean=8.9343, ret_std=0.6166 | val_mean=8.9327, val_std=0.5062 | explained_var=0.698860
[GradSplit pre-clip] backbone=0.563688, critic=0.375792
[Loss] pg_loss=-0.068929, entropy_loss=0.000015, value_loss=0.011326
[EpochKL] epoch=0 mean_kl=0.00137 max_kl=0.00274
[EpochKL] epoch=1 mean_kl=0.00488 max_kl=0.01540
[EarlyStop] epoch=2 mean_kl=0.01285 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01285 max_kl=0.02005
[Time] Env Create Time: 4.3877s |Rollout Collect Time: 1.6802s |Loss & Update :0.9624
[PPODiag] kl_mean=0.0064, kl_p90=0.0153, kl_max=0.0200 | clipfrac_mean=0.015, logratio_std_mean=0.126, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.685, min=0.680 | pg_loss_mean=0.0014, v_loss_mean=0.0267, ent_mean=0.0169 | gn_bb_mean=0.738, gn_bb_max=1.256 | gn_v_mean=0.252, gn_v_max=0.864

  7%|▋         | 353/5000 [43:37<9:11:15,  7.12s/it]------------------ Training Record ------------------
Epoch: 353/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1120, reward_valid_std=4.1828
[BatchDiag] adv_mean=-0.0189, adv_std=0.2928, adv_abs_mean=0.1978 | ret_mean=8.9577, ret_std=0.5839 | val_mean=8.9767, val_std=0.4948 | explained_var=0.748518
[GradSplit pre-clip] backbone=2.467999, critic=0.170867
[Loss] pg_loss=-0.078209, entropy_loss=0.000009, value_loss=0.007832
[EarlyStop] epoch=0 mean_kl=0.04019 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.04019 max_kl=0.11041
[Time] Env Create Time: 4.6111s |Rollout Collect Time: 1.6954s |Loss & Update :0.3501
[PPODiag] kl_mean=0.0402, kl_p90=0.0957, kl_max=0.1104 | clipfrac_mean=0.026, logratio_std_mean=0.422, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.678 | pg_loss_mean=0.0167, v_loss_mean=0.0212, ent_mean=0.0151 | gn_bb_mean=1.964, gn_bb_max=6.081 | gn_v_mean=0.228, gn_v_max=0.317

  7%|▋         | 354/5000 [43:44<9:00:26,  6.98s/it]------------------ Training Record ------------------
Epoch: 354/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1074, reward_valid_std=4.1764
[BatchDiag] adv_mean=0.0062, adv_std=0.2923, adv_abs_mean=0.2017 | ret_mean=8.9554, ret_std=0.5731 | val_mean=8.9492, val_std=0.5197 | explained_var=0.739962
[GradSplit pre-clip] backbone=0.666244, critic=0.134342
[Loss] pg_loss=0.003022, entropy_loss=0.000014, value_loss=0.010415
[EarlyStop] epoch=0 mean_kl=0.02677 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02677 max_kl=0.05578
[Time] Env Create Time: 4.4220s |Rollout Collect Time: 1.6804s |Loss & Update :0.3474
[PPODiag] kl_mean=0.0268, kl_p90=0.0515, kl_max=0.0558 | clipfrac_mean=0.031, logratio_std_mean=0.276, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.680 | pg_loss_mean=0.0081, v_loss_mean=0.0216, ent_mean=0.0206 | gn_bb_mean=1.447, gn_bb_max=4.732 | gn_v_mean=0.227, gn_v_max=0.299

  7%|▋         | 355/5000 [43:50<8:48:01,  6.82s/it]------------------ Training Record ------------------
Epoch: 355/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0954, reward_valid_std=4.1767
[BatchDiag] adv_mean=-0.0371, adv_std=0.3180, adv_abs_mean=0.2123 | ret_mean=8.9459, ret_std=0.5886 | val_mean=8.9830, val_std=0.4878 | explained_var=0.708006
[GradSplit pre-clip] backbone=0.908528, critic=0.212748
[Loss] pg_loss=-0.045502, entropy_loss=0.000017, value_loss=0.010194
[EarlyStop] epoch=0 mean_kl=0.01341 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01341 max_kl=0.05100
[Time] Env Create Time: 4.4209s |Rollout Collect Time: 1.6966s |Loss & Update :0.3612
[PPODiag] kl_mean=0.0134, kl_p90=0.0293, kl_max=0.0510 | clipfrac_mean=0.021, logratio_std_mean=0.169, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.683 | pg_loss_mean=0.0064, v_loss_mean=0.0251, ent_mean=0.0188 | gn_bb_mean=1.440, gn_bb_max=3.026 | gn_v_mean=0.310, gn_v_max=0.509
[AttnScore] scale=1.0503, C=10.0

  7%|▋         | 356/5000 [43:57<8:39:59,  6.72s/it]------------------ Training Record ------------------
Epoch: 356/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.594, reward_valid_mean=2.0898, reward_valid_std=4.1701
[BatchDiag] adv_mean=0.0018, adv_std=0.3416, adv_abs_mean=0.2255 | ret_mean=8.9368, ret_std=0.6035 | val_mean=8.9351, val_std=0.5297 | explained_var=0.679614
[GradSplit pre-clip] backbone=0.846794, critic=0.349175
[Loss] pg_loss=-0.067261, entropy_loss=0.000012, value_loss=0.012747
[EpochKL] epoch=0 mean_kl=0.00833 max_kl=0.03939
[EarlyStop] epoch=1 mean_kl=0.02309 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02309 max_kl=0.04652
[Time] Env Create Time: 4.3951s |Rollout Collect Time: 1.9375s |Loss & Update :0.7403
[PPODiag] kl_mean=0.0157, kl_p90=0.0340, kl_max=0.0465 | clipfrac_mean=0.021, logratio_std_mean=0.234, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.594, p10=0.587, min=0.586 | pg_loss_mean=0.0031, v_loss_mean=0.0279, ent_mean=0.0152 | gn_bb_mean=0.871, gn_bb_max=1.678 | gn_v_mean=0.290, gn_v_max=0.471

  7%|▋         | 357/5000 [44:04<8:48:07,  6.82s/it]------------------ Training Record ------------------
Epoch: 357/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.593, reward_valid_mean=2.0948, reward_valid_std=4.1717
[BatchDiag] adv_mean=0.0002, adv_std=0.3251, adv_abs_mean=0.2178 | ret_mean=8.9515, ret_std=0.5898 | val_mean=8.9513, val_std=0.5088 | explained_var=0.696202
[GradSplit pre-clip] backbone=0.454831, critic=0.360924
[Loss] pg_loss=-0.090820, entropy_loss=0.000012, value_loss=0.010978
[EpochKL] epoch=0 mean_kl=0.00435 max_kl=0.01580
[EarlyStop] epoch=1 mean_kl=0.01299 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01299 max_kl=0.03342
[Time] Env Create Time: 4.3823s |Rollout Collect Time: 1.9218s |Loss & Update :0.7387
[PPODiag] kl_mean=0.0087, kl_p90=0.0154, kl_max=0.0334 | clipfrac_mean=0.015, logratio_std_mean=0.149, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.593, p10=0.588, min=0.586 | pg_loss_mean=0.0021, v_loss_mean=0.0253, ent_mean=0.0141 | gn_bb_mean=0.817, gn_bb_max=1.898 | gn_v_mean=0.329, gn_v_max=0.578

  7%|▋         | 358/5000 [44:11<8:53:04,  6.89s/it]------------------ Training Record ------------------
Epoch: 358/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0992, reward_valid_std=4.1726
[BatchDiag] adv_mean=0.0285, adv_std=0.3112, adv_abs_mean=0.2176 | ret_mean=8.9497, ret_std=0.5878 | val_mean=8.9212, val_std=0.4858 | explained_var=0.719722
[GradSplit pre-clip] backbone=0.379928, critic=0.371903
[Loss] pg_loss=0.001006, entropy_loss=0.000015, value_loss=0.012246
[EpochKL] epoch=0 mean_kl=0.00666 max_kl=0.01562
[EarlyStop] epoch=1 mean_kl=0.03272 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03272 max_kl=0.04864
[Time] Env Create Time: 4.3902s |Rollout Collect Time: 1.7002s |Loss & Update :0.6650
[PPODiag] kl_mean=0.0197, kl_p90=0.0433, kl_max=0.0486 | clipfrac_mean=0.023, logratio_std_mean=0.248, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.683, min=0.683 | pg_loss_mean=0.0065, v_loss_mean=0.0241, ent_mean=0.0173 | gn_bb_mean=1.478, gn_bb_max=5.802 | gn_v_mean=0.356, gn_v_max=0.729

  7%|▋         | 359/5000 [44:18<8:49:50,  6.85s/it]------------------ Training Record ------------------
Epoch: 359/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.594, reward_valid_mean=2.0930, reward_valid_std=4.1706
[BatchDiag] adv_mean=0.0145, adv_std=0.3279, adv_abs_mean=0.2248 | ret_mean=8.9467, ret_std=0.5824 | val_mean=8.9323, val_std=0.5101 | explained_var=0.683011
[GradSplit pre-clip] backbone=0.697208, critic=0.212993
[Loss] pg_loss=0.054705, entropy_loss=0.000018, value_loss=0.013465
[EpochKL] epoch=0 mean_kl=0.00717 max_kl=0.01465
[EarlyStop] epoch=1 mean_kl=0.01316 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01316 max_kl=0.02906
[Time] Env Create Time: 4.3567s |Rollout Collect Time: 1.9348s |Loss & Update :0.7256
[PPODiag] kl_mean=0.0102, kl_p90=0.0157, kl_max=0.0291 | clipfrac_mean=0.024, logratio_std_mean=0.168, ratio_p95_mean=1.009 | valid_ratio_mb_mean=0.594, p10=0.589, min=0.587 | pg_loss_mean=0.0018, v_loss_mean=0.0255, ent_mean=0.0192 | gn_bb_mean=0.978, gn_bb_max=1.854 | gn_v_mean=0.261, gn_v_max=0.577

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.977, Step: 7, Avg Done Step: 6.63, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8120s
-----------------------------
  7%|▋         | 360/5000 [44:27<9:36:29,  7.45s/it]------------------ Training Record ------------------
Epoch: 360/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1060, reward_valid_std=4.1751
[BatchDiag] adv_mean=-0.0200, adv_std=0.3179, adv_abs_mean=0.2078 | ret_mean=8.9519, ret_std=0.5818 | val_mean=8.9719, val_std=0.4971 | explained_var=0.701433
[GradSplit pre-clip] backbone=0.407366, critic=0.154221
[Loss] pg_loss=-0.003266, entropy_loss=0.000010, value_loss=0.011694
[EpochKL] epoch=0 mean_kl=0.00656 max_kl=0.01637
[EpochKL] epoch=1 mean_kl=0.00954 max_kl=0.01999
[EarlyStop] epoch=2 mean_kl=0.01008 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01008 max_kl=0.01579
[Time] Env Create Time: 4.6054s |Rollout Collect Time: 1.6960s |Loss & Update :0.9704
[PPODiag] kl_mean=0.0087, kl_p90=0.0161, kl_max=0.0200 | clipfrac_mean=0.017, logratio_std_mean=0.164, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.679 | pg_loss_mean=0.0017, v_loss_mean=0.0244, ent_mean=0.0167 | gn_bb_mean=0.799, gn_bb_max=1.847 | gn_v_mean=0.233, gn_v_max=0.605
[AttnScore] scale=1.0500, C=10.0

  7%|▋         | 361/5000 [44:34<9:32:08,  7.40s/it]------------------ Training Record ------------------
Epoch: 361/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0954, reward_valid_std=4.1708
[BatchDiag] adv_mean=0.0118, adv_std=0.3306, adv_abs_mean=0.2230 | ret_mean=8.9385, ret_std=0.5970 | val_mean=8.9266, val_std=0.5042 | explained_var=0.693364
[GradSplit pre-clip] backbone=0.225247, critic=0.430604
[Loss] pg_loss=-0.054333, entropy_loss=0.000013, value_loss=0.012991
[EpochKL] epoch=0 mean_kl=0.00464 max_kl=0.02104
[EarlyStop] epoch=1 mean_kl=0.01794 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01794 max_kl=0.02940
[Time] Env Create Time: 4.4049s |Rollout Collect Time: 1.7052s |Loss & Update :0.6677
[PPODiag] kl_mean=0.0113, kl_p90=0.0239, kl_max=0.0294 | clipfrac_mean=0.016, logratio_std_mean=0.209, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.684, min=0.683 | pg_loss_mean=0.0020, v_loss_mean=0.0259, ent_mean=0.0170 | gn_bb_mean=1.090, gn_bb_max=4.849 | gn_v_mean=0.290, gn_v_max=0.539

  7%|▋         | 362/5000 [44:41<9:17:35,  7.21s/it]------------------ Training Record ------------------
Epoch: 362/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1042, reward_valid_std=4.1761
[BatchDiag] adv_mean=-0.0011, adv_std=0.3135, adv_abs_mean=0.2080 | ret_mean=8.9542, ret_std=0.5866 | val_mean=8.9554, val_std=0.4731 | explained_var=0.714407
[GradSplit pre-clip] backbone=0.715394, critic=0.411448
[Loss] pg_loss=-0.124116, entropy_loss=0.000008, value_loss=0.008297
[EpochKL] epoch=0 mean_kl=0.00318 max_kl=0.00840
[EarlyStop] epoch=1 mean_kl=0.01049 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01049 max_kl=0.01883
[Time] Env Create Time: 4.4274s |Rollout Collect Time: 1.9298s |Loss & Update :0.7500
[PPODiag] kl_mean=0.0068, kl_p90=0.0124, kl_max=0.0188 | clipfrac_mean=0.014, logratio_std_mean=0.126, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.585, min=0.582 | pg_loss_mean=0.0016, v_loss_mean=0.0237, ent_mean=0.0126 | gn_bb_mean=0.864, gn_bb_max=3.092 | gn_v_mean=0.282, gn_v_max=0.532

  7%|▋         | 363/5000 [44:48<9:15:01,  7.18s/it]------------------ Training Record ------------------
Epoch: 363/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1007, reward_valid_std=4.1785
[BatchDiag] adv_mean=0.0272, adv_std=0.3192, adv_abs_mean=0.2163 | ret_mean=8.9511, ret_std=0.5970 | val_mean=8.9238, val_std=0.4910 | explained_var=0.714065
[GradSplit pre-clip] backbone=1.348417, critic=0.458165
[Loss] pg_loss=-0.039901, entropy_loss=0.000020, value_loss=0.011286
[EarlyStop] epoch=0 mean_kl=0.01001 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01001 max_kl=0.02715
[Time] Env Create Time: 4.4192s |Rollout Collect Time: 1.6924s |Loss & Update :0.3631
[PPODiag] kl_mean=0.0100, kl_p90=0.0229, kl_max=0.0271 | clipfrac_mean=0.020, logratio_std_mean=0.142, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.683 | pg_loss_mean=0.0045, v_loss_mean=0.0248, ent_mean=0.0190 | gn_bb_mean=1.199, gn_bb_max=1.980 | gn_v_mean=0.408, gn_v_max=0.864

  7%|▋         | 364/5000 [44:54<8:58:31,  6.97s/it]------------------ Training Record ------------------
Epoch: 364/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0881, reward_valid_std=4.1682
[BatchDiag] adv_mean=-0.0322, adv_std=0.3291, adv_abs_mean=0.2104 | ret_mean=8.9396, ret_std=0.6021 | val_mean=8.9719, val_std=0.4890 | explained_var=0.701246
[GradSplit pre-clip] backbone=1.273128, critic=0.234616
[Loss] pg_loss=0.014999, entropy_loss=0.000023, value_loss=0.014444
[EpochKL] epoch=0 mean_kl=0.00407 max_kl=0.00885
[EpochKL] epoch=1 mean_kl=0.00921 max_kl=0.02483
[EarlyStop] epoch=2 mean_kl=0.02749 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02749 max_kl=0.04147
[Time] Env Create Time: 4.3990s |Rollout Collect Time: 1.7019s |Loss & Update :0.9696
[PPODiag] kl_mean=0.0136, kl_p90=0.0299, kl_max=0.0415 | clipfrac_mean=0.023, logratio_std_mean=0.205, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.693, p10=0.686, min=0.685 | pg_loss_mean=0.0020, v_loss_mean=0.0263, ent_mean=0.0190 | gn_bb_mean=0.805, gn_bb_max=2.487 | gn_v_mean=0.270, gn_v_max=0.538

  7%|▋         | 365/5000 [45:01<9:00:45,  7.00s/it]------------------ Training Record ------------------
Epoch: 365/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1056, reward_valid_std=4.1776
[BatchDiag] adv_mean=-0.0269, adv_std=0.3173, adv_abs_mean=0.2096 | ret_mean=8.9499, ret_std=0.5939 | val_mean=8.9768, val_std=0.4730 | explained_var=0.714561
[GradSplit pre-clip] backbone=0.506588, critic=0.193141
[Loss] pg_loss=-0.079429, entropy_loss=0.000014, value_loss=0.009725
[EpochKL] epoch=0 mean_kl=0.00429 max_kl=0.01153
[EarlyStop] epoch=1 mean_kl=0.01115 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01115 max_kl=0.01755
[Time] Env Create Time: 4.3804s |Rollout Collect Time: 1.7027s |Loss & Update :0.6647
[PPODiag] kl_mean=0.0077, kl_p90=0.0163, kl_max=0.0176 | clipfrac_mean=0.020, logratio_std_mean=0.135, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.678 | pg_loss_mean=0.0033, v_loss_mean=0.0248, ent_mean=0.0202 | gn_bb_mean=1.051, gn_bb_max=1.467 | gn_v_mean=0.369, gn_v_max=0.810
[AttnScore] scale=1.0501, C=10.0

  7%|▋         | 366/5000 [45:08<8:54:48,  6.92s/it]------------------ Training Record ------------------
Epoch: 366/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.593, reward_valid_mean=2.0922, reward_valid_std=4.1695
[BatchDiag] adv_mean=0.0074, adv_std=0.3304, adv_abs_mean=0.2231 | ret_mean=8.9359, ret_std=0.5964 | val_mean=8.9285, val_std=0.4938 | explained_var=0.693064
[GradSplit pre-clip] backbone=0.671488, critic=0.437739
[Loss] pg_loss=-0.046199, entropy_loss=0.000012, value_loss=0.012589
[EpochKL] epoch=0 mean_kl=0.00857 max_kl=0.01944
[EarlyStop] epoch=1 mean_kl=0.03063 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03063 max_kl=0.06344
[Time] Env Create Time: 4.6488s |Rollout Collect Time: 1.9499s |Loss & Update :0.7344
[PPODiag] kl_mean=0.0196, kl_p90=0.0340, kl_max=0.0634 | clipfrac_mean=0.022, logratio_std_mean=0.277, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.593, p10=0.587, min=0.585 | pg_loss_mean=0.0038, v_loss_mean=0.0265, ent_mean=0.0157 | gn_bb_mean=0.935, gn_bb_max=1.851 | gn_v_mean=0.295, gn_v_max=0.468

  7%|▋         | 367/5000 [45:15<9:04:09,  7.05s/it]------------------ Training Record ------------------
Epoch: 367/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0949, reward_valid_std=4.1720
[BatchDiag] adv_mean=-0.0010, adv_std=0.3223, adv_abs_mean=0.2170 | ret_mean=8.9466, ret_std=0.5902 | val_mean=8.9476, val_std=0.5162 | explained_var=0.701757
[GradSplit pre-clip] backbone=0.835308, critic=0.316675
[Loss] pg_loss=-0.100356, entropy_loss=0.000017, value_loss=0.008456
[EpochKL] epoch=0 mean_kl=0.00307 max_kl=0.00644
[EpochKL] epoch=1 mean_kl=0.00989 max_kl=0.01821
[EpochKL] epoch=2 mean_kl=0.00528 max_kl=0.00654
[Time] Env Create Time: 4.4278s |Rollout Collect Time: 1.6996s |Loss & Update :0.9627
[PPODiag] kl_mean=0.0061, kl_p90=0.0106, kl_max=0.0182 | clipfrac_mean=0.015, logratio_std_mean=0.124, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.682 | pg_loss_mean=0.0015, v_loss_mean=0.0242, ent_mean=0.0179 | gn_bb_mean=0.839, gn_bb_max=1.989 | gn_v_mean=0.224, gn_v_max=0.526

  7%|▋         | 368/5000 [45:23<9:05:02,  7.06s/it]------------------ Training Record ------------------
Epoch: 368/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1044, reward_valid_std=4.1783
[BatchDiag] adv_mean=0.0059, adv_std=0.2878, adv_abs_mean=0.1958 | ret_mean=8.9493, ret_std=0.5788 | val_mean=8.9435, val_std=0.4930 | explained_var=0.752767
[GradSplit pre-clip] backbone=0.493277, critic=0.256610
[Loss] pg_loss=-0.047783, entropy_loss=0.000016, value_loss=0.008657
[EpochKL] epoch=0 mean_kl=0.00188 max_kl=0.00377
[EpochKL] epoch=1 mean_kl=0.00584 max_kl=0.01231
[EpochKL] epoch=2 mean_kl=0.00814 max_kl=0.02153
[Time] Env Create Time: 4.4237s |Rollout Collect Time: 1.6982s |Loss & Update :0.9625
[PPODiag] kl_mean=0.0053, kl_p90=0.0115, kl_max=0.0215 | clipfrac_mean=0.014, logratio_std_mean=0.105, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.677 | pg_loss_mean=0.0008, v_loss_mean=0.0203, ent_mean=0.0174 | gn_bb_mean=0.658, gn_bb_max=1.308 | gn_v_mean=0.229, gn_v_max=0.525

  7%|▋         | 369/5000 [45:30<9:05:29,  7.07s/it]------------------ Training Record ------------------
Epoch: 369/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1039, reward_valid_std=4.1747
[BatchDiag] adv_mean=-0.0040, adv_std=0.3075, adv_abs_mean=0.2066 | ret_mean=8.9543, ret_std=0.5926 | val_mean=8.9583, val_std=0.4958 | explained_var=0.730741
[GradSplit pre-clip] backbone=0.459679, critic=0.182552
[Loss] pg_loss=-0.014920, entropy_loss=0.000014, value_loss=0.011348
[EpochKL] epoch=0 mean_kl=0.00223 max_kl=0.00517
[EpochKL] epoch=1 mean_kl=0.00660 max_kl=0.01196
[EarlyStop] epoch=2 mean_kl=0.01127 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01127 max_kl=0.02083
[Time] Env Create Time: 4.4122s |Rollout Collect Time: 1.9434s |Loss & Update :1.0914
[PPODiag] kl_mean=0.0067, kl_p90=0.0131, kl_max=0.0208 | clipfrac_mean=0.016, logratio_std_mean=0.127, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.591, p10=0.587, min=0.581 | pg_loss_mean=0.0016, v_loss_mean=0.0229, ent_mean=0.0153 | gn_bb_mean=0.751, gn_bb_max=1.761 | gn_v_mean=0.291, gn_v_max=0.543

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.017, Step: 7, Avg Done Step: 6.59, #CS visited: 0.16
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8212s
-----------------------------
  7%|▋         | 370/5000 [45:39<9:56:58,  7.74s/it]------------------ Training Record ------------------
Epoch: 370/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1075, reward_valid_std=4.1838
[BatchDiag] adv_mean=0.0139, adv_std=0.2946, adv_abs_mean=0.2035 | ret_mean=8.9494, ret_std=0.5918 | val_mean=8.9355, val_std=0.5066 | explained_var=0.752218
[GradSplit pre-clip] backbone=0.644600, critic=0.460109
[Loss] pg_loss=-0.099062, entropy_loss=0.000012, value_loss=0.009064
[EpochKL] epoch=0 mean_kl=0.00459 max_kl=0.01165
[EarlyStop] epoch=1 mean_kl=0.08288 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.08288 max_kl=0.52430
[Time] Env Create Time: 4.4591s |Rollout Collect Time: 1.8744s |Loss & Update :0.6645
[PPODiag] kl_mean=0.0437, kl_p90=0.0326, kl_max=0.5243 | clipfrac_mean=0.022, logratio_std_mean=0.184, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.681 | pg_loss_mean=0.0035, v_loss_mean=0.0215, ent_mean=0.0173 | gn_bb_mean=1.070, gn_bb_max=1.876 | gn_v_mean=0.283, gn_v_max=0.530
[AttnScore] scale=1.0507, C=10.0

  7%|▋         | 371/5000 [45:46<9:39:46,  7.51s/it]------------------ Training Record ------------------
Epoch: 371/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1068, reward_valid_std=4.1843
[BatchDiag] adv_mean=-0.0287, adv_std=0.3022, adv_abs_mean=0.2014 | ret_mean=8.9621, ret_std=0.5911 | val_mean=8.9908, val_std=0.5184 | explained_var=0.738656
[GradSplit pre-clip] backbone=1.823721, critic=0.162644
[Loss] pg_loss=-0.058936, entropy_loss=0.000015, value_loss=0.007977
[EarlyStop] epoch=0 mean_kl=0.01660 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01660 max_kl=0.05637
[Time] Env Create Time: 4.4353s |Rollout Collect Time: 1.7070s |Loss & Update :0.3601
[PPODiag] kl_mean=0.0166, kl_p90=0.0405, kl_max=0.0564 | clipfrac_mean=0.022, logratio_std_mean=0.200, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.681 | pg_loss_mean=0.0045, v_loss_mean=0.0225, ent_mean=0.0185 | gn_bb_mean=1.659, gn_bb_max=4.937 | gn_v_mean=0.209, gn_v_max=0.347

  7%|▋         | 372/5000 [45:52<9:16:13,  7.21s/it]------------------ Training Record ------------------
Epoch: 372/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1152, reward_valid_std=4.1832
[BatchDiag] adv_mean=0.0103, adv_std=0.2931, adv_abs_mean=0.2016 | ret_mean=8.9502, ret_std=0.5929 | val_mean=8.9399, val_std=0.4861 | explained_var=0.755543
[GradSplit pre-clip] backbone=1.346069, critic=0.322797
[Loss] pg_loss=-0.048772, entropy_loss=0.000014, value_loss=0.007662
[EarlyStop] epoch=0 mean_kl=0.01134 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01134 max_kl=0.02979
[Time] Env Create Time: 4.4375s |Rollout Collect Time: 1.6997s |Loss & Update :0.3549
[PPODiag] kl_mean=0.0113, kl_p90=0.0222, kl_max=0.0298 | clipfrac_mean=0.019, logratio_std_mean=0.170, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.682, min=0.679 | pg_loss_mean=0.0029, v_loss_mean=0.0205, ent_mean=0.0179 | gn_bb_mean=1.360, gn_bb_max=2.814 | gn_v_mean=0.230, gn_v_max=0.391

  7%|▋         | 373/5000 [45:59<8:59:28,  7.00s/it]------------------ Training Record ------------------
Epoch: 373/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.586, reward_valid_mean=2.1198, reward_valid_std=4.1910
[BatchDiag] adv_mean=0.0165, adv_std=0.2958, adv_abs_mean=0.2000 | ret_mean=8.9559, ret_std=0.5988 | val_mean=8.9394, val_std=0.4882 | explained_var=0.755940
[GradSplit pre-clip] backbone=1.001076, critic=0.499860
[Loss] pg_loss=-0.105047, entropy_loss=0.000012, value_loss=0.008489
[EpochKL] epoch=0 mean_kl=0.00610 max_kl=0.01563
[EarlyStop] epoch=1 mean_kl=0.02188 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02188 max_kl=0.03592
[Time] Env Create Time: 4.4123s |Rollout Collect Time: 1.9224s |Loss & Update :0.7271
[PPODiag] kl_mean=0.0140, kl_p90=0.0329, kl_max=0.0359 | clipfrac_mean=0.022, logratio_std_mean=0.199, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.586, p10=0.582, min=0.579 | pg_loss_mean=0.0029, v_loss_mean=0.0216, ent_mean=0.0144 | gn_bb_mean=0.893, gn_bb_max=1.863 | gn_v_mean=0.333, gn_v_max=0.524

  7%|▋         | 374/5000 [46:06<9:00:54,  7.02s/it]------------------ Training Record ------------------
Epoch: 374/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1126, reward_valid_std=4.1831
[BatchDiag] adv_mean=0.0090, adv_std=0.3074, adv_abs_mean=0.2061 | ret_mean=8.9489, ret_std=0.5919 | val_mean=8.9400, val_std=0.5019 | explained_var=0.730272
[GradSplit pre-clip] backbone=0.649812, critic=0.394440
[Loss] pg_loss=-0.093714, entropy_loss=0.000016, value_loss=0.007947
[EpochKL] epoch=0 mean_kl=0.00713 max_kl=0.01575
[EarlyStop] epoch=1 mean_kl=0.01175 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01175 max_kl=0.01734
[Time] Env Create Time: 4.4229s |Rollout Collect Time: 1.6893s |Loss & Update :0.6512
[PPODiag] kl_mean=0.0094, kl_p90=0.0162, kl_max=0.0173 | clipfrac_mean=0.017, logratio_std_mean=0.169, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.682, min=0.678 | pg_loss_mean=0.0020, v_loss_mean=0.0231, ent_mean=0.0170 | gn_bb_mean=0.973, gn_bb_max=2.639 | gn_v_mean=0.319, gn_v_max=0.476

  8%|▊         | 375/5000 [46:13<8:54:57,  6.94s/it]------------------ Training Record ------------------
Epoch: 375/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1109, reward_valid_std=4.1851
[BatchDiag] adv_mean=-0.0394, adv_std=0.3124, adv_abs_mean=0.2042 | ret_mean=8.9527, ret_std=0.5942 | val_mean=8.9922, val_std=0.5286 | explained_var=0.723580
[GradSplit pre-clip] backbone=0.756572, critic=0.396483
[Loss] pg_loss=-0.003251, entropy_loss=0.000012, value_loss=0.008947
[EpochKL] epoch=0 mean_kl=0.00533 max_kl=0.01205
[EarlyStop] epoch=1 mean_kl=0.02161 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02161 max_kl=0.03555
[Time] Env Create Time: 4.4236s |Rollout Collect Time: 1.7032s |Loss & Update :0.6564
[PPODiag] kl_mean=0.0135, kl_p90=0.0269, kl_max=0.0355 | clipfrac_mean=0.021, logratio_std_mean=0.191, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.679, min=0.675 | pg_loss_mean=0.0046, v_loss_mean=0.0232, ent_mean=0.0184 | gn_bb_mean=1.244, gn_bb_max=3.674 | gn_v_mean=0.362, gn_v_max=0.888
[AttnScore] scale=1.0503, C=10.0

  8%|▊         | 376/5000 [46:20<8:51:14,  6.89s/it]------------------ Training Record ------------------
Epoch: 376/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.684, reward_valid_mean=2.1197, reward_valid_std=4.1887
[BatchDiag] adv_mean=0.0183, adv_std=0.2874, adv_abs_mean=0.1956 | ret_mean=8.9556, ret_std=0.5798 | val_mean=8.9373, val_std=0.4837 | explained_var=0.754257
[GradSplit pre-clip] backbone=0.572491, critic=0.411437
[Loss] pg_loss=-0.067523, entropy_loss=0.000011, value_loss=0.006408
[EpochKL] epoch=0 mean_kl=0.00418 max_kl=0.00827
[EarlyStop] epoch=1 mean_kl=0.02305 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02305 max_kl=0.03754
[Time] Env Create Time: 4.6152s |Rollout Collect Time: 1.6955s |Loss & Update :0.6644
[PPODiag] kl_mean=0.0136, kl_p90=0.0319, kl_max=0.0375 | clipfrac_mean=0.021, logratio_std_mean=0.196, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.684, p10=0.678, min=0.677 | pg_loss_mean=0.0055, v_loss_mean=0.0197, ent_mean=0.0165 | gn_bb_mean=0.945, gn_bb_max=1.661 | gn_v_mean=0.215, gn_v_max=0.538

  8%|▊         | 377/5000 [46:27<8:53:01,  6.92s/it]------------------ Training Record ------------------
Epoch: 377/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1041, reward_valid_std=4.1835
[BatchDiag] adv_mean=-0.0332, adv_std=0.3200, adv_abs_mean=0.2042 | ret_mean=8.9458, ret_std=0.6109 | val_mean=8.9790, val_std=0.5092 | explained_var=0.725595
[GradSplit pre-clip] backbone=0.307866, critic=0.166367
[Loss] pg_loss=-0.127025, entropy_loss=0.000018, value_loss=0.007571
[EpochKL] epoch=0 mean_kl=0.00373 max_kl=0.01443
[EarlyStop] epoch=1 mean_kl=0.02106 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02106 max_kl=0.03454
[Time] Env Create Time: 4.4337s |Rollout Collect Time: 1.7057s |Loss & Update :0.6670
[PPODiag] kl_mean=0.0124, kl_p90=0.0298, kl_max=0.0345 | clipfrac_mean=0.020, logratio_std_mean=0.178, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.682 | pg_loss_mean=0.0037, v_loss_mean=0.0247, ent_mean=0.0205 | gn_bb_mean=1.243, gn_bb_max=2.820 | gn_v_mean=0.267, gn_v_max=0.563

  8%|▊         | 378/5000 [46:33<8:50:20,  6.88s/it]------------------ Training Record ------------------
Epoch: 378/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.684, reward_valid_mean=2.1174, reward_valid_std=4.1928
[BatchDiag] adv_mean=0.0331, adv_std=0.2825, adv_abs_mean=0.1979 | ret_mean=8.9510, ret_std=0.5803 | val_mean=8.9178, val_std=0.5177 | explained_var=0.762920
[GradSplit pre-clip] backbone=1.024040, critic=0.299596
[Loss] pg_loss=0.035842, entropy_loss=0.000016, value_loss=0.010192
[EpochKL] epoch=0 mean_kl=0.00761 max_kl=0.01533
[EarlyStop] epoch=1 mean_kl=0.02381 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02381 max_kl=0.03094
[Time] Env Create Time: 4.4850s |Rollout Collect Time: 1.6982s |Loss & Update :0.6650
[PPODiag] kl_mean=0.0157, kl_p90=0.0280, kl_max=0.0309 | clipfrac_mean=0.022, logratio_std_mean=0.230, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.684, p10=0.681, min=0.680 | pg_loss_mean=0.0038, v_loss_mean=0.0196, ent_mean=0.0167 | gn_bb_mean=0.941, gn_bb_max=1.629 | gn_v_mean=0.271, gn_v_max=0.463

  8%|▊         | 379/5000 [46:40<8:49:23,  6.87s/it]------------------ Training Record ------------------
Epoch: 379/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.588, reward_valid_mean=2.1086, reward_valid_std=4.1853
[BatchDiag] adv_mean=-0.0176, adv_std=0.3107, adv_abs_mean=0.2037 | ret_mean=8.9374, ret_std=0.6044 | val_mean=8.9550, val_std=0.4993 | explained_var=0.735754
[GradSplit pre-clip] backbone=0.867703, critic=0.199658
[Loss] pg_loss=-0.097544, entropy_loss=0.000014, value_loss=0.008838
[EpochKL] epoch=0 mean_kl=0.00772 max_kl=0.01976
[EarlyStop] epoch=1 mean_kl=0.01431 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01431 max_kl=0.02576
[Time] Env Create Time: 4.4542s |Rollout Collect Time: 1.9380s |Loss & Update :0.7326
[PPODiag] kl_mean=0.0110, kl_p90=0.0176, kl_max=0.0258 | clipfrac_mean=0.019, logratio_std_mean=0.187, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.588, p10=0.583, min=0.582 | pg_loss_mean=0.0010, v_loss_mean=0.0239, ent_mean=0.0137 | gn_bb_mean=0.830, gn_bb_max=2.220 | gn_v_mean=0.330, gn_v_max=0.644

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.012, Step: 7, Avg Done Step: 6.59, #CS visited: 0.15
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8404s
-----------------------------
  8%|▊         | 380/5000 [46:49<9:38:25,  7.51s/it]------------------ Training Record ------------------
Epoch: 380/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1153, reward_valid_std=4.1871
[BatchDiag] adv_mean=-0.0035, adv_std=0.2852, adv_abs_mean=0.1900 | ret_mean=8.9569, ret_std=0.5794 | val_mean=8.9604, val_std=0.5026 | explained_var=0.757610
[GradSplit pre-clip] backbone=0.602512, critic=0.174174
[Loss] pg_loss=-0.032388, entropy_loss=0.000018, value_loss=0.010416
[EpochKL] epoch=0 mean_kl=0.00218 max_kl=0.00458
[EpochKL] epoch=1 mean_kl=0.00793 max_kl=0.01775
[EpochKL] epoch=2 mean_kl=0.00995 max_kl=0.01615
[Time] Env Create Time: 4.4041s |Rollout Collect Time: 1.6957s |Loss & Update :0.9632
[PPODiag] kl_mean=0.0067, kl_p90=0.0148, kl_max=0.0178 | clipfrac_mean=0.015, logratio_std_mean=0.115, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.680, min=0.679 | pg_loss_mean=0.0023, v_loss_mean=0.0197, ent_mean=0.0168 | gn_bb_mean=1.118, gn_bb_max=3.816 | gn_v_mean=0.241, gn_v_max=0.681
[AttnScore] scale=1.0503, C=10.0

  8%|▊         | 381/5000 [46:56<9:27:56,  7.38s/it]------------------ Training Record ------------------
Epoch: 381/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1119, reward_valid_std=4.1859
[BatchDiag] adv_mean=-0.0290, adv_std=0.2978, adv_abs_mean=0.1966 | ret_mean=8.9545, ret_std=0.5844 | val_mean=8.9835, val_std=0.4803 | explained_var=0.740261
[GradSplit pre-clip] backbone=0.608404, critic=0.176930
[Loss] pg_loss=-0.071018, entropy_loss=0.000018, value_loss=0.008123
[EpochKL] epoch=0 mean_kl=0.00427 max_kl=0.01084
[EarlyStop] epoch=1 mean_kl=0.01683 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01683 max_kl=0.03337
[Time] Env Create Time: 4.4094s |Rollout Collect Time: 1.6955s |Loss & Update :0.6552
[PPODiag] kl_mean=0.0105, kl_p90=0.0247, kl_max=0.0334 | clipfrac_mean=0.019, logratio_std_mean=0.163, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.678 | pg_loss_mean=0.0044, v_loss_mean=0.0217, ent_mean=0.0187 | gn_bb_mean=1.353, gn_bb_max=5.554 | gn_v_mean=0.364, gn_v_max=0.683

  8%|▊         | 382/5000 [47:03<9:13:34,  7.19s/it]------------------ Training Record ------------------
Epoch: 382/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1159, reward_valid_std=4.1875
[BatchDiag] adv_mean=0.0123, adv_std=0.2991, adv_abs_mean=0.1997 | ret_mean=8.9540, ret_std=0.5963 | val_mean=8.9417, val_std=0.5206 | explained_var=0.748489
[GradSplit pre-clip] backbone=0.710692, critic=0.464155
[Loss] pg_loss=-0.107922, entropy_loss=0.000015, value_loss=0.008692
[EarlyStop] epoch=0 mean_kl=0.01977 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01977 max_kl=0.04305
[Time] Env Create Time: 4.6245s |Rollout Collect Time: 1.7018s |Loss & Update :0.3602
[PPODiag] kl_mean=0.0198, kl_p90=0.0356, kl_max=0.0431 | clipfrac_mean=0.023, logratio_std_mean=0.238, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.685, p10=0.679, min=0.678 | pg_loss_mean=0.0080, v_loss_mean=0.0226, ent_mean=0.0171 | gn_bb_mean=1.306, gn_bb_max=3.187 | gn_v_mean=0.439, gn_v_max=0.716

  8%|▊         | 383/5000 [47:10<9:01:47,  7.04s/it]------------------ Training Record ------------------
Epoch: 383/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1066, reward_valid_std=4.1785
[BatchDiag] adv_mean=0.0327, adv_std=0.3391, adv_abs_mean=0.2349 | ret_mean=8.9383, ret_std=0.6153 | val_mean=8.9055, val_std=0.4782 | explained_var=0.696313
[GradSplit pre-clip] backbone=0.494871, critic=0.665841
[Loss] pg_loss=-0.065821, entropy_loss=0.000021, value_loss=0.010757
[EpochKL] epoch=0 mean_kl=0.00363 max_kl=0.01452
[EpochKL] epoch=1 mean_kl=0.00964 max_kl=0.02271
[EarlyStop] epoch=2 mean_kl=0.01909 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01909 max_kl=0.03601
[Time] Env Create Time: 4.4573s |Rollout Collect Time: 1.7006s |Loss & Update :0.9545
[PPODiag] kl_mean=0.0108, kl_p90=0.0218, kl_max=0.0360 | clipfrac_mean=0.019, logratio_std_mean=0.188, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.688, p10=0.681, min=0.677 | pg_loss_mean=0.0018, v_loss_mean=0.0270, ent_mean=0.0198 | gn_bb_mean=0.704, gn_bb_max=1.692 | gn_v_mean=0.276, gn_v_max=0.666

  8%|▊         | 384/5000 [47:17<9:03:19,  7.06s/it]------------------ Training Record ------------------
Epoch: 384/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1088, reward_valid_std=4.1830
[BatchDiag] adv_mean=-0.0069, adv_std=0.3018, adv_abs_mean=0.2059 | ret_mean=8.9482, ret_std=0.5857 | val_mean=8.9551, val_std=0.4846 | explained_var=0.734455
[GradSplit pre-clip] backbone=1.459015, critic=0.325987
[Loss] pg_loss=-0.045353, entropy_loss=0.000018, value_loss=0.010481
[EpochKL] epoch=0 mean_kl=0.00348 max_kl=0.00696
[EarlyStop] epoch=1 mean_kl=0.01513 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01513 max_kl=0.03294
[Time] Env Create Time: 4.4318s |Rollout Collect Time: 1.6917s |Loss & Update :0.6728
[PPODiag] kl_mean=0.0093, kl_p90=0.0226, kl_max=0.0329 | clipfrac_mean=0.017, logratio_std_mean=0.151, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.680 | pg_loss_mean=0.0025, v_loss_mean=0.0219, ent_mean=0.0179 | gn_bb_mean=1.126, gn_bb_max=2.596 | gn_v_mean=0.204, gn_v_max=0.326

  8%|▊         | 385/5000 [47:24<8:57:05,  6.98s/it]------------------ Training Record ------------------
Epoch: 385/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1072, reward_valid_std=4.1857
[BatchDiag] adv_mean=-0.0432, adv_std=0.3070, adv_abs_mean=0.1996 | ret_mean=8.9571, ret_std=0.5946 | val_mean=9.0004, val_std=0.5195 | explained_var=0.733387
[GradSplit pre-clip] backbone=0.415386, critic=0.256197
[Loss] pg_loss=-0.062841, entropy_loss=0.000021, value_loss=0.009326
[EarlyStop] epoch=0 mean_kl=0.01207 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01207 max_kl=0.02277
[Time] Env Create Time: 4.5004s |Rollout Collect Time: 1.7422s |Loss & Update :0.3574
[PPODiag] kl_mean=0.0121, kl_p90=0.0199, kl_max=0.0228 | clipfrac_mean=0.023, logratio_std_mean=0.162, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.686, min=0.685 | pg_loss_mean=0.0063, v_loss_mean=0.0232, ent_mean=0.0243 | gn_bb_mean=1.270, gn_bb_max=2.301 | gn_v_mean=0.339, gn_v_max=0.518
[AttnScore] scale=1.0505, C=10.0

  8%|▊         | 386/5000 [47:30<8:48:09,  6.87s/it]------------------ Training Record ------------------
Epoch: 386/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1052, reward_valid_std=4.1840
[BatchDiag] adv_mean=0.0442, adv_std=0.3120, adv_abs_mean=0.2177 | ret_mean=8.9438, ret_std=0.6015 | val_mean=8.8996, val_std=0.5122 | explained_var=0.730908
[GradSplit pre-clip] backbone=0.528501, critic=0.676314
[Loss] pg_loss=-0.074563, entropy_loss=0.000016, value_loss=0.009900
[EarlyStop] epoch=0 mean_kl=0.01073 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01073 max_kl=0.02621
[Time] Env Create Time: 4.4308s |Rollout Collect Time: 1.6985s |Loss & Update :0.3485
[PPODiag] kl_mean=0.0107, kl_p90=0.0189, kl_max=0.0262 | clipfrac_mean=0.019, logratio_std_mean=0.171, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.683 | pg_loss_mean=0.0057, v_loss_mean=0.0244, ent_mean=0.0170 | gn_bb_mean=0.999, gn_bb_max=1.571 | gn_v_mean=0.450, gn_v_max=0.798

  8%|▊         | 387/5000 [47:37<8:39:02,  6.75s/it]------------------ Training Record ------------------
Epoch: 387/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1083, reward_valid_std=4.1796
[BatchDiag] adv_mean=0.0243, adv_std=0.3089, adv_abs_mean=0.2105 | ret_mean=8.9467, ret_std=0.5935 | val_mean=8.9224, val_std=0.4854 | explained_var=0.728989
[GradSplit pre-clip] backbone=1.375563, critic=0.363076
[Loss] pg_loss=-0.001823, entropy_loss=0.000014, value_loss=0.010754
[EpochKL] epoch=0 mean_kl=0.00366 max_kl=0.00692
[EarlyStop] epoch=1 mean_kl=0.01834 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01834 max_kl=0.03644
[Time] Env Create Time: 4.4064s |Rollout Collect Time: 1.9450s |Loss & Update :0.7438
[PPODiag] kl_mean=0.0110, kl_p90=0.0230, kl_max=0.0364 | clipfrac_mean=0.018, logratio_std_mean=0.181, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.590, p10=0.583, min=0.583 | pg_loss_mean=0.0033, v_loss_mean=0.0229, ent_mean=0.0153 | gn_bb_mean=0.930, gn_bb_max=1.946 | gn_v_mean=0.302, gn_v_max=0.532

  8%|▊         | 388/5000 [47:44<8:46:52,  6.85s/it]------------------ Training Record ------------------
Epoch: 388/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1129, reward_valid_std=4.1828
[BatchDiag] adv_mean=-0.0215, adv_std=0.2915, adv_abs_mean=0.1927 | ret_mean=8.9599, ret_std=0.5844 | val_mean=8.9814, val_std=0.5422 | explained_var=0.751292
[GradSplit pre-clip] backbone=0.463152, critic=0.257152
[Loss] pg_loss=-0.034927, entropy_loss=0.000015, value_loss=0.008792
[EpochKL] epoch=0 mean_kl=0.00483 max_kl=0.01435
[EpochKL] epoch=1 mean_kl=0.00751 max_kl=0.01156
[EarlyStop] epoch=2 mean_kl=0.01347 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01347 max_kl=0.02434
[Time] Env Create Time: 4.6147s |Rollout Collect Time: 1.6936s |Loss & Update :0.9689
[PPODiag] kl_mean=0.0086, kl_p90=0.0139, kl_max=0.0243 | clipfrac_mean=0.018, logratio_std_mean=0.160, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.686, p10=0.682, min=0.679 | pg_loss_mean=0.0022, v_loss_mean=0.0204, ent_mean=0.0177 | gn_bb_mean=0.791, gn_bb_max=1.708 | gn_v_mean=0.248, gn_v_max=0.442

  8%|▊         | 389/5000 [47:51<8:56:31,  6.98s/it]------------------ Training Record ------------------
Epoch: 389/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1047, reward_valid_std=4.1796
[BatchDiag] adv_mean=-0.0132, adv_std=0.3032, adv_abs_mean=0.2034 | ret_mean=8.9504, ret_std=0.5902 | val_mean=8.9636, val_std=0.5157 | explained_var=0.736135
[GradSplit pre-clip] backbone=0.799281, critic=0.156275
[Loss] pg_loss=-0.027980, entropy_loss=0.000016, value_loss=0.009875
[EpochKL] epoch=0 mean_kl=0.00332 max_kl=0.00738
[EarlyStop] epoch=1 mean_kl=0.01662 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01662 max_kl=0.02837
[Time] Env Create Time: 4.4389s |Rollout Collect Time: 1.6959s |Loss & Update :0.6582
[PPODiag] kl_mean=0.0100, kl_p90=0.0190, kl_max=0.0284 | clipfrac_mean=0.020, logratio_std_mean=0.161, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.685 | pg_loss_mean=0.0033, v_loss_mean=0.0225, ent_mean=0.0192 | gn_bb_mean=1.029, gn_bb_max=1.713 | gn_v_mean=0.330, gn_v_max=0.559

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.978, Step: 7, Avg Done Step: 6.63, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8536s
-----------------------------
  8%|▊         | 390/5000 [48:00<9:35:36,  7.49s/it]------------------ Training Record ------------------
Epoch: 390/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.0991, reward_valid_std=4.1799
[BatchDiag] adv_mean=-0.0071, adv_std=0.3118, adv_abs_mean=0.2022 | ret_mean=8.9515, ret_std=0.5977 | val_mean=8.9587, val_std=0.5240 | explained_var=0.727867
[GradSplit pre-clip] backbone=0.886930, critic=0.233786
[Loss] pg_loss=-0.084458, entropy_loss=0.000015, value_loss=0.007242
[EpochKL] epoch=0 mean_kl=0.00616 max_kl=0.01358
[EarlyStop] epoch=1 mean_kl=0.02037 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02037 max_kl=0.02874
[Time] Env Create Time: 4.4230s |Rollout Collect Time: 1.9370s |Loss & Update :0.7287
[PPODiag] kl_mean=0.0133, kl_p90=0.0270, kl_max=0.0287 | clipfrac_mean=0.019, logratio_std_mean=0.209, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.591, p10=0.586, min=0.584 | pg_loss_mean=0.0031, v_loss_mean=0.0240, ent_mean=0.0144 | gn_bb_mean=1.129, gn_bb_max=3.760 | gn_v_mean=0.445, gn_v_max=0.899
[AttnScore] scale=1.0508, C=10.0

  8%|▊         | 391/5000 [48:07<9:26:12,  7.37s/it]------------------ Training Record ------------------
Epoch: 391/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1022, reward_valid_std=4.1769
[BatchDiag] adv_mean=0.0347, adv_std=0.2946, adv_abs_mean=0.2084 | ret_mean=8.9420, ret_std=0.5799 | val_mean=8.9073, val_std=0.4899 | explained_var=0.741961
[GradSplit pre-clip] backbone=0.549382, critic=0.397052
[Loss] pg_loss=0.008477, entropy_loss=0.000020, value_loss=0.011601
[EpochKL] epoch=0 mean_kl=0.00257 max_kl=0.00712
[EarlyStop] epoch=1 mean_kl=0.01365 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01365 max_kl=0.02060
[Time] Env Create Time: 4.4558s |Rollout Collect Time: 1.7009s |Loss & Update :0.6566
[PPODiag] kl_mean=0.0081, kl_p90=0.0164, kl_max=0.0206 | clipfrac_mean=0.016, logratio_std_mean=0.148, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.678 | pg_loss_mean=0.0017, v_loss_mean=0.0212, ent_mean=0.0174 | gn_bb_mean=0.836, gn_bb_max=2.508 | gn_v_mean=0.326, gn_v_max=0.495

  8%|▊         | 392/5000 [48:14<9:13:15,  7.20s/it]------------------ Training Record ------------------
Epoch: 392/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.0985, reward_valid_std=4.1729
[BatchDiag] adv_mean=-0.0159, adv_std=0.3181, adv_abs_mean=0.2018 | ret_mean=8.9364, ret_std=0.5990 | val_mean=8.9524, val_std=0.5083 | explained_var=0.718047
[GradSplit pre-clip] backbone=0.703637, critic=0.220490
[Loss] pg_loss=0.062999, entropy_loss=0.000014, value_loss=0.013456
[EpochKL] epoch=0 mean_kl=0.00549 max_kl=0.01465
[EarlyStop] epoch=1 mean_kl=0.01300 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01300 max_kl=0.02409
[Time] Env Create Time: 4.4189s |Rollout Collect Time: 1.9272s |Loss & Update :0.7264
[PPODiag] kl_mean=0.0092, kl_p90=0.0193, kl_max=0.0241 | clipfrac_mean=0.017, logratio_std_mean=0.160, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.591, p10=0.587, min=0.584 | pg_loss_mean=0.0016, v_loss_mean=0.0237, ent_mean=0.0143 | gn_bb_mean=0.868, gn_bb_max=2.111 | gn_v_mean=0.218, gn_v_max=0.514

  8%|▊         | 393/5000 [48:21<9:10:07,  7.16s/it]------------------ Training Record ------------------
Epoch: 393/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1132, reward_valid_std=4.1868
[BatchDiag] adv_mean=-0.0021, adv_std=0.2801, adv_abs_mean=0.1852 | ret_mean=8.9495, ret_std=0.5805 | val_mean=8.9517, val_std=0.5041 | explained_var=0.767237
[GradSplit pre-clip] backbone=0.684615, critic=0.126141
[Loss] pg_loss=-0.019149, entropy_loss=0.000017, value_loss=0.008588
[EpochKL] epoch=0 mean_kl=0.00202 max_kl=0.00688
[EarlyStop] epoch=1 mean_kl=0.01114 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01114 max_kl=0.01955
[Time] Env Create Time: 4.6256s |Rollout Collect Time: 1.6916s |Loss & Update :0.6470
[PPODiag] kl_mean=0.0066, kl_p90=0.0155, kl_max=0.0196 | clipfrac_mean=0.014, logratio_std_mean=0.118, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.682, min=0.680 | pg_loss_mean=0.0028, v_loss_mean=0.0192, ent_mean=0.0177 | gn_bb_mean=1.119, gn_bb_max=3.330 | gn_v_mean=0.258, gn_v_max=0.564

  8%|▊         | 394/5000 [48:28<9:05:23,  7.10s/it]------------------ Training Record ------------------
Epoch: 394/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.684, reward_valid_mean=2.1225, reward_valid_std=4.1899
[BatchDiag] adv_mean=-0.0271, adv_std=0.2718, adv_abs_mean=0.1812 | ret_mean=8.9702, ret_std=0.5715 | val_mean=8.9973, val_std=0.4829 | explained_var=0.773881
[GradSplit pre-clip] backbone=0.931477, critic=0.135015
[Loss] pg_loss=-0.124133, entropy_loss=0.000015, value_loss=0.006519
[EpochKL] epoch=0 mean_kl=0.00525 max_kl=0.01727
[EarlyStop] epoch=1 mean_kl=0.03243 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03243 max_kl=0.07622
[Time] Env Create Time: 4.4345s |Rollout Collect Time: 1.7040s |Loss & Update :0.6557
[PPODiag] kl_mean=0.0188, kl_p90=0.0401, kl_max=0.0762 | clipfrac_mean=0.022, logratio_std_mean=0.255, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.684, p10=0.682, min=0.679 | pg_loss_mean=0.0029, v_loss_mean=0.0185, ent_mean=0.0174 | gn_bb_mean=1.127, gn_bb_max=4.065 | gn_v_mean=0.235, gn_v_max=0.406

  8%|▊         | 395/5000 [48:34<8:58:08,  7.01s/it]------------------ Training Record ------------------
Epoch: 395/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1061, reward_valid_std=4.1832
[BatchDiag] adv_mean=-0.0115, adv_std=0.3073, adv_abs_mean=0.2035 | ret_mean=8.9503, ret_std=0.5904 | val_mean=8.9618, val_std=0.4948 | explained_var=0.729094
[GradSplit pre-clip] backbone=0.335156, critic=0.286946
[Loss] pg_loss=-0.091132, entropy_loss=0.000013, value_loss=0.008481
[EpochKL] epoch=0 mean_kl=0.00464 max_kl=0.00860
[EarlyStop] epoch=1 mean_kl=0.01160 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01160 max_kl=0.02531
[Time] Env Create Time: 4.4415s |Rollout Collect Time: 1.6987s |Loss & Update :0.6618
[PPODiag] kl_mean=0.0081, kl_p90=0.0140, kl_max=0.0253 | clipfrac_mean=0.015, logratio_std_mean=0.149, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.680, min=0.678 | pg_loss_mean=0.0021, v_loss_mean=0.0228, ent_mean=0.0165 | gn_bb_mean=1.053, gn_bb_max=2.456 | gn_v_mean=0.324, gn_v_max=0.710
[AttnScore] scale=1.0511, C=10.0

  8%|▊         | 396/5000 [48:41<8:53:12,  6.95s/it]------------------ Training Record ------------------
Epoch: 396/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0972, reward_valid_std=4.1761
[BatchDiag] adv_mean=-0.0443, adv_std=0.3095, adv_abs_mean=0.1976 | ret_mean=8.9525, ret_std=0.5918 | val_mean=8.9968, val_std=0.4976 | explained_var=0.726502
[GradSplit pre-clip] backbone=2.067000, critic=0.230372
[Loss] pg_loss=-0.026721, entropy_loss=0.000015, value_loss=0.012108
[EpochKL] epoch=0 mean_kl=0.00811 max_kl=0.01754
[EarlyStop] epoch=1 mean_kl=0.01215 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01215 max_kl=0.02620
[Time] Env Create Time: 4.4661s |Rollout Collect Time: 1.9413s |Loss & Update :0.7361
[PPODiag] kl_mean=0.0101, kl_p90=0.0199, kl_max=0.0262 | clipfrac_mean=0.021, logratio_std_mean=0.167, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.592, p10=0.587, min=0.586 | pg_loss_mean=0.0034, v_loss_mean=0.0232, ent_mean=0.0163 | gn_bb_mean=1.049, gn_bb_max=2.560 | gn_v_mean=0.222, gn_v_max=0.388

  8%|▊         | 397/5000 [48:48<8:57:35,  7.01s/it]------------------ Training Record ------------------
Epoch: 397/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1126, reward_valid_std=4.1894
[BatchDiag] adv_mean=0.0094, adv_std=0.2928, adv_abs_mean=0.1958 | ret_mean=8.9671, ret_std=0.5830 | val_mean=8.9577, val_std=0.5030 | explained_var=0.747850
[GradSplit pre-clip] backbone=0.542807, critic=0.325284
[Loss] pg_loss=-0.075919, entropy_loss=0.000014, value_loss=0.007806
[EpochKL] epoch=0 mean_kl=0.00216 max_kl=0.00427
[EpochKL] epoch=1 mean_kl=0.00674 max_kl=0.01482
[EpochKL] epoch=2 mean_kl=0.00949 max_kl=0.01496
[Time] Env Create Time: 4.4232s |Rollout Collect Time: 1.7069s |Loss & Update :0.9547
[PPODiag] kl_mean=0.0061, kl_p90=0.0120, kl_max=0.0150 | clipfrac_mean=0.015, logratio_std_mean=0.120, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.679 | pg_loss_mean=0.0019, v_loss_mean=0.0202, ent_mean=0.0156 | gn_bb_mean=0.868, gn_bb_max=2.351 | gn_v_mean=0.210, gn_v_max=0.375

  8%|▊         | 398/5000 [48:55<8:59:15,  7.03s/it]------------------ Training Record ------------------
Epoch: 398/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1106, reward_valid_std=4.1859
[BatchDiag] adv_mean=-0.0291, adv_std=0.2969, adv_abs_mean=0.1926 | ret_mean=8.9661, ret_std=0.5889 | val_mean=8.9952, val_std=0.5028 | explained_var=0.745899
[GradSplit pre-clip] backbone=0.907563, critic=0.176170
[Loss] pg_loss=-0.054068, entropy_loss=0.000016, value_loss=0.007662
[EpochKL] epoch=0 mean_kl=0.00354 max_kl=0.00910
[EpochKL] epoch=1 mean_kl=0.00781 max_kl=0.01603
[EarlyStop] epoch=2 mean_kl=0.01045 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01045 max_kl=0.01533
[Time] Env Create Time: 4.4083s |Rollout Collect Time: 1.7024s |Loss & Update :0.9543
[PPODiag] kl_mean=0.0073, kl_p90=0.0141, kl_max=0.0160 | clipfrac_mean=0.015, logratio_std_mean=0.141, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.676 | pg_loss_mean=0.0014, v_loss_mean=0.0211, ent_mean=0.0176 | gn_bb_mean=0.811, gn_bb_max=2.670 | gn_v_mean=0.291, gn_v_max=0.694

  8%|▊         | 399/5000 [49:03<8:59:56,  7.04s/it]------------------ Training Record ------------------
Epoch: 399/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1081, reward_valid_std=4.1807
[BatchDiag] adv_mean=-0.0136, adv_std=0.2908, adv_abs_mean=0.1905 | ret_mean=8.9639, ret_std=0.5898 | val_mean=8.9774, val_std=0.5071 | explained_var=0.756917
[GradSplit pre-clip] backbone=0.878102, critic=0.117106
[Loss] pg_loss=0.010825, entropy_loss=0.000016, value_loss=0.011226
[EpochKL] epoch=0 mean_kl=0.00176 max_kl=0.00323
[EpochKL] epoch=1 mean_kl=0.00679 max_kl=0.01601
[EarlyStop] epoch=2 mean_kl=0.01979 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01979 max_kl=0.04878
[Time] Env Create Time: 4.3679s |Rollout Collect Time: 1.7099s |Loss & Update :0.9544
[PPODiag] kl_mean=0.0094, kl_p90=0.0151, kl_max=0.0488 | clipfrac_mean=0.017, logratio_std_mean=0.160, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.678 | pg_loss_mean=0.0026, v_loss_mean=0.0203, ent_mean=0.0166 | gn_bb_mean=1.026, gn_bb_max=2.588 | gn_v_mean=0.225, gn_v_max=0.436

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.982, Step: 7, Avg Done Step: 6.62, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8213s
-----------------------------
  8%|▊         | 400/5000 [49:11<9:42:06,  7.59s/it]------------------ Training Record ------------------
Epoch: 400/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1099, reward_valid_std=4.1767
[BatchDiag] adv_mean=-0.0468, adv_std=0.2956, adv_abs_mean=0.1925 | ret_mean=8.9710, ret_std=0.5818 | val_mean=9.0178, val_std=0.5108 | explained_var=0.741795
[GradSplit pre-clip] backbone=1.799861, critic=0.403515
[Loss] pg_loss=0.010577, entropy_loss=0.000017, value_loss=0.010763
[EarlyStop] epoch=0 mean_kl=0.01461 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01461 max_kl=0.04180
[Time] Env Create Time: 4.6247s |Rollout Collect Time: 1.6917s |Loss & Update :0.3676
[PPODiag] kl_mean=0.0146, kl_p90=0.0317, kl_max=0.0418 | clipfrac_mean=0.019, logratio_std_mean=0.220, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.683 | pg_loss_mean=0.0044, v_loss_mean=0.0215, ent_mean=0.0177 | gn_bb_mean=1.671, gn_bb_max=2.463 | gn_v_mean=0.357, gn_v_max=0.467
[AttnScore] scale=1.0521, C=10.0

  8%|▊         | 401/5000 [49:18<9:21:06,  7.32s/it]------------------ Training Record ------------------
Epoch: 401/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1147, reward_valid_std=4.1882
[BatchDiag] adv_mean=0.0170, adv_std=0.2764, adv_abs_mean=0.1867 | ret_mean=8.9658, ret_std=0.5734 | val_mean=8.9488, val_std=0.4957 | explained_var=0.767603
[GradSplit pre-clip] backbone=0.631898, critic=0.388191
[Loss] pg_loss=-0.072642, entropy_loss=0.000014, value_loss=0.007415
[EarlyStop] epoch=0 mean_kl=0.01365 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01365 max_kl=0.02364
[Time] Env Create Time: 4.4251s |Rollout Collect Time: 1.7027s |Loss & Update :0.3575
[PPODiag] kl_mean=0.0136, kl_p90=0.0224, kl_max=0.0236 | clipfrac_mean=0.019, logratio_std_mean=0.191, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.677 | pg_loss_mean=0.0030, v_loss_mean=0.0191, ent_mean=0.0167 | gn_bb_mean=0.868, gn_bb_max=1.525 | gn_v_mean=0.412, gn_v_max=0.681

  8%|▊         | 402/5000 [49:25<9:01:47,  7.07s/it]------------------ Training Record ------------------
Epoch: 402/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1066, reward_valid_std=4.1795
[BatchDiag] adv_mean=0.0270, adv_std=0.2888, adv_abs_mean=0.2015 | ret_mean=8.9443, ret_std=0.5858 | val_mean=8.9173, val_std=0.4897 | explained_var=0.756891
[GradSplit pre-clip] backbone=0.705423, critic=0.537135
[Loss] pg_loss=-0.074361, entropy_loss=0.000012, value_loss=0.006836
[EpochKL] epoch=0 mean_kl=0.00471 max_kl=0.00986
[EpochKL] epoch=1 mean_kl=0.00791 max_kl=0.01305
[EarlyStop] epoch=2 mean_kl=0.01868 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01868 max_kl=0.04311
[Time] Env Create Time: 4.4500s |Rollout Collect Time: 1.6904s |Loss & Update :0.9551
[PPODiag] kl_mean=0.0104, kl_p90=0.0138, kl_max=0.0431 | clipfrac_mean=0.018, logratio_std_mean=0.171, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.677 | pg_loss_mean=0.0024, v_loss_mean=0.0205, ent_mean=0.0160 | gn_bb_mean=0.955, gn_bb_max=2.429 | gn_v_mean=0.239, gn_v_max=0.653

  8%|▊         | 403/5000 [49:32<9:02:16,  7.08s/it]------------------ Training Record ------------------
Epoch: 403/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0964, reward_valid_std=4.1713
[BatchDiag] adv_mean=0.0078, adv_std=0.3162, adv_abs_mean=0.2112 | ret_mean=8.9571, ret_std=0.5942 | val_mean=8.9494, val_std=0.5128 | explained_var=0.716794
[GradSplit pre-clip] backbone=1.138519, critic=0.306142
[Loss] pg_loss=-0.054069, entropy_loss=0.000017, value_loss=0.008348
[EpochKL] epoch=0 mean_kl=0.00552 max_kl=0.01453
[EarlyStop] epoch=1 mean_kl=0.02814 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02814 max_kl=0.05359
[Time] Env Create Time: 4.4302s |Rollout Collect Time: 1.6988s |Loss & Update :0.6543
[PPODiag] kl_mean=0.0168, kl_p90=0.0383, kl_max=0.0536 | clipfrac_mean=0.023, logratio_std_mean=0.235, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.692, p10=0.686, min=0.678 | pg_loss_mean=0.0025, v_loss_mean=0.0241, ent_mean=0.0192 | gn_bb_mean=1.106, gn_bb_max=2.347 | gn_v_mean=0.275, gn_v_max=0.488

  8%|▊         | 404/5000 [49:38<8:55:23,  6.99s/it]------------------ Training Record ------------------
Epoch: 404/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.695, reward_valid_mean=2.0784, reward_valid_std=4.1646
[BatchDiag] adv_mean=-0.0485, adv_std=0.3359, adv_abs_mean=0.2091 | ret_mean=8.9303, ret_std=0.6116 | val_mean=8.9787, val_std=0.5069 | explained_var=0.698329
[GradSplit pre-clip] backbone=2.904485, critic=0.243274
[Loss] pg_loss=-0.059319, entropy_loss=0.000019, value_loss=0.009677
[EarlyStop] epoch=0 mean_kl=0.02300 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02300 max_kl=0.05771
[Time] Env Create Time: 4.4327s |Rollout Collect Time: 1.7095s |Loss & Update :0.3487
[PPODiag] kl_mean=0.0230, kl_p90=0.0486, kl_max=0.0577 | clipfrac_mean=0.026, logratio_std_mean=0.277, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.695, p10=0.689, min=0.689 | pg_loss_mean=0.0038, v_loss_mean=0.0269, ent_mean=0.0204 | gn_bb_mean=1.428, gn_bb_max=2.904 | gn_v_mean=0.254, gn_v_max=0.356

  8%|▊         | 405/5000 [49:45<8:43:50,  6.84s/it]------------------ Training Record ------------------
Epoch: 405/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.597, reward_valid_mean=2.0824, reward_valid_std=4.1615
[BatchDiag] adv_mean=-0.0410, adv_std=0.3532, adv_abs_mean=0.2270 | ret_mean=8.9437, ret_std=0.6090 | val_mean=8.9847, val_std=0.4787 | explained_var=0.663558
[GradSplit pre-clip] backbone=3.012243, critic=0.186206
[Loss] pg_loss=-0.041696, entropy_loss=0.000020, value_loss=0.012838
[EarlyStop] epoch=0 mean_kl=0.02784 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02784 max_kl=0.10133
[Time] Env Create Time: 4.4040s |Rollout Collect Time: 1.9492s |Loss & Update :0.4047
[PPODiag] kl_mean=0.0278, kl_p90=0.0561, kl_max=0.1013 | clipfrac_mean=0.030, logratio_std_mean=0.294, ratio_p95_mean=1.013 | valid_ratio_mb_mean=0.597, p10=0.591, min=0.589 | pg_loss_mean=0.0010, v_loss_mean=0.0299, ent_mean=0.0207 | gn_bb_mean=1.288, gn_bb_max=3.012 | gn_v_mean=0.350, gn_v_max=0.515
[AttnScore] scale=1.0524, C=10.0

  8%|▊         | 406/5000 [49:52<8:41:50,  6.82s/it]------------------ Training Record ------------------
Epoch: 406/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.694, reward_valid_mean=2.0900, reward_valid_std=4.1629
[BatchDiag] adv_mean=0.0347, adv_std=0.3256, adv_abs_mean=0.2243 | ret_mean=8.9391, ret_std=0.5999 | val_mean=8.9043, val_std=0.5017 | explained_var=0.705456
[GradSplit pre-clip] backbone=1.857860, critic=0.480155
[Loss] pg_loss=-0.022149, entropy_loss=0.000022, value_loss=0.011056
[EpochKL] epoch=0 mean_kl=0.00248 max_kl=0.00453
[EpochKL] epoch=1 mean_kl=0.00508 max_kl=0.00966
[EarlyStop] epoch=2 mean_kl=0.01852 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01852 max_kl=0.03772
[Time] Env Create Time: 4.6253s |Rollout Collect Time: 1.7081s |Loss & Update :0.9562
[PPODiag] kl_mean=0.0087, kl_p90=0.0217, kl_max=0.0377 | clipfrac_mean=0.018, logratio_std_mean=0.145, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.694, p10=0.689, min=0.685 | pg_loss_mean=0.0016, v_loss_mean=0.0256, ent_mean=0.0224 | gn_bb_mean=1.101, gn_bb_max=3.296 | gn_v_mean=0.305, gn_v_max=0.798

  8%|▊         | 407/5000 [49:59<8:52:37,  6.96s/it]------------------ Training Record ------------------
Epoch: 407/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.597, reward_valid_mean=2.0787, reward_valid_std=4.1592
[BatchDiag] adv_mean=-0.0116, adv_std=0.3374, adv_abs_mean=0.2187 | ret_mean=8.9362, ret_std=0.6068 | val_mean=8.9478, val_std=0.5197 | explained_var=0.690757
[GradSplit pre-clip] backbone=2.859502, critic=0.169870
[Loss] pg_loss=0.020972, entropy_loss=0.000024, value_loss=0.012347
[EarlyStop] epoch=0 mean_kl=0.01281 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01281 max_kl=0.03340
[Time] Env Create Time: 4.4404s |Rollout Collect Time: 1.9424s |Loss & Update :0.4041
[PPODiag] kl_mean=0.0128, kl_p90=0.0238, kl_max=0.0334 | clipfrac_mean=0.023, logratio_std_mean=0.198, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.597, p10=0.593, min=0.593 | pg_loss_mean=0.0023, v_loss_mean=0.0272, ent_mean=0.0210 | gn_bb_mean=1.499, gn_bb_max=2.860 | gn_v_mean=0.224, gn_v_max=0.433

  8%|▊         | 408/5000 [50:06<8:48:35,  6.91s/it]------------------ Training Record ------------------
Epoch: 408/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.596, reward_valid_mean=2.0834, reward_valid_std=4.1643
[BatchDiag] adv_mean=0.0269, adv_std=0.3359, adv_abs_mean=0.2311 | ret_mean=8.9375, ret_std=0.6025 | val_mean=8.9105, val_std=0.4942 | explained_var=0.689221
[GradSplit pre-clip] backbone=1.862546, critic=0.559025
[Loss] pg_loss=-0.066099, entropy_loss=0.000019, value_loss=0.010440
[EarlyStop] epoch=0 mean_kl=0.03648 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.03648 max_kl=0.06883
[Time] Env Create Time: 4.4540s |Rollout Collect Time: 1.9400s |Loss & Update :0.3885
[PPODiag] kl_mean=0.0365, kl_p90=0.0683, kl_max=0.0688 | clipfrac_mean=0.037, logratio_std_mean=0.344, ratio_p95_mean=1.006 | valid_ratio_mb_mean=0.596, p10=0.590, min=0.588 | pg_loss_mean=0.0078, v_loss_mean=0.0273, ent_mean=0.0204 | gn_bb_mean=1.723, gn_bb_max=2.989 | gn_v_mean=0.462, gn_v_max=0.759

  8%|▊         | 409/5000 [50:13<8:45:38,  6.87s/it]------------------ Training Record ------------------
Epoch: 409/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.696, reward_valid_mean=2.0829, reward_valid_std=4.1653
[BatchDiag] adv_mean=0.0143, adv_std=0.3472, adv_abs_mean=0.2429 | ret_mean=8.9398, ret_std=0.6057 | val_mean=8.9255, val_std=0.4756 | explained_var=0.671513
[GradSplit pre-clip] backbone=2.701337, critic=0.563805
[Loss] pg_loss=-0.057470, entropy_loss=0.000036, value_loss=0.012031
[EarlyStop] epoch=0 mean_kl=0.01452 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01452 max_kl=0.04896
[Time] Env Create Time: 4.4461s |Rollout Collect Time: 1.7121s |Loss & Update :0.3563
[PPODiag] kl_mean=0.0145, kl_p90=0.0257, kl_max=0.0490 | clipfrac_mean=0.025, logratio_std_mean=0.217, ratio_p95_mean=1.014 | valid_ratio_mb_mean=0.696, p10=0.693, min=0.692 | pg_loss_mean=0.0015, v_loss_mean=0.0292, ent_mean=0.0280 | gn_bb_mean=1.622, gn_bb_max=2.701 | gn_v_mean=0.401, gn_v_max=0.569

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.957, Step: 7, Avg Done Step: 6.66, #CS visited: 0.11
D->C5->C2->C3->D->C4->C1->D
Eval cost : 1.8323s
-----------------------------
  8%|▊         | 410/5000 [50:21<9:20:37,  7.33s/it]------------------ Training Record ------------------
Epoch: 410/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1005, reward_valid_std=4.1749
[BatchDiag] adv_mean=0.0276, adv_std=0.3124, adv_abs_mean=0.2111 | ret_mean=8.9428, ret_std=0.5895 | val_mean=8.9153, val_std=0.5065 | explained_var=0.719100
[GradSplit pre-clip] backbone=1.203088, critic=0.366940
[Loss] pg_loss=-0.023151, entropy_loss=0.000020, value_loss=0.008795
[EarlyStop] epoch=0 mean_kl=0.01318 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01318 max_kl=0.02779
[Time] Env Create Time: 4.4069s |Rollout Collect Time: 1.8967s |Loss & Update :0.3676
[PPODiag] kl_mean=0.0132, kl_p90=0.0229, kl_max=0.0278 | clipfrac_mean=0.023, logratio_std_mean=0.180, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.685 | pg_loss_mean=0.0048, v_loss_mean=0.0241, ent_mean=0.0217 | gn_bb_mean=2.923, gn_bb_max=11.804 | gn_v_mean=0.438, gn_v_max=0.748
[AttnScore] scale=1.0524, C=10.0

  8%|▊         | 411/5000 [50:28<9:05:25,  7.13s/it]------------------ Training Record ------------------
Epoch: 411/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1094, reward_valid_std=4.1835
[BatchDiag] adv_mean=-0.0006, adv_std=0.3043, adv_abs_mean=0.2055 | ret_mean=8.9662, ret_std=0.5827 | val_mean=8.9669, val_std=0.4910 | explained_var=0.727265
[GradSplit pre-clip] backbone=0.904041, critic=0.269865
[Loss] pg_loss=-0.081150, entropy_loss=0.000022, value_loss=0.006939
[EpochKL] epoch=0 mean_kl=0.00495 max_kl=0.01663
[EarlyStop] epoch=1 mean_kl=0.01672 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01672 max_kl=0.02580
[Time] Env Create Time: 4.4359s |Rollout Collect Time: 1.7087s |Loss & Update :0.6561
[PPODiag] kl_mean=0.0108, kl_p90=0.0235, kl_max=0.0258 | clipfrac_mean=0.022, logratio_std_mean=0.174, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.689, p10=0.681, min=0.678 | pg_loss_mean=0.0024, v_loss_mean=0.0229, ent_mean=0.0231 | gn_bb_mean=1.167, gn_bb_max=2.546 | gn_v_mean=0.254, gn_v_max=0.439

  8%|▊         | 412/5000 [50:34<8:57:44,  7.03s/it]------------------ Training Record ------------------
Epoch: 412/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1025, reward_valid_std=4.1779
[BatchDiag] adv_mean=-0.0265, adv_std=0.3166, adv_abs_mean=0.2042 | ret_mean=8.9569, ret_std=0.5967 | val_mean=8.9834, val_std=0.5126 | explained_var=0.718514
[GradSplit pre-clip] backbone=0.751713, critic=0.190130
[Loss] pg_loss=-0.048397, entropy_loss=0.000019, value_loss=0.008489
[EpochKL] epoch=0 mean_kl=0.00299 max_kl=0.01014
[EpochKL] epoch=1 mean_kl=0.00660 max_kl=0.01013
[EpochKL] epoch=2 mean_kl=0.00642 max_kl=0.01019
[Time] Env Create Time: 4.4389s |Rollout Collect Time: 1.7001s |Loss & Update :0.9659
[PPODiag] kl_mean=0.0053, kl_p90=0.0100, kl_max=0.0102 | clipfrac_mean=0.015, logratio_std_mean=0.121, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.690, p10=0.683, min=0.680 | pg_loss_mean=0.0013, v_loss_mean=0.0233, ent_mean=0.0180 | gn_bb_mean=0.815, gn_bb_max=2.119 | gn_v_mean=0.206, gn_v_max=0.394

  8%|▊         | 413/5000 [50:42<8:59:17,  7.05s/it]------------------ Training Record ------------------
Epoch: 413/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1049, reward_valid_std=4.1796
[BatchDiag] adv_mean=-0.0302, adv_std=0.3128, adv_abs_mean=0.2029 | ret_mean=8.9498, ret_std=0.5987 | val_mean=8.9800, val_std=0.4830 | explained_var=0.727008
[GradSplit pre-clip] backbone=0.427781, critic=0.127941
[Loss] pg_loss=-0.097724, entropy_loss=0.000015, value_loss=0.007643
[EpochKL] epoch=0 mean_kl=0.00777 max_kl=0.01629
[EarlyStop] epoch=1 mean_kl=0.01067 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01067 max_kl=0.01681
[Time] Env Create Time: 4.4264s |Rollout Collect Time: 1.7007s |Loss & Update :0.6555
[PPODiag] kl_mean=0.0092, kl_p90=0.0161, kl_max=0.0168 | clipfrac_mean=0.017, logratio_std_mean=0.162, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.682 | pg_loss_mean=0.0039, v_loss_mean=0.0240, ent_mean=0.0177 | gn_bb_mean=0.773, gn_bb_max=1.781 | gn_v_mean=0.298, gn_v_max=0.720

  8%|▊         | 414/5000 [50:48<8:52:57,  6.97s/it]------------------ Training Record ------------------
Epoch: 414/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1009, reward_valid_std=4.1838
[BatchDiag] adv_mean=-0.0210, adv_std=0.3211, adv_abs_mean=0.2097 | ret_mean=8.9478, ret_std=0.6065 | val_mean=8.9688, val_std=0.5043 | explained_var=0.719748
[GradSplit pre-clip] backbone=1.341650, critic=0.186268
[Loss] pg_loss=-0.046025, entropy_loss=0.000015, value_loss=0.008996
[EpochKL] epoch=0 mean_kl=0.00738 max_kl=0.01750
[EarlyStop] epoch=1 mean_kl=0.01223 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01223 max_kl=0.02021
[Time] Env Create Time: 4.4220s |Rollout Collect Time: 1.6961s |Loss & Update :0.6647
[PPODiag] kl_mean=0.0098, kl_p90=0.0188, kl_max=0.0202 | clipfrac_mean=0.020, logratio_std_mean=0.174, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.683 | pg_loss_mean=0.0023, v_loss_mean=0.0243, ent_mean=0.0200 | gn_bb_mean=0.903, gn_bb_max=1.726 | gn_v_mean=0.233, gn_v_max=0.422

  8%|▊         | 415/5000 [50:55<8:48:29,  6.92s/it]------------------ Training Record ------------------
Epoch: 415/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1012, reward_valid_std=4.1790
[BatchDiag] adv_mean=-0.0175, adv_std=0.3057, adv_abs_mean=0.2007 | ret_mean=8.9530, ret_std=0.5922 | val_mean=8.9705, val_std=0.5168 | explained_var=0.733546
[GradSplit pre-clip] backbone=0.628469, critic=0.275860
[Loss] pg_loss=0.027062, entropy_loss=0.000015, value_loss=0.009822
[EpochKL] epoch=0 mean_kl=0.00562 max_kl=0.01182
[EarlyStop] epoch=1 mean_kl=0.02335 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02335 max_kl=0.03421
[Time] Env Create Time: 4.4041s |Rollout Collect Time: 1.6990s |Loss & Update :0.6479
[PPODiag] kl_mean=0.0145, kl_p90=0.0292, kl_max=0.0342 | clipfrac_mean=0.020, logratio_std_mean=0.201, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.681, min=0.678 | pg_loss_mean=0.0043, v_loss_mean=0.0228, ent_mean=0.0184 | gn_bb_mean=1.355, gn_bb_max=2.754 | gn_v_mean=0.267, gn_v_max=0.403
[AttnScore] scale=1.0530, C=10.0

  8%|▊         | 416/5000 [51:02<8:44:36,  6.87s/it]------------------ Training Record ------------------
Epoch: 416/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1016, reward_valid_std=4.1767
[BatchDiag] adv_mean=0.0154, adv_std=0.3201, adv_abs_mean=0.2130 | ret_mean=8.9481, ret_std=0.6003 | val_mean=8.9327, val_std=0.5108 | explained_var=0.715603
[GradSplit pre-clip] backbone=0.597373, critic=0.332407
[Loss] pg_loss=-0.018905, entropy_loss=0.000016, value_loss=0.012070
[EpochKL] epoch=0 mean_kl=0.00683 max_kl=0.01220
[EarlyStop] epoch=1 mean_kl=0.01280 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01280 max_kl=0.02155
[Time] Env Create Time: 4.6204s |Rollout Collect Time: 1.6953s |Loss & Update :0.6578
[PPODiag] kl_mean=0.0098, kl_p90=0.0175, kl_max=0.0215 | clipfrac_mean=0.020, logratio_std_mean=0.173, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.690, p10=0.683, min=0.682 | pg_loss_mean=0.0026, v_loss_mean=0.0247, ent_mean=0.0179 | gn_bb_mean=0.751, gn_bb_max=1.863 | gn_v_mean=0.280, gn_v_max=0.359

  8%|▊         | 417/5000 [51:09<8:46:57,  6.90s/it]------------------ Training Record ------------------
Epoch: 417/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1070, reward_valid_std=4.1761
[BatchDiag] adv_mean=-0.0269, adv_std=0.3074, adv_abs_mean=0.2018 | ret_mean=8.9467, ret_std=0.5835 | val_mean=8.9736, val_std=0.5009 | explained_var=0.722447
[GradSplit pre-clip] backbone=0.641756, critic=0.150037
[Loss] pg_loss=-0.070016, entropy_loss=0.000017, value_loss=0.007886
[EpochKL] epoch=0 mean_kl=0.00492 max_kl=0.01707
[EarlyStop] epoch=1 mean_kl=0.01568 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01568 max_kl=0.02418
[Time] Env Create Time: 4.4193s |Rollout Collect Time: 1.6978s |Loss & Update :0.6646
[PPODiag] kl_mean=0.0103, kl_p90=0.0220, kl_max=0.0242 | clipfrac_mean=0.017, logratio_std_mean=0.190, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.680, min=0.678 | pg_loss_mean=0.0024, v_loss_mean=0.0225, ent_mean=0.0180 | gn_bb_mean=1.139, gn_bb_max=3.581 | gn_v_mean=0.310, gn_v_max=0.674

  8%|▊         | 418/5000 [51:16<8:44:10,  6.86s/it]------------------ Training Record ------------------
Epoch: 418/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1081, reward_valid_std=4.1850
[BatchDiag] adv_mean=0.0137, adv_std=0.2949, adv_abs_mean=0.2005 | ret_mean=8.9527, ret_std=0.5882 | val_mean=8.9390, val_std=0.4853 | explained_var=0.748585
[GradSplit pre-clip] backbone=0.537760, critic=0.370420
[Loss] pg_loss=-0.030977, entropy_loss=0.000015, value_loss=0.009335
[EpochKL] epoch=0 mean_kl=0.00483 max_kl=0.02114
[EpochKL] epoch=1 mean_kl=0.00410 max_kl=0.00839
[EarlyStop] epoch=2 mean_kl=0.01135 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01135 max_kl=0.01698
[Time] Env Create Time: 4.4171s |Rollout Collect Time: 1.6941s |Loss & Update :0.9501
[PPODiag] kl_mean=0.0068, kl_p90=0.0162, kl_max=0.0211 | clipfrac_mean=0.015, logratio_std_mean=0.136, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.675 | pg_loss_mean=0.0015, v_loss_mean=0.0203, ent_mean=0.0145 | gn_bb_mean=0.896, gn_bb_max=1.991 | gn_v_mean=0.242, gn_v_max=0.557

  8%|▊         | 419/5000 [51:23<8:48:35,  6.92s/it]------------------ Training Record ------------------
Epoch: 419/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1126, reward_valid_std=4.1824
[BatchDiag] adv_mean=-0.0014, adv_std=0.2916, adv_abs_mean=0.1907 | ret_mean=8.9514, ret_std=0.5956 | val_mean=8.9528, val_std=0.5059 | explained_var=0.760274
[GradSplit pre-clip] backbone=0.414782, critic=0.136970
[Loss] pg_loss=-0.000772, entropy_loss=0.000011, value_loss=0.008679
[EpochKL] epoch=0 mean_kl=0.00941 max_kl=0.02604
[EarlyStop] epoch=1 mean_kl=0.01361 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01361 max_kl=0.02526
[Time] Env Create Time: 4.4097s |Rollout Collect Time: 1.6970s |Loss & Update :0.6514
[PPODiag] kl_mean=0.0115, kl_p90=0.0234, kl_max=0.0260 | clipfrac_mean=0.018, logratio_std_mean=0.186, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.678 | pg_loss_mean=0.0031, v_loss_mean=0.0206, ent_mean=0.0164 | gn_bb_mean=1.181, gn_bb_max=6.165 | gn_v_mean=0.177, gn_v_max=0.352

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.985, Step: 7, Avg Done Step: 6.60, #CS visited: 0.15
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8239s
-----------------------------
  8%|▊         | 420/5000 [51:31<9:27:02,  7.43s/it]------------------ Training Record ------------------
Epoch: 420/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1208, reward_valid_std=4.1887
[BatchDiag] adv_mean=0.0056, adv_std=0.2743, adv_abs_mean=0.1835 | ret_mean=8.9687, ret_std=0.5740 | val_mean=8.9631, val_std=0.5044 | explained_var=0.771629
[GradSplit pre-clip] backbone=0.975679, critic=0.416869
[Loss] pg_loss=-0.140515, entropy_loss=0.000013, value_loss=0.006359
[EpochKL] epoch=0 mean_kl=0.00306 max_kl=0.01016
[EpochKL] epoch=1 mean_kl=0.00758 max_kl=0.01488
[EpochKL] epoch=2 mean_kl=0.00898 max_kl=0.01561
[Time] Env Create Time: 4.3940s |Rollout Collect Time: 1.6914s |Loss & Update :0.9586
[PPODiag] kl_mean=0.0065, kl_p90=0.0133, kl_max=0.0156 | clipfrac_mean=0.016, logratio_std_mean=0.122, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.679, min=0.675 | pg_loss_mean=0.0023, v_loss_mean=0.0187, ent_mean=0.0158 | gn_bb_mean=1.009, gn_bb_max=4.252 | gn_v_mean=0.228, gn_v_max=0.533
[AttnScore] scale=1.0537, C=10.0

  8%|▊         | 421/5000 [51:38<9:18:07,  7.31s/it]------------------ Training Record ------------------
Epoch: 421/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.588, reward_valid_mean=2.1155, reward_valid_std=4.1885
[BatchDiag] adv_mean=-0.0129, adv_std=0.2873, adv_abs_mean=0.1849 | ret_mean=8.9658, ret_std=0.5869 | val_mean=8.9787, val_std=0.5048 | explained_var=0.760446
[GradSplit pre-clip] backbone=1.471805, critic=0.136718
[Loss] pg_loss=-0.002004, entropy_loss=0.000015, value_loss=0.008850
[EarlyStop] epoch=0 mean_kl=0.06799 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.06799 max_kl=0.18518
[Time] Env Create Time: 4.4170s |Rollout Collect Time: 1.9360s |Loss & Update :0.4024
[PPODiag] kl_mean=0.0680, kl_p90=0.1245, kl_max=0.1852 | clipfrac_mean=0.027, logratio_std_mean=0.671, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.588, p10=0.585, min=0.582 | pg_loss_mean=0.0141, v_loss_mean=0.0201, ent_mean=0.0116 | gn_bb_mean=1.463, gn_bb_max=4.045 | gn_v_mean=0.208, gn_v_max=0.380

  8%|▊         | 422/5000 [51:45<9:05:14,  7.15s/it]------------------ Training Record ------------------
Epoch: 422/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1091, reward_valid_std=4.1817
[BatchDiag] adv_mean=-0.0208, adv_std=0.2989, adv_abs_mean=0.1932 | ret_mean=8.9632, ret_std=0.5925 | val_mean=8.9839, val_std=0.5182 | explained_var=0.745415
[GradSplit pre-clip] backbone=1.243990, critic=0.151492
[Loss] pg_loss=-0.090499, entropy_loss=0.000017, value_loss=0.007548
[EarlyStop] epoch=0 mean_kl=0.01538 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01538 max_kl=0.04408
[Time] Env Create Time: 4.6250s |Rollout Collect Time: 1.7104s |Loss & Update :0.3550
[PPODiag] kl_mean=0.0154, kl_p90=0.0312, kl_max=0.0441 | clipfrac_mean=0.022, logratio_std_mean=0.194, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.688, p10=0.681, min=0.680 | pg_loss_mean=0.0084, v_loss_mean=0.0223, ent_mean=0.0214 | gn_bb_mean=1.179, gn_bb_max=2.690 | gn_v_mean=0.450, gn_v_max=1.006

  8%|▊         | 423/5000 [51:52<8:54:42,  7.01s/it]------------------ Training Record ------------------
Epoch: 423/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1041, reward_valid_std=4.1821
[BatchDiag] adv_mean=0.0525, adv_std=0.3005, adv_abs_mean=0.2067 | ret_mean=8.9452, ret_std=0.6007 | val_mean=8.8927, val_std=0.5341 | explained_var=0.749673
[GradSplit pre-clip] backbone=0.708403, critic=0.735368
[Loss] pg_loss=-0.076431, entropy_loss=0.000014, value_loss=0.010337
[EpochKL] epoch=0 mean_kl=0.00583 max_kl=0.01137
[EpochKL] epoch=1 mean_kl=0.00626 max_kl=0.01049
[EarlyStop] epoch=2 mean_kl=0.01264 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01264 max_kl=0.02474
[Time] Env Create Time: 4.4348s |Rollout Collect Time: 1.9319s |Loss & Update :1.0904
[PPODiag] kl_mean=0.0082, kl_p90=0.0117, kl_max=0.0247 | clipfrac_mean=0.016, logratio_std_mean=0.153, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.590, p10=0.585, min=0.578 | pg_loss_mean=0.0021, v_loss_mean=0.0220, ent_mean=0.0135 | gn_bb_mean=0.906, gn_bb_max=2.320 | gn_v_mean=0.413, gn_v_max=1.024

  8%|▊         | 424/5000 [51:59<9:04:50,  7.14s/it]------------------ Training Record ------------------
Epoch: 424/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1095, reward_valid_std=4.1819
[BatchDiag] adv_mean=-0.0247, adv_std=0.2917, adv_abs_mean=0.1926 | ret_mean=8.9711, ret_std=0.5882 | val_mean=8.9958, val_std=0.5290 | explained_var=0.753973
[GradSplit pre-clip] backbone=0.645521, critic=0.178498
[Loss] pg_loss=-0.080632, entropy_loss=0.000015, value_loss=0.007540
[EpochKL] epoch=0 mean_kl=0.00131 max_kl=0.00270
[EpochKL] epoch=1 mean_kl=0.00524 max_kl=0.00919
[EarlyStop] epoch=2 mean_kl=0.01116 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01116 max_kl=0.01699
[Time] Env Create Time: 4.3967s |Rollout Collect Time: 1.9228s |Loss & Update :1.0702
[PPODiag] kl_mean=0.0059, kl_p90=0.0152, kl_max=0.0170 | clipfrac_mean=0.014, logratio_std_mean=0.120, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.585, min=0.580 | pg_loss_mean=0.0009, v_loss_mean=0.0203, ent_mean=0.0143 | gn_bb_mean=0.673, gn_bb_max=1.550 | gn_v_mean=0.240, gn_v_max=0.554

  8%|▊         | 425/5000 [52:07<9:10:21,  7.22s/it]------------------ Training Record ------------------
Epoch: 425/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1065, reward_valid_std=4.1781
[BatchDiag] adv_mean=-0.0021, adv_std=0.2966, adv_abs_mean=0.1982 | ret_mean=8.9448, ret_std=0.5870 | val_mean=8.9469, val_std=0.5003 | explained_var=0.744742
[GradSplit pre-clip] backbone=0.750620, critic=0.135972
[Loss] pg_loss=-0.004614, entropy_loss=0.000014, value_loss=0.008839
[EpochKL] epoch=0 mean_kl=0.00473 max_kl=0.01457
[EarlyStop] epoch=1 mean_kl=0.03497 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03497 max_kl=0.07742
[Time] Env Create Time: 4.3963s |Rollout Collect Time: 1.9368s |Loss & Update :0.7336
[PPODiag] kl_mean=0.0199, kl_p90=0.0577, kl_max=0.0774 | clipfrac_mean=0.017, logratio_std_mean=0.271, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.590, p10=0.583, min=0.582 | pg_loss_mean=0.0050, v_loss_mean=0.0217, ent_mean=0.0128 | gn_bb_mean=0.990, gn_bb_max=2.015 | gn_v_mean=0.249, gn_v_max=0.488
[AttnScore] scale=1.0538, C=10.0

  9%|▊         | 426/5000 [52:14<9:06:47,  7.17s/it]------------------ Training Record ------------------
Epoch: 426/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1047, reward_valid_std=4.1812
[BatchDiag] adv_mean=-0.0169, adv_std=0.2988, adv_abs_mean=0.1966 | ret_mean=8.9484, ret_std=0.5937 | val_mean=8.9653, val_std=0.5097 | explained_var=0.746759
[GradSplit pre-clip] backbone=0.531150, critic=0.116810
[Loss] pg_loss=-0.048608, entropy_loss=0.000008, value_loss=0.007751
[EarlyStop] epoch=0 mean_kl=0.01013 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01013 max_kl=0.02814
[Time] Env Create Time: 4.3798s |Rollout Collect Time: 1.6785s |Loss & Update :0.3599
[PPODiag] kl_mean=0.0101, kl_p90=0.0195, kl_max=0.0281 | clipfrac_mean=0.015, logratio_std_mean=0.161, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.683 | pg_loss_mean=0.0026, v_loss_mean=0.0218, ent_mean=0.0137 | gn_bb_mean=1.252, gn_bb_max=2.823 | gn_v_mean=0.252, gn_v_max=0.436

  9%|▊         | 427/5000 [52:20<8:49:25,  6.95s/it]------------------ Training Record ------------------
Epoch: 427/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1075, reward_valid_std=4.1846
[BatchDiag] adv_mean=-0.0196, adv_std=0.2898, adv_abs_mean=0.1956 | ret_mean=8.9494, ret_std=0.5853 | val_mean=8.9691, val_std=0.5296 | explained_var=0.754857
[GradSplit pre-clip] backbone=1.970920, critic=0.180035
[Loss] pg_loss=-0.022444, entropy_loss=0.000014, value_loss=0.008356
[EarlyStop] epoch=0 mean_kl=0.02528 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02528 max_kl=0.07368
[Time] Env Create Time: 4.3886s |Rollout Collect Time: 1.6860s |Loss & Update :0.3587
[PPODiag] kl_mean=0.0253, kl_p90=0.0578, kl_max=0.0737 | clipfrac_mean=0.022, logratio_std_mean=0.268, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.680, min=0.677 | pg_loss_mean=0.0050, v_loss_mean=0.0212, ent_mean=0.0160 | gn_bb_mean=1.242, gn_bb_max=2.168 | gn_v_mean=0.278, gn_v_max=0.447

  9%|▊         | 428/5000 [52:27<8:37:35,  6.79s/it]------------------ Training Record ------------------
Epoch: 428/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1073, reward_valid_std=4.1803
[BatchDiag] adv_mean=-0.0083, adv_std=0.3000, adv_abs_mean=0.1993 | ret_mean=8.9478, ret_std=0.5939 | val_mean=8.9561, val_std=0.5020 | explained_var=0.744854
[GradSplit pre-clip] backbone=0.617491, critic=0.190487
[Loss] pg_loss=-0.053675, entropy_loss=0.000015, value_loss=0.009895
[EarlyStop] epoch=0 mean_kl=0.01983 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01983 max_kl=0.04865
[Time] Env Create Time: 4.6029s |Rollout Collect Time: 1.6863s |Loss & Update :0.3563
[PPODiag] kl_mean=0.0198, kl_p90=0.0407, kl_max=0.0486 | clipfrac_mean=0.016, logratio_std_mean=0.249, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.681 | pg_loss_mean=0.0027, v_loss_mean=0.0221, ent_mean=0.0152 | gn_bb_mean=0.856, gn_bb_max=2.748 | gn_v_mean=0.294, gn_v_max=0.558

  9%|▊         | 429/5000 [52:33<8:34:07,  6.75s/it]------------------ Training Record ------------------
Epoch: 429/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1020, reward_valid_std=4.1781
[BatchDiag] adv_mean=0.0189, adv_std=0.3043, adv_abs_mean=0.2104 | ret_mean=8.9412, ret_std=0.5998 | val_mean=8.9222, val_std=0.4947 | explained_var=0.742630
[GradSplit pre-clip] backbone=0.340606, critic=0.350544
[Loss] pg_loss=-0.022119, entropy_loss=0.000015, value_loss=0.011168
[EpochKL] epoch=0 mean_kl=0.00171 max_kl=0.00428
[EarlyStop] epoch=1 mean_kl=0.01459 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01459 max_kl=0.02926
[Time] Env Create Time: 4.4025s |Rollout Collect Time: 1.6893s |Loss & Update :0.6568
[PPODiag] kl_mean=0.0082, kl_p90=0.0211, kl_max=0.0293 | clipfrac_mean=0.014, logratio_std_mean=0.128, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.685 | pg_loss_mean=0.0020, v_loss_mean=0.0222, ent_mean=0.0165 | gn_bb_mean=0.700, gn_bb_max=1.155 | gn_v_mean=0.265, gn_v_max=0.400

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.983, Step: 7, Avg Done Step: 6.61, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8332s
-----------------------------
  9%|▊         | 430/5000 [52:42<9:16:32,  7.31s/it]------------------ Training Record ------------------
Epoch: 430/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1171, reward_valid_std=4.1870
[BatchDiag] adv_mean=-0.0179, adv_std=0.2855, adv_abs_mean=0.1851 | ret_mean=8.9750, ret_std=0.5800 | val_mean=8.9929, val_std=0.5229 | explained_var=0.757659
[GradSplit pre-clip] backbone=0.352226, critic=0.231205
[Loss] pg_loss=-0.013019, entropy_loss=0.000012, value_loss=0.009126
[EpochKL] epoch=0 mean_kl=0.00426 max_kl=0.00766
[EarlyStop] epoch=1 mean_kl=0.01534 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01534 max_kl=0.02506
[Time] Env Create Time: 4.3948s |Rollout Collect Time: 1.6815s |Loss & Update :0.6633
[PPODiag] kl_mean=0.0098, kl_p90=0.0167, kl_max=0.0251 | clipfrac_mean=0.018, logratio_std_mean=0.175, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.681 | pg_loss_mean=0.0035, v_loss_mean=0.0196, ent_mean=0.0162 | gn_bb_mean=0.803, gn_bb_max=1.858 | gn_v_mean=0.259, gn_v_max=0.494
[AttnScore] scale=1.0541, C=10.0

  9%|▊         | 431/5000 [52:49<9:03:28,  7.14s/it]------------------ Training Record ------------------
Epoch: 431/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1030, reward_valid_std=4.1757
[BatchDiag] adv_mean=-0.0155, adv_std=0.2987, adv_abs_mean=0.1929 | ret_mean=8.9463, ret_std=0.5866 | val_mean=8.9619, val_std=0.5087 | explained_var=0.740715
[GradSplit pre-clip] backbone=0.587703, critic=0.106416
[Loss] pg_loss=-0.025241, entropy_loss=0.000013, value_loss=0.008227
[EpochKL] epoch=0 mean_kl=0.00477 max_kl=0.01181
[EarlyStop] epoch=1 mean_kl=0.01118 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01118 max_kl=0.02188
[Time] Env Create Time: 4.3814s |Rollout Collect Time: 1.6947s |Loss & Update :0.6511
[PPODiag] kl_mean=0.0080, kl_p90=0.0136, kl_max=0.0219 | clipfrac_mean=0.015, logratio_std_mean=0.144, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.681 | pg_loss_mean=0.0019, v_loss_mean=0.0221, ent_mean=0.0171 | gn_bb_mean=0.875, gn_bb_max=1.859 | gn_v_mean=0.267, gn_v_max=0.554

  9%|▊         | 432/5000 [52:55<8:54:00,  7.01s/it]------------------ Training Record ------------------
Epoch: 432/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1134, reward_valid_std=4.1851
[BatchDiag] adv_mean=-0.0019, adv_std=0.2916, adv_abs_mean=0.1897 | ret_mean=8.9640, ret_std=0.5812 | val_mean=8.9659, val_std=0.5183 | explained_var=0.748271
[GradSplit pre-clip] backbone=0.875112, critic=0.280265
[Loss] pg_loss=-0.095675, entropy_loss=0.000014, value_loss=0.006967
[EpochKL] epoch=0 mean_kl=0.00469 max_kl=0.01112
[EarlyStop] epoch=1 mean_kl=0.01003 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01003 max_kl=0.01714
[Time] Env Create Time: 4.3832s |Rollout Collect Time: 1.9178s |Loss & Update :0.7374
[PPODiag] kl_mean=0.0074, kl_p90=0.0137, kl_max=0.0171 | clipfrac_mean=0.016, logratio_std_mean=0.141, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.589, p10=0.584, min=0.583 | pg_loss_mean=0.0026, v_loss_mean=0.0211, ent_mean=0.0149 | gn_bb_mean=0.879, gn_bb_max=2.026 | gn_v_mean=0.269, gn_v_max=0.392

  9%|▊         | 433/5000 [53:02<8:54:27,  7.02s/it]------------------ Training Record ------------------
Epoch: 433/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1161, reward_valid_std=4.1856
[BatchDiag] adv_mean=0.0066, adv_std=0.2830, adv_abs_mean=0.1910 | ret_mean=8.9638, ret_std=0.5764 | val_mean=8.9573, val_std=0.4929 | explained_var=0.758943
[GradSplit pre-clip] backbone=0.708980, critic=0.226602
[Loss] pg_loss=-0.037449, entropy_loss=0.000017, value_loss=0.008595
[EpochKL] epoch=0 mean_kl=0.00186 max_kl=0.00450
[EarlyStop] epoch=1 mean_kl=0.01569 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01569 max_kl=0.02667
[Time] Env Create Time: 4.6109s |Rollout Collect Time: 1.6983s |Loss & Update :0.6610
[PPODiag] kl_mean=0.0088, kl_p90=0.0188, kl_max=0.0267 | clipfrac_mean=0.016, logratio_std_mean=0.144, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.678 | pg_loss_mean=0.0009, v_loss_mean=0.0193, ent_mean=0.0154 | gn_bb_mean=0.596, gn_bb_max=1.633 | gn_v_mean=0.232, gn_v_max=0.351

  9%|▊         | 434/5000 [53:09<8:53:10,  7.01s/it]------------------ Training Record ------------------
Epoch: 434/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1075, reward_valid_std=4.1798
[BatchDiag] adv_mean=-0.0147, adv_std=0.2861, adv_abs_mean=0.1858 | ret_mean=8.9528, ret_std=0.5811 | val_mean=8.9675, val_std=0.5112 | explained_var=0.757597
[GradSplit pre-clip] backbone=1.258698, critic=0.127725
[Loss] pg_loss=-0.092331, entropy_loss=0.000016, value_loss=0.006511
[EarlyStop] epoch=0 mean_kl=0.01081 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01081 max_kl=0.03229
[Time] Env Create Time: 4.4486s |Rollout Collect Time: 1.6950s |Loss & Update :0.3614
[PPODiag] kl_mean=0.0108, kl_p90=0.0224, kl_max=0.0323 | clipfrac_mean=0.016, logratio_std_mean=0.163, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.681 | pg_loss_mean=0.0034, v_loss_mean=0.0197, ent_mean=0.0185 | gn_bb_mean=1.267, gn_bb_max=2.472 | gn_v_mean=0.252, gn_v_max=0.497

  9%|▊         | 435/5000 [53:16<8:41:37,  6.86s/it]------------------ Training Record ------------------
Epoch: 435/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.587, reward_valid_mean=2.1141, reward_valid_std=4.1868
[BatchDiag] adv_mean=-0.0049, adv_std=0.2747, adv_abs_mean=0.1848 | ret_mean=8.9499, ret_std=0.5749 | val_mean=8.9548, val_std=0.4914 | explained_var=0.771621
[GradSplit pre-clip] backbone=0.380210, critic=0.140956
[Loss] pg_loss=0.014284, entropy_loss=0.000013, value_loss=0.009376
[EpochKL] epoch=0 mean_kl=0.00766 max_kl=0.02364
[EarlyStop] epoch=1 mean_kl=0.01951 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01951 max_kl=0.03785
[Time] Env Create Time: 4.4219s |Rollout Collect Time: 1.9343s |Loss & Update :0.7288
[PPODiag] kl_mean=0.0136, kl_p90=0.0251, kl_max=0.0378 | clipfrac_mean=0.018, logratio_std_mean=0.198, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.587, p10=0.583, min=0.582 | pg_loss_mean=0.0050, v_loss_mean=0.0185, ent_mean=0.0132 | gn_bb_mean=0.851, gn_bb_max=1.583 | gn_v_mean=0.268, gn_v_max=0.565
[AttnScore] scale=1.0542, C=10.0

  9%|▊         | 436/5000 [53:23<8:46:45,  6.92s/it]------------------ Training Record ------------------
Epoch: 436/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1071, reward_valid_std=4.1827
[BatchDiag] adv_mean=-0.0388, adv_std=0.2968, adv_abs_mean=0.1917 | ret_mean=8.9589, ret_std=0.5843 | val_mean=8.9977, val_std=0.5261 | explained_var=0.741928
[GradSplit pre-clip] backbone=0.954502, critic=0.367875
[Loss] pg_loss=-0.022412, entropy_loss=0.000014, value_loss=0.008654
[EpochKL] epoch=0 mean_kl=0.00627 max_kl=0.01688
[EarlyStop] epoch=1 mean_kl=0.01557 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01557 max_kl=0.02547
[Time] Env Create Time: 4.4418s |Rollout Collect Time: 1.7041s |Loss & Update :0.6585
[PPODiag] kl_mean=0.0109, kl_p90=0.0213, kl_max=0.0255 | clipfrac_mean=0.017, logratio_std_mean=0.161, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.681, min=0.679 | pg_loss_mean=0.0037, v_loss_mean=0.0214, ent_mean=0.0164 | gn_bb_mean=1.041, gn_bb_max=1.904 | gn_v_mean=0.292, gn_v_max=0.405

  9%|▊         | 437/5000 [53:30<8:43:54,  6.89s/it]------------------ Training Record ------------------
Epoch: 437/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1116, reward_valid_std=4.1844
[BatchDiag] adv_mean=-0.0052, adv_std=0.2791, adv_abs_mean=0.1868 | ret_mean=8.9586, ret_std=0.5793 | val_mean=8.9638, val_std=0.4952 | explained_var=0.767973
[GradSplit pre-clip] backbone=0.581716, critic=0.136465
[Loss] pg_loss=-0.013145, entropy_loss=0.000011, value_loss=0.007942
[EarlyStop] epoch=0 mean_kl=0.01474 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01474 max_kl=0.03050
[Time] Env Create Time: 4.4768s |Rollout Collect Time: 1.7187s |Loss & Update :0.3699
[PPODiag] kl_mean=0.0147, kl_p90=0.0290, kl_max=0.0305 | clipfrac_mean=0.018, logratio_std_mean=0.204, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.680, min=0.677 | pg_loss_mean=0.0037, v_loss_mean=0.0186, ent_mean=0.0156 | gn_bb_mean=0.860, gn_bb_max=1.421 | gn_v_mean=0.277, gn_v_max=0.497

  9%|▉         | 438/5000 [53:36<8:36:24,  6.79s/it]------------------ Training Record ------------------
Epoch: 438/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1166, reward_valid_std=4.1857
[BatchDiag] adv_mean=0.0242, adv_std=0.2751, adv_abs_mean=0.1893 | ret_mean=8.9550, ret_std=0.5842 | val_mean=8.9308, val_std=0.5002 | explained_var=0.778265
[GradSplit pre-clip] backbone=0.668296, critic=0.305089
[Loss] pg_loss=-0.002426, entropy_loss=0.000016, value_loss=0.007626
[EpochKL] epoch=0 mean_kl=0.00243 max_kl=0.00510
[EpochKL] epoch=1 mean_kl=0.00499 max_kl=0.01394
[EpochKL] epoch=2 mean_kl=0.00751 max_kl=0.01259
[Time] Env Create Time: 4.4639s |Rollout Collect Time: 1.7248s |Loss & Update :0.9624
[PPODiag] kl_mean=0.0050, kl_p90=0.0095, kl_max=0.0139 | clipfrac_mean=0.012, logratio_std_mean=0.107, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.681, min=0.674 | pg_loss_mean=0.0007, v_loss_mean=0.0186, ent_mean=0.0148 | gn_bb_mean=0.661, gn_bb_max=2.276 | gn_v_mean=0.286, gn_v_max=0.659

  9%|▉         | 439/5000 [53:43<8:44:30,  6.90s/it]------------------ Training Record ------------------
Epoch: 439/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1117, reward_valid_std=4.1875
[BatchDiag] adv_mean=-0.0006, adv_std=0.2905, adv_abs_mean=0.1867 | ret_mean=8.9527, ret_std=0.5903 | val_mean=8.9533, val_std=0.5218 | explained_var=0.757807
[GradSplit pre-clip] backbone=0.278987, critic=0.183748
[Loss] pg_loss=-0.039457, entropy_loss=0.000013, value_loss=0.007861
[EpochKL] epoch=0 mean_kl=0.00380 max_kl=0.00938
[EpochKL] epoch=1 mean_kl=0.00712 max_kl=0.01491
[EpochKL] epoch=2 mean_kl=0.00963 max_kl=0.01336
[Time] Env Create Time: 4.4371s |Rollout Collect Time: 1.7204s |Loss & Update :0.9769
[PPODiag] kl_mean=0.0068, kl_p90=0.0125, kl_max=0.0149 | clipfrac_mean=0.015, logratio_std_mean=0.133, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.679 | pg_loss_mean=0.0013, v_loss_mean=0.0202, ent_mean=0.0154 | gn_bb_mean=0.683, gn_bb_max=2.960 | gn_v_mean=0.191, gn_v_max=0.377

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.981, Step: 7, Avg Done Step: 6.60, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8460s
-----------------------------
  9%|▉         | 440/5000 [53:52<9:32:13,  7.53s/it]------------------ Training Record ------------------
Epoch: 440/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1087, reward_valid_std=4.1800
[BatchDiag] adv_mean=-0.0009, adv_std=0.2790, adv_abs_mean=0.1859 | ret_mean=8.9616, ret_std=0.5831 | val_mean=8.9624, val_std=0.5100 | explained_var=0.771038
[GradSplit pre-clip] backbone=0.593785, critic=0.252080
[Loss] pg_loss=-0.083203, entropy_loss=0.000013, value_loss=0.007763
[EpochKL] epoch=0 mean_kl=0.00155 max_kl=0.00285
[EpochKL] epoch=1 mean_kl=0.00764 max_kl=0.01504
[EarlyStop] epoch=2 mean_kl=0.01269 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01269 max_kl=0.02549
[Time] Env Create Time: 4.6670s |Rollout Collect Time: 1.7097s |Loss & Update :0.9636
[PPODiag] kl_mean=0.0073, kl_p90=0.0153, kl_max=0.0255 | clipfrac_mean=0.015, logratio_std_mean=0.149, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.681 | pg_loss_mean=0.0019, v_loss_mean=0.0191, ent_mean=0.0157 | gn_bb_mean=0.810, gn_bb_max=1.695 | gn_v_mean=0.230, gn_v_max=0.448
[AttnScore] scale=1.0548, C=10.0

  9%|▉         | 441/5000 [54:00<9:27:48,  7.47s/it]------------------ Training Record ------------------
Epoch: 441/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1021, reward_valid_std=4.1775
[BatchDiag] adv_mean=-0.0228, adv_std=0.2963, adv_abs_mean=0.1935 | ret_mean=8.9362, ret_std=0.5866 | val_mean=8.9589, val_std=0.5066 | explained_var=0.744916
[GradSplit pre-clip] backbone=0.246035, critic=0.152189
[Loss] pg_loss=-0.052518, entropy_loss=0.000011, value_loss=0.007494
[EpochKL] epoch=0 mean_kl=0.00244 max_kl=0.00618
[EpochKL] epoch=1 mean_kl=0.00991 max_kl=0.01645
[EarlyStop] epoch=2 mean_kl=0.01120 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01120 max_kl=0.02711
[Time] Env Create Time: 4.4889s |Rollout Collect Time: 1.7112s |Loss & Update :0.9668
[PPODiag] kl_mean=0.0078, kl_p90=0.0155, kl_max=0.0271 | clipfrac_mean=0.016, logratio_std_mean=0.143, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.681 | pg_loss_mean=0.0016, v_loss_mean=0.0212, ent_mean=0.0167 | gn_bb_mean=0.865, gn_bb_max=4.291 | gn_v_mean=0.267, gn_v_max=0.631

  9%|▉         | 442/5000 [54:07<9:20:42,  7.38s/it]------------------ Training Record ------------------
Epoch: 442/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1116, reward_valid_std=4.1803
[BatchDiag] adv_mean=-0.0285, adv_std=0.2873, adv_abs_mean=0.1879 | ret_mean=8.9556, ret_std=0.5844 | val_mean=8.9841, val_std=0.5085 | explained_var=0.758395
[GradSplit pre-clip] backbone=0.440485, critic=0.138051
[Loss] pg_loss=-0.065021, entropy_loss=0.000016, value_loss=0.007133
[EpochKL] epoch=0 mean_kl=0.00110 max_kl=0.00309
[EpochKL] epoch=1 mean_kl=0.00409 max_kl=0.00804
[EpochKL] epoch=2 mean_kl=0.00484 max_kl=0.00999
[Time] Env Create Time: 4.4750s |Rollout Collect Time: 1.7103s |Loss & Update :0.9792
[PPODiag] kl_mean=0.0033, kl_p90=0.0065, kl_max=0.0100 | clipfrac_mean=0.012, logratio_std_mean=0.087, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.677 | pg_loss_mean=0.0004, v_loss_mean=0.0198, ent_mean=0.0176 | gn_bb_mean=0.675, gn_bb_max=1.730 | gn_v_mean=0.256, gn_v_max=0.733

  9%|▉         | 443/5000 [54:14<9:15:40,  7.32s/it]------------------ Training Record ------------------
Epoch: 443/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1067, reward_valid_std=4.1835
[BatchDiag] adv_mean=0.0061, adv_std=0.2900, adv_abs_mean=0.1893 | ret_mean=8.9570, ret_std=0.5895 | val_mean=8.9509, val_std=0.5227 | explained_var=0.758077
[GradSplit pre-clip] backbone=0.367228, critic=0.301169
[Loss] pg_loss=-0.066480, entropy_loss=0.000016, value_loss=0.010430
[EpochKL] epoch=0 mean_kl=0.00174 max_kl=0.00456
[EpochKL] epoch=1 mean_kl=0.00905 max_kl=0.02354
[EpochKL] epoch=2 mean_kl=0.00804 max_kl=0.01625
[Time] Env Create Time: 4.4594s |Rollout Collect Time: 1.9558s |Loss & Update :1.0742
[PPODiag] kl_mean=0.0063, kl_p90=0.0118, kl_max=0.0235 | clipfrac_mean=0.015, logratio_std_mean=0.128, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.590, p10=0.587, min=0.584 | pg_loss_mean=0.0018, v_loss_mean=0.0203, ent_mean=0.0146 | gn_bb_mean=0.722, gn_bb_max=1.348 | gn_v_mean=0.171, gn_v_max=0.301

  9%|▉         | 444/5000 [54:22<9:19:30,  7.37s/it]------------------ Training Record ------------------
Epoch: 444/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1187, reward_valid_std=4.1885
[BatchDiag] adv_mean=-0.0046, adv_std=0.2791, adv_abs_mean=0.1824 | ret_mean=8.9698, ret_std=0.5826 | val_mean=8.9744, val_std=0.5050 | explained_var=0.770469
[GradSplit pre-clip] backbone=0.610447, critic=0.216686
[Loss] pg_loss=-0.086204, entropy_loss=0.000017, value_loss=0.006750
[EpochKL] epoch=0 mean_kl=0.00195 max_kl=0.00437
[EpochKL] epoch=1 mean_kl=0.00890 max_kl=0.01686
[EarlyStop] epoch=2 mean_kl=0.01121 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01121 max_kl=0.01564
[Time] Env Create Time: 4.4451s |Rollout Collect Time: 1.7109s |Loss & Update :0.9624
[PPODiag] kl_mean=0.0074, kl_p90=0.0138, kl_max=0.0169 | clipfrac_mean=0.017, logratio_std_mean=0.136, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.679, min=0.678 | pg_loss_mean=0.0021, v_loss_mean=0.0190, ent_mean=0.0185 | gn_bb_mean=1.055, gn_bb_max=3.836 | gn_v_mean=0.268, gn_v_max=0.474

  9%|▉         | 445/5000 [54:29<9:13:41,  7.29s/it]------------------ Training Record ------------------
Epoch: 445/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1147, reward_valid_std=4.1791
[BatchDiag] adv_mean=0.0087, adv_std=0.2814, adv_abs_mean=0.1920 | ret_mean=8.9618, ret_std=0.5794 | val_mean=8.9530, val_std=0.4940 | explained_var=0.764046
[GradSplit pre-clip] backbone=0.906697, critic=0.321404
[Loss] pg_loss=-0.063544, entropy_loss=0.000014, value_loss=0.007788
[EpochKL] epoch=0 mean_kl=0.00654 max_kl=0.01575
[EarlyStop] epoch=1 mean_kl=0.01277 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01277 max_kl=0.02082
[Time] Env Create Time: 4.4252s |Rollout Collect Time: 1.9420s |Loss & Update :0.7465
[PPODiag] kl_mean=0.0097, kl_p90=0.0169, kl_max=0.0208 | clipfrac_mean=0.018, logratio_std_mean=0.165, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.589, p10=0.585, min=0.580 | pg_loss_mean=0.0032, v_loss_mean=0.0193, ent_mean=0.0157 | gn_bb_mean=1.171, gn_bb_max=2.963 | gn_v_mean=0.287, gn_v_max=0.505
[AttnScore] scale=1.0558, C=10.0

  9%|▉         | 446/5000 [54:36<9:09:29,  7.24s/it]------------------ Training Record ------------------
Epoch: 446/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1033, reward_valid_std=4.1727
[BatchDiag] adv_mean=-0.0044, adv_std=0.2968, adv_abs_mean=0.1942 | ret_mean=8.9466, ret_std=0.5884 | val_mean=8.9510, val_std=0.4925 | explained_var=0.745657
[GradSplit pre-clip] backbone=0.507964, critic=0.202365
[Loss] pg_loss=-0.033224, entropy_loss=0.000015, value_loss=0.008998
[EpochKL] epoch=0 mean_kl=0.00257 max_kl=0.00609
[EpochKL] epoch=1 mean_kl=0.00553 max_kl=0.00937
[EarlyStop] epoch=2 mean_kl=0.01402 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01402 max_kl=0.02355
[Time] Env Create Time: 4.6508s |Rollout Collect Time: 1.7112s |Loss & Update :0.9668
[PPODiag] kl_mean=0.0074, kl_p90=0.0168, kl_max=0.0235 | clipfrac_mean=0.015, logratio_std_mean=0.144, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.681 | pg_loss_mean=0.0011, v_loss_mean=0.0215, ent_mean=0.0178 | gn_bb_mean=0.780, gn_bb_max=1.727 | gn_v_mean=0.301, gn_v_max=0.528

  9%|▉         | 447/5000 [54:43<9:11:24,  7.27s/it]------------------ Training Record ------------------
Epoch: 447/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1041, reward_valid_std=4.1761
[BatchDiag] adv_mean=-0.0459, adv_std=0.3058, adv_abs_mean=0.1960 | ret_mean=8.9501, ret_std=0.5946 | val_mean=8.9960, val_std=0.4904 | explained_var=0.735496
[GradSplit pre-clip] backbone=0.735680, critic=0.288308
[Loss] pg_loss=-0.037327, entropy_loss=0.000017, value_loss=0.008947
[EpochKL] epoch=0 mean_kl=0.00189 max_kl=0.00436
[EpochKL] epoch=1 mean_kl=0.00749 max_kl=0.01768
[EarlyStop] epoch=2 mean_kl=0.01000 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01000 max_kl=0.02064
[Time] Env Create Time: 4.4632s |Rollout Collect Time: 1.7108s |Loss & Update :0.9805
[PPODiag] kl_mean=0.0065, kl_p90=0.0162, kl_max=0.0206 | clipfrac_mean=0.015, logratio_std_mean=0.128, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.683 | pg_loss_mean=0.0012, v_loss_mean=0.0222, ent_mean=0.0179 | gn_bb_mean=0.633, gn_bb_max=1.426 | gn_v_mean=0.218, gn_v_max=0.530

  9%|▉         | 448/5000 [54:50<9:08:45,  7.23s/it]------------------ Training Record ------------------
Epoch: 448/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1036, reward_valid_std=4.1834
[BatchDiag] adv_mean=-0.0193, adv_std=0.2910, adv_abs_mean=0.1912 | ret_mean=8.9538, ret_std=0.5889 | val_mean=8.9731, val_std=0.5101 | explained_var=0.755886
[GradSplit pre-clip] backbone=0.643574, critic=0.113140
[Loss] pg_loss=-0.042071, entropy_loss=0.000013, value_loss=0.007811
[EpochKL] epoch=0 mean_kl=0.00182 max_kl=0.00479
[EpochKL] epoch=1 mean_kl=0.00621 max_kl=0.01022
[EpochKL] epoch=2 mean_kl=0.00921 max_kl=0.01704
[Time] Env Create Time: 4.4622s |Rollout Collect Time: 1.9425s |Loss & Update :1.0766
[PPODiag] kl_mean=0.0057, kl_p90=0.0103, kl_max=0.0170 | clipfrac_mean=0.015, logratio_std_mean=0.120, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.590, p10=0.585, min=0.584 | pg_loss_mean=0.0017, v_loss_mean=0.0205, ent_mean=0.0146 | gn_bb_mean=0.790, gn_bb_max=1.631 | gn_v_mean=0.241, gn_v_max=0.462

  9%|▉         | 449/5000 [54:58<9:14:17,  7.31s/it]------------------ Training Record ------------------
Epoch: 449/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1051, reward_valid_std=4.1767
[BatchDiag] adv_mean=-0.0338, adv_std=0.2962, adv_abs_mean=0.1909 | ret_mean=8.9543, ret_std=0.5927 | val_mean=8.9880, val_std=0.4927 | explained_var=0.750224
[GradSplit pre-clip] backbone=0.939334, critic=0.234254
[Loss] pg_loss=-0.021309, entropy_loss=0.000015, value_loss=0.010400
[EpochKL] epoch=0 mean_kl=0.00802 max_kl=0.01692
[EpochKL] epoch=1 mean_kl=0.00782 max_kl=0.01613
[EpochKL] epoch=2 mean_kl=0.00912 max_kl=0.01196
[Time] Env Create Time: 4.4217s |Rollout Collect Time: 1.6857s |Loss & Update :0.9638
[PPODiag] kl_mean=0.0083, kl_p90=0.0130, kl_max=0.0169 | clipfrac_mean=0.016, logratio_std_mean=0.153, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.682 | pg_loss_mean=0.0025, v_loss_mean=0.0220, ent_mean=0.0161 | gn_bb_mean=0.708, gn_bb_max=1.139 | gn_v_mean=0.284, gn_v_max=0.523

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.962, Step: 7, Avg Done Step: 6.60, #CS visited: 0.12
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8192s
-----------------------------
  9%|▉         | 450/5000 [55:07<9:50:53,  7.79s/it]------------------ Training Record ------------------
Epoch: 450/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1018, reward_valid_std=4.1770
[BatchDiag] adv_mean=-0.0207, adv_std=0.3084, adv_abs_mean=0.1966 | ret_mean=8.9510, ret_std=0.6008 | val_mean=8.9717, val_std=0.5077 | explained_var=0.736449
[GradSplit pre-clip] backbone=0.987576, critic=0.135237
[Loss] pg_loss=-0.017199, entropy_loss=0.000018, value_loss=0.010336
[EpochKL] epoch=0 mean_kl=0.00213 max_kl=0.00691
[EpochKL] epoch=1 mean_kl=0.00556 max_kl=0.00866
[EpochKL] epoch=2 mean_kl=0.00911 max_kl=0.01673
[Time] Env Create Time: 4.3677s |Rollout Collect Time: 1.8693s |Loss & Update :0.9651
[PPODiag] kl_mean=0.0056, kl_p90=0.0106, kl_max=0.0167 | clipfrac_mean=0.013, logratio_std_mean=0.119, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.680 | pg_loss_mean=0.0007, v_loss_mean=0.0230, ent_mean=0.0172 | gn_bb_mean=0.762, gn_bb_max=2.911 | gn_v_mean=0.306, gn_v_max=0.717
[AttnScore] scale=1.0567, C=10.0

  9%|▉         | 451/5000 [55:14<9:37:20,  7.62s/it]------------------ Training Record ------------------
Epoch: 451/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1128, reward_valid_std=4.1818
[BatchDiag] adv_mean=-0.0031, adv_std=0.2857, adv_abs_mean=0.1943 | ret_mean=8.9691, ret_std=0.5762 | val_mean=8.9722, val_std=0.4950 | explained_var=0.754104
[GradSplit pre-clip] backbone=0.866397, critic=0.202595
[Loss] pg_loss=-0.013261, entropy_loss=0.000014, value_loss=0.007982
[EpochKL] epoch=0 mean_kl=0.00367 max_kl=0.01192
[EarlyStop] epoch=1 mean_kl=0.02387 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02387 max_kl=0.04204
[Time] Env Create Time: 4.3926s |Rollout Collect Time: 1.9166s |Loss & Update :0.7339
[PPODiag] kl_mean=0.0138, kl_p90=0.0290, kl_max=0.0420 | clipfrac_mean=0.018, logratio_std_mean=0.192, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.590, p10=0.582, min=0.581 | pg_loss_mean=0.0050, v_loss_mean=0.0198, ent_mean=0.0142 | gn_bb_mean=1.140, gn_bb_max=2.347 | gn_v_mean=0.245, gn_v_max=0.544

  9%|▉         | 452/5000 [55:21<9:24:13,  7.44s/it]------------------ Training Record ------------------
Epoch: 452/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1066, reward_valid_std=4.1817
[BatchDiag] adv_mean=0.0039, adv_std=0.2879, adv_abs_mean=0.1906 | ret_mean=8.9603, ret_std=0.5824 | val_mean=8.9564, val_std=0.5049 | explained_var=0.755635
[GradSplit pre-clip] backbone=1.431643, critic=0.100606
[Loss] pg_loss=0.027382, entropy_loss=0.000017, value_loss=0.008711
[EarlyStop] epoch=0 mean_kl=0.01808 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01808 max_kl=0.04579
[Time] Env Create Time: 4.4015s |Rollout Collect Time: 1.6855s |Loss & Update :0.3537
[PPODiag] kl_mean=0.0181, kl_p90=0.0353, kl_max=0.0458 | clipfrac_mean=0.021, logratio_std_mean=0.235, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.681 | pg_loss_mean=0.0060, v_loss_mean=0.0205, ent_mean=0.0178 | gn_bb_mean=1.809, gn_bb_max=3.351 | gn_v_mean=0.277, gn_v_max=0.574

  9%|▉         | 453/5000 [55:27<9:01:18,  7.14s/it]------------------ Training Record ------------------
Epoch: 453/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1191, reward_valid_std=4.1896
[BatchDiag] adv_mean=-0.0061, adv_std=0.2803, adv_abs_mean=0.1903 | ret_mean=8.9699, ret_std=0.5785 | val_mean=8.9759, val_std=0.4988 | explained_var=0.765279
[GradSplit pre-clip] backbone=1.431254, critic=0.283764
[Loss] pg_loss=-0.093877, entropy_loss=0.000012, value_loss=0.008051
[EpochKL] epoch=0 mean_kl=0.00557 max_kl=0.01308
[EarlyStop] epoch=1 mean_kl=0.03741 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03741 max_kl=0.07650
[Time] Env Create Time: 4.3765s |Rollout Collect Time: 1.6878s |Loss & Update :0.6581
[PPODiag] kl_mean=0.0215, kl_p90=0.0448, kl_max=0.0765 | clipfrac_mean=0.021, logratio_std_mean=0.285, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.685, p10=0.681, min=0.680 | pg_loss_mean=0.0021, v_loss_mean=0.0199, ent_mean=0.0156 | gn_bb_mean=1.126, gn_bb_max=3.189 | gn_v_mean=0.341, gn_v_max=0.635

  9%|▉         | 454/5000 [55:34<8:51:38,  7.02s/it]------------------ Training Record ------------------
Epoch: 454/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1023, reward_valid_std=4.1808
[BatchDiag] adv_mean=-0.0157, adv_std=0.2960, adv_abs_mean=0.1915 | ret_mean=8.9436, ret_std=0.5919 | val_mean=8.9593, val_std=0.5301 | explained_var=0.750007
[GradSplit pre-clip] backbone=1.257965, critic=0.141389
[Loss] pg_loss=-0.037140, entropy_loss=0.000010, value_loss=0.009283
[EpochKL] epoch=0 mean_kl=0.00586 max_kl=0.02443
[EarlyStop] epoch=1 mean_kl=0.02054 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02054 max_kl=0.03253
[Time] Env Create Time: 4.4374s |Rollout Collect Time: 1.7171s |Loss & Update :0.6659
[PPODiag] kl_mean=0.0132, kl_p90=0.0266, kl_max=0.0325 | clipfrac_mean=0.015, logratio_std_mean=0.216, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.680 | pg_loss_mean=0.0009, v_loss_mean=0.0210, ent_mean=0.0146 | gn_bb_mean=0.830, gn_bb_max=2.041 | gn_v_mean=0.335, gn_v_max=0.699

  9%|▉         | 455/5000 [55:41<8:47:04,  6.96s/it]------------------ Training Record ------------------
Epoch: 455/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1112, reward_valid_std=4.1856
[BatchDiag] adv_mean=0.0352, adv_std=0.2850, adv_abs_mean=0.1958 | ret_mean=8.9463, ret_std=0.5860 | val_mean=8.9111, val_std=0.5255 | explained_var=0.763511
[GradSplit pre-clip] backbone=1.102421, critic=0.527623
[Loss] pg_loss=-0.046061, entropy_loss=0.000012, value_loss=0.009430
[EarlyStop] epoch=0 mean_kl=0.01625 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01625 max_kl=0.05099
[Time] Env Create Time: 4.4258s |Rollout Collect Time: 1.7202s |Loss & Update :0.3645
[PPODiag] kl_mean=0.0163, kl_p90=0.0343, kl_max=0.0510 | clipfrac_mean=0.019, logratio_std_mean=0.219, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.679 | pg_loss_mean=0.0032, v_loss_mean=0.0208, ent_mean=0.0157 | gn_bb_mean=1.223, gn_bb_max=2.647 | gn_v_mean=0.482, gn_v_max=0.717
[AttnScore] scale=1.0565, C=10.0

  9%|▉         | 456/5000 [55:47<8:36:47,  6.82s/it]------------------ Training Record ------------------
Epoch: 456/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1185, reward_valid_std=4.1872
[BatchDiag] adv_mean=0.0591, adv_std=0.2771, adv_abs_mean=0.2034 | ret_mean=8.9660, ret_std=0.5784 | val_mean=8.9070, val_std=0.5150 | explained_var=0.770565
[GradSplit pre-clip] backbone=0.502397, critic=0.767185
[Loss] pg_loss=-0.058857, entropy_loss=0.000015, value_loss=0.008719
[EpochKL] epoch=0 mean_kl=0.00670 max_kl=0.02333
[EpochKL] epoch=1 mean_kl=0.00776 max_kl=0.01109
[EarlyStop] epoch=2 mean_kl=0.01635 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01635 max_kl=0.04176
[Time] Env Create Time: 4.6325s |Rollout Collect Time: 1.6932s |Loss & Update :0.9661
[PPODiag] kl_mean=0.0103, kl_p90=0.0207, kl_max=0.0418 | clipfrac_mean=0.019, logratio_std_mean=0.159, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.680, min=0.678 | pg_loss_mean=0.0033, v_loss_mean=0.0189, ent_mean=0.0178 | gn_bb_mean=1.619, gn_bb_max=6.715 | gn_v_mean=0.318, gn_v_max=0.767

  9%|▉         | 457/5000 [55:55<8:47:19,  6.96s/it]------------------ Training Record ------------------
Epoch: 457/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1134, reward_valid_std=4.1844
[BatchDiag] adv_mean=0.0474, adv_std=0.2826, adv_abs_mean=0.1989 | ret_mean=8.9529, ret_std=0.5853 | val_mean=8.9054, val_std=0.5253 | explained_var=0.766861
[GradSplit pre-clip] backbone=1.163834, critic=0.527342
[Loss] pg_loss=-0.003863, entropy_loss=0.000015, value_loss=0.009351
[EarlyStop] epoch=0 mean_kl=0.01019 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01019 max_kl=0.02356
[Time] Env Create Time: 4.4400s |Rollout Collect Time: 1.7007s |Loss & Update :0.3450
[PPODiag] kl_mean=0.0102, kl_p90=0.0207, kl_max=0.0236 | clipfrac_mean=0.016, logratio_std_mean=0.167, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.681 | pg_loss_mean=0.0038, v_loss_mean=0.0206, ent_mean=0.0158 | gn_bb_mean=1.171, gn_bb_max=2.954 | gn_v_mean=0.445, gn_v_max=0.702

  9%|▉         | 458/5000 [56:01<8:36:20,  6.82s/it]------------------ Training Record ------------------
Epoch: 458/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1132, reward_valid_std=4.1853
[BatchDiag] adv_mean=-0.0087, adv_std=0.2838, adv_abs_mean=0.1933 | ret_mean=8.9561, ret_std=0.5776 | val_mean=8.9648, val_std=0.4724 | explained_var=0.758649
[GradSplit pre-clip] backbone=0.697340, critic=0.271067
[Loss] pg_loss=-0.071983, entropy_loss=0.000014, value_loss=0.006334
[EpochKL] epoch=0 mean_kl=0.00641 max_kl=0.01944
[EarlyStop] epoch=1 mean_kl=0.01641 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01641 max_kl=0.02928
[Time] Env Create Time: 4.4448s |Rollout Collect Time: 1.6895s |Loss & Update :0.6657
[PPODiag] kl_mean=0.0114, kl_p90=0.0229, kl_max=0.0293 | clipfrac_mean=0.017, logratio_std_mean=0.184, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.675 | pg_loss_mean=0.0035, v_loss_mean=0.0194, ent_mean=0.0162 | gn_bb_mean=0.905, gn_bb_max=1.512 | gn_v_mean=0.260, gn_v_max=0.504

  9%|▉         | 459/5000 [56:08<8:35:45,  6.81s/it]------------------ Training Record ------------------
Epoch: 459/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1121, reward_valid_std=4.1791
[BatchDiag] adv_mean=-0.0123, adv_std=0.3004, adv_abs_mean=0.1939 | ret_mean=8.9544, ret_std=0.5920 | val_mean=8.9667, val_std=0.5076 | explained_var=0.742496
[GradSplit pre-clip] backbone=0.333280, critic=0.170850
[Loss] pg_loss=0.013130, entropy_loss=0.000016, value_loss=0.010850
[EpochKL] epoch=0 mean_kl=0.00518 max_kl=0.00937
[EarlyStop] epoch=1 mean_kl=0.01682 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01682 max_kl=0.03289
[Time] Env Create Time: 4.4397s |Rollout Collect Time: 1.7049s |Loss & Update :0.6618
[PPODiag] kl_mean=0.0110, kl_p90=0.0183, kl_max=0.0329 | clipfrac_mean=0.020, logratio_std_mean=0.175, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.678 | pg_loss_mean=0.0040, v_loss_mean=0.0215, ent_mean=0.0195 | gn_bb_mean=1.031, gn_bb_max=4.597 | gn_v_mean=0.246, gn_v_max=0.521

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.972, Step: 7, Avg Done Step: 6.63, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8286s
-----------------------------
  9%|▉         | 460/5000 [56:17<9:17:41,  7.37s/it]------------------ Training Record ------------------
Epoch: 460/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.595, reward_valid_mean=2.0821, reward_valid_std=4.1716
[BatchDiag] adv_mean=-0.0473, adv_std=0.3258, adv_abs_mean=0.2120 | ret_mean=8.9371, ret_std=0.6131 | val_mean=8.9844, val_std=0.4919 | explained_var=0.717543
[GradSplit pre-clip] backbone=1.025952, critic=0.336656
[Loss] pg_loss=-0.003814, entropy_loss=0.000021, value_loss=0.013910
[EpochKL] epoch=0 mean_kl=0.00591 max_kl=0.02903
[EarlyStop] epoch=1 mean_kl=0.03028 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03028 max_kl=0.07965
[Time] Env Create Time: 4.4052s |Rollout Collect Time: 1.9191s |Loss & Update :0.7422
[PPODiag] kl_mean=0.0181, kl_p90=0.0362, kl_max=0.0797 | clipfrac_mean=0.021, logratio_std_mean=0.285, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.595, p10=0.588, min=0.587 | pg_loss_mean=0.0034, v_loss_mean=0.0251, ent_mean=0.0189 | gn_bb_mean=1.030, gn_bb_max=2.133 | gn_v_mean=0.381, gn_v_max=0.810
[AttnScore] scale=1.0565, C=10.0

  9%|▉         | 461/5000 [56:24<9:10:41,  7.28s/it]------------------ Training Record ------------------
Epoch: 461/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1062, reward_valid_std=4.1754
[BatchDiag] adv_mean=0.0375, adv_std=0.2997, adv_abs_mean=0.2078 | ret_mean=8.9493, ret_std=0.5914 | val_mean=8.9118, val_std=0.4940 | explained_var=0.743207
[GradSplit pre-clip] backbone=0.535890, critic=0.530295
[Loss] pg_loss=-0.001985, entropy_loss=0.000016, value_loss=0.011800
[EpochKL] epoch=0 mean_kl=0.00253 max_kl=0.00654
[EpochKL] epoch=1 mean_kl=0.00903 max_kl=0.01863
[EarlyStop] epoch=2 mean_kl=0.01011 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01011 max_kl=0.01931
[Time] Env Create Time: 4.3778s |Rollout Collect Time: 1.6783s |Loss & Update :0.9494
[PPODiag] kl_mean=0.0072, kl_p90=0.0142, kl_max=0.0193 | clipfrac_mean=0.016, logratio_std_mean=0.139, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.685, min=0.682 | pg_loss_mean=0.0022, v_loss_mean=0.0216, ent_mean=0.0187 | gn_bb_mean=0.941, gn_bb_max=4.380 | gn_v_mean=0.459, gn_v_max=0.793

  9%|▉         | 462/5000 [56:31<9:04:21,  7.20s/it]------------------ Training Record ------------------
Epoch: 462/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0929, reward_valid_std=4.1769
[BatchDiag] adv_mean=-0.0054, adv_std=0.3055, adv_abs_mean=0.1975 | ret_mean=8.9414, ret_std=0.6067 | val_mean=8.9467, val_std=0.5166 | explained_var=0.746475
[GradSplit pre-clip] backbone=0.645812, critic=0.242506
[Loss] pg_loss=0.092019, entropy_loss=0.000021, value_loss=0.013935
[EpochKL] epoch=0 mean_kl=0.00708 max_kl=0.01546
[EarlyStop] epoch=1 mean_kl=0.01129 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01129 max_kl=0.01790
[Time] Env Create Time: 4.5806s |Rollout Collect Time: 1.6801s |Loss & Update :0.6521
[PPODiag] kl_mean=0.0092, kl_p90=0.0159, kl_max=0.0179 | clipfrac_mean=0.019, logratio_std_mean=0.152, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.685, min=0.680 | pg_loss_mean=0.0035, v_loss_mean=0.0232, ent_mean=0.0184 | gn_bb_mean=0.771, gn_bb_max=1.314 | gn_v_mean=0.334, gn_v_max=0.625

  9%|▉         | 463/5000 [56:38<8:57:47,  7.11s/it]------------------ Training Record ------------------
Epoch: 463/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1127, reward_valid_std=4.1759
[BatchDiag] adv_mean=-0.0114, adv_std=0.2859, adv_abs_mean=0.1871 | ret_mean=8.9566, ret_std=0.5851 | val_mean=8.9680, val_std=0.5200 | explained_var=0.761163
[GradSplit pre-clip] backbone=1.090766, critic=0.247153
[Loss] pg_loss=-0.101589, entropy_loss=0.000013, value_loss=0.007439
[EpochKL] epoch=0 mean_kl=0.00298 max_kl=0.00884
[EpochKL] epoch=1 mean_kl=0.00901 max_kl=0.01913
[EarlyStop] epoch=2 mean_kl=0.01328 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01328 max_kl=0.02612
[Time] Env Create Time: 4.4448s |Rollout Collect Time: 1.6993s |Loss & Update :0.9597
[PPODiag] kl_mean=0.0084, kl_p90=0.0148, kl_max=0.0261 | clipfrac_mean=0.016, logratio_std_mean=0.174, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.677 | pg_loss_mean=0.0021, v_loss_mean=0.0202, ent_mean=0.0176 | gn_bb_mean=0.776, gn_bb_max=1.931 | gn_v_mean=0.233, gn_v_max=0.435

  9%|▉         | 464/5000 [56:45<8:57:29,  7.11s/it]------------------ Training Record ------------------
Epoch: 464/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1167, reward_valid_std=4.1821
[BatchDiag] adv_mean=-0.0016, adv_std=0.2822, adv_abs_mean=0.1863 | ret_mean=8.9598, ret_std=0.5824 | val_mean=8.9614, val_std=0.5245 | explained_var=0.765135
[GradSplit pre-clip] backbone=0.946353, critic=0.295606
[Loss] pg_loss=-0.091816, entropy_loss=0.000014, value_loss=0.007348
[EpochKL] epoch=0 mean_kl=0.00476 max_kl=0.01373
[EpochKL] epoch=1 mean_kl=0.00913 max_kl=0.01866
[EpochKL] epoch=2 mean_kl=0.00663 max_kl=0.00919
[Time] Env Create Time: 4.4334s |Rollout Collect Time: 1.6961s |Loss & Update :0.9569
[PPODiag] kl_mean=0.0068, kl_p90=0.0136, kl_max=0.0187 | clipfrac_mean=0.016, logratio_std_mean=0.138, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.680 | pg_loss_mean=0.0020, v_loss_mean=0.0193, ent_mean=0.0158 | gn_bb_mean=0.917, gn_bb_max=2.899 | gn_v_mean=0.256, gn_v_max=0.477

  9%|▉         | 465/5000 [56:52<8:56:51,  7.10s/it]------------------ Training Record ------------------
Epoch: 465/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1128, reward_valid_std=4.1818
[BatchDiag] adv_mean=-0.0010, adv_std=0.2710, adv_abs_mean=0.1758 | ret_mean=8.9513, ret_std=0.5785 | val_mean=8.9524, val_std=0.5152 | explained_var=0.780529
[GradSplit pre-clip] backbone=0.765092, critic=0.155080
[Loss] pg_loss=0.012600, entropy_loss=0.000016, value_loss=0.010219
[EpochKL] epoch=0 mean_kl=0.00542 max_kl=0.01503
[EarlyStop] epoch=1 mean_kl=0.01825 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01825 max_kl=0.04462
[Time] Env Create Time: 4.4294s |Rollout Collect Time: 1.7068s |Loss & Update :0.6564
[PPODiag] kl_mean=0.0118, kl_p90=0.0285, kl_max=0.0446 | clipfrac_mean=0.016, logratio_std_mean=0.181, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.682, min=0.672 | pg_loss_mean=0.0026, v_loss_mean=0.0184, ent_mean=0.0155 | gn_bb_mean=1.354, gn_bb_max=7.530 | gn_v_mean=0.287, gn_v_max=0.588
[AttnScore] scale=1.0574, C=10.0

  9%|▉         | 466/5000 [56:59<8:49:43,  7.01s/it]------------------ Training Record ------------------
Epoch: 466/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1136, reward_valid_std=4.1812
[BatchDiag] adv_mean=-0.0471, adv_std=0.3072, adv_abs_mean=0.1921 | ret_mean=8.9581, ret_std=0.5939 | val_mean=9.0053, val_std=0.5259 | explained_var=0.732410
[GradSplit pre-clip] backbone=1.379070, critic=0.306951
[Loss] pg_loss=-0.048013, entropy_loss=0.000009, value_loss=0.010459
[EpochKL] epoch=0 mean_kl=0.00258 max_kl=0.00750
[EarlyStop] epoch=1 mean_kl=0.01111 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01111 max_kl=0.02062
[Time] Env Create Time: 4.4156s |Rollout Collect Time: 1.9376s |Loss & Update :0.7313
[PPODiag] kl_mean=0.0068, kl_p90=0.0147, kl_max=0.0206 | clipfrac_mean=0.013, logratio_std_mean=0.127, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.589, p10=0.584, min=0.583 | pg_loss_mean=0.0013, v_loss_mean=0.0223, ent_mean=0.0127 | gn_bb_mean=1.021, gn_bb_max=1.959 | gn_v_mean=0.275, gn_v_max=0.452

  9%|▉         | 467/5000 [57:06<8:51:18,  7.03s/it]------------------ Training Record ------------------
Epoch: 467/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1168, reward_valid_std=4.1866
[BatchDiag] adv_mean=0.0037, adv_std=0.2812, adv_abs_mean=0.1854 | ret_mean=8.9616, ret_std=0.5806 | val_mean=8.9579, val_std=0.5134 | explained_var=0.765358
[GradSplit pre-clip] backbone=0.890515, critic=0.310474
[Loss] pg_loss=-0.083313, entropy_loss=0.000015, value_loss=0.008492
[EpochKL] epoch=0 mean_kl=0.00276 max_kl=0.00692
[EpochKL] epoch=1 mean_kl=0.00942 max_kl=0.02454
[EarlyStop] epoch=2 mean_kl=0.01240 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01240 max_kl=0.01930
[Time] Env Create Time: 4.3912s |Rollout Collect Time: 1.7023s |Loss & Update :0.9595
[PPODiag] kl_mean=0.0082, kl_p90=0.0162, kl_max=0.0245 | clipfrac_mean=0.016, logratio_std_mean=0.152, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.678 | pg_loss_mean=0.0025, v_loss_mean=0.0195, ent_mean=0.0161 | gn_bb_mean=1.055, gn_bb_max=3.955 | gn_v_mean=0.341, gn_v_max=0.620

  9%|▉         | 468/5000 [57:13<8:51:39,  7.04s/it]------------------ Training Record ------------------
Epoch: 468/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.684, reward_valid_mean=2.1274, reward_valid_std=4.1828
[BatchDiag] adv_mean=-0.0192, adv_std=0.2696, adv_abs_mean=0.1776 | ret_mean=8.9749, ret_std=0.5654 | val_mean=8.9940, val_std=0.5102 | explained_var=0.772658
[GradSplit pre-clip] backbone=0.433118, critic=0.172538
[Loss] pg_loss=-0.025722, entropy_loss=0.000011, value_loss=0.005353
[EpochKL] epoch=0 mean_kl=0.00307 max_kl=0.00683
[EpochKL] epoch=1 mean_kl=0.00810 max_kl=0.01687
[EpochKL] epoch=2 mean_kl=0.00948 max_kl=0.01453
[Time] Env Create Time: 4.6212s |Rollout Collect Time: 1.6930s |Loss & Update :0.9578
[PPODiag] kl_mean=0.0069, kl_p90=0.0135, kl_max=0.0169 | clipfrac_mean=0.016, logratio_std_mean=0.129, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.684, p10=0.678, min=0.676 | pg_loss_mean=0.0020, v_loss_mean=0.0170, ent_mean=0.0155 | gn_bb_mean=1.022, gn_bb_max=3.764 | gn_v_mean=0.187, gn_v_max=0.396

  9%|▉         | 469/5000 [57:20<8:56:50,  7.11s/it]------------------ Training Record ------------------
Epoch: 469/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1067, reward_valid_std=4.1830
[BatchDiag] adv_mean=0.0076, adv_std=0.2956, adv_abs_mean=0.1931 | ret_mean=8.9498, ret_std=0.5885 | val_mean=8.9422, val_std=0.5099 | explained_var=0.747612
[GradSplit pre-clip] backbone=1.204161, critic=0.316452
[Loss] pg_loss=-0.066298, entropy_loss=0.000012, value_loss=0.007982
[EpochKL] epoch=0 mean_kl=0.00374 max_kl=0.01070
[EarlyStop] epoch=1 mean_kl=0.01060 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01060 max_kl=0.01785
[Time] Env Create Time: 4.4475s |Rollout Collect Time: 1.6998s |Loss & Update :0.6699
[PPODiag] kl_mean=0.0072, kl_p90=0.0162, kl_max=0.0179 | clipfrac_mean=0.014, logratio_std_mean=0.139, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.681, min=0.679 | pg_loss_mean=0.0023, v_loss_mean=0.0213, ent_mean=0.0151 | gn_bb_mean=1.109, gn_bb_max=3.443 | gn_v_mean=0.248, gn_v_max=0.455

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.986, Step: 7, Avg Done Step: 6.61, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8578s
-----------------------------
  9%|▉         | 470/5000 [57:29<9:32:49,  7.59s/it]------------------ Training Record ------------------
Epoch: 470/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1018, reward_valid_std=4.1796
[BatchDiag] adv_mean=-0.0197, adv_std=0.2976, adv_abs_mean=0.1902 | ret_mean=8.9531, ret_std=0.5984 | val_mean=8.9728, val_std=0.5266 | explained_var=0.752683
[GradSplit pre-clip] backbone=0.764876, critic=0.181314
[Loss] pg_loss=-0.027166, entropy_loss=0.000018, value_loss=0.010323
[EpochKL] epoch=0 mean_kl=0.00408 max_kl=0.00671
[EarlyStop] epoch=1 mean_kl=0.01408 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01408 max_kl=0.02725
[Time] Env Create Time: 4.4240s |Rollout Collect Time: 1.6898s |Loss & Update :0.6674
[PPODiag] kl_mean=0.0091, kl_p90=0.0177, kl_max=0.0272 | clipfrac_mean=0.017, logratio_std_mean=0.164, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.682 | pg_loss_mean=0.0025, v_loss_mean=0.0217, ent_mean=0.0170 | gn_bb_mean=0.980, gn_bb_max=1.802 | gn_v_mean=0.208, gn_v_max=0.347
[AttnScore] scale=1.0580, C=10.0

  9%|▉         | 471/5000 [57:36<9:14:28,  7.35s/it]------------------ Training Record ------------------
Epoch: 471/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1026, reward_valid_std=4.1780
[BatchDiag] adv_mean=0.0124, adv_std=0.2777, adv_abs_mean=0.1875 | ret_mean=8.9571, ret_std=0.5815 | val_mean=8.9447, val_std=0.5290 | explained_var=0.771996
[GradSplit pre-clip] backbone=0.780395, critic=0.213899
[Loss] pg_loss=-0.018710, entropy_loss=0.000016, value_loss=0.008017
[EpochKL] epoch=0 mean_kl=0.00428 max_kl=0.02277
[EarlyStop] epoch=1 mean_kl=0.01384 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01384 max_kl=0.02865
[Time] Env Create Time: 4.4119s |Rollout Collect Time: 1.6812s |Loss & Update :0.6576
[PPODiag] kl_mean=0.0091, kl_p90=0.0218, kl_max=0.0287 | clipfrac_mean=0.015, logratio_std_mean=0.153, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.680 | pg_loss_mean=0.0039, v_loss_mean=0.0187, ent_mean=0.0158 | gn_bb_mean=1.381, gn_bb_max=4.461 | gn_v_mean=0.225, gn_v_max=0.472

  9%|▉         | 472/5000 [57:42<9:00:53,  7.17s/it]------------------ Training Record ------------------
Epoch: 472/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1066, reward_valid_std=4.1786
[BatchDiag] adv_mean=0.0102, adv_std=0.2876, adv_abs_mean=0.1875 | ret_mean=8.9683, ret_std=0.5860 | val_mean=8.9581, val_std=0.5398 | explained_var=0.759072
[GradSplit pre-clip] backbone=0.493659, critic=0.259622
[Loss] pg_loss=-0.026521, entropy_loss=0.000012, value_loss=0.007907
[EpochKL] epoch=0 mean_kl=0.00794 max_kl=0.01764
[EpochKL] epoch=1 mean_kl=0.00854 max_kl=0.02256
[EarlyStop] epoch=2 mean_kl=0.01288 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01288 max_kl=0.02750
[Time] Env Create Time: 4.4407s |Rollout Collect Time: 1.9376s |Loss & Update :1.0767
[PPODiag] kl_mean=0.0098, kl_p90=0.0192, kl_max=0.0275 | clipfrac_mean=0.016, logratio_std_mean=0.165, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.587, min=0.582 | pg_loss_mean=0.0029, v_loss_mean=0.0199, ent_mean=0.0133 | gn_bb_mean=0.936, gn_bb_max=2.342 | gn_v_mean=0.342, gn_v_max=0.846

  9%|▉         | 473/5000 [57:50<9:07:17,  7.25s/it]------------------ Training Record ------------------
Epoch: 473/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1136, reward_valid_std=4.1807
[BatchDiag] adv_mean=0.0363, adv_std=0.2984, adv_abs_mean=0.1978 | ret_mean=8.9571, ret_std=0.5910 | val_mean=8.9208, val_std=0.5306 | explained_var=0.745119
[GradSplit pre-clip] backbone=0.534948, critic=0.509563
[Loss] pg_loss=-0.053567, entropy_loss=0.000013, value_loss=0.007800
[EpochKL] epoch=0 mean_kl=0.00394 max_kl=0.00682
[EpochKL] epoch=1 mean_kl=0.00631 max_kl=0.01011
[EarlyStop] epoch=2 mean_kl=0.01343 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01343 max_kl=0.02657
[Time] Env Create Time: 4.6244s |Rollout Collect Time: 1.6922s |Loss & Update :0.9613
[PPODiag] kl_mean=0.0079, kl_p90=0.0140, kl_max=0.0266 | clipfrac_mean=0.016, logratio_std_mean=0.141, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.677 | pg_loss_mean=0.0023, v_loss_mean=0.0210, ent_mean=0.0153 | gn_bb_mean=0.838, gn_bb_max=2.599 | gn_v_mean=0.305, gn_v_max=0.751

  9%|▉         | 474/5000 [57:57<9:07:43,  7.26s/it]------------------ Training Record ------------------
Epoch: 474/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1094, reward_valid_std=4.1846
[BatchDiag] adv_mean=-0.0061, adv_std=0.2861, adv_abs_mean=0.1847 | ret_mean=8.9608, ret_std=0.5924 | val_mean=8.9669, val_std=0.5096 | explained_var=0.766740
[GradSplit pre-clip] backbone=0.288461, critic=0.114423
[Loss] pg_loss=0.013028, entropy_loss=0.000012, value_loss=0.009455
[EarlyStop] epoch=0 mean_kl=0.01085 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01085 max_kl=0.02610
[Time] Env Create Time: 4.4278s |Rollout Collect Time: 1.6897s |Loss & Update :0.3466
[PPODiag] kl_mean=0.0109, kl_p90=0.0215, kl_max=0.0261 | clipfrac_mean=0.017, logratio_std_mean=0.143, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.678 | pg_loss_mean=0.0034, v_loss_mean=0.0197, ent_mean=0.0169 | gn_bb_mean=1.135, gn_bb_max=1.990 | gn_v_mean=0.301, gn_v_max=0.483

 10%|▉         | 475/5000 [58:04<8:49:35,  7.02s/it]------------------ Training Record ------------------
Epoch: 475/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1195, reward_valid_std=4.1881
[BatchDiag] adv_mean=-0.0007, adv_std=0.2759, adv_abs_mean=0.1775 | ret_mean=8.9662, ret_std=0.5875 | val_mean=8.9670, val_std=0.5187 | explained_var=0.779440
[GradSplit pre-clip] backbone=0.564592, critic=0.121919
[Loss] pg_loss=0.004522, entropy_loss=0.000012, value_loss=0.008370
[EarlyStop] epoch=0 mean_kl=0.01255 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01255 max_kl=0.03435
[Time] Env Create Time: 4.4359s |Rollout Collect Time: 1.6859s |Loss & Update :0.3701
[PPODiag] kl_mean=0.0126, kl_p90=0.0273, kl_max=0.0343 | clipfrac_mean=0.017, logratio_std_mean=0.183, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.678, min=0.675 | pg_loss_mean=0.0049, v_loss_mean=0.0189, ent_mean=0.0164 | gn_bb_mean=1.389, gn_bb_max=4.338 | gn_v_mean=0.244, gn_v_max=0.451
[AttnScore] scale=1.0584, C=10.0

 10%|▉         | 476/5000 [58:10<8:37:29,  6.86s/it]------------------ Training Record ------------------
Epoch: 476/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1100, reward_valid_std=4.1809
[BatchDiag] adv_mean=0.0147, adv_std=0.2852, adv_abs_mean=0.1905 | ret_mean=8.9525, ret_std=0.5876 | val_mean=8.9379, val_std=0.5193 | explained_var=0.764423
[GradSplit pre-clip] backbone=1.360025, critic=0.462736
[Loss] pg_loss=-0.110507, entropy_loss=0.000016, value_loss=0.007142
[EpochKL] epoch=0 mean_kl=0.00954 max_kl=0.01847
[EarlyStop] epoch=1 mean_kl=0.01552 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01552 max_kl=0.02255
[Time] Env Create Time: 4.4294s |Rollout Collect Time: 1.6908s |Loss & Update :0.6643
[PPODiag] kl_mean=0.0125, kl_p90=0.0193, kl_max=0.0225 | clipfrac_mean=0.021, logratio_std_mean=0.197, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.680 | pg_loss_mean=0.0053, v_loss_mean=0.0205, ent_mean=0.0174 | gn_bb_mean=1.463, gn_bb_max=4.305 | gn_v_mean=0.497, gn_v_max=0.991

 10%|▉         | 477/5000 [58:17<8:35:35,  6.84s/it]------------------ Training Record ------------------
Epoch: 477/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1043, reward_valid_std=4.1751
[BatchDiag] adv_mean=-0.0210, adv_std=0.3103, adv_abs_mean=0.1964 | ret_mean=8.9467, ret_std=0.6054 | val_mean=8.9677, val_std=0.5345 | explained_var=0.737345
[GradSplit pre-clip] backbone=0.900263, critic=0.135811
[Loss] pg_loss=-0.078827, entropy_loss=0.000023, value_loss=0.007551
[EarlyStop] epoch=0 mean_kl=0.01126 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01126 max_kl=0.02414
[Time] Env Create Time: 4.3776s |Rollout Collect Time: 1.6907s |Loss & Update :0.3479
[PPODiag] kl_mean=0.0113, kl_p90=0.0206, kl_max=0.0241 | clipfrac_mean=0.018, logratio_std_mean=0.163, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.681 | pg_loss_mean=0.0036, v_loss_mean=0.0237, ent_mean=0.0202 | gn_bb_mean=1.278, gn_bb_max=1.952 | gn_v_mean=0.393, gn_v_max=0.645

 10%|▉         | 478/5000 [58:23<8:25:55,  6.71s/it]------------------ Training Record ------------------
Epoch: 478/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1056, reward_valid_std=4.1772
[BatchDiag] adv_mean=-0.0211, adv_std=0.2864, adv_abs_mean=0.1874 | ret_mean=8.9580, ret_std=0.5830 | val_mean=8.9792, val_std=0.5271 | explained_var=0.758649
[GradSplit pre-clip] backbone=0.706676, critic=0.288140
[Loss] pg_loss=0.011325, entropy_loss=0.000015, value_loss=0.010217
[EpochKL] epoch=0 mean_kl=0.00363 max_kl=0.00859
[EarlyStop] epoch=1 mean_kl=0.01476 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01476 max_kl=0.03238
[Time] Env Create Time: 4.3886s |Rollout Collect Time: 1.9270s |Loss & Update :0.7379
[PPODiag] kl_mean=0.0092, kl_p90=0.0190, kl_max=0.0324 | clipfrac_mean=0.017, logratio_std_mean=0.156, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.591, p10=0.585, min=0.583 | pg_loss_mean=0.0034, v_loss_mean=0.0207, ent_mean=0.0155 | gn_bb_mean=0.971, gn_bb_max=2.051 | gn_v_mean=0.318, gn_v_max=0.611

 10%|▉         | 479/5000 [58:30<8:33:31,  6.82s/it]------------------ Training Record ------------------
Epoch: 479/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1158, reward_valid_std=4.1817
[BatchDiag] adv_mean=-0.0003, adv_std=0.2906, adv_abs_mean=0.1913 | ret_mean=8.9704, ret_std=0.5761 | val_mean=8.9707, val_std=0.5338 | explained_var=0.745581
[GradSplit pre-clip] backbone=0.960058, critic=0.325835
[Loss] pg_loss=-0.102621, entropy_loss=0.000022, value_loss=0.007479
[EarlyStop] epoch=0 mean_kl=0.01266 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01266 max_kl=0.04060
[Time] Env Create Time: 4.3654s |Rollout Collect Time: 1.6848s |Loss & Update :0.3506
[PPODiag] kl_mean=0.0127, kl_p90=0.0258, kl_max=0.0406 | clipfrac_mean=0.019, logratio_std_mean=0.188, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.680 | pg_loss_mean=0.0024, v_loss_mean=0.0214, ent_mean=0.0183 | gn_bb_mean=0.928, gn_bb_max=2.294 | gn_v_mean=0.389, gn_v_max=0.805

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.017, Step: 7, Avg Done Step: 6.60, #CS visited: 0.15
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8184s
-----------------------------
 10%|▉         | 480/5000 [58:39<9:05:46,  7.24s/it]------------------ Training Record ------------------
Epoch: 480/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1156, reward_valid_std=4.1794
[BatchDiag] adv_mean=0.0070, adv_std=0.2886, adv_abs_mean=0.1925 | ret_mean=8.9539, ret_std=0.5889 | val_mean=8.9470, val_std=0.4925 | explained_var=0.759892
[GradSplit pre-clip] backbone=2.199185, critic=0.308259
[Loss] pg_loss=-0.035308, entropy_loss=0.000017, value_loss=0.008829
[EpochKL] epoch=0 mean_kl=0.00416 max_kl=0.00922
[EarlyStop] epoch=1 mean_kl=0.02282 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02282 max_kl=0.03726
[Time] Env Create Time: 4.6044s |Rollout Collect Time: 1.6798s |Loss & Update :0.6555
[PPODiag] kl_mean=0.0135, kl_p90=0.0339, kl_max=0.0373 | clipfrac_mean=0.016, logratio_std_mean=0.196, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.681 | pg_loss_mean=0.0029, v_loss_mean=0.0205, ent_mean=0.0153 | gn_bb_mean=1.536, gn_bb_max=9.833 | gn_v_mean=0.356, gn_v_max=0.647
[AttnScore] scale=1.0592, C=10.0

 10%|▉         | 481/5000 [58:45<8:58:46,  7.15s/it]------------------ Training Record ------------------
Epoch: 481/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1153, reward_valid_std=4.1792
[BatchDiag] adv_mean=0.0083, adv_std=0.2827, adv_abs_mean=0.1914 | ret_mean=8.9497, ret_std=0.5795 | val_mean=8.9414, val_std=0.5007 | explained_var=0.762071
[GradSplit pre-clip] backbone=0.232366, critic=0.171693
[Loss] pg_loss=0.003244, entropy_loss=0.000012, value_loss=0.008198
[EpochKL] epoch=0 mean_kl=0.00412 max_kl=0.00827
[EarlyStop] epoch=1 mean_kl=0.01509 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01509 max_kl=0.02680
[Time] Env Create Time: 4.4013s |Rollout Collect Time: 1.6880s |Loss & Update :0.6592
[PPODiag] kl_mean=0.0096, kl_p90=0.0210, kl_max=0.0268 | clipfrac_mean=0.017, logratio_std_mean=0.170, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.679, min=0.676 | pg_loss_mean=0.0025, v_loss_mean=0.0197, ent_mean=0.0170 | gn_bb_mean=0.992, gn_bb_max=2.973 | gn_v_mean=0.274, gn_v_max=0.600

 10%|▉         | 482/5000 [58:52<8:49:30,  7.03s/it]------------------ Training Record ------------------
Epoch: 482/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1140, reward_valid_std=4.1878
[BatchDiag] adv_mean=-0.0431, adv_std=0.2763, adv_abs_mean=0.1791 | ret_mean=8.9628, ret_std=0.5873 | val_mean=9.0059, val_std=0.5145 | explained_var=0.778631
[GradSplit pre-clip] backbone=0.587994, critic=0.161757
[Loss] pg_loss=-0.139430, entropy_loss=0.000012, value_loss=0.006068
[EpochKL] epoch=0 mean_kl=0.00526 max_kl=0.01328
[EpochKL] epoch=1 mean_kl=0.00924 max_kl=0.01449
[EarlyStop] epoch=2 mean_kl=0.01178 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01178 max_kl=0.02289
[Time] Env Create Time: 4.3940s |Rollout Collect Time: 1.6948s |Loss & Update :0.9779
[PPODiag] kl_mean=0.0088, kl_p90=0.0145, kl_max=0.0229 | clipfrac_mean=0.017, logratio_std_mean=0.160, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.678 | pg_loss_mean=0.0021, v_loss_mean=0.0190, ent_mean=0.0159 | gn_bb_mean=0.847, gn_bb_max=2.483 | gn_v_mean=0.452, gn_v_max=0.877

 10%|▉         | 483/5000 [58:59<8:50:11,  7.04s/it]------------------ Training Record ------------------
Epoch: 483/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1121, reward_valid_std=4.1789
[BatchDiag] adv_mean=0.0010, adv_std=0.2887, adv_abs_mean=0.1908 | ret_mean=8.9541, ret_std=0.5855 | val_mean=8.9531, val_std=0.5046 | explained_var=0.756933
[GradSplit pre-clip] backbone=0.672823, critic=0.339369
[Loss] pg_loss=-0.098298, entropy_loss=0.000018, value_loss=0.006239
[EpochKL] epoch=0 mean_kl=0.00153 max_kl=0.00462
[EarlyStop] epoch=1 mean_kl=0.01120 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01120 max_kl=0.02620
[Time] Env Create Time: 4.3809s |Rollout Collect Time: 1.6840s |Loss & Update :0.6728
[PPODiag] kl_mean=0.0064, kl_p90=0.0162, kl_max=0.0262 | clipfrac_mean=0.013, logratio_std_mean=0.116, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.679 | pg_loss_mean=0.0033, v_loss_mean=0.0201, ent_mean=0.0158 | gn_bb_mean=1.460, gn_bb_max=10.636 | gn_v_mean=0.308, gn_v_max=0.623

 10%|▉         | 484/5000 [59:06<8:43:11,  6.95s/it]------------------ Training Record ------------------
Epoch: 484/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1132, reward_valid_std=4.1780
[BatchDiag] adv_mean=-0.0060, adv_std=0.2815, adv_abs_mean=0.1859 | ret_mean=8.9619, ret_std=0.5743 | val_mean=8.9679, val_std=0.5307 | explained_var=0.759795
[GradSplit pre-clip] backbone=0.470942, critic=0.249136
[Loss] pg_loss=0.059536, entropy_loss=0.000016, value_loss=0.008726
[EpochKL] epoch=0 mean_kl=0.00450 max_kl=0.01030
[EpochKL] epoch=1 mean_kl=0.00749 max_kl=0.01046
[EarlyStop] epoch=2 mean_kl=0.01461 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01461 max_kl=0.02332
[Time] Env Create Time: 4.3916s |Rollout Collect Time: 1.6907s |Loss & Update :0.9613
[PPODiag] kl_mean=0.0089, kl_p90=0.0165, kl_max=0.0233 | clipfrac_mean=0.017, logratio_std_mean=0.156, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.687, p10=0.680, min=0.675 | pg_loss_mean=0.0023, v_loss_mean=0.0192, ent_mean=0.0163 | gn_bb_mean=0.838, gn_bb_max=2.089 | gn_v_mean=0.243, gn_v_max=0.370

 10%|▉         | 485/5000 [59:13<8:45:10,  6.98s/it]------------------ Training Record ------------------
Epoch: 485/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1055, reward_valid_std=4.1787
[BatchDiag] adv_mean=-0.0272, adv_std=0.2926, adv_abs_mean=0.1921 | ret_mean=8.9489, ret_std=0.5881 | val_mean=8.9761, val_std=0.5108 | explained_var=0.752530
[GradSplit pre-clip] backbone=1.092133, critic=0.232895
[Loss] pg_loss=-0.034324, entropy_loss=0.000018, value_loss=0.007933
[EpochKL] epoch=0 mean_kl=0.00288 max_kl=0.00899
[EarlyStop] epoch=1 mean_kl=0.01002 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01002 max_kl=0.02603
[Time] Env Create Time: 4.3608s |Rollout Collect Time: 1.6869s |Loss & Update :0.6610
[PPODiag] kl_mean=0.0065, kl_p90=0.0118, kl_max=0.0260 | clipfrac_mean=0.012, logratio_std_mean=0.134, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.680, min=0.677 | pg_loss_mean=0.0015, v_loss_mean=0.0206, ent_mean=0.0172 | gn_bb_mean=1.150, gn_bb_max=3.262 | gn_v_mean=0.206, gn_v_max=0.312
[AttnScore] scale=1.0601, C=10.0

 10%|▉         | 486/5000 [59:20<8:38:58,  6.90s/it]------------------ Training Record ------------------
Epoch: 486/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=8, valid_ratio=0.519, reward_valid_mean=2.0904, reward_valid_std=4.1719
[BatchDiag] adv_mean=-0.0075, adv_std=0.3135, adv_abs_mean=0.2022 | ret_mean=8.9403, ret_std=0.6045 | val_mean=8.9478, val_std=0.5047 | explained_var=0.731012
[GradSplit pre-clip] backbone=1.189063, critic=0.231033
[Loss] pg_loss=-0.064393, entropy_loss=0.000015, value_loss=0.008747
[EpochKL] epoch=0 mean_kl=0.00462 max_kl=0.01445
[EarlyStop] epoch=1 mean_kl=0.01375 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01375 max_kl=0.03546
[Time] Env Create Time: 4.5887s |Rollout Collect Time: 2.1732s |Loss & Update :0.8161
[PPODiag] kl_mean=0.0092, kl_p90=0.0141, kl_max=0.0355 | clipfrac_mean=0.018, logratio_std_mean=0.172, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.519, p10=0.515, min=0.513 | pg_loss_mean=0.0031, v_loss_mean=0.0234, ent_mean=0.0146 | gn_bb_mean=1.200, gn_bb_max=2.579 | gn_v_mean=0.315, gn_v_max=0.426

 10%|▉         | 487/5000 [59:27<8:54:12,  7.10s/it]------------------ Training Record ------------------
Epoch: 487/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1219, reward_valid_std=4.1822
[BatchDiag] adv_mean=0.0158, adv_std=0.2779, adv_abs_mean=0.1889 | ret_mean=8.9631, ret_std=0.5772 | val_mean=8.9473, val_std=0.4961 | explained_var=0.768170
[GradSplit pre-clip] backbone=2.066748, critic=0.192835
[Loss] pg_loss=0.035462, entropy_loss=0.000019, value_loss=0.010731
[EpochKL] epoch=0 mean_kl=0.00379 max_kl=0.00974
[EarlyStop] epoch=1 mean_kl=0.02272 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02272 max_kl=0.03676
[Time] Env Create Time: 4.3953s |Rollout Collect Time: 1.6820s |Loss & Update :0.6555
[PPODiag] kl_mean=0.0133, kl_p90=0.0310, kl_max=0.0368 | clipfrac_mean=0.020, logratio_std_mean=0.205, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.685, p10=0.681, min=0.679 | pg_loss_mean=0.0034, v_loss_mean=0.0192, ent_mean=0.0187 | gn_bb_mean=1.167, gn_bb_max=2.387 | gn_v_mean=0.354, gn_v_max=0.710

 10%|▉         | 488/5000 [59:34<8:45:45,  6.99s/it]------------------ Training Record ------------------
Epoch: 488/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1155, reward_valid_std=4.1830
[BatchDiag] adv_mean=-0.0363, adv_std=0.2872, adv_abs_mean=0.1871 | ret_mean=8.9643, ret_std=0.5756 | val_mean=9.0006, val_std=0.5168 | explained_var=0.751029
[GradSplit pre-clip] backbone=1.446794, critic=0.207040
[Loss] pg_loss=-0.075458, entropy_loss=0.000019, value_loss=0.008754
[EpochKL] epoch=0 mean_kl=0.00504 max_kl=0.00932
[EarlyStop] epoch=1 mean_kl=0.02318 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02318 max_kl=0.06517
[Time] Env Create Time: 4.3930s |Rollout Collect Time: 1.6912s |Loss & Update :0.6692
[PPODiag] kl_mean=0.0141, kl_p90=0.0259, kl_max=0.0652 | clipfrac_mean=0.022, logratio_std_mean=0.214, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.677 | pg_loss_mean=0.0052, v_loss_mean=0.0198, ent_mean=0.0199 | gn_bb_mean=1.476, gn_bb_max=4.196 | gn_v_mean=0.341, gn_v_max=0.634

 10%|▉         | 489/5000 [59:41<8:40:17,  6.92s/it]------------------ Training Record ------------------
Epoch: 489/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1164, reward_valid_std=4.1804
[BatchDiag] adv_mean=-0.0035, adv_std=0.2924, adv_abs_mean=0.1902 | ret_mean=8.9644, ret_std=0.5868 | val_mean=8.9679, val_std=0.4928 | explained_var=0.751726
[GradSplit pre-clip] backbone=0.603566, critic=0.166851
[Loss] pg_loss=-0.043445, entropy_loss=0.000017, value_loss=0.008793
[EarlyStop] epoch=0 mean_kl=0.01458 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01458 max_kl=0.04781
[Time] Env Create Time: 4.3967s |Rollout Collect Time: 1.6880s |Loss & Update :0.3490
[PPODiag] kl_mean=0.0146, kl_p90=0.0252, kl_max=0.0478 | clipfrac_mean=0.017, logratio_std_mean=0.195, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.678 | pg_loss_mean=0.0100, v_loss_mean=0.0209, ent_mean=0.0175 | gn_bb_mean=0.929, gn_bb_max=1.427 | gn_v_mean=0.347, gn_v_max=0.619

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.993, Step: 8, Avg Done Step: 6.60, #CS visited: 0.15
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.9626s
-----------------------------
 10%|▉         | 490/5000 [59:49<9:14:05,  7.37s/it]------------------ Training Record ------------------
Epoch: 490/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1132, reward_valid_std=4.1855
[BatchDiag] adv_mean=0.0554, adv_std=0.2979, adv_abs_mean=0.2101 | ret_mean=8.9502, ret_std=0.6000 | val_mean=8.8948, val_std=0.5076 | explained_var=0.753565
[GradSplit pre-clip] backbone=1.488117, critic=0.670936
[Loss] pg_loss=-0.022688, entropy_loss=0.000018, value_loss=0.011010
[EpochKL] epoch=0 mean_kl=0.00382 max_kl=0.01763
[EarlyStop] epoch=1 mean_kl=0.01517 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01517 max_kl=0.03749
[Time] Env Create Time: 4.3928s |Rollout Collect Time: 1.8699s |Loss & Update :0.6581
[PPODiag] kl_mean=0.0095, kl_p90=0.0181, kl_max=0.0375 | clipfrac_mean=0.014, logratio_std_mean=0.173, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.679 | pg_loss_mean=0.0015, v_loss_mean=0.0220, ent_mean=0.0175 | gn_bb_mean=0.896, gn_bb_max=2.703 | gn_v_mean=0.464, gn_v_max=0.867
[AttnScore] scale=1.0601, C=10.0

 10%|▉         | 491/5000 [59:56<9:03:49,  7.24s/it]------------------ Training Record ------------------
Epoch: 491/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1146, reward_valid_std=4.1843
[BatchDiag] adv_mean=-0.0195, adv_std=0.2889, adv_abs_mean=0.1836 | ret_mean=8.9631, ret_std=0.5895 | val_mean=8.9826, val_std=0.5358 | explained_var=0.759876
[GradSplit pre-clip] backbone=0.486266, critic=0.237712
[Loss] pg_loss=-0.084685, entropy_loss=0.000011, value_loss=0.007077
[EpochKL] epoch=0 mean_kl=0.00144 max_kl=0.00324
[EpochKL] epoch=1 mean_kl=0.00451 max_kl=0.01044
[EarlyStop] epoch=2 mean_kl=0.01304 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01304 max_kl=0.03658
[Time] Env Create Time: 4.4096s |Rollout Collect Time: 1.6856s |Loss & Update :0.9710
[PPODiag] kl_mean=0.0063, kl_p90=0.0108, kl_max=0.0366 | clipfrac_mean=0.014, logratio_std_mean=0.120, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.680 | pg_loss_mean=0.0009, v_loss_mean=0.0200, ent_mean=0.0159 | gn_bb_mean=0.658, gn_bb_max=1.339 | gn_v_mean=0.434, gn_v_max=0.860

 10%|▉         | 492/5000 [1:00:03<8:59:52,  7.19s/it]------------------ Training Record ------------------
Epoch: 492/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1135, reward_valid_std=4.1840
[BatchDiag] adv_mean=-0.0100, adv_std=0.2873, adv_abs_mean=0.1836 | ret_mean=8.9577, ret_std=0.5895 | val_mean=8.9677, val_std=0.5320 | explained_var=0.762401
[GradSplit pre-clip] backbone=0.419601, critic=0.164046
[Loss] pg_loss=-0.062988, entropy_loss=0.000016, value_loss=0.007812
[EpochKL] epoch=0 mean_kl=0.00435 max_kl=0.01005
[EpochKL] epoch=1 mean_kl=0.00961 max_kl=0.01764
[EarlyStop] epoch=2 mean_kl=0.02171 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02171 max_kl=0.03928
[Time] Env Create Time: 4.4153s |Rollout Collect Time: 1.6891s |Loss & Update :0.9692
[PPODiag] kl_mean=0.0119, kl_p90=0.0247, kl_max=0.0393 | clipfrac_mean=0.021, logratio_std_mean=0.185, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.686, p10=0.679, min=0.677 | pg_loss_mean=0.0041, v_loss_mean=0.0202, ent_mean=0.0177 | gn_bb_mean=1.230, gn_bb_max=7.136 | gn_v_mean=0.326, gn_v_max=0.757

 10%|▉         | 493/5000 [1:00:10<8:57:14,  7.15s/it]------------------ Training Record ------------------
Epoch: 493/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.588, reward_valid_mean=2.1137, reward_valid_std=4.1835
[BatchDiag] adv_mean=-0.0087, adv_std=0.2901, adv_abs_mean=0.1883 | ret_mean=8.9505, ret_std=0.5852 | val_mean=8.9592, val_std=0.5077 | explained_var=0.754309
[GradSplit pre-clip] backbone=0.276311, critic=0.315295
[Loss] pg_loss=-0.140934, entropy_loss=0.000011, value_loss=0.004894
[EpochKL] epoch=0 mean_kl=0.00212 max_kl=0.00650
[EarlyStop] epoch=1 mean_kl=0.01348 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01348 max_kl=0.02702
[Time] Env Create Time: 4.4032s |Rollout Collect Time: 1.9247s |Loss & Update :0.7319
[PPODiag] kl_mean=0.0078, kl_p90=0.0211, kl_max=0.0270 | clipfrac_mean=0.013, logratio_std_mean=0.158, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.588, p10=0.586, min=0.580 | pg_loss_mean=0.0017, v_loss_mean=0.0209, ent_mean=0.0140 | gn_bb_mean=0.899, gn_bb_max=1.847 | gn_v_mean=0.306, gn_v_max=0.528

 10%|▉         | 494/5000 [1:00:17<8:55:03,  7.12s/it]------------------ Training Record ------------------
Epoch: 494/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1231, reward_valid_std=4.1880
[BatchDiag] adv_mean=0.0189, adv_std=0.2803, adv_abs_mean=0.1916 | ret_mean=8.9663, ret_std=0.5787 | val_mean=8.9473, val_std=0.5188 | explained_var=0.765291
[GradSplit pre-clip] backbone=1.208357, critic=0.331195
[Loss] pg_loss=-0.013262, entropy_loss=0.000014, value_loss=0.009343
[EarlyStop] epoch=0 mean_kl=0.01011 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01011 max_kl=0.03519
[Time] Env Create Time: 4.4027s |Rollout Collect Time: 1.6907s |Loss & Update :0.3542
[PPODiag] kl_mean=0.0101, kl_p90=0.0222, kl_max=0.0352 | clipfrac_mean=0.019, logratio_std_mean=0.169, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.679, min=0.677 | pg_loss_mean=0.0044, v_loss_mean=0.0196, ent_mean=0.0190 | gn_bb_mean=1.595, gn_bb_max=2.973 | gn_v_mean=0.354, gn_v_max=0.616

 10%|▉         | 495/5000 [1:00:24<8:39:41,  6.92s/it]------------------ Training Record ------------------
Epoch: 495/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0986, reward_valid_std=4.1785
[BatchDiag] adv_mean=-0.0307, adv_std=0.3013, adv_abs_mean=0.1992 | ret_mean=8.9449, ret_std=0.5931 | val_mean=8.9756, val_std=0.4878 | explained_var=0.741841
[GradSplit pre-clip] backbone=0.343514, critic=0.274521
[Loss] pg_loss=0.011654, entropy_loss=0.000016, value_loss=0.010671
[EpochKL] epoch=0 mean_kl=0.00642 max_kl=0.01485
[EarlyStop] epoch=1 mean_kl=0.02299 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02299 max_kl=0.03368
[Time] Env Create Time: 4.3845s |Rollout Collect Time: 1.6955s |Loss & Update :0.6571
[PPODiag] kl_mean=0.0147, kl_p90=0.0302, kl_max=0.0337 | clipfrac_mean=0.020, logratio_std_mean=0.219, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.686, min=0.685 | pg_loss_mean=0.0026, v_loss_mean=0.0227, ent_mean=0.0178 | gn_bb_mean=0.963, gn_bb_max=3.267 | gn_v_mean=0.304, gn_v_max=0.745
[AttnScore] scale=1.0607, C=10.0

 10%|▉         | 496/5000 [1:00:31<8:35:26,  6.87s/it]------------------ Training Record ------------------
Epoch: 496/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1022, reward_valid_std=4.1780
[BatchDiag] adv_mean=-0.0150, adv_std=0.3141, adv_abs_mean=0.2045 | ret_mean=8.9474, ret_std=0.5903 | val_mean=8.9623, val_std=0.5125 | explained_var=0.716932
[GradSplit pre-clip] backbone=0.785786, critic=0.143093
[Loss] pg_loss=-0.051640, entropy_loss=0.000016, value_loss=0.009978
[EpochKL] epoch=0 mean_kl=0.00693 max_kl=0.02287
[EpochKL] epoch=1 mean_kl=0.00748 max_kl=0.01093
[EpochKL] epoch=2 mean_kl=0.00805 max_kl=0.01125
[Time] Env Create Time: 4.5985s |Rollout Collect Time: 1.9369s |Loss & Update :1.0838
[PPODiag] kl_mean=0.0075, kl_p90=0.0112, kl_max=0.0229 | clipfrac_mean=0.018, logratio_std_mean=0.141, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.591, p10=0.587, min=0.584 | pg_loss_mean=0.0015, v_loss_mean=0.0231, ent_mean=0.0153 | gn_bb_mean=0.806, gn_bb_max=2.716 | gn_v_mean=0.201, gn_v_max=0.393

 10%|▉         | 497/5000 [1:00:38<8:52:17,  7.09s/it]------------------ Training Record ------------------
Epoch: 497/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1084, reward_valid_std=4.1800
[BatchDiag] adv_mean=-0.0144, adv_std=0.2941, adv_abs_mean=0.1899 | ret_mean=8.9562, ret_std=0.5873 | val_mean=8.9706, val_std=0.4964 | explained_var=0.749197
[GradSplit pre-clip] backbone=0.735570, critic=0.110430
[Loss] pg_loss=-0.052308, entropy_loss=0.000016, value_loss=0.008978
[EpochKL] epoch=0 mean_kl=0.00081 max_kl=0.00251
[EpochKL] epoch=1 mean_kl=0.00290 max_kl=0.00425
[EpochKL] epoch=2 mean_kl=0.00584 max_kl=0.01207
[Time] Env Create Time: 4.4508s |Rollout Collect Time: 1.6893s |Loss & Update :0.9725
[PPODiag] kl_mean=0.0032, kl_p90=0.0072, kl_max=0.0121 | clipfrac_mean=0.009, logratio_std_mean=0.086, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.677 | pg_loss_mean=0.0003, v_loss_mean=0.0205, ent_mean=0.0159 | gn_bb_mean=0.592, gn_bb_max=1.268 | gn_v_mean=0.237, gn_v_max=0.495

 10%|▉         | 498/5000 [1:00:45<8:52:37,  7.10s/it]------------------ Training Record ------------------
Epoch: 498/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1061, reward_valid_std=4.1756
[BatchDiag] adv_mean=-0.0215, adv_std=0.2961, adv_abs_mean=0.1879 | ret_mean=8.9473, ret_std=0.5913 | val_mean=8.9688, val_std=0.5185 | explained_var=0.749326
[GradSplit pre-clip] backbone=0.571444, critic=0.201895
[Loss] pg_loss=-0.052769, entropy_loss=0.000022, value_loss=0.008044
[EpochKL] epoch=0 mean_kl=0.00247 max_kl=0.00940
[EpochKL] epoch=1 mean_kl=0.00643 max_kl=0.00903
[EarlyStop] epoch=2 mean_kl=0.01497 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01497 max_kl=0.02495
[Time] Env Create Time: 4.4102s |Rollout Collect Time: 1.6854s |Loss & Update :0.9684
[PPODiag] kl_mean=0.0080, kl_p90=0.0158, kl_max=0.0250 | clipfrac_mean=0.016, logratio_std_mean=0.158, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.678 | pg_loss_mean=0.0020, v_loss_mean=0.0212, ent_mean=0.0168 | gn_bb_mean=0.892, gn_bb_max=2.021 | gn_v_mean=0.282, gn_v_max=0.536

 10%|▉         | 499/5000 [1:00:52<8:51:44,  7.09s/it]------------------ Training Record ------------------
Epoch: 499/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1083, reward_valid_std=4.1793
[BatchDiag] adv_mean=-0.0071, adv_std=0.2834, adv_abs_mean=0.1895 | ret_mean=8.9627, ret_std=0.5783 | val_mean=8.9698, val_std=0.5054 | explained_var=0.759846
[GradSplit pre-clip] backbone=0.323578, critic=0.231896
[Loss] pg_loss=-0.069606, entropy_loss=0.000014, value_loss=0.008658
[EpochKL] epoch=0 mean_kl=0.00335 max_kl=0.00762
[EpochKL] epoch=1 mean_kl=0.00743 max_kl=0.01546
[EpochKL] epoch=2 mean_kl=0.00755 max_kl=0.01381
[Time] Env Create Time: 4.4264s |Rollout Collect Time: 1.7156s |Loss & Update :0.9590
[PPODiag] kl_mean=0.0061, kl_p90=0.0101, kl_max=0.0155 | clipfrac_mean=0.014, logratio_std_mean=0.122, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.677 | pg_loss_mean=0.0016, v_loss_mean=0.0190, ent_mean=0.0152 | gn_bb_mean=0.679, gn_bb_max=1.742 | gn_v_mean=0.219, gn_v_max=0.606

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.976, Step: 7, Avg Done Step: 6.61, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8362s
-----------------------------
 10%|█         | 500/5000 [1:01:01<9:33:52,  7.65s/it]------------------ Training Record ------------------
Epoch: 500/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1018, reward_valid_std=4.1762
[BatchDiag] adv_mean=-0.0068, adv_std=0.3070, adv_abs_mean=0.1973 | ret_mean=8.9407, ret_std=0.6037 | val_mean=8.9475, val_std=0.4991 | explained_var=0.741327
[GradSplit pre-clip] backbone=0.503773, critic=0.255473
[Loss] pg_loss=-0.092595, entropy_loss=0.000012, value_loss=0.007692
[EpochKL] epoch=0 mean_kl=0.00279 max_kl=0.00908
[EpochKL] epoch=1 mean_kl=0.00432 max_kl=0.01028
[EpochKL] epoch=2 mean_kl=0.00762 max_kl=0.01141
[Time] Env Create Time: 4.3999s |Rollout Collect Time: 1.6878s |Loss & Update :0.9795
[PPODiag] kl_mean=0.0049, kl_p90=0.0099, kl_max=0.0114 | clipfrac_mean=0.014, logratio_std_mean=0.105, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.680 | pg_loss_mean=0.0015, v_loss_mean=0.0225, ent_mean=0.0168 | gn_bb_mean=0.947, gn_bb_max=2.167 | gn_v_mean=0.258, gn_v_max=0.593
[AttnScore] scale=1.0618, C=10.0

 10%|█         | 501/5000 [1:01:08<9:20:36,  7.48s/it]------------------ Training Record ------------------
Epoch: 501/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1051, reward_valid_std=4.1742
[BatchDiag] adv_mean=0.0132, adv_std=0.3068, adv_abs_mean=0.2011 | ret_mean=8.9462, ret_std=0.6025 | val_mean=8.9330, val_std=0.5089 | explained_var=0.740737
[GradSplit pre-clip] backbone=0.435058, critic=0.384960
[Loss] pg_loss=-0.073988, entropy_loss=0.000015, value_loss=0.008608
[EpochKL] epoch=0 mean_kl=0.00408 max_kl=0.00896
[EpochKL] epoch=1 mean_kl=0.00885 max_kl=0.02799
[EarlyStop] epoch=2 mean_kl=0.02069 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02069 max_kl=0.03714
[Time] Env Create Time: 4.3886s |Rollout Collect Time: 1.6991s |Loss & Update :0.9741
[PPODiag] kl_mean=0.0112, kl_p90=0.0265, kl_max=0.0371 | clipfrac_mean=0.017, logratio_std_mean=0.195, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.681 | pg_loss_mean=0.0035, v_loss_mean=0.0225, ent_mean=0.0170 | gn_bb_mean=0.767, gn_bb_max=1.695 | gn_v_mean=0.227, gn_v_max=0.457

 10%|█         | 502/5000 [1:01:15<9:11:10,  7.35s/it]------------------ Training Record ------------------
Epoch: 502/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1137, reward_valid_std=4.1809
[BatchDiag] adv_mean=-0.0008, adv_std=0.2829, adv_abs_mean=0.1889 | ret_mean=8.9680, ret_std=0.5636 | val_mean=8.9687, val_std=0.5267 | explained_var=0.748118
[GradSplit pre-clip] backbone=0.661589, critic=0.189708
[Loss] pg_loss=-0.013919, entropy_loss=0.000016, value_loss=0.007141
[EpochKL] epoch=0 mean_kl=0.00697 max_kl=0.01432
[EarlyStop] epoch=1 mean_kl=0.01253 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01253 max_kl=0.03244
[Time] Env Create Time: 4.6284s |Rollout Collect Time: 1.6987s |Loss & Update :0.6631
[PPODiag] kl_mean=0.0098, kl_p90=0.0203, kl_max=0.0324 | clipfrac_mean=0.018, logratio_std_mean=0.162, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.687, p10=0.678, min=0.676 | pg_loss_mean=0.0043, v_loss_mean=0.0195, ent_mean=0.0172 | gn_bb_mean=1.297, gn_bb_max=2.838 | gn_v_mean=0.324, gn_v_max=0.632

 10%|█         | 503/5000 [1:01:22<9:02:54,  7.24s/it]------------------ Training Record ------------------
Epoch: 503/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1123, reward_valid_std=4.1797
[BatchDiag] adv_mean=0.0009, adv_std=0.2740, adv_abs_mean=0.1829 | ret_mean=8.9656, ret_std=0.5790 | val_mean=8.9648, val_std=0.5107 | explained_var=0.775946
[GradSplit pre-clip] backbone=0.370134, critic=0.286922
[Loss] pg_loss=-0.094673, entropy_loss=0.000014, value_loss=0.006553
[EarlyStop] epoch=0 mean_kl=0.01227 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01227 max_kl=0.02626
[Time] Env Create Time: 4.4485s |Rollout Collect Time: 1.7054s |Loss & Update :0.3606
[PPODiag] kl_mean=0.0123, kl_p90=0.0221, kl_max=0.0263 | clipfrac_mean=0.016, logratio_std_mean=0.193, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.681, min=0.678 | pg_loss_mean=0.0037, v_loss_mean=0.0191, ent_mean=0.0168 | gn_bb_mean=1.517, gn_bb_max=4.381 | gn_v_mean=0.348, gn_v_max=0.509

 10%|█         | 504/5000 [1:01:29<8:46:24,  7.03s/it]------------------ Training Record ------------------
Epoch: 504/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.588, reward_valid_mean=2.1098, reward_valid_std=4.1851
[BatchDiag] adv_mean=0.0241, adv_std=0.2825, adv_abs_mean=0.1946 | ret_mean=8.9489, ret_std=0.5888 | val_mean=8.9248, val_std=0.4981 | explained_var=0.769736
[GradSplit pre-clip] backbone=0.337831, critic=0.447750
[Loss] pg_loss=-0.059041, entropy_loss=0.000011, value_loss=0.008624
[EarlyStop] epoch=0 mean_kl=0.01743 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01743 max_kl=0.07234
[Time] Env Create Time: 4.4536s |Rollout Collect Time: 1.9358s |Loss & Update :0.4045
[PPODiag] kl_mean=0.0174, kl_p90=0.0358, kl_max=0.0723 | clipfrac_mean=0.021, logratio_std_mean=0.238, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.588, p10=0.583, min=0.582 | pg_loss_mean=0.0047, v_loss_mean=0.0199, ent_mean=0.0147 | gn_bb_mean=1.853, gn_bb_max=5.886 | gn_v_mean=0.471, gn_v_max=0.677

 10%|█         | 505/5000 [1:01:36<8:41:06,  6.96s/it]------------------ Training Record ------------------
Epoch: 505/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1172, reward_valid_std=4.1824
[BatchDiag] adv_mean=0.0310, adv_std=0.2862, adv_abs_mean=0.2026 | ret_mean=8.9576, ret_std=0.5831 | val_mean=8.9266, val_std=0.4709 | explained_var=0.759117
[GradSplit pre-clip] backbone=1.939254, critic=0.607887
[Loss] pg_loss=-0.095832, entropy_loss=0.000014, value_loss=0.006545
[EarlyStop] epoch=0 mean_kl=0.01073 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01073 max_kl=0.01687
[Time] Env Create Time: 4.4450s |Rollout Collect Time: 1.7098s |Loss & Update :0.3524
[PPODiag] kl_mean=0.0107, kl_p90=0.0166, kl_max=0.0169 | clipfrac_mean=0.020, logratio_std_mean=0.163, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.679 | pg_loss_mean=0.0064, v_loss_mean=0.0202, ent_mean=0.0172 | gn_bb_mean=1.715, gn_bb_max=4.721 | gn_v_mean=0.488, gn_v_max=0.726
[AttnScore] scale=1.0620, C=10.0

 10%|█         | 506/5000 [1:01:42<8:30:55,  6.82s/it]------------------ Training Record ------------------
Epoch: 506/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1051, reward_valid_std=4.1718
[BatchDiag] adv_mean=-0.0552, adv_std=0.3117, adv_abs_mean=0.1990 | ret_mean=8.9522, ret_std=0.5856 | val_mean=9.0074, val_std=0.5133 | explained_var=0.716783
[GradSplit pre-clip] backbone=2.207523, critic=0.321425
[Loss] pg_loss=-0.086725, entropy_loss=0.000015, value_loss=0.008284
[EarlyStop] epoch=0 mean_kl=0.02144 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02144 max_kl=0.05080
[Time] Env Create Time: 4.4199s |Rollout Collect Time: 1.9368s |Loss & Update :0.4075
[PPODiag] kl_mean=0.0214, kl_p90=0.0507, kl_max=0.0508 | clipfrac_mean=0.018, logratio_std_mean=0.352, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.591, p10=0.587, min=0.586 | pg_loss_mean=0.0045, v_loss_mean=0.0235, ent_mean=0.0152 | gn_bb_mean=1.137, gn_bb_max=2.208 | gn_v_mean=0.387, gn_v_max=0.636

 10%|█         | 507/5000 [1:01:49<8:29:32,  6.80s/it]------------------ Training Record ------------------
Epoch: 507/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1034, reward_valid_std=4.1749
[BatchDiag] adv_mean=-0.0289, adv_std=0.3097, adv_abs_mean=0.2000 | ret_mean=8.9519, ret_std=0.5936 | val_mean=8.9808, val_std=0.5343 | explained_var=0.727826
[GradSplit pre-clip] backbone=1.538353, critic=0.185710
[Loss] pg_loss=-0.084785, entropy_loss=0.000014, value_loss=0.008054
[EpochKL] epoch=0 mean_kl=0.00462 max_kl=0.00954
[EarlyStop] epoch=1 mean_kl=0.01695 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01695 max_kl=0.03144
[Time] Env Create Time: 4.4197s |Rollout Collect Time: 1.9451s |Loss & Update :0.7302
[PPODiag] kl_mean=0.0108, kl_p90=0.0303, kl_max=0.0314 | clipfrac_mean=0.017, logratio_std_mean=0.183, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.586, min=0.585 | pg_loss_mean=0.0025, v_loss_mean=0.0231, ent_mean=0.0135 | gn_bb_mean=0.806, gn_bb_max=1.538 | gn_v_mean=0.415, gn_v_max=0.835

 10%|█         | 508/5000 [1:01:56<8:35:57,  6.89s/it]------------------ Training Record ------------------
Epoch: 508/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1083, reward_valid_std=4.1728
[BatchDiag] adv_mean=-0.0391, adv_std=0.3105, adv_abs_mean=0.1932 | ret_mean=8.9586, ret_std=0.5950 | val_mean=8.9976, val_std=0.4927 | explained_var=0.727765
[GradSplit pre-clip] backbone=1.572208, critic=0.469933
[Loss] pg_loss=0.063289, entropy_loss=0.000013, value_loss=0.012135
[EpochKL] epoch=0 mean_kl=0.00555 max_kl=0.00949
[EarlyStop] epoch=1 mean_kl=0.02022 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02022 max_kl=0.05698
[Time] Env Create Time: 4.6249s |Rollout Collect Time: 1.9347s |Loss & Update :0.7434
[PPODiag] kl_mean=0.0129, kl_p90=0.0244, kl_max=0.0570 | clipfrac_mean=0.016, logratio_std_mean=0.236, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.590, p10=0.585, min=0.582 | pg_loss_mean=0.0021, v_loss_mean=0.0231, ent_mean=0.0147 | gn_bb_mean=0.959, gn_bb_max=2.691 | gn_v_mean=0.392, gn_v_max=0.830

 10%|█         | 509/5000 [1:02:03<8:45:05,  7.02s/it]------------------ Training Record ------------------
Epoch: 509/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0978, reward_valid_std=4.1764
[BatchDiag] adv_mean=0.0005, adv_std=0.2995, adv_abs_mean=0.1956 | ret_mean=8.9533, ret_std=0.5949 | val_mean=8.9528, val_std=0.5181 | explained_var=0.746494
[GradSplit pre-clip] backbone=1.862708, critic=0.185553
[Loss] pg_loss=-0.039404, entropy_loss=0.000018, value_loss=0.009889
[EpochKL] epoch=0 mean_kl=0.00661 max_kl=0.01335
[EarlyStop] epoch=1 mean_kl=0.01302 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01302 max_kl=0.01851
[Time] Env Create Time: 4.4331s |Rollout Collect Time: 1.7029s |Loss & Update :0.6687
[PPODiag] kl_mean=0.0098, kl_p90=0.0170, kl_max=0.0185 | clipfrac_mean=0.019, logratio_std_mean=0.185, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.691, p10=0.685, min=0.685 | pg_loss_mean=0.0013, v_loss_mean=0.0220, ent_mean=0.0188 | gn_bb_mean=0.850, gn_bb_max=1.863 | gn_v_mean=0.240, gn_v_max=0.455

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.973, Step: 7, Avg Done Step: 6.61, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8553s
-----------------------------
 10%|█         | 510/5000 [1:02:12<9:22:31,  7.52s/it]------------------ Training Record ------------------
Epoch: 510/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1045, reward_valid_std=4.1800
[BatchDiag] adv_mean=0.0130, adv_std=0.2960, adv_abs_mean=0.1964 | ret_mean=8.9511, ret_std=0.5899 | val_mean=8.9381, val_std=0.5311 | explained_var=0.748214
[GradSplit pre-clip] backbone=0.538859, critic=0.379241
[Loss] pg_loss=-0.086802, entropy_loss=0.000011, value_loss=0.007406
[EpochKL] epoch=0 mean_kl=0.00428 max_kl=0.01461
[EarlyStop] epoch=1 mean_kl=0.01586 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01586 max_kl=0.03725
[Time] Env Create Time: 4.4061s |Rollout Collect Time: 1.9421s |Loss & Update :0.7377
[PPODiag] kl_mean=0.0101, kl_p90=0.0179, kl_max=0.0372 | clipfrac_mean=0.017, logratio_std_mean=0.174, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.590, p10=0.585, min=0.582 | pg_loss_mean=0.0026, v_loss_mean=0.0215, ent_mean=0.0151 | gn_bb_mean=1.003, gn_bb_max=2.574 | gn_v_mean=0.278, gn_v_max=0.393
[AttnScore] scale=1.0623, C=10.0

 10%|█         | 511/5000 [1:02:19<9:12:44,  7.39s/it]------------------ Training Record ------------------
Epoch: 511/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1166, reward_valid_std=4.1803
[BatchDiag] adv_mean=0.0383, adv_std=0.2970, adv_abs_mean=0.2031 | ret_mean=8.9590, ret_std=0.5832 | val_mean=8.9207, val_std=0.5235 | explained_var=0.740612
[GradSplit pre-clip] backbone=0.364351, critic=0.739319
[Loss] pg_loss=-0.123785, entropy_loss=0.000017, value_loss=0.007466
[EpochKL] epoch=0 mean_kl=0.00331 max_kl=0.00854
[EarlyStop] epoch=1 mean_kl=0.02411 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02411 max_kl=0.05318
[Time] Env Create Time: 4.4167s |Rollout Collect Time: 1.7003s |Loss & Update :0.6561
[PPODiag] kl_mean=0.0137, kl_p90=0.0308, kl_max=0.0532 | clipfrac_mean=0.021, logratio_std_mean=0.192, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.686, p10=0.679, min=0.678 | pg_loss_mean=0.0035, v_loss_mean=0.0219, ent_mean=0.0189 | gn_bb_mean=1.273, gn_bb_max=3.677 | gn_v_mean=0.423, gn_v_max=0.782

 10%|█         | 512/5000 [1:02:26<8:58:49,  7.20s/it]------------------ Training Record ------------------
Epoch: 512/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0940, reward_valid_std=4.1733
[BatchDiag] adv_mean=-0.0310, adv_std=0.3275, adv_abs_mean=0.2124 | ret_mean=8.9445, ret_std=0.6026 | val_mean=8.9756, val_std=0.5280 | explained_var=0.704726
[GradSplit pre-clip] backbone=0.773433, critic=0.239248
[Loss] pg_loss=-0.052814, entropy_loss=0.000014, value_loss=0.010214
[EpochKL] epoch=0 mean_kl=0.00605 max_kl=0.01946
[EarlyStop] epoch=1 mean_kl=0.01706 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01706 max_kl=0.02628
[Time] Env Create Time: 4.4029s |Rollout Collect Time: 1.7071s |Loss & Update :0.6699
[PPODiag] kl_mean=0.0116, kl_p90=0.0228, kl_max=0.0263 | clipfrac_mean=0.019, logratio_std_mean=0.182, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.692, p10=0.685, min=0.682 | pg_loss_mean=0.0074, v_loss_mean=0.0250, ent_mean=0.0187 | gn_bb_mean=5.957, gn_bb_max=82.399 | gn_v_mean=0.318, gn_v_max=0.624

 10%|█         | 513/5000 [1:02:33<8:49:12,  7.08s/it]------------------ Training Record ------------------
Epoch: 513/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1044, reward_valid_std=4.1768
[BatchDiag] adv_mean=0.0079, adv_std=0.3011, adv_abs_mean=0.2004 | ret_mean=8.9477, ret_std=0.5922 | val_mean=8.9398, val_std=0.4909 | explained_var=0.741552
[GradSplit pre-clip] backbone=0.665946, critic=0.170849
[Loss] pg_loss=0.040388, entropy_loss=0.000011, value_loss=0.011903
[EpochKL] epoch=0 mean_kl=0.00448 max_kl=0.01101
[EarlyStop] epoch=1 mean_kl=0.01875 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01875 max_kl=0.03911
[Time] Env Create Time: 4.6302s |Rollout Collect Time: 1.9429s |Loss & Update :0.7432
[PPODiag] kl_mean=0.0116, kl_p90=0.0261, kl_max=0.0391 | clipfrac_mean=0.017, logratio_std_mean=0.182, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.591, p10=0.584, min=0.582 | pg_loss_mean=0.0038, v_loss_mean=0.0217, ent_mean=0.0143 | gn_bb_mean=1.193, gn_bb_max=2.712 | gn_v_mean=0.336, gn_v_max=0.578

 10%|█         | 514/5000 [1:02:40<8:54:29,  7.15s/it]------------------ Training Record ------------------
Epoch: 514/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.595, reward_valid_mean=2.0876, reward_valid_std=4.1653
[BatchDiag] adv_mean=-0.0521, adv_std=0.3248, adv_abs_mean=0.2064 | ret_mean=8.9458, ret_std=0.6037 | val_mean=8.9979, val_std=0.5238 | explained_var=0.710536
[GradSplit pre-clip] backbone=0.388212, critic=0.257884
[Loss] pg_loss=-0.065072, entropy_loss=0.000015, value_loss=0.011041
[EpochKL] epoch=0 mean_kl=0.00322 max_kl=0.00677
[EarlyStop] epoch=1 mean_kl=0.01139 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01139 max_kl=0.03059
[Time] Env Create Time: 4.4535s |Rollout Collect Time: 1.9313s |Loss & Update :0.7331
[PPODiag] kl_mean=0.0073, kl_p90=0.0141, kl_max=0.0306 | clipfrac_mean=0.017, logratio_std_mean=0.130, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.595, p10=0.591, min=0.589 | pg_loss_mean=0.0021, v_loss_mean=0.0250, ent_mean=0.0173 | gn_bb_mean=1.309, gn_bb_max=6.734 | gn_v_mean=0.291, gn_v_max=0.548

 10%|█         | 515/5000 [1:02:47<8:53:41,  7.14s/it]------------------ Training Record ------------------
Epoch: 515/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1116, reward_valid_std=4.1826
[BatchDiag] adv_mean=0.0168, adv_std=0.2727, adv_abs_mean=0.1877 | ret_mean=8.9690, ret_std=0.5693 | val_mean=8.9522, val_std=0.5082 | explained_var=0.770522
[GradSplit pre-clip] backbone=0.594329, critic=0.319851
[Loss] pg_loss=-0.046585, entropy_loss=0.000012, value_loss=0.007603
[EpochKL] epoch=0 mean_kl=0.00363 max_kl=0.01033
[EarlyStop] epoch=1 mean_kl=0.01693 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01693 max_kl=0.03424
[Time] Env Create Time: 4.4584s |Rollout Collect Time: 1.6972s |Loss & Update :0.6644
[PPODiag] kl_mean=0.0103, kl_p90=0.0225, kl_max=0.0342 | clipfrac_mean=0.018, logratio_std_mean=0.168, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.679, min=0.679 | pg_loss_mean=0.0023, v_loss_mean=0.0181, ent_mean=0.0161 | gn_bb_mean=0.880, gn_bb_max=2.201 | gn_v_mean=0.262, gn_v_max=0.582
[AttnScore] scale=1.0628, C=10.0

 10%|█         | 516/5000 [1:02:54<8:46:24,  7.04s/it]------------------ Training Record ------------------
Epoch: 516/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0983, reward_valid_std=4.1745
[BatchDiag] adv_mean=-0.0179, adv_std=0.3027, adv_abs_mean=0.1995 | ret_mean=8.9560, ret_std=0.5918 | val_mean=8.9740, val_std=0.4855 | explained_var=0.738297
[GradSplit pre-clip] backbone=1.607573, critic=0.146090
[Loss] pg_loss=-0.067635, entropy_loss=0.000016, value_loss=0.008295
[EpochKL] epoch=0 mean_kl=0.00413 max_kl=0.01046
[EarlyStop] epoch=1 mean_kl=0.02887 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02887 max_kl=0.07549
[Time] Env Create Time: 4.4348s |Rollout Collect Time: 1.7015s |Loss & Update :0.6543
[PPODiag] kl_mean=0.0165, kl_p90=0.0432, kl_max=0.0755 | clipfrac_mean=0.018, logratio_std_mean=0.201, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.685, min=0.682 | pg_loss_mean=0.0050, v_loss_mean=0.0224, ent_mean=0.0165 | gn_bb_mean=1.929, gn_bb_max=16.848 | gn_v_mean=0.287, gn_v_max=0.571

 10%|█         | 517/5000 [1:03:01<8:40:37,  6.97s/it]------------------ Training Record ------------------
Epoch: 517/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.0991, reward_valid_std=4.1775
[BatchDiag] adv_mean=-0.0148, adv_std=0.3042, adv_abs_mean=0.2003 | ret_mean=8.9407, ret_std=0.5950 | val_mean=8.9555, val_std=0.5124 | explained_var=0.738710
[GradSplit pre-clip] backbone=0.613362, critic=0.121721
[Loss] pg_loss=-0.033711, entropy_loss=0.000017, value_loss=0.008815
[EpochKL] epoch=0 mean_kl=0.00878 max_kl=0.01562
[EarlyStop] epoch=1 mean_kl=0.03056 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.03056 max_kl=0.05397
[Time] Env Create Time: 4.4193s |Rollout Collect Time: 1.6983s |Loss & Update :0.6627
[PPODiag] kl_mean=0.0197, kl_p90=0.0413, kl_max=0.0540 | clipfrac_mean=0.020, logratio_std_mean=0.281, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.684 | pg_loss_mean=0.0032, v_loss_mean=0.0224, ent_mean=0.0158 | gn_bb_mean=0.956, gn_bb_max=2.913 | gn_v_mean=0.218, gn_v_max=0.356

 10%|█         | 518/5000 [1:03:08<8:36:18,  6.91s/it]------------------ Training Record ------------------
Epoch: 518/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1090, reward_valid_std=4.1805
[BatchDiag] adv_mean=-0.0060, adv_std=0.2904, adv_abs_mean=0.1931 | ret_mean=8.9586, ret_std=0.5789 | val_mean=8.9646, val_std=0.5079 | explained_var=0.748346
[GradSplit pre-clip] backbone=0.602640, critic=0.128036
[Loss] pg_loss=-0.005078, entropy_loss=0.000017, value_loss=0.008916
[EpochKL] epoch=0 mean_kl=0.00220 max_kl=0.00938
[EarlyStop] epoch=1 mean_kl=0.01238 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01238 max_kl=0.04170
[Time] Env Create Time: 4.4150s |Rollout Collect Time: 1.7135s |Loss & Update :0.6690
[PPODiag] kl_mean=0.0073, kl_p90=0.0147, kl_max=0.0417 | clipfrac_mean=0.013, logratio_std_mean=0.119, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.679 | pg_loss_mean=0.0039, v_loss_mean=0.0203, ent_mean=0.0161 | gn_bb_mean=1.326, gn_bb_max=3.998 | gn_v_mean=0.208, gn_v_max=0.332

 10%|█         | 519/5000 [1:03:14<8:33:38,  6.88s/it]------------------ Training Record ------------------
Epoch: 519/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1114, reward_valid_std=4.1844
[BatchDiag] adv_mean=0.0017, adv_std=0.2901, adv_abs_mean=0.1947 | ret_mean=8.9581, ret_std=0.5812 | val_mean=8.9565, val_std=0.4925 | explained_var=0.750772
[GradSplit pre-clip] backbone=0.497379, critic=0.129310
[Loss] pg_loss=0.014200, entropy_loss=0.000016, value_loss=0.010015
[EarlyStop] epoch=0 mean_kl=0.02070 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02070 max_kl=0.05272
[Time] Env Create Time: 4.3974s |Rollout Collect Time: 1.7028s |Loss & Update :0.3525
[PPODiag] kl_mean=0.0207, kl_p90=0.0482, kl_max=0.0527 | clipfrac_mean=0.021, logratio_std_mean=0.274, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.680 | pg_loss_mean=0.0050, v_loss_mean=0.0203, ent_mean=0.0173 | gn_bb_mean=1.599, gn_bb_max=3.666 | gn_v_mean=0.241, gn_v_max=0.401

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.987, Step: 7, Avg Done Step: 6.61, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8558s
-----------------------------
 10%|█         | 520/5000 [1:03:23<9:06:13,  7.32s/it]------------------ Training Record ------------------
Epoch: 520/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.593, reward_valid_mean=2.0959, reward_valid_std=4.1744
[BatchDiag] adv_mean=0.0146, adv_std=0.3150, adv_abs_mean=0.2088 | ret_mean=8.9485, ret_std=0.5964 | val_mean=8.9339, val_std=0.4816 | explained_var=0.720995
[GradSplit pre-clip] backbone=0.464076, critic=0.265878
[Loss] pg_loss=0.016386, entropy_loss=0.000016, value_loss=0.011553
[EpochKL] epoch=0 mean_kl=0.00208 max_kl=0.00352
[EpochKL] epoch=1 mean_kl=0.00771 max_kl=0.01250
[EpochKL] epoch=2 mean_kl=0.00808 max_kl=0.01130
[Time] Env Create Time: 4.6444s |Rollout Collect Time: 1.9436s |Loss & Update :1.0726
[PPODiag] kl_mean=0.0060, kl_p90=0.0111, kl_max=0.0125 | clipfrac_mean=0.014, logratio_std_mean=0.130, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.593, p10=0.588, min=0.587 | pg_loss_mean=0.0011, v_loss_mean=0.0232, ent_mean=0.0142 | gn_bb_mean=0.736, gn_bb_max=2.431 | gn_v_mean=0.260, gn_v_max=0.679
[AttnScore] scale=1.0633, C=10.0

 10%|█         | 521/5000 [1:03:30<9:13:50,  7.42s/it]------------------ Training Record ------------------
Epoch: 521/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0973, reward_valid_std=4.1729
[BatchDiag] adv_mean=-0.0302, adv_std=0.2986, adv_abs_mean=0.1951 | ret_mean=8.9430, ret_std=0.5924 | val_mean=8.9731, val_std=0.4975 | explained_var=0.745955
[GradSplit pre-clip] backbone=0.966495, critic=0.146917
[Loss] pg_loss=-0.046921, entropy_loss=0.000015, value_loss=0.008875
[EpochKL] epoch=0 mean_kl=0.00272 max_kl=0.00566
[EarlyStop] epoch=1 mean_kl=0.02585 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02585 max_kl=0.03913
[Time] Env Create Time: 4.4438s |Rollout Collect Time: 1.6974s |Loss & Update :0.6560
[PPODiag] kl_mean=0.0143, kl_p90=0.0276, kl_max=0.0391 | clipfrac_mean=0.015, logratio_std_mean=0.217, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.691, p10=0.682, min=0.674 | pg_loss_mean=0.0023, v_loss_mean=0.0217, ent_mean=0.0160 | gn_bb_mean=1.039, gn_bb_max=1.934 | gn_v_mean=0.214, gn_v_max=0.373

 10%|█         | 522/5000 [1:03:37<8:59:48,  7.23s/it]------------------ Training Record ------------------
Epoch: 522/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1062, reward_valid_std=4.1780
[BatchDiag] adv_mean=-0.0376, adv_std=0.2950, adv_abs_mean=0.1947 | ret_mean=8.9649, ret_std=0.5862 | val_mean=9.0024, val_std=0.5083 | explained_var=0.746821
[GradSplit pre-clip] backbone=0.648913, critic=0.215369
[Loss] pg_loss=-0.025598, entropy_loss=0.000025, value_loss=0.009860
[EarlyStop] epoch=0 mean_kl=0.01695 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01695 max_kl=0.07048
[Time] Env Create Time: 4.4414s |Rollout Collect Time: 1.6922s |Loss & Update :0.3587
[PPODiag] kl_mean=0.0169, kl_p90=0.0392, kl_max=0.0705 | clipfrac_mean=0.015, logratio_std_mean=0.244, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.680 | pg_loss_mean=0.0054, v_loss_mean=0.0214, ent_mean=0.0191 | gn_bb_mean=1.580, gn_bb_max=3.104 | gn_v_mean=0.188, gn_v_max=0.241

 10%|█         | 523/5000 [1:03:44<8:43:07,  7.01s/it]------------------ Training Record ------------------
Epoch: 523/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.588, reward_valid_mean=2.1192, reward_valid_std=4.1790
[BatchDiag] adv_mean=-0.0051, adv_std=0.2750, adv_abs_mean=0.1849 | ret_mean=8.9685, ret_std=0.5715 | val_mean=8.9735, val_std=0.5078 | explained_var=0.768475
[GradSplit pre-clip] backbone=0.539774, critic=0.154973
[Loss] pg_loss=-0.011351, entropy_loss=0.000014, value_loss=0.008793
[EpochKL] epoch=0 mean_kl=0.00585 max_kl=0.01365
[EpochKL] epoch=1 mean_kl=0.00863 max_kl=0.01611
[EpochKL] epoch=2 mean_kl=0.00971 max_kl=0.01598
[Time] Env Create Time: 4.4313s |Rollout Collect Time: 1.9477s |Loss & Update :1.0874
[PPODiag] kl_mean=0.0081, kl_p90=0.0144, kl_max=0.0161 | clipfrac_mean=0.016, logratio_std_mean=0.151, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.588, p10=0.584, min=0.578 | pg_loss_mean=0.0024, v_loss_mean=0.0185, ent_mean=0.0135 | gn_bb_mean=0.791, gn_bb_max=3.021 | gn_v_mean=0.207, gn_v_max=0.405

 10%|█         | 524/5000 [1:03:51<8:53:12,  7.15s/it]------------------ Training Record ------------------
Epoch: 524/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1095, reward_valid_std=4.1803
[BatchDiag] adv_mean=-0.0050, adv_std=0.2842, adv_abs_mean=0.1884 | ret_mean=8.9704, ret_std=0.5807 | val_mean=8.9754, val_std=0.5213 | explained_var=0.760419
[GradSplit pre-clip] backbone=0.370363, critic=0.200407
[Loss] pg_loss=-0.036916, entropy_loss=0.000011, value_loss=0.008944
[EpochKL] epoch=0 mean_kl=0.00470 max_kl=0.01887
[EpochKL] epoch=1 mean_kl=0.00597 max_kl=0.01217
[EarlyStop] epoch=2 mean_kl=0.01279 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01279 max_kl=0.02103
[Time] Env Create Time: 4.4131s |Rollout Collect Time: 1.9344s |Loss & Update :1.0736
[PPODiag] kl_mean=0.0078, kl_p90=0.0168, kl_max=0.0210 | clipfrac_mean=0.014, logratio_std_mean=0.152, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.590, p10=0.586, min=0.584 | pg_loss_mean=0.0019, v_loss_mean=0.0194, ent_mean=0.0125 | gn_bb_mean=0.797, gn_bb_max=1.789 | gn_v_mean=0.264, gn_v_max=0.601

 10%|█         | 525/5000 [1:03:59<8:59:13,  7.23s/it]------------------ Training Record ------------------
Epoch: 525/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1105, reward_valid_std=4.1794
[BatchDiag] adv_mean=-0.0289, adv_std=0.2908, adv_abs_mean=0.1904 | ret_mean=8.9616, ret_std=0.5840 | val_mean=8.9905, val_std=0.5024 | explained_var=0.752045
[GradSplit pre-clip] backbone=1.990869, critic=0.166703
[Loss] pg_loss=-0.038243, entropy_loss=0.000018, value_loss=0.007926
[EpochKL] epoch=0 mean_kl=0.00873 max_kl=0.01863
[EarlyStop] epoch=1 mean_kl=0.02136 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02136 max_kl=0.03249
[Time] Env Create Time: 4.3787s |Rollout Collect Time: 1.7022s |Loss & Update :0.6620
[PPODiag] kl_mean=0.0150, kl_p90=0.0263, kl_max=0.0325 | clipfrac_mean=0.021, logratio_std_mean=0.225, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.680 | pg_loss_mean=0.0042, v_loss_mean=0.0205, ent_mean=0.0183 | gn_bb_mean=1.055, gn_bb_max=2.139 | gn_v_mean=0.409, gn_v_max=0.865
[AttnScore] scale=1.0643, C=10.0

 11%|█         | 526/5000 [1:04:05<8:48:13,  7.08s/it]------------------ Training Record ------------------
Epoch: 526/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1034, reward_valid_std=4.1775
[BatchDiag] adv_mean=-0.0148, adv_std=0.2850, adv_abs_mean=0.1899 | ret_mean=8.9509, ret_std=0.5849 | val_mean=8.9657, val_std=0.4871 | explained_var=0.762611
[GradSplit pre-clip] backbone=0.448512, critic=0.138670
[Loss] pg_loss=-0.066460, entropy_loss=0.000014, value_loss=0.006913
[EpochKL] epoch=0 mean_kl=0.00224 max_kl=0.00609
[EpochKL] epoch=1 mean_kl=0.00587 max_kl=0.01004
[EarlyStop] epoch=2 mean_kl=0.01231 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01231 max_kl=0.03207
[Time] Env Create Time: 4.6285s |Rollout Collect Time: 1.9450s |Loss & Update :1.0834
[PPODiag] kl_mean=0.0068, kl_p90=0.0122, kl_max=0.0321 | clipfrac_mean=0.016, logratio_std_mean=0.131, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.585, min=0.581 | pg_loss_mean=0.0019, v_loss_mean=0.0195, ent_mean=0.0139 | gn_bb_mean=0.683, gn_bb_max=1.217 | gn_v_mean=0.229, gn_v_max=0.502

 11%|█         | 527/5000 [1:04:13<9:00:55,  7.26s/it]------------------ Training Record ------------------
Epoch: 527/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1139, reward_valid_std=4.1829
[BatchDiag] adv_mean=0.0034, adv_std=0.2842, adv_abs_mean=0.1916 | ret_mean=8.9556, ret_std=0.5827 | val_mean=8.9521, val_std=0.5043 | explained_var=0.762147
[GradSplit pre-clip] backbone=1.873930, critic=0.142629
[Loss] pg_loss=-0.003249, entropy_loss=0.000018, value_loss=0.008542
[EpochKL] epoch=0 mean_kl=0.00741 max_kl=0.01860
[EarlyStop] epoch=1 mean_kl=0.04728 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.04728 max_kl=0.07418
[Time] Env Create Time: 4.4328s |Rollout Collect Time: 1.7070s |Loss & Update :0.6635
[PPODiag] kl_mean=0.0273, kl_p90=0.0697, kl_max=0.0742 | clipfrac_mean=0.023, logratio_std_mean=0.323, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.676 | pg_loss_mean=0.0062, v_loss_mean=0.0199, ent_mean=0.0171 | gn_bb_mean=1.319, gn_bb_max=3.238 | gn_v_mean=0.286, gn_v_max=0.490

 11%|█         | 528/5000 [1:04:20<8:50:41,  7.12s/it]------------------ Training Record ------------------
Epoch: 528/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=8, valid_ratio=0.519, reward_valid_mean=2.0961, reward_valid_std=4.1733
[BatchDiag] adv_mean=-0.0088, adv_std=0.3417, adv_abs_mean=0.2137 | ret_mean=8.9425, ret_std=0.6124 | val_mean=8.9513, val_std=0.4742 | explained_var=0.688771
[GradSplit pre-clip] backbone=3.452882, critic=0.359127
[Loss] pg_loss=-0.126119, entropy_loss=0.000018, value_loss=0.007827
[EarlyStop] epoch=0 mean_kl=0.03842 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.03842 max_kl=0.09411
[Time] Env Create Time: 4.4238s |Rollout Collect Time: 2.1752s |Loss & Update :0.4327
[PPODiag] kl_mean=0.0384, kl_p90=0.0784, kl_max=0.0941 | clipfrac_mean=0.031, logratio_std_mean=0.460, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.519, p10=0.513, min=0.512 | pg_loss_mean=0.0046, v_loss_mean=0.0266, ent_mean=0.0155 | gn_bb_mean=1.126, gn_bb_max=3.453 | gn_v_mean=0.331, gn_v_max=0.466

 11%|█         | 529/5000 [1:04:27<8:48:36,  7.09s/it]------------------ Training Record ------------------
Epoch: 529/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1163, reward_valid_std=4.1819
[BatchDiag] adv_mean=-0.0013, adv_std=0.2825, adv_abs_mean=0.1898 | ret_mean=8.9606, ret_std=0.5729 | val_mean=8.9619, val_std=0.4888 | explained_var=0.756779
[GradSplit pre-clip] backbone=0.682280, critic=0.142752
[Loss] pg_loss=0.014247, entropy_loss=0.000020, value_loss=0.009169
[EpochKL] epoch=0 mean_kl=0.00399 max_kl=0.01552
[EarlyStop] epoch=1 mean_kl=0.01029 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01029 max_kl=0.01517
[Time] Env Create Time: 4.4191s |Rollout Collect Time: 1.6987s |Loss & Update :0.6684
[PPODiag] kl_mean=0.0071, kl_p90=0.0146, kl_max=0.0155 | clipfrac_mean=0.017, logratio_std_mean=0.139, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.676 | pg_loss_mean=0.0021, v_loss_mean=0.0195, ent_mean=0.0177 | gn_bb_mean=1.100, gn_bb_max=2.731 | gn_v_mean=0.285, gn_v_max=0.603

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.006, Step: 8, Avg Done Step: 6.60, #CS visited: 0.15
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.9743s
-----------------------------
 11%|█         | 530/5000 [1:04:36<9:26:22,  7.60s/it]------------------ Training Record ------------------
Epoch: 530/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1126, reward_valid_std=4.1812
[BatchDiag] adv_mean=-0.0349, adv_std=0.3041, adv_abs_mean=0.1915 | ret_mean=8.9648, ret_std=0.5864 | val_mean=8.9997, val_std=0.5046 | explained_var=0.731108
[GradSplit pre-clip] backbone=1.162632, critic=0.241838
[Loss] pg_loss=-0.011634, entropy_loss=0.000022, value_loss=0.011762
[EpochKL] epoch=0 mean_kl=0.00363 max_kl=0.01069
[EpochKL] epoch=1 mean_kl=0.00972 max_kl=0.02022
[EarlyStop] epoch=2 mean_kl=0.01650 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01650 max_kl=0.03065
[Time] Env Create Time: 4.4118s |Rollout Collect Time: 1.8985s |Loss & Update :0.9527
[PPODiag] kl_mean=0.0099, kl_p90=0.0225, kl_max=0.0307 | clipfrac_mean=0.018, logratio_std_mean=0.167, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.676 | pg_loss_mean=0.0022, v_loss_mean=0.0220, ent_mean=0.0171 | gn_bb_mean=0.770, gn_bb_max=1.724 | gn_v_mean=0.209, gn_v_max=0.312
[AttnScore] scale=1.0645, C=10.0

 11%|█         | 531/5000 [1:04:43<9:18:41,  7.50s/it]------------------ Training Record ------------------
Epoch: 531/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1122, reward_valid_std=4.1791
[BatchDiag] adv_mean=0.0048, adv_std=0.2913, adv_abs_mean=0.1940 | ret_mean=8.9602, ret_std=0.5843 | val_mean=8.9554, val_std=0.4907 | explained_var=0.751434
[GradSplit pre-clip] backbone=0.837122, critic=0.346313
[Loss] pg_loss=-0.061840, entropy_loss=0.000015, value_loss=0.009697
[EpochKL] epoch=0 mean_kl=0.00525 max_kl=0.01632
[EarlyStop] epoch=1 mean_kl=0.01861 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01861 max_kl=0.04868
[Time] Env Create Time: 4.4729s |Rollout Collect Time: 1.9440s |Loss & Update :0.7396
[PPODiag] kl_mean=0.0119, kl_p90=0.0240, kl_max=0.0487 | clipfrac_mean=0.019, logratio_std_mean=0.193, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.589, p10=0.585, min=0.583 | pg_loss_mean=0.0032, v_loss_mean=0.0210, ent_mean=0.0149 | gn_bb_mean=1.099, gn_bb_max=2.815 | gn_v_mean=0.261, gn_v_max=0.396

 11%|█         | 532/5000 [1:04:50<9:10:52,  7.40s/it]------------------ Training Record ------------------
Epoch: 532/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1180, reward_valid_std=4.1812
[BatchDiag] adv_mean=-0.0008, adv_std=0.2856, adv_abs_mean=0.1909 | ret_mean=8.9613, ret_std=0.5788 | val_mean=8.9621, val_std=0.5199 | explained_var=0.756615
[GradSplit pre-clip] backbone=0.738025, critic=0.278424
[Loss] pg_loss=-0.080298, entropy_loss=0.000016, value_loss=0.006549
[EpochKL] epoch=0 mean_kl=0.00386 max_kl=0.01010
[EpochKL] epoch=1 mean_kl=0.00546 max_kl=0.00998
[EpochKL] epoch=2 mean_kl=0.00518 max_kl=0.00809
[Time] Env Create Time: 4.4604s |Rollout Collect Time: 1.6970s |Loss & Update :0.9613
[PPODiag] kl_mean=0.0048, kl_p90=0.0081, kl_max=0.0101 | clipfrac_mean=0.013, logratio_std_mean=0.114, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.679, min=0.676 | pg_loss_mean=0.0013, v_loss_mean=0.0195, ent_mean=0.0151 | gn_bb_mean=0.551, gn_bb_max=0.923 | gn_v_mean=0.269, gn_v_max=0.512

 11%|█         | 533/5000 [1:04:57<9:04:32,  7.31s/it]------------------ Training Record ------------------
Epoch: 533/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1147, reward_valid_std=4.1792
[BatchDiag] adv_mean=-0.0057, adv_std=0.2920, adv_abs_mean=0.1898 | ret_mean=8.9632, ret_std=0.5850 | val_mean=8.9689, val_std=0.5046 | explained_var=0.750878
[GradSplit pre-clip] backbone=0.622845, critic=0.239530
[Loss] pg_loss=-0.085028, entropy_loss=0.000015, value_loss=0.007056
[EpochKL] epoch=0 mean_kl=0.00114 max_kl=0.00398
[EpochKL] epoch=1 mean_kl=0.00383 max_kl=0.00970
[EpochKL] epoch=2 mean_kl=0.00904 max_kl=0.01654
[Time] Env Create Time: 4.4311s |Rollout Collect Time: 1.7074s |Loss & Update :0.9682
[PPODiag] kl_mean=0.0047, kl_p90=0.0096, kl_max=0.0165 | clipfrac_mean=0.013, logratio_std_mean=0.112, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.679 | pg_loss_mean=0.0002, v_loss_mean=0.0203, ent_mean=0.0161 | gn_bb_mean=0.515, gn_bb_max=1.361 | gn_v_mean=0.190, gn_v_max=0.411

 11%|█         | 534/5000 [1:05:04<8:59:47,  7.25s/it]------------------ Training Record ------------------
Epoch: 534/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1035, reward_valid_std=4.1747
[BatchDiag] adv_mean=-0.0304, adv_std=0.2973, adv_abs_mean=0.1942 | ret_mean=8.9483, ret_std=0.5886 | val_mean=8.9786, val_std=0.5169 | explained_var=0.744840
[GradSplit pre-clip] backbone=1.684049, critic=0.250562
[Loss] pg_loss=-0.015748, entropy_loss=0.000014, value_loss=0.007793
[EpochKL] epoch=0 mean_kl=0.00340 max_kl=0.00986
[EarlyStop] epoch=1 mean_kl=0.01595 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01595 max_kl=0.02905
[Time] Env Create Time: 4.3994s |Rollout Collect Time: 1.9319s |Loss & Update :0.7450
[PPODiag] kl_mean=0.0097, kl_p90=0.0176, kl_max=0.0291 | clipfrac_mean=0.016, logratio_std_mean=0.171, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.584, min=0.582 | pg_loss_mean=0.0025, v_loss_mean=0.0219, ent_mean=0.0146 | gn_bb_mean=1.046, gn_bb_max=1.790 | gn_v_mean=0.303, gn_v_max=0.587

 11%|█         | 535/5000 [1:05:11<8:55:45,  7.20s/it]------------------ Training Record ------------------
Epoch: 535/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1076, reward_valid_std=4.1805
[BatchDiag] adv_mean=0.0376, adv_std=0.2996, adv_abs_mean=0.2122 | ret_mean=8.9533, ret_std=0.5907 | val_mean=8.9157, val_std=0.5012 | explained_var=0.742841
[GradSplit pre-clip] backbone=0.949140, critic=0.573123
[Loss] pg_loss=-0.053166, entropy_loss=0.000014, value_loss=0.008330
[EpochKL] epoch=0 mean_kl=0.00330 max_kl=0.01025
[EpochKL] epoch=1 mean_kl=0.00838 max_kl=0.01731
[EarlyStop] epoch=2 mean_kl=0.01106 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01106 max_kl=0.01660
[Time] Env Create Time: 4.4633s |Rollout Collect Time: 1.7113s |Loss & Update :0.9607
[PPODiag] kl_mean=0.0076, kl_p90=0.0161, kl_max=0.0173 | clipfrac_mean=0.017, logratio_std_mean=0.144, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.682 | pg_loss_mean=0.0014, v_loss_mean=0.0212, ent_mean=0.0176 | gn_bb_mean=0.783, gn_bb_max=1.475 | gn_v_mean=0.341, gn_v_max=0.613
[AttnScore] scale=1.0650, C=10.0

 11%|█         | 536/5000 [1:05:18<8:54:13,  7.18s/it]------------------ Training Record ------------------
Epoch: 536/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1083, reward_valid_std=4.1760
[BatchDiag] adv_mean=-0.0286, adv_std=0.2898, adv_abs_mean=0.1887 | ret_mean=8.9458, ret_std=0.5846 | val_mean=8.9744, val_std=0.5064 | explained_var=0.754221
[GradSplit pre-clip] backbone=0.523235, critic=0.138229
[Loss] pg_loss=-0.124884, entropy_loss=0.000018, value_loss=0.006634
[EpochKL] epoch=0 mean_kl=0.00235 max_kl=0.01164
[EarlyStop] epoch=1 mean_kl=0.01420 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01420 max_kl=0.03307
[Time] Env Create Time: 4.6270s |Rollout Collect Time: 1.6943s |Loss & Update :0.6552
[PPODiag] kl_mean=0.0083, kl_p90=0.0157, kl_max=0.0331 | clipfrac_mean=0.013, logratio_std_mean=0.165, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.680 | pg_loss_mean=0.0024, v_loss_mean=0.0210, ent_mean=0.0173 | gn_bb_mean=1.151, gn_bb_max=4.600 | gn_v_mean=0.389, gn_v_max=0.679

 11%|█         | 537/5000 [1:05:25<8:49:33,  7.12s/it]------------------ Training Record ------------------
Epoch: 537/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.593, reward_valid_mean=2.0933, reward_valid_std=4.1706
[BatchDiag] adv_mean=-0.0268, adv_std=0.3207, adv_abs_mean=0.2056 | ret_mean=8.9419, ret_std=0.6008 | val_mean=8.9688, val_std=0.4830 | explained_var=0.715081
[GradSplit pre-clip] backbone=0.855868, critic=0.165081
[Loss] pg_loss=-0.078552, entropy_loss=0.000015, value_loss=0.009394
[EpochKL] epoch=0 mean_kl=0.00663 max_kl=0.02030
[EarlyStop] epoch=1 mean_kl=0.02533 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02533 max_kl=0.05379
[Time] Env Create Time: 4.4562s |Rollout Collect Time: 1.9370s |Loss & Update :0.7388
[PPODiag] kl_mean=0.0160, kl_p90=0.0414, kl_max=0.0538 | clipfrac_mean=0.018, logratio_std_mean=0.250, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.593, p10=0.588, min=0.587 | pg_loss_mean=0.0016, v_loss_mean=0.0243, ent_mean=0.0165 | gn_bb_mean=1.286, gn_bb_max=2.818 | gn_v_mean=0.245, gn_v_max=0.610

 11%|█         | 538/5000 [1:05:33<8:49:44,  7.12s/it]------------------ Training Record ------------------
Epoch: 538/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1005, reward_valid_std=4.1735
[BatchDiag] adv_mean=-0.0020, adv_std=0.2942, adv_abs_mean=0.1932 | ret_mean=8.9506, ret_std=0.5868 | val_mean=8.9526, val_std=0.5270 | explained_var=0.748671
[GradSplit pre-clip] backbone=0.978624, critic=0.167260
[Loss] pg_loss=-0.045315, entropy_loss=0.000016, value_loss=0.006491
[EarlyStop] epoch=0 mean_kl=0.02054 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02054 max_kl=0.10791
[Time] Env Create Time: 4.4388s |Rollout Collect Time: 1.6974s |Loss & Update :0.3661
[PPODiag] kl_mean=0.0205, kl_p90=0.0488, kl_max=0.1079 | clipfrac_mean=0.018, logratio_std_mean=0.275, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.686, min=0.684 | pg_loss_mean=0.0034, v_loss_mean=0.0212, ent_mean=0.0155 | gn_bb_mean=1.747, gn_bb_max=6.045 | gn_v_mean=0.232, gn_v_max=0.354

 11%|█         | 539/5000 [1:05:39<8:35:46,  6.94s/it]------------------ Training Record ------------------
Epoch: 539/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1054, reward_valid_std=4.1785
[BatchDiag] adv_mean=-0.0307, adv_std=0.2858, adv_abs_mean=0.1888 | ret_mean=8.9624, ret_std=0.5849 | val_mean=8.9931, val_std=0.5067 | explained_var=0.761194
[GradSplit pre-clip] backbone=1.369351, critic=0.140517
[Loss] pg_loss=-0.067509, entropy_loss=0.000017, value_loss=0.007058
[EpochKL] epoch=0 mean_kl=0.00614 max_kl=0.01431
[EarlyStop] epoch=1 mean_kl=0.02277 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02277 max_kl=0.03564
[Time] Env Create Time: 4.4298s |Rollout Collect Time: 1.7067s |Loss & Update :0.6603
[PPODiag] kl_mean=0.0145, kl_p90=0.0305, kl_max=0.0356 | clipfrac_mean=0.021, logratio_std_mean=0.225, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.684 | pg_loss_mean=0.0049, v_loss_mean=0.0208, ent_mean=0.0193 | gn_bb_mean=1.062, gn_bb_max=1.808 | gn_v_mean=0.423, gn_v_max=1.069

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.970, Step: 8, Avg Done Step: 6.63, #CS visited: 0.12
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.9735s
-----------------------------
 11%|█         | 540/5000 [1:05:48<9:17:10,  7.50s/it]------------------ Training Record ------------------
Epoch: 540/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0899, reward_valid_std=4.1725
[BatchDiag] adv_mean=-0.0095, adv_std=0.3337, adv_abs_mean=0.2175 | ret_mean=8.9425, ret_std=0.6117 | val_mean=8.9521, val_std=0.4941 | explained_var=0.702299
[GradSplit pre-clip] backbone=7.251005, critic=0.270222
[Loss] pg_loss=-0.047208, entropy_loss=0.000015, value_loss=0.011222
[EarlyStop] epoch=0 mean_kl=0.01425 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01425 max_kl=0.02629
[Time] Env Create Time: 4.4174s |Rollout Collect Time: 1.6957s |Loss & Update :0.3674
[PPODiag] kl_mean=0.0142, kl_p90=0.0221, kl_max=0.0263 | clipfrac_mean=0.020, logratio_std_mean=0.250, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.693, p10=0.686, min=0.686 | pg_loss_mean=0.0028, v_loss_mean=0.0267, ent_mean=0.0194 | gn_bb_mean=1.943, gn_bb_max=7.251 | gn_v_mean=0.334, gn_v_max=0.686
[AttnScore] scale=1.0649, C=10.0

 11%|█         | 541/5000 [1:05:54<8:54:25,  7.19s/it]------------------ Training Record ------------------
Epoch: 541/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.693, reward_valid_mean=2.0909, reward_valid_std=4.1672
[BatchDiag] adv_mean=0.0035, adv_std=0.3078, adv_abs_mean=0.2039 | ret_mean=8.9430, ret_std=0.6028 | val_mean=8.9395, val_std=0.5288 | explained_var=0.739383
[GradSplit pre-clip] backbone=0.513058, critic=0.200147
[Loss] pg_loss=-0.027138, entropy_loss=0.000021, value_loss=0.009851
[EpochKL] epoch=0 mean_kl=0.00711 max_kl=0.01659
[EarlyStop] epoch=1 mean_kl=0.02171 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02171 max_kl=0.04138
[Time] Env Create Time: 4.4049s |Rollout Collect Time: 1.7055s |Loss & Update :0.6610
[PPODiag] kl_mean=0.0144, kl_p90=0.0361, kl_max=0.0414 | clipfrac_mean=0.021, logratio_std_mean=0.211, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.693, p10=0.687, min=0.687 | pg_loss_mean=0.0021, v_loss_mean=0.0230, ent_mean=0.0192 | gn_bb_mean=0.931, gn_bb_max=1.613 | gn_v_mean=0.263, gn_v_max=0.446

 11%|█         | 542/5000 [1:06:01<8:44:57,  7.07s/it]------------------ Training Record ------------------
Epoch: 542/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.1010, reward_valid_std=4.1748
[BatchDiag] adv_mean=-0.0240, adv_std=0.2952, adv_abs_mean=0.1920 | ret_mean=8.9606, ret_std=0.5858 | val_mean=8.9845, val_std=0.5036 | explained_var=0.746017
[GradSplit pre-clip] backbone=0.997139, critic=0.121650
[Loss] pg_loss=-0.094675, entropy_loss=0.000013, value_loss=0.006631
[EpochKL] epoch=0 mean_kl=0.00685 max_kl=0.02034
[EpochKL] epoch=1 mean_kl=0.00961 max_kl=0.01655
[EarlyStop] epoch=2 mean_kl=0.01171 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01171 max_kl=0.02189
[Time] Env Create Time: 4.6491s |Rollout Collect Time: 1.9490s |Loss & Update :1.0821
[PPODiag] kl_mean=0.0094, kl_p90=0.0170, kl_max=0.0219 | clipfrac_mean=0.017, logratio_std_mean=0.180, ratio_p95_mean=1.004 | valid_ratio_mb_mean=0.592, p10=0.587, min=0.583 | pg_loss_mean=0.0024, v_loss_mean=0.0217, ent_mean=0.0148 | gn_bb_mean=0.740, gn_bb_max=2.328 | gn_v_mean=0.278, gn_v_max=0.508

 11%|█         | 543/5000 [1:06:09<8:58:33,  7.25s/it]------------------ Training Record ------------------
Epoch: 543/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1034, reward_valid_std=4.1710
[BatchDiag] adv_mean=-0.0048, adv_std=0.2954, adv_abs_mean=0.2007 | ret_mean=8.9568, ret_std=0.5815 | val_mean=8.9616, val_std=0.4944 | explained_var=0.741928
[GradSplit pre-clip] backbone=1.049421, critic=0.196695
[Loss] pg_loss=0.032246, entropy_loss=0.000017, value_loss=0.009334
[EpochKL] epoch=0 mean_kl=0.00249 max_kl=0.00880
[EarlyStop] epoch=1 mean_kl=0.01558 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01558 max_kl=0.02704
[Time] Env Create Time: 4.4723s |Rollout Collect Time: 1.7070s |Loss & Update :0.6603
[PPODiag] kl_mean=0.0090, kl_p90=0.0205, kl_max=0.0270 | clipfrac_mean=0.015, logratio_std_mean=0.173, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.690, p10=0.686, min=0.683 | pg_loss_mean=0.0019, v_loss_mean=0.0208, ent_mean=0.0181 | gn_bb_mean=0.952, gn_bb_max=3.734 | gn_v_mean=0.208, gn_v_max=0.345

 11%|█         | 544/5000 [1:06:16<8:49:18,  7.13s/it]------------------ Training Record ------------------
Epoch: 544/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1135, reward_valid_std=4.1816
[BatchDiag] adv_mean=0.0089, adv_std=0.2893, adv_abs_mean=0.1915 | ret_mean=8.9588, ret_std=0.5826 | val_mean=8.9499, val_std=0.5137 | explained_var=0.753384
[GradSplit pre-clip] backbone=0.498358, critic=0.192351
[Loss] pg_loss=0.005371, entropy_loss=0.000019, value_loss=0.011741
[EpochKL] epoch=0 mean_kl=0.00235 max_kl=0.00501
[EarlyStop] epoch=1 mean_kl=0.01488 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01488 max_kl=0.02814
[Time] Env Create Time: 4.4700s |Rollout Collect Time: 1.6973s |Loss & Update :0.6612
[PPODiag] kl_mean=0.0086, kl_p90=0.0194, kl_max=0.0281 | clipfrac_mean=0.015, logratio_std_mean=0.164, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.680 | pg_loss_mean=0.0017, v_loss_mean=0.0203, ent_mean=0.0153 | gn_bb_mean=0.721, gn_bb_max=1.375 | gn_v_mean=0.192, gn_v_max=0.344

 11%|█         | 545/5000 [1:06:22<8:42:32,  7.04s/it]------------------ Training Record ------------------
Epoch: 545/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1100, reward_valid_std=4.1748
[BatchDiag] adv_mean=-0.0045, adv_std=0.2996, adv_abs_mean=0.1916 | ret_mean=8.9658, ret_std=0.5857 | val_mean=8.9703, val_std=0.5249 | explained_var=0.738354
[GradSplit pre-clip] backbone=0.756257, critic=0.180436
[Loss] pg_loss=-0.058060, entropy_loss=0.000012, value_loss=0.006456
[EpochKL] epoch=0 mean_kl=0.00293 max_kl=0.01116
[EarlyStop] epoch=1 mean_kl=0.01660 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01660 max_kl=0.04505
[Time] Env Create Time: 4.4398s |Rollout Collect Time: 1.7024s |Loss & Update :0.6634
[PPODiag] kl_mean=0.0098, kl_p90=0.0225, kl_max=0.0450 | clipfrac_mean=0.014, logratio_std_mean=0.162, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.682 | pg_loss_mean=0.0031, v_loss_mean=0.0216, ent_mean=0.0153 | gn_bb_mean=1.151, gn_bb_max=3.567 | gn_v_mean=0.266, gn_v_max=0.527
[AttnScore] scale=1.0651, C=10.0

 11%|█         | 546/5000 [1:06:29<8:37:16,  6.97s/it]------------------ Training Record ------------------
Epoch: 546/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1112, reward_valid_std=4.1754
[BatchDiag] adv_mean=-0.0191, adv_std=0.2936, adv_abs_mean=0.1921 | ret_mean=8.9548, ret_std=0.5790 | val_mean=8.9740, val_std=0.5138 | explained_var=0.742834
[GradSplit pre-clip] backbone=0.470207, critic=0.208873
[Loss] pg_loss=-0.109847, entropy_loss=0.000016, value_loss=0.007357
[EpochKL] epoch=0 mean_kl=0.00506 max_kl=0.01185
[EarlyStop] epoch=1 mean_kl=0.01038 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01038 max_kl=0.02126
[Time] Env Create Time: 4.4130s |Rollout Collect Time: 1.6936s |Loss & Update :0.6749
[PPODiag] kl_mean=0.0077, kl_p90=0.0142, kl_max=0.0213 | clipfrac_mean=0.015, logratio_std_mean=0.147, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.680 | pg_loss_mean=0.0032, v_loss_mean=0.0207, ent_mean=0.0158 | gn_bb_mean=0.748, gn_bb_max=1.628 | gn_v_mean=0.208, gn_v_max=0.339

 11%|█         | 547/5000 [1:06:36<8:33:00,  6.91s/it]------------------ Training Record ------------------
Epoch: 547/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1061, reward_valid_std=4.1763
[BatchDiag] adv_mean=-0.0278, adv_std=0.2948, adv_abs_mean=0.1904 | ret_mean=8.9560, ret_std=0.5837 | val_mean=8.9838, val_std=0.5116 | explained_var=0.744956
[GradSplit pre-clip] backbone=0.872856, critic=0.241112
[Loss] pg_loss=-0.011337, entropy_loss=0.000012, value_loss=0.009775
[EpochKL] epoch=0 mean_kl=0.00186 max_kl=0.00492
[EpochKL] epoch=1 mean_kl=0.00504 max_kl=0.00861
[EpochKL] epoch=2 mean_kl=0.00893 max_kl=0.01072
[Time] Env Create Time: 4.4168s |Rollout Collect Time: 1.9412s |Loss & Update :1.0917
[PPODiag] kl_mean=0.0053, kl_p90=0.0103, kl_max=0.0107 | clipfrac_mean=0.014, logratio_std_mean=0.115, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.590, p10=0.584, min=0.582 | pg_loss_mean=0.0010, v_loss_mean=0.0209, ent_mean=0.0135 | gn_bb_mean=0.593, gn_bb_max=1.310 | gn_v_mean=0.207, gn_v_max=0.408

 11%|█         | 548/5000 [1:06:43<8:44:51,  7.07s/it]------------------ Training Record ------------------
Epoch: 548/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1195, reward_valid_std=4.1788
[BatchDiag] adv_mean=0.0268, adv_std=0.2823, adv_abs_mean=0.1955 | ret_mean=8.9688, ret_std=0.5706 | val_mean=8.9420, val_std=0.5032 | explained_var=0.755277
[GradSplit pre-clip] backbone=1.123111, critic=0.410073
[Loss] pg_loss=-0.051946, entropy_loss=0.000016, value_loss=0.007290
[EpochKL] epoch=0 mean_kl=0.00474 max_kl=0.01247
[EarlyStop] epoch=1 mean_kl=0.01205 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01205 max_kl=0.02302
[Time] Env Create Time: 4.6273s |Rollout Collect Time: 1.7256s |Loss & Update :0.6695
[PPODiag] kl_mean=0.0084, kl_p90=0.0195, kl_max=0.0230 | clipfrac_mean=0.017, logratio_std_mean=0.151, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.686, p10=0.682, min=0.680 | pg_loss_mean=0.0028, v_loss_mean=0.0192, ent_mean=0.0167 | gn_bb_mean=1.073, gn_bb_max=2.479 | gn_v_mean=0.307, gn_v_max=0.533

 11%|█         | 549/5000 [1:06:51<8:43:37,  7.06s/it]------------------ Training Record ------------------
Epoch: 549/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1035, reward_valid_std=4.1767
[BatchDiag] adv_mean=-0.0588, adv_std=0.2898, adv_abs_mean=0.1852 | ret_mean=8.9570, ret_std=0.5907 | val_mean=9.0158, val_std=0.4986 | explained_var=0.759322
[GradSplit pre-clip] backbone=1.211211, critic=0.505692
[Loss] pg_loss=-0.001587, entropy_loss=0.000016, value_loss=0.008458
[EpochKL] epoch=0 mean_kl=0.00336 max_kl=0.00921
[EarlyStop] epoch=1 mean_kl=0.01110 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01110 max_kl=0.01617
[Time] Env Create Time: 4.4418s |Rollout Collect Time: 1.6943s |Loss & Update :0.6577
[PPODiag] kl_mean=0.0072, kl_p90=0.0154, kl_max=0.0162 | clipfrac_mean=0.015, logratio_std_mean=0.131, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.678 | pg_loss_mean=0.0025, v_loss_mean=0.0205, ent_mean=0.0161 | gn_bb_mean=1.118, gn_bb_max=3.715 | gn_v_mean=0.322, gn_v_max=0.507

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.985, Step: 7, Avg Done Step: 6.62, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8582s
-----------------------------
 11%|█         | 550/5000 [1:06:59<9:19:35,  7.54s/it]------------------ Training Record ------------------
Epoch: 550/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1137, reward_valid_std=4.1775
[BatchDiag] adv_mean=0.0207, adv_std=0.2951, adv_abs_mean=0.1994 | ret_mean=8.9520, ret_std=0.5874 | val_mean=8.9313, val_std=0.4922 | explained_var=0.747558
[GradSplit pre-clip] backbone=1.140270, critic=0.219421
[Loss] pg_loss=0.064956, entropy_loss=0.000016, value_loss=0.011237
[EpochKL] epoch=0 mean_kl=0.00538 max_kl=0.01176
[EarlyStop] epoch=1 mean_kl=0.01071 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01071 max_kl=0.02374
[Time] Env Create Time: 4.3982s |Rollout Collect Time: 1.9374s |Loss & Update :0.7473
[PPODiag] kl_mean=0.0080, kl_p90=0.0179, kl_max=0.0237 | clipfrac_mean=0.018, logratio_std_mean=0.142, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.589, p10=0.585, min=0.582 | pg_loss_mean=0.0018, v_loss_mean=0.0212, ent_mean=0.0164 | gn_bb_mean=1.140, gn_bb_max=3.520 | gn_v_mean=0.331, gn_v_max=0.639
[AttnScore] scale=1.0655, C=10.0

 11%|█         | 551/5000 [1:07:06<9:09:11,  7.41s/it]------------------ Training Record ------------------
Epoch: 551/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1074, reward_valid_std=4.1770
[BatchDiag] adv_mean=-0.0285, adv_std=0.2885, adv_abs_mean=0.1855 | ret_mean=8.9649, ret_std=0.5778 | val_mean=8.9933, val_std=0.5358 | explained_var=0.750645
[GradSplit pre-clip] backbone=0.542333, critic=0.166085
[Loss] pg_loss=-0.097349, entropy_loss=0.000016, value_loss=0.006058
[EpochKL] epoch=0 mean_kl=0.00189 max_kl=0.00349
[EpochKL] epoch=1 mean_kl=0.00605 max_kl=0.01565
[EarlyStop] epoch=2 mean_kl=0.01028 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01028 max_kl=0.02652
[Time] Env Create Time: 4.4193s |Rollout Collect Time: 1.6894s |Loss & Update :0.9717
[PPODiag] kl_mean=0.0061, kl_p90=0.0130, kl_max=0.0265 | clipfrac_mean=0.013, logratio_std_mean=0.137, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.678 | pg_loss_mean=0.0006, v_loss_mean=0.0200, ent_mean=0.0158 | gn_bb_mean=0.591, gn_bb_max=1.480 | gn_v_mean=0.257, gn_v_max=0.461

 11%|█         | 552/5000 [1:07:13<9:01:49,  7.31s/it]------------------ Training Record ------------------
Epoch: 552/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1091, reward_valid_std=4.1786
[BatchDiag] adv_mean=-0.0089, adv_std=0.2954, adv_abs_mean=0.1888 | ret_mean=8.9433, ret_std=0.5921 | val_mean=8.9522, val_std=0.5153 | explained_var=0.751137
[GradSplit pre-clip] backbone=0.798345, critic=0.135956
[Loss] pg_loss=-0.044379, entropy_loss=0.000021, value_loss=0.008818
[EpochKL] epoch=0 mean_kl=0.00196 max_kl=0.00473
[EarlyStop] epoch=1 mean_kl=0.01187 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01187 max_kl=0.02554
[Time] Env Create Time: 4.3815s |Rollout Collect Time: 1.6888s |Loss & Update :0.6735
[PPODiag] kl_mean=0.0069, kl_p90=0.0131, kl_max=0.0255 | clipfrac_mean=0.015, logratio_std_mean=0.137, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.676 | pg_loss_mean=0.0019, v_loss_mean=0.0209, ent_mean=0.0165 | gn_bb_mean=0.815, gn_bb_max=1.444 | gn_v_mean=0.215, gn_v_max=0.371

 11%|█         | 553/5000 [1:07:20<8:49:13,  7.14s/it]------------------ Training Record ------------------
Epoch: 553/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1071, reward_valid_std=4.1800
[BatchDiag] adv_mean=-0.0290, adv_std=0.2916, adv_abs_mean=0.1896 | ret_mean=8.9603, ret_std=0.5901 | val_mean=8.9893, val_std=0.5244 | explained_var=0.755832
[GradSplit pre-clip] backbone=1.040525, critic=0.305331
[Loss] pg_loss=-0.004109, entropy_loss=0.000015, value_loss=0.008865
[EpochKL] epoch=0 mean_kl=0.00462 max_kl=0.01537
[EarlyStop] epoch=1 mean_kl=0.01123 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01123 max_kl=0.01932
[Time] Env Create Time: 4.6062s |Rollout Collect Time: 1.6927s |Loss & Update :0.6551
[PPODiag] kl_mean=0.0079, kl_p90=0.0166, kl_max=0.0193 | clipfrac_mean=0.017, logratio_std_mean=0.159, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.675 | pg_loss_mean=0.0025, v_loss_mean=0.0205, ent_mean=0.0168 | gn_bb_mean=0.930, gn_bb_max=1.697 | gn_v_mean=0.231, gn_v_max=0.394

 11%|█         | 554/5000 [1:07:27<8:44:58,  7.08s/it]------------------ Training Record ------------------
Epoch: 554/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1100, reward_valid_std=4.1809
[BatchDiag] adv_mean=0.0097, adv_std=0.3023, adv_abs_mean=0.1968 | ret_mean=8.9585, ret_std=0.5989 | val_mean=8.9488, val_std=0.5094 | explained_var=0.745220
[GradSplit pre-clip] backbone=0.400903, critic=0.242666
[Loss] pg_loss=-0.038898, entropy_loss=0.000015, value_loss=0.007048
[EpochKL] epoch=0 mean_kl=0.00606 max_kl=0.01868
[EarlyStop] epoch=1 mean_kl=0.01256 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01256 max_kl=0.02242
[Time] Env Create Time: 4.4293s |Rollout Collect Time: 1.7008s |Loss & Update :0.6576
[PPODiag] kl_mean=0.0093, kl_p90=0.0176, kl_max=0.0224 | clipfrac_mean=0.018, logratio_std_mean=0.157, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.678 | pg_loss_mean=0.0027, v_loss_mean=0.0215, ent_mean=0.0163 | gn_bb_mean=0.848, gn_bb_max=2.606 | gn_v_mean=0.275, gn_v_max=0.728

 11%|█         | 555/5000 [1:07:34<8:38:15,  7.00s/it]------------------ Training Record ------------------
Epoch: 555/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1060, reward_valid_std=4.1736
[BatchDiag] adv_mean=-0.0495, adv_std=0.3013, adv_abs_mean=0.1871 | ret_mean=8.9612, ret_std=0.5837 | val_mean=9.0107, val_std=0.4882 | explained_var=0.733639
[GradSplit pre-clip] backbone=1.433420, critic=0.174228
[Loss] pg_loss=-0.097468, entropy_loss=0.000019, value_loss=0.007418
[EpochKL] epoch=0 mean_kl=0.00250 max_kl=0.00596
[EarlyStop] epoch=1 mean_kl=0.02079 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02079 max_kl=0.03627
[Time] Env Create Time: 4.4178s |Rollout Collect Time: 1.6847s |Loss & Update :0.6670
[PPODiag] kl_mean=0.0116, kl_p90=0.0286, kl_max=0.0363 | clipfrac_mean=0.016, logratio_std_mean=0.180, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.686, min=0.680 | pg_loss_mean=0.0043, v_loss_mean=0.0217, ent_mean=0.0172 | gn_bb_mean=1.901, gn_bb_max=10.088 | gn_v_mean=0.264, gn_v_max=0.465
[AttnScore] scale=1.0657, C=10.0

 11%|█         | 556/5000 [1:07:41<8:33:07,  6.93s/it]------------------ Training Record ------------------
Epoch: 556/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1136, reward_valid_std=4.1852
[BatchDiag] adv_mean=-0.0147, adv_std=0.2851, adv_abs_mean=0.1852 | ret_mean=8.9579, ret_std=0.5854 | val_mean=8.9726, val_std=0.4993 | explained_var=0.762889
[GradSplit pre-clip] backbone=0.324816, critic=0.134535
[Loss] pg_loss=-0.065988, entropy_loss=0.000011, value_loss=0.006590
[EpochKL] epoch=0 mean_kl=0.00498 max_kl=0.01409
[EarlyStop] epoch=1 mean_kl=0.01111 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01111 max_kl=0.01866
[Time] Env Create Time: 4.4189s |Rollout Collect Time: 1.7045s |Loss & Update :0.6732
[PPODiag] kl_mean=0.0080, kl_p90=0.0137, kl_max=0.0187 | clipfrac_mean=0.014, logratio_std_mean=0.158, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.678, min=0.677 | pg_loss_mean=0.0020, v_loss_mean=0.0206, ent_mean=0.0163 | gn_bb_mean=0.822, gn_bb_max=2.474 | gn_v_mean=0.306, gn_v_max=0.539

 11%|█         | 557/5000 [1:07:47<8:30:06,  6.89s/it]------------------ Training Record ------------------
Epoch: 557/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1107, reward_valid_std=4.1802
[BatchDiag] adv_mean=0.0048, adv_std=0.2874, adv_abs_mean=0.1907 | ret_mean=8.9621, ret_std=0.5787 | val_mean=8.9573, val_std=0.4983 | explained_var=0.753398
[GradSplit pre-clip] backbone=1.124036, critic=0.276422
[Loss] pg_loss=-0.068779, entropy_loss=0.000012, value_loss=0.008094
[EpochKL] epoch=0 mean_kl=0.00336 max_kl=0.00887
[EarlyStop] epoch=1 mean_kl=0.01434 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01434 max_kl=0.03513
[Time] Env Create Time: 4.4383s |Rollout Collect Time: 1.7069s |Loss & Update :0.6623
[PPODiag] kl_mean=0.0088, kl_p90=0.0247, kl_max=0.0351 | clipfrac_mean=0.013, logratio_std_mean=0.158, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.682 | pg_loss_mean=0.0022, v_loss_mean=0.0203, ent_mean=0.0164 | gn_bb_mean=1.090, gn_bb_max=3.569 | gn_v_mean=0.264, gn_v_max=0.504

 11%|█         | 558/5000 [1:07:54<8:28:11,  6.86s/it]------------------ Training Record ------------------
Epoch: 558/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1216, reward_valid_std=4.1819
[BatchDiag] adv_mean=0.0252, adv_std=0.2819, adv_abs_mean=0.1926 | ret_mean=8.9661, ret_std=0.5760 | val_mean=8.9409, val_std=0.5163 | explained_var=0.760375
[GradSplit pre-clip] backbone=0.469875, critic=0.369320
[Loss] pg_loss=-0.036507, entropy_loss=0.000012, value_loss=0.007298
[EpochKL] epoch=0 mean_kl=0.00877 max_kl=0.02028
[EarlyStop] epoch=1 mean_kl=0.02577 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02577 max_kl=0.03770
[Time] Env Create Time: 4.4008s |Rollout Collect Time: 1.7023s |Loss & Update :0.6587
[PPODiag] kl_mean=0.0173, kl_p90=0.0357, kl_max=0.0377 | clipfrac_mean=0.020, logratio_std_mean=0.264, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.680, min=0.673 | pg_loss_mean=0.0029, v_loss_mean=0.0195, ent_mean=0.0177 | gn_bb_mean=1.039, gn_bb_max=2.119 | gn_v_mean=0.321, gn_v_max=0.478

 11%|█         | 559/5000 [1:08:01<8:25:49,  6.83s/it]------------------ Training Record ------------------
Epoch: 559/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1031, reward_valid_std=4.1791
[BatchDiag] adv_mean=0.0118, adv_std=0.3088, adv_abs_mean=0.2028 | ret_mean=8.9495, ret_std=0.6029 | val_mean=8.9377, val_std=0.4958 | explained_var=0.737657
[GradSplit pre-clip] backbone=0.863558, critic=0.219447
[Loss] pg_loss=-0.006954, entropy_loss=0.000014, value_loss=0.009227
[EpochKL] epoch=0 mean_kl=0.00542 max_kl=0.01414
[EarlyStop] epoch=1 mean_kl=0.01651 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01651 max_kl=0.04494
[Time] Env Create Time: 4.3863s |Rollout Collect Time: 1.9486s |Loss & Update :0.7407
[PPODiag] kl_mean=0.0110, kl_p90=0.0191, kl_max=0.0449 | clipfrac_mean=0.018, logratio_std_mean=0.175, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.591, p10=0.585, min=0.583 | pg_loss_mean=0.0028, v_loss_mean=0.0231, ent_mean=0.0151 | gn_bb_mean=0.992, gn_bb_max=2.233 | gn_v_mean=0.263, gn_v_max=0.376

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.991, Step: 7, Avg Done Step: 6.60, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8298s
-----------------------------
 11%|█         | 560/5000 [1:08:10<9:12:19,  7.46s/it]------------------ Training Record ------------------
Epoch: 560/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1045, reward_valid_std=4.1779
[BatchDiag] adv_mean=-0.0153, adv_std=0.3131, adv_abs_mean=0.2017 | ret_mean=8.9547, ret_std=0.6075 | val_mean=8.9700, val_std=0.5141 | explained_var=0.734450
[GradSplit pre-clip] backbone=0.454294, critic=0.177114
[Loss] pg_loss=-0.079924, entropy_loss=0.000016, value_loss=0.007970
[EpochKL] epoch=0 mean_kl=0.00262 max_kl=0.00672
[EpochKL] epoch=1 mean_kl=0.00575 max_kl=0.00952
[EpochKL] epoch=2 mean_kl=0.00858 max_kl=0.01629
[Time] Env Create Time: 4.6247s |Rollout Collect Time: 1.6920s |Loss & Update :0.9613
[PPODiag] kl_mean=0.0056, kl_p90=0.0097, kl_max=0.0163 | clipfrac_mean=0.014, logratio_std_mean=0.125, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.681 | pg_loss_mean=0.0015, v_loss_mean=0.0235, ent_mean=0.0169 | gn_bb_mean=0.729, gn_bb_max=1.259 | gn_v_mean=0.246, gn_v_max=0.592
[AttnScore] scale=1.0664, C=10.0

 11%|█         | 561/5000 [1:08:17<9:08:04,  7.41s/it]------------------ Training Record ------------------
Epoch: 561/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1050, reward_valid_std=4.1771
[BatchDiag] adv_mean=0.0501, adv_std=0.2918, adv_abs_mean=0.2098 | ret_mean=8.9534, ret_std=0.5918 | val_mean=8.9033, val_std=0.5121 | explained_var=0.756907
[GradSplit pre-clip] backbone=0.780997, critic=0.601169
[Loss] pg_loss=-0.018344, entropy_loss=0.000012, value_loss=0.008928
[EpochKL] epoch=0 mean_kl=0.00295 max_kl=0.01076
[EarlyStop] epoch=1 mean_kl=0.01325 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01325 max_kl=0.02754
[Time] Env Create Time: 4.4176s |Rollout Collect Time: 1.9328s |Loss & Update :0.7537
[PPODiag] kl_mean=0.0081, kl_p90=0.0207, kl_max=0.0275 | clipfrac_mean=0.013, logratio_std_mean=0.133, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.587, min=0.581 | pg_loss_mean=0.0037, v_loss_mean=0.0207, ent_mean=0.0131 | gn_bb_mean=0.933, gn_bb_max=3.733 | gn_v_mean=0.356, gn_v_max=0.734

 11%|█         | 562/5000 [1:08:24<9:01:13,  7.32s/it]------------------ Training Record ------------------
Epoch: 562/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1144, reward_valid_std=4.1783
[BatchDiag] adv_mean=-0.0437, adv_std=0.2847, adv_abs_mean=0.1877 | ret_mean=8.9657, ret_std=0.5740 | val_mean=9.0094, val_std=0.5033 | explained_var=0.753953
[GradSplit pre-clip] backbone=1.303660, critic=0.252116
[Loss] pg_loss=-0.075918, entropy_loss=0.000013, value_loss=0.008650
[EarlyStop] epoch=0 mean_kl=0.01114 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01114 max_kl=0.02719
[Time] Env Create Time: 4.4378s |Rollout Collect Time: 1.6892s |Loss & Update :0.3631
[PPODiag] kl_mean=0.0111, kl_p90=0.0198, kl_max=0.0272 | clipfrac_mean=0.017, logratio_std_mean=0.178, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.679, min=0.678 | pg_loss_mean=0.0040, v_loss_mean=0.0198, ent_mean=0.0175 | gn_bb_mean=1.427, gn_bb_max=2.777 | gn_v_mean=0.270, gn_v_max=0.477

 11%|█▏        | 563/5000 [1:08:31<8:42:45,  7.07s/it]------------------ Training Record ------------------
Epoch: 563/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0995, reward_valid_std=4.1770
[BatchDiag] adv_mean=-0.0419, adv_std=0.3094, adv_abs_mean=0.1980 | ret_mean=8.9527, ret_std=0.5984 | val_mean=8.9946, val_std=0.5227 | explained_var=0.732703
[GradSplit pre-clip] backbone=1.021985, critic=0.248873
[Loss] pg_loss=-0.086219, entropy_loss=0.000015, value_loss=0.007374
[EpochKL] epoch=0 mean_kl=0.00928 max_kl=0.02041
[EarlyStop] epoch=1 mean_kl=0.01099 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01099 max_kl=0.02022
[Time] Env Create Time: 4.4053s |Rollout Collect Time: 1.9279s |Loss & Update :0.7360
[PPODiag] kl_mean=0.0101, kl_p90=0.0183, kl_max=0.0204 | clipfrac_mean=0.021, logratio_std_mean=0.166, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.592, p10=0.587, min=0.583 | pg_loss_mean=0.0044, v_loss_mean=0.0236, ent_mean=0.0161 | gn_bb_mean=1.910, gn_bb_max=7.945 | gn_v_mean=0.390, gn_v_max=0.727

 11%|█▏        | 564/5000 [1:08:38<8:42:39,  7.07s/it]------------------ Training Record ------------------
Epoch: 564/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1099, reward_valid_std=4.1768
[BatchDiag] adv_mean=0.0104, adv_std=0.2943, adv_abs_mean=0.2002 | ret_mean=8.9530, ret_std=0.5833 | val_mean=8.9425, val_std=0.4939 | explained_var=0.745474
[GradSplit pre-clip] backbone=1.265394, critic=0.424465
[Loss] pg_loss=-0.095663, entropy_loss=0.000014, value_loss=0.006755
[EpochKL] epoch=0 mean_kl=0.00493 max_kl=0.01615
[EarlyStop] epoch=1 mean_kl=0.01744 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01744 max_kl=0.04394
[Time] Env Create Time: 4.3814s |Rollout Collect Time: 1.7041s |Loss & Update :0.6616
[PPODiag] kl_mean=0.0112, kl_p90=0.0263, kl_max=0.0439 | clipfrac_mean=0.016, logratio_std_mean=0.177, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.681 | pg_loss_mean=0.0028, v_loss_mean=0.0208, ent_mean=0.0152 | gn_bb_mean=0.998, gn_bb_max=2.701 | gn_v_mean=0.244, gn_v_max=0.432

 11%|█▏        | 565/5000 [1:08:45<8:35:24,  6.97s/it]------------------ Training Record ------------------
Epoch: 565/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1135, reward_valid_std=4.1818
[BatchDiag] adv_mean=-0.0254, adv_std=0.2818, adv_abs_mean=0.1816 | ret_mean=8.9672, ret_std=0.5777 | val_mean=8.9926, val_std=0.5051 | explained_var=0.762021
[GradSplit pre-clip] backbone=0.300215, critic=0.213113
[Loss] pg_loss=-0.018048, entropy_loss=0.000017, value_loss=0.007774
[EpochKL] epoch=0 mean_kl=0.00924 max_kl=0.01441
[EarlyStop] epoch=1 mean_kl=0.01674 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01674 max_kl=0.02540
[Time] Env Create Time: 4.3735s |Rollout Collect Time: 1.7009s |Loss & Update :0.6735
[PPODiag] kl_mean=0.0130, kl_p90=0.0213, kl_max=0.0254 | clipfrac_mean=0.022, logratio_std_mean=0.196, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.678 | pg_loss_mean=0.0050, v_loss_mean=0.0191, ent_mean=0.0204 | gn_bb_mean=1.287, gn_bb_max=2.359 | gn_v_mean=0.270, gn_v_max=0.601
[AttnScore] scale=1.0664, C=10.0

 11%|█▏        | 566/5000 [1:08:51<8:30:18,  6.91s/it]------------------ Training Record ------------------
Epoch: 566/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1073, reward_valid_std=4.1794
[BatchDiag] adv_mean=0.0246, adv_std=0.2868, adv_abs_mean=0.1963 | ret_mean=8.9571, ret_std=0.5802 | val_mean=8.9324, val_std=0.5406 | explained_var=0.755590
[GradSplit pre-clip] backbone=0.420957, critic=0.349375
[Loss] pg_loss=-0.017089, entropy_loss=0.000016, value_loss=0.008556
[EarlyStop] epoch=0 mean_kl=0.01407 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01407 max_kl=0.04059
[Time] Env Create Time: 4.6198s |Rollout Collect Time: 1.7035s |Loss & Update :0.3484
[PPODiag] kl_mean=0.0141, kl_p90=0.0389, kl_max=0.0406 | clipfrac_mean=0.020, logratio_std_mean=0.224, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.681 | pg_loss_mean=0.0039, v_loss_mean=0.0204, ent_mean=0.0211 | gn_bb_mean=1.101, gn_bb_max=3.045 | gn_v_mean=0.451, gn_v_max=0.785

 11%|█▏        | 567/5000 [1:08:58<8:25:01,  6.84s/it]------------------ Training Record ------------------
Epoch: 567/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0938, reward_valid_std=4.1727
[BatchDiag] adv_mean=-0.0196, adv_std=0.3149, adv_abs_mean=0.2091 | ret_mean=8.9465, ret_std=0.6044 | val_mean=8.9661, val_std=0.4930 | explained_var=0.728587
[GradSplit pre-clip] backbone=1.080545, critic=0.235426
[Loss] pg_loss=-0.009142, entropy_loss=0.000021, value_loss=0.007996
[EarlyStop] epoch=0 mean_kl=0.01911 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01911 max_kl=0.05884
[Time] Env Create Time: 4.4215s |Rollout Collect Time: 1.6888s |Loss & Update :0.3628
[PPODiag] kl_mean=0.0191, kl_p90=0.0378, kl_max=0.0588 | clipfrac_mean=0.023, logratio_std_mean=0.274, ratio_p95_mean=1.007 | valid_ratio_mb_mean=0.692, p10=0.687, min=0.686 | pg_loss_mean=0.0037, v_loss_mean=0.0243, ent_mean=0.0218 | gn_bb_mean=1.150, gn_bb_max=2.178 | gn_v_mean=0.347, gn_v_max=0.547

 11%|█▏        | 568/5000 [1:09:05<8:16:53,  6.73s/it]------------------ Training Record ------------------
Epoch: 568/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1057, reward_valid_std=4.1816
[BatchDiag] adv_mean=-0.0152, adv_std=0.3013, adv_abs_mean=0.1912 | ret_mean=8.9583, ret_std=0.6053 | val_mean=8.9735, val_std=0.5107 | explained_var=0.752282
[GradSplit pre-clip] backbone=0.699408, critic=0.107889
[Loss] pg_loss=-0.019664, entropy_loss=0.000010, value_loss=0.008154
[EpochKL] epoch=0 mean_kl=0.00162 max_kl=0.00370
[EpochKL] epoch=1 mean_kl=0.00444 max_kl=0.00658
[EpochKL] epoch=2 mean_kl=0.00764 max_kl=0.01423
[Time] Env Create Time: 4.4195s |Rollout Collect Time: 1.9270s |Loss & Update :1.0848
[PPODiag] kl_mean=0.0046, kl_p90=0.0091, kl_max=0.0142 | clipfrac_mean=0.013, logratio_std_mean=0.109, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.586, min=0.580 | pg_loss_mean=0.0016, v_loss_mean=0.0219, ent_mean=0.0132 | gn_bb_mean=0.714, gn_bb_max=1.512 | gn_v_mean=0.352, gn_v_max=0.868

 11%|█▏        | 569/5000 [1:09:12<8:32:23,  6.94s/it]------------------ Training Record ------------------
Epoch: 569/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1106, reward_valid_std=4.1785
[BatchDiag] adv_mean=0.0480, adv_std=0.2986, adv_abs_mean=0.2127 | ret_mean=8.9448, ret_std=0.5990 | val_mean=8.8968, val_std=0.5135 | explained_var=0.751435
[GradSplit pre-clip] backbone=0.514613, critic=0.713381
[Loss] pg_loss=-0.082178, entropy_loss=0.000016, value_loss=0.007650
[EpochKL] epoch=0 mean_kl=0.00100 max_kl=0.00190
[EpochKL] epoch=1 mean_kl=0.00374 max_kl=0.00827
[EpochKL] epoch=2 mean_kl=0.00448 max_kl=0.00783
[Time] Env Create Time: 4.4071s |Rollout Collect Time: 1.6967s |Loss & Update :0.9762
[PPODiag] kl_mean=0.0031, kl_p90=0.0054, kl_max=0.0083 | clipfrac_mean=0.011, logratio_std_mean=0.083, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.680 | pg_loss_mean=0.0005, v_loss_mean=0.0215, ent_mean=0.0169 | gn_bb_mean=0.499, gn_bb_max=0.806 | gn_v_mean=0.385, gn_v_max=0.713

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.955, Step: 7, Avg Done Step: 6.59, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8245s
-----------------------------
 11%|█▏        | 570/5000 [1:09:21<9:16:59,  7.54s/it]------------------ Training Record ------------------
Epoch: 570/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1115, reward_valid_std=4.1798
[BatchDiag] adv_mean=0.0028, adv_std=0.2847, adv_abs_mean=0.1897 | ret_mean=8.9603, ret_std=0.5878 | val_mean=8.9574, val_std=0.5058 | explained_var=0.765363
[GradSplit pre-clip] backbone=0.611109, critic=0.273296
[Loss] pg_loss=-0.056672, entropy_loss=0.000017, value_loss=0.006765
[EpochKL] epoch=0 mean_kl=0.00087 max_kl=0.00208
[EpochKL] epoch=1 mean_kl=0.00324 max_kl=0.00669
[EpochKL] epoch=2 mean_kl=0.00507 max_kl=0.01039
[Time] Env Create Time: 4.3976s |Rollout Collect Time: 1.8805s |Loss & Update :0.9643
[PPODiag] kl_mean=0.0031, kl_p90=0.0071, kl_max=0.0104 | clipfrac_mean=0.011, logratio_std_mean=0.088, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.680 | pg_loss_mean=-0.0001, v_loss_mean=0.0198, ent_mean=0.0171 | gn_bb_mean=0.524, gn_bb_max=1.074 | gn_v_mean=0.384, gn_v_max=0.797
[AttnScore] scale=1.0666, C=10.0

 11%|█▏        | 571/5000 [1:09:28<9:10:11,  7.45s/it]------------------ Training Record ------------------
Epoch: 571/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1065, reward_valid_std=4.1767
[BatchDiag] adv_mean=-0.0491, adv_std=0.2808, adv_abs_mean=0.1816 | ret_mean=8.9644, ret_std=0.5820 | val_mean=9.0135, val_std=0.4913 | explained_var=0.767169
[GradSplit pre-clip] backbone=0.375210, critic=0.123532
[Loss] pg_loss=-0.142428, entropy_loss=0.000016, value_loss=0.005096
[EpochKL] epoch=0 mean_kl=0.00206 max_kl=0.00753
[EpochKL] epoch=1 mean_kl=0.00658 max_kl=0.01126
[EpochKL] epoch=2 mean_kl=0.00869 max_kl=0.02383
[Time] Env Create Time: 4.4178s |Rollout Collect Time: 1.6853s |Loss & Update :0.9600
[PPODiag] kl_mean=0.0058, kl_p90=0.0104, kl_max=0.0238 | clipfrac_mean=0.015, logratio_std_mean=0.122, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.682, min=0.678 | pg_loss_mean=0.0014, v_loss_mean=0.0194, ent_mean=0.0185 | gn_bb_mean=0.790, gn_bb_max=1.530 | gn_v_mean=0.226, gn_v_max=0.472

 11%|█▏        | 572/5000 [1:09:35<9:01:26,  7.34s/it]------------------ Training Record ------------------
Epoch: 572/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1079, reward_valid_std=4.1787
[BatchDiag] adv_mean=-0.0013, adv_std=0.2929, adv_abs_mean=0.1898 | ret_mean=8.9551, ret_std=0.5924 | val_mean=8.9564, val_std=0.5188 | explained_var=0.755600
[GradSplit pre-clip] backbone=0.467655, critic=0.165195
[Loss] pg_loss=-0.007529, entropy_loss=0.000011, value_loss=0.008855
[EpochKL] epoch=0 mean_kl=0.00822 max_kl=0.02495
[EarlyStop] epoch=1 mean_kl=0.02174 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02174 max_kl=0.03470
[Time] Env Create Time: 4.4200s |Rollout Collect Time: 1.9578s |Loss & Update :0.7478
[PPODiag] kl_mean=0.0150, kl_p90=0.0297, kl_max=0.0347 | clipfrac_mean=0.018, logratio_std_mean=0.227, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.590, p10=0.586, min=0.581 | pg_loss_mean=0.0056, v_loss_mean=0.0207, ent_mean=0.0137 | gn_bb_mean=1.487, gn_bb_max=5.926 | gn_v_mean=0.253, gn_v_max=0.468

 11%|█▏        | 573/5000 [1:09:42<8:56:39,  7.27s/it]------------------ Training Record ------------------
Epoch: 573/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1031, reward_valid_std=4.1739
[BatchDiag] adv_mean=-0.0415, adv_std=0.2873, adv_abs_mean=0.1868 | ret_mean=8.9582, ret_std=0.5829 | val_mean=8.9997, val_std=0.5293 | explained_var=0.757060
[GradSplit pre-clip] backbone=0.448172, critic=0.373470
[Loss] pg_loss=-0.018935, entropy_loss=0.000012, value_loss=0.007161
[EarlyStop] epoch=0 mean_kl=0.02943 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02943 max_kl=0.05983
[Time] Env Create Time: 4.4651s |Rollout Collect Time: 1.7047s |Loss & Update :0.3562
[PPODiag] kl_mean=0.0294, kl_p90=0.0522, kl_max=0.0598 | clipfrac_mean=0.023, logratio_std_mean=0.344, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.681 | pg_loss_mean=0.0077, v_loss_mean=0.0218, ent_mean=0.0163 | gn_bb_mean=0.619, gn_bb_max=1.345 | gn_v_mean=0.332, gn_v_max=0.475

 11%|█▏        | 574/5000 [1:09:49<8:40:00,  7.05s/it]------------------ Training Record ------------------
Epoch: 574/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0958, reward_valid_std=4.1724
[BatchDiag] adv_mean=-0.0067, adv_std=0.3049, adv_abs_mean=0.2014 | ret_mean=8.9417, ret_std=0.5887 | val_mean=8.9484, val_std=0.5196 | explained_var=0.731663
[GradSplit pre-clip] backbone=0.577162, critic=0.209005
[Loss] pg_loss=0.043123, entropy_loss=0.000017, value_loss=0.010353
[EpochKL] epoch=0 mean_kl=0.00284 max_kl=0.00549
[EarlyStop] epoch=1 mean_kl=0.01244 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01244 max_kl=0.03050
[Time] Env Create Time: 4.4597s |Rollout Collect Time: 1.7014s |Loss & Update :0.6516
[PPODiag] kl_mean=0.0076, kl_p90=0.0129, kl_max=0.0305 | clipfrac_mean=0.017, logratio_std_mean=0.145, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.680 | pg_loss_mean=0.0002, v_loss_mean=0.0218, ent_mean=0.0179 | gn_bb_mean=0.644, gn_bb_max=1.087 | gn_v_mean=0.236, gn_v_max=0.543

 12%|█▏        | 575/5000 [1:09:56<8:34:39,  6.98s/it]------------------ Training Record ------------------
Epoch: 575/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1046, reward_valid_std=4.1762
[BatchDiag] adv_mean=-0.0218, adv_std=0.2862, adv_abs_mean=0.1851 | ret_mean=8.9595, ret_std=0.5793 | val_mean=8.9813, val_std=0.5116 | explained_var=0.755991
[GradSplit pre-clip] backbone=0.581095, critic=0.117648
[Loss] pg_loss=-0.076652, entropy_loss=0.000017, value_loss=0.005906
[EpochKL] epoch=0 mean_kl=0.00226 max_kl=0.00575
[EpochKL] epoch=1 mean_kl=0.00706 max_kl=0.01305
[EarlyStop] epoch=2 mean_kl=0.01608 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01608 max_kl=0.02759
[Time] Env Create Time: 4.4362s |Rollout Collect Time: 1.6999s |Loss & Update :0.9521
[PPODiag] kl_mean=0.0085, kl_p90=0.0170, kl_max=0.0276 | clipfrac_mean=0.018, logratio_std_mean=0.150, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.682 | pg_loss_mean=0.0006, v_loss_mean=0.0195, ent_mean=0.0179 | gn_bb_mean=0.728, gn_bb_max=1.547 | gn_v_mean=0.202, gn_v_max=0.412
[AttnScore] scale=1.0668, C=10.0

 12%|█▏        | 576/5000 [1:10:03<8:37:04,  7.01s/it]------------------ Training Record ------------------
Epoch: 576/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0975, reward_valid_std=4.1752
[BatchDiag] adv_mean=-0.0294, adv_std=0.2884, adv_abs_mean=0.1865 | ret_mean=8.9509, ret_std=0.5923 | val_mean=8.9803, val_std=0.4956 | explained_var=0.762913
[GradSplit pre-clip] backbone=1.065698, critic=0.125425
[Loss] pg_loss=-0.069839, entropy_loss=0.000016, value_loss=0.006626
[EpochKL] epoch=0 mean_kl=0.00223 max_kl=0.00568
[EpochKL] epoch=1 mean_kl=0.00729 max_kl=0.01327
[EarlyStop] epoch=2 mean_kl=0.01181 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01181 max_kl=0.02312
[Time] Env Create Time: 4.6437s |Rollout Collect Time: 1.7052s |Loss & Update :0.9743
[PPODiag] kl_mean=0.0071, kl_p90=0.0134, kl_max=0.0231 | clipfrac_mean=0.015, logratio_std_mean=0.146, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.691, p10=0.684, min=0.680 | pg_loss_mean=0.0009, v_loss_mean=0.0200, ent_mean=0.0181 | gn_bb_mean=0.685, gn_bb_max=1.600 | gn_v_mean=0.214, gn_v_max=0.365

 12%|█▏        | 577/5000 [1:10:10<8:43:49,  7.11s/it]------------------ Training Record ------------------
Epoch: 577/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.1008, reward_valid_std=4.1770
[BatchDiag] adv_mean=-0.0009, adv_std=0.2833, adv_abs_mean=0.1869 | ret_mean=8.9657, ret_std=0.5887 | val_mean=8.9667, val_std=0.5188 | explained_var=0.768373
[GradSplit pre-clip] backbone=0.681943, critic=0.252939
[Loss] pg_loss=-0.095595, entropy_loss=0.000012, value_loss=0.005391
[EpochKL] epoch=0 mean_kl=0.00768 max_kl=0.01580
[EarlyStop] epoch=1 mean_kl=0.01523 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01523 max_kl=0.03492
[Time] Env Create Time: 4.4546s |Rollout Collect Time: 1.6996s |Loss & Update :0.6609
[PPODiag] kl_mean=0.0115, kl_p90=0.0166, kl_max=0.0349 | clipfrac_mean=0.018, logratio_std_mean=0.170, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.682, min=0.681 | pg_loss_mean=0.0052, v_loss_mean=0.0203, ent_mean=0.0180 | gn_bb_mean=1.610, gn_bb_max=10.270 | gn_v_mean=0.200, gn_v_max=0.306

 12%|█▏        | 578/5000 [1:10:17<8:37:17,  7.02s/it]------------------ Training Record ------------------
Epoch: 578/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1041, reward_valid_std=4.1772
[BatchDiag] adv_mean=0.0048, adv_std=0.2886, adv_abs_mean=0.1932 | ret_mean=8.9598, ret_std=0.5923 | val_mean=8.9550, val_std=0.5187 | explained_var=0.762468
[GradSplit pre-clip] backbone=0.790686, critic=0.167874
[Loss] pg_loss=0.000825, entropy_loss=0.000012, value_loss=0.008091
[EpochKL] epoch=0 mean_kl=0.00664 max_kl=0.01492
[EarlyStop] epoch=1 mean_kl=0.02811 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02811 max_kl=0.05485
[Time] Env Create Time: 4.4336s |Rollout Collect Time: 1.9393s |Loss & Update :0.7377
[PPODiag] kl_mean=0.0174, kl_p90=0.0414, kl_max=0.0548 | clipfrac_mean=0.022, logratio_std_mean=0.228, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.591, p10=0.587, min=0.584 | pg_loss_mean=0.0046, v_loss_mean=0.0215, ent_mean=0.0152 | gn_bb_mean=1.179, gn_bb_max=2.234 | gn_v_mean=0.351, gn_v_max=0.590

 12%|█▏        | 579/5000 [1:10:24<8:39:12,  7.05s/it]------------------ Training Record ------------------
Epoch: 579/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1047, reward_valid_std=4.1776
[BatchDiag] adv_mean=-0.0293, adv_std=0.2997, adv_abs_mean=0.1958 | ret_mean=8.9535, ret_std=0.5944 | val_mean=8.9829, val_std=0.5453 | explained_var=0.745779
[GradSplit pre-clip] backbone=0.472647, critic=0.292691
[Loss] pg_loss=-0.071158, entropy_loss=0.000015, value_loss=0.007119
[EpochKL] epoch=0 mean_kl=0.00867 max_kl=0.01592
[EarlyStop] epoch=1 mean_kl=0.02421 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02421 max_kl=0.05002
[Time] Env Create Time: 4.4223s |Rollout Collect Time: 1.7106s |Loss & Update :0.6536
[PPODiag] kl_mean=0.0164, kl_p90=0.0293, kl_max=0.0500 | clipfrac_mean=0.022, logratio_std_mean=0.249, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.680 | pg_loss_mean=0.0042, v_loss_mean=0.0215, ent_mean=0.0157 | gn_bb_mean=0.834, gn_bb_max=1.433 | gn_v_mean=0.377, gn_v_max=0.720

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -3.007, Step: 7, Avg Done Step: 6.62, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8286s
-----------------------------
 12%|█▏        | 580/5000 [1:10:33<9:14:23,  7.53s/it]------------------ Training Record ------------------
Epoch: 580/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1038, reward_valid_std=4.1808
[BatchDiag] adv_mean=-0.0337, adv_std=0.2811, adv_abs_mean=0.1874 | ret_mean=8.9529, ret_std=0.5868 | val_mean=8.9866, val_std=0.5013 | explained_var=0.770438
[GradSplit pre-clip] backbone=0.831371, critic=0.292560
[Loss] pg_loss=0.005105, entropy_loss=0.000014, value_loss=0.007993
[EpochKL] epoch=0 mean_kl=0.00267 max_kl=0.00864
[EpochKL] epoch=1 mean_kl=0.00875 max_kl=0.01320
[EarlyStop] epoch=2 mean_kl=0.01331 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01331 max_kl=0.02644
[Time] Env Create Time: 4.3935s |Rollout Collect Time: 1.6916s |Loss & Update :0.9619
[PPODiag] kl_mean=0.0082, kl_p90=0.0144, kl_max=0.0264 | clipfrac_mean=0.015, logratio_std_mean=0.149, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.680 | pg_loss_mean=0.0007, v_loss_mean=0.0192, ent_mean=0.0143 | gn_bb_mean=0.641, gn_bb_max=1.345 | gn_v_mean=0.227, gn_v_max=0.343
[AttnScore] scale=1.0671, C=10.0

 12%|█▏        | 581/5000 [1:10:40<9:03:42,  7.38s/it]------------------ Training Record ------------------
Epoch: 581/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1129, reward_valid_std=4.1802
[BatchDiag] adv_mean=0.0055, adv_std=0.2763, adv_abs_mean=0.1866 | ret_mean=8.9629, ret_std=0.5804 | val_mean=8.9574, val_std=0.5050 | explained_var=0.773437
[GradSplit pre-clip] backbone=0.569978, critic=0.344963
[Loss] pg_loss=-0.106708, entropy_loss=0.000016, value_loss=0.006304
[EpochKL] epoch=0 mean_kl=0.00564 max_kl=0.01928
[EarlyStop] epoch=1 mean_kl=0.01192 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01192 max_kl=0.01852
[Time] Env Create Time: 4.4085s |Rollout Collect Time: 1.6815s |Loss & Update :0.6612
[PPODiag] kl_mean=0.0088, kl_p90=0.0169, kl_max=0.0193 | clipfrac_mean=0.016, logratio_std_mean=0.158, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.687, p10=0.680, min=0.676 | pg_loss_mean=0.0027, v_loss_mean=0.0189, ent_mean=0.0163 | gn_bb_mean=0.947, gn_bb_max=2.391 | gn_v_mean=0.305, gn_v_max=0.699

 12%|█▏        | 582/5000 [1:10:46<8:49:38,  7.19s/it]------------------ Training Record ------------------
Epoch: 582/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0972, reward_valid_std=4.1736
[BatchDiag] adv_mean=-0.0149, adv_std=0.2955, adv_abs_mean=0.1880 | ret_mean=8.9492, ret_std=0.5969 | val_mean=8.9642, val_std=0.5129 | explained_var=0.754910
[GradSplit pre-clip] backbone=0.957228, critic=0.135368
[Loss] pg_loss=-0.067964, entropy_loss=0.000020, value_loss=0.007623
[EpochKL] epoch=0 mean_kl=0.00154 max_kl=0.00412
[EpochKL] epoch=1 mean_kl=0.00814 max_kl=0.01779
[EarlyStop] epoch=2 mean_kl=0.01026 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01026 max_kl=0.02804
[Time] Env Create Time: 4.6185s |Rollout Collect Time: 1.6864s |Loss & Update :0.9788
[PPODiag] kl_mean=0.0066, kl_p90=0.0130, kl_max=0.0280 | clipfrac_mean=0.015, logratio_std_mean=0.139, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.686, min=0.683 | pg_loss_mean=0.0013, v_loss_mean=0.0208, ent_mean=0.0179 | gn_bb_mean=0.768, gn_bb_max=1.697 | gn_v_mean=0.227, gn_v_max=0.432

 12%|█▏        | 583/5000 [1:10:54<8:51:32,  7.22s/it]------------------ Training Record ------------------
Epoch: 583/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1059, reward_valid_std=4.1769
[BatchDiag] adv_mean=-0.0234, adv_std=0.2813, adv_abs_mean=0.1839 | ret_mean=8.9605, ret_std=0.5814 | val_mean=8.9840, val_std=0.4996 | explained_var=0.765989
[GradSplit pre-clip] backbone=1.916800, critic=0.117410
[Loss] pg_loss=-0.050754, entropy_loss=0.000015, value_loss=0.008101
[EpochKL] epoch=0 mean_kl=0.00861 max_kl=0.01773
[EarlyStop] epoch=1 mean_kl=0.01745 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01745 max_kl=0.02219
[Time] Env Create Time: 4.4370s |Rollout Collect Time: 1.9401s |Loss & Update :0.7304
[PPODiag] kl_mean=0.0130, kl_p90=0.0221, kl_max=0.0222 | clipfrac_mean=0.017, logratio_std_mean=0.226, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.586, min=0.584 | pg_loss_mean=0.0036, v_loss_mean=0.0191, ent_mean=0.0138 | gn_bb_mean=1.008, gn_bb_max=2.427 | gn_v_mean=0.188, gn_v_max=0.338

 12%|█▏        | 584/5000 [1:11:01<8:48:56,  7.19s/it]------------------ Training Record ------------------
Epoch: 584/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1078, reward_valid_std=4.1797
[BatchDiag] adv_mean=-0.0209, adv_std=0.2751, adv_abs_mean=0.1813 | ret_mean=8.9681, ret_std=0.5773 | val_mean=8.9890, val_std=0.5144 | explained_var=0.772861
[GradSplit pre-clip] backbone=0.560449, critic=0.135714
[Loss] pg_loss=-0.042665, entropy_loss=0.000016, value_loss=0.007175
[EpochKL] epoch=0 mean_kl=0.00203 max_kl=0.00763
[EpochKL] epoch=1 mean_kl=0.00540 max_kl=0.00883
[EpochKL] epoch=2 mean_kl=0.00583 max_kl=0.00848
[Time] Env Create Time: 4.4305s |Rollout Collect Time: 1.7003s |Loss & Update :0.9627
[PPODiag] kl_mean=0.0044, kl_p90=0.0078, kl_max=0.0088 | clipfrac_mean=0.011, logratio_std_mean=0.106, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.678 | pg_loss_mean=0.0006, v_loss_mean=0.0185, ent_mean=0.0139 | gn_bb_mean=0.567, gn_bb_max=1.104 | gn_v_mean=0.238, gn_v_max=0.465

 12%|█▏        | 585/5000 [1:11:08<8:46:46,  7.16s/it]------------------ Training Record ------------------
Epoch: 585/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1076, reward_valid_std=4.1812
[BatchDiag] adv_mean=-0.0008, adv_std=0.2917, adv_abs_mean=0.1906 | ret_mean=8.9520, ret_std=0.6004 | val_mean=8.9528, val_std=0.5046 | explained_var=0.763910
[GradSplit pre-clip] backbone=0.391919, critic=0.113078
[Loss] pg_loss=0.031188, entropy_loss=0.000014, value_loss=0.010120
[EpochKL] epoch=0 mean_kl=0.00218 max_kl=0.00520
[EpochKL] epoch=1 mean_kl=0.00985 max_kl=0.02397
[EarlyStop] epoch=2 mean_kl=0.01701 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01701 max_kl=0.04967
[Time] Env Create Time: 4.4292s |Rollout Collect Time: 1.7123s |Loss & Update :0.9772
[PPODiag] kl_mean=0.0097, kl_p90=0.0194, kl_max=0.0497 | clipfrac_mean=0.017, logratio_std_mean=0.174, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.680 | pg_loss_mean=0.0024, v_loss_mean=0.0202, ent_mean=0.0144 | gn_bb_mean=0.910, gn_bb_max=2.087 | gn_v_mean=0.280, gn_v_max=0.661
[AttnScore] scale=1.0678, C=10.0

 12%|█▏        | 586/5000 [1:11:15<8:45:46,  7.15s/it]------------------ Training Record ------------------
Epoch: 586/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1111, reward_valid_std=4.1834
[BatchDiag] adv_mean=-0.0171, adv_std=0.2867, adv_abs_mean=0.1885 | ret_mean=8.9606, ret_std=0.5812 | val_mean=8.9777, val_std=0.4935 | explained_var=0.756621
[GradSplit pre-clip] backbone=0.259697, critic=0.176782
[Loss] pg_loss=-0.076620, entropy_loss=0.000011, value_loss=0.005714
[EarlyStop] epoch=0 mean_kl=0.02418 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02418 max_kl=0.05616
[Time] Env Create Time: 4.4136s |Rollout Collect Time: 1.6954s |Loss & Update :0.3622
[PPODiag] kl_mean=0.0242, kl_p90=0.0505, kl_max=0.0562 | clipfrac_mean=0.022, logratio_std_mean=0.277, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.679 | pg_loss_mean=0.0126, v_loss_mean=0.0200, ent_mean=0.0169 | gn_bb_mean=1.431, gn_bb_max=4.114 | gn_v_mean=0.280, gn_v_max=0.538

 12%|█▏        | 587/5000 [1:11:22<8:30:45,  6.94s/it]------------------ Training Record ------------------
Epoch: 587/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1132, reward_valid_std=4.1819
[BatchDiag] adv_mean=0.0148, adv_std=0.2861, adv_abs_mean=0.1915 | ret_mean=8.9679, ret_std=0.5871 | val_mean=8.9531, val_std=0.5425 | explained_var=0.762602
[GradSplit pre-clip] backbone=1.008452, critic=0.272557
[Loss] pg_loss=-0.008775, entropy_loss=0.000011, value_loss=0.009249
[EpochKL] epoch=0 mean_kl=0.00739 max_kl=0.02246
[EarlyStop] epoch=1 mean_kl=0.02992 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02992 max_kl=0.09061
[Time] Env Create Time: 4.4233s |Rollout Collect Time: 1.9327s |Loss & Update :0.7264
[PPODiag] kl_mean=0.0187, kl_p90=0.0367, kl_max=0.0906 | clipfrac_mean=0.018, logratio_std_mean=0.271, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.589, p10=0.585, min=0.583 | pg_loss_mean=0.0043, v_loss_mean=0.0198, ent_mean=0.0139 | gn_bb_mean=1.021, gn_bb_max=2.007 | gn_v_mean=0.274, gn_v_max=0.510

 12%|█▏        | 588/5000 [1:11:29<8:33:41,  6.99s/it]------------------ Training Record ------------------
Epoch: 588/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1074, reward_valid_std=4.1786
[BatchDiag] adv_mean=0.0168, adv_std=0.2900, adv_abs_mean=0.1945 | ret_mean=8.9548, ret_std=0.5837 | val_mean=8.9380, val_std=0.5177 | explained_var=0.753111
[GradSplit pre-clip] backbone=0.467376, critic=0.415552
[Loss] pg_loss=-0.089795, entropy_loss=0.000011, value_loss=0.008130
[EarlyStop] epoch=0 mean_kl=0.01423 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01423 max_kl=0.03321
[Time] Env Create Time: 4.5997s |Rollout Collect Time: 1.6930s |Loss & Update :0.3504
[PPODiag] kl_mean=0.0142, kl_p90=0.0323, kl_max=0.0332 | clipfrac_mean=0.019, logratio_std_mean=0.221, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.682 | pg_loss_mean=0.0045, v_loss_mean=0.0208, ent_mean=0.0174 | gn_bb_mean=0.918, gn_bb_max=1.890 | gn_v_mean=0.318, gn_v_max=0.609

 12%|█▏        | 589/5000 [1:11:35<8:26:01,  6.88s/it]------------------ Training Record ------------------
Epoch: 589/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1170, reward_valid_std=4.1875
[BatchDiag] adv_mean=0.0163, adv_std=0.2859, adv_abs_mean=0.1925 | ret_mean=8.9682, ret_std=0.5841 | val_mean=8.9519, val_std=0.4898 | explained_var=0.760435
[GradSplit pre-clip] backbone=1.068979, critic=0.334429
[Loss] pg_loss=-0.022566, entropy_loss=0.000011, value_loss=0.010645
[EpochKL] epoch=0 mean_kl=0.00507 max_kl=0.01466
[EarlyStop] epoch=1 mean_kl=0.01128 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01128 max_kl=0.01855
[Time] Env Create Time: 4.4197s |Rollout Collect Time: 1.6884s |Loss & Update :0.6482
[PPODiag] kl_mean=0.0082, kl_p90=0.0152, kl_max=0.0185 | clipfrac_mean=0.016, logratio_std_mean=0.150, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.680 | pg_loss_mean=0.0030, v_loss_mean=0.0199, ent_mean=0.0148 | gn_bb_mean=0.902, gn_bb_max=2.782 | gn_v_mean=0.265, gn_v_max=0.384

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.995, Step: 7, Avg Done Step: 6.58, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8634s
-----------------------------
 12%|█▏        | 590/5000 [1:11:44<9:04:49,  7.41s/it]------------------ Training Record ------------------
Epoch: 590/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1070, reward_valid_std=4.1824
[BatchDiag] adv_mean=0.0083, adv_std=0.2868, adv_abs_mean=0.1907 | ret_mean=8.9583, ret_std=0.5801 | val_mean=8.9500, val_std=0.5308 | explained_var=0.755623
[GradSplit pre-clip] backbone=0.706919, critic=0.233233
[Loss] pg_loss=-0.017695, entropy_loss=0.000015, value_loss=0.009588
[EpochKL] epoch=0 mean_kl=0.00722 max_kl=0.01711
[EarlyStop] epoch=1 mean_kl=0.02093 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02093 max_kl=0.04337
[Time] Env Create Time: 4.3979s |Rollout Collect Time: 1.6834s |Loss & Update :0.6534
[PPODiag] kl_mean=0.0141, kl_p90=0.0309, kl_max=0.0434 | clipfrac_mean=0.019, logratio_std_mean=0.210, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.676 | pg_loss_mean=0.0044, v_loss_mean=0.0195, ent_mean=0.0166 | gn_bb_mean=1.229, gn_bb_max=4.970 | gn_v_mean=0.232, gn_v_max=0.463
[AttnScore] scale=1.0681, C=10.0

 12%|█▏        | 591/5000 [1:11:51<8:49:46,  7.21s/it]------------------ Training Record ------------------
Epoch: 591/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1108, reward_valid_std=4.1802
[BatchDiag] adv_mean=0.0253, adv_std=0.2854, adv_abs_mean=0.1930 | ret_mean=8.9590, ret_std=0.5775 | val_mean=8.9337, val_std=0.5369 | explained_var=0.755862
[GradSplit pre-clip] backbone=0.550533, critic=0.278843
[Loss] pg_loss=0.004765, entropy_loss=0.000016, value_loss=0.007719
[EpochKL] epoch=0 mean_kl=0.00629 max_kl=0.01544
[EarlyStop] epoch=1 mean_kl=0.01749 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01749 max_kl=0.03826
[Time] Env Create Time: 4.4093s |Rollout Collect Time: 1.6915s |Loss & Update :0.6613
[PPODiag] kl_mean=0.0119, kl_p90=0.0252, kl_max=0.0383 | clipfrac_mean=0.018, logratio_std_mean=0.200, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.680 | pg_loss_mean=0.0051, v_loss_mean=0.0200, ent_mean=0.0181 | gn_bb_mean=1.197, gn_bb_max=4.038 | gn_v_mean=0.321, gn_v_max=0.826

 12%|█▏        | 592/5000 [1:11:57<8:39:48,  7.08s/it]------------------ Training Record ------------------
Epoch: 592/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1120, reward_valid_std=4.1815
[BatchDiag] adv_mean=-0.0000, adv_std=0.2825, adv_abs_mean=0.1890 | ret_mean=8.9636, ret_std=0.5793 | val_mean=8.9636, val_std=0.5290 | explained_var=0.762212
[GradSplit pre-clip] backbone=0.615914, critic=0.325177
[Loss] pg_loss=-0.115012, entropy_loss=0.000017, value_loss=0.007000
[EpochKL] epoch=0 mean_kl=0.00741 max_kl=0.01498
[EarlyStop] epoch=1 mean_kl=0.02407 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02407 max_kl=0.04447
[Time] Env Create Time: 4.4087s |Rollout Collect Time: 1.6880s |Loss & Update :0.6466
[PPODiag] kl_mean=0.0157, kl_p90=0.0350, kl_max=0.0445 | clipfrac_mean=0.019, logratio_std_mean=0.246, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.687, p10=0.681, min=0.678 | pg_loss_mean=0.0036, v_loss_mean=0.0197, ent_mean=0.0164 | gn_bb_mean=0.952, gn_bb_max=1.679 | gn_v_mean=0.269, gn_v_max=0.500

 12%|█▏        | 593/5000 [1:12:04<8:32:22,  6.98s/it]------------------ Training Record ------------------
Epoch: 593/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1044, reward_valid_std=4.1767
[BatchDiag] adv_mean=-0.0182, adv_std=0.3072, adv_abs_mean=0.2051 | ret_mean=8.9546, ret_std=0.5968 | val_mean=8.9727, val_std=0.4902 | explained_var=0.735076
[GradSplit pre-clip] backbone=2.177245, critic=0.204196
[Loss] pg_loss=-0.060388, entropy_loss=0.000018, value_loss=0.009235
[EarlyStop] epoch=0 mean_kl=0.01082 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01082 max_kl=0.03326
[Time] Env Create Time: 4.6118s |Rollout Collect Time: 1.6896s |Loss & Update :0.3585
[PPODiag] kl_mean=0.0108, kl_p90=0.0288, kl_max=0.0333 | clipfrac_mean=0.013, logratio_std_mean=0.181, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.687, min=0.684 | pg_loss_mean=0.0031, v_loss_mean=0.0227, ent_mean=0.0172 | gn_bb_mean=1.208, gn_bb_max=2.177 | gn_v_mean=0.382, gn_v_max=0.679

 12%|█▏        | 594/5000 [1:12:11<8:25:18,  6.88s/it]------------------ Training Record ------------------
Epoch: 594/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0950, reward_valid_std=4.1713
[BatchDiag] adv_mean=-0.0524, adv_std=0.3183, adv_abs_mean=0.2021 | ret_mean=8.9546, ret_std=0.5983 | val_mean=9.0070, val_std=0.4919 | explained_var=0.716873
[GradSplit pre-clip] backbone=6.315143, critic=0.499414
[Loss] pg_loss=0.040672, entropy_loss=0.000018, value_loss=0.011885
[EarlyStop] epoch=0 mean_kl=0.04556 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.04556 max_kl=0.09773
[Time] Env Create Time: 4.4343s |Rollout Collect Time: 1.6896s |Loss & Update :0.3482
[PPODiag] kl_mean=0.0456, kl_p90=0.0801, kl_max=0.0977 | clipfrac_mean=0.024, logratio_std_mean=0.573, ratio_p95_mean=1.005 | valid_ratio_mb_mean=0.692, p10=0.686, min=0.682 | pg_loss_mean=0.0018, v_loss_mean=0.0241, ent_mean=0.0167 | gn_bb_mean=1.453, gn_bb_max=6.315 | gn_v_mean=0.336, gn_v_max=0.525

 12%|█▏        | 595/5000 [1:12:17<8:16:11,  6.76s/it]------------------ Training Record ------------------
Epoch: 595/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0967, reward_valid_std=4.1777
[BatchDiag] adv_mean=-0.0274, adv_std=0.3076, adv_abs_mean=0.1955 | ret_mean=8.9447, ret_std=0.6018 | val_mean=8.9721, val_std=0.5020 | explained_var=0.738753
[GradSplit pre-clip] backbone=0.851782, critic=0.092557
[Loss] pg_loss=-0.067738, entropy_loss=0.000013, value_loss=0.008905
[EpochKL] epoch=0 mean_kl=0.00975 max_kl=0.03326
[EarlyStop] epoch=1 mean_kl=0.01934 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01934 max_kl=0.03039
[Time] Env Create Time: 4.4252s |Rollout Collect Time: 1.7023s |Loss & Update :0.6517
[PPODiag] kl_mean=0.0145, kl_p90=0.0284, kl_max=0.0333 | clipfrac_mean=0.020, logratio_std_mean=0.236, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.682, min=0.680 | pg_loss_mean=0.0041, v_loss_mean=0.0227, ent_mean=0.0178 | gn_bb_mean=1.125, gn_bb_max=3.069 | gn_v_mean=0.310, gn_v_max=0.599
[AttnScore] scale=1.0678, C=10.0

 12%|█▏        | 596/5000 [1:12:24<8:16:32,  6.76s/it]------------------ Training Record ------------------
Epoch: 596/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1163, reward_valid_std=4.1827
[BatchDiag] adv_mean=0.0603, adv_std=0.2773, adv_abs_mean=0.1980 | ret_mean=8.9637, ret_std=0.5779 | val_mean=8.9034, val_std=0.5210 | explained_var=0.769729
[GradSplit pre-clip] backbone=0.298764, critic=0.797518
[Loss] pg_loss=-0.084598, entropy_loss=0.000011, value_loss=0.007884
[EpochKL] epoch=0 mean_kl=0.00180 max_kl=0.00328
[EpochKL] epoch=1 mean_kl=0.00956 max_kl=0.02689
[EarlyStop] epoch=2 mean_kl=0.01369 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01369 max_kl=0.03278
[Time] Env Create Time: 4.4020s |Rollout Collect Time: 1.6956s |Loss & Update :0.9600
[PPODiag] kl_mean=0.0083, kl_p90=0.0226, kl_max=0.0328 | clipfrac_mean=0.015, logratio_std_mean=0.163, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.681, min=0.680 | pg_loss_mean=0.0010, v_loss_mean=0.0186, ent_mean=0.0145 | gn_bb_mean=0.881, gn_bb_max=4.465 | gn_v_mean=0.308, gn_v_max=0.798

 12%|█▏        | 597/5000 [1:12:31<8:22:53,  6.85s/it]------------------ Training Record ------------------
Epoch: 597/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1149, reward_valid_std=4.1818
[BatchDiag] adv_mean=0.0255, adv_std=0.2703, adv_abs_mean=0.1834 | ret_mean=8.9716, ret_std=0.5709 | val_mean=8.9461, val_std=0.5178 | explained_var=0.775871
[GradSplit pre-clip] backbone=0.546297, critic=0.381925
[Loss] pg_loss=-0.055701, entropy_loss=0.000009, value_loss=0.005137
[EpochKL] epoch=0 mean_kl=0.00173 max_kl=0.00350
[EarlyStop] epoch=1 mean_kl=0.01239 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01239 max_kl=0.02922
[Time] Env Create Time: 4.4178s |Rollout Collect Time: 1.9271s |Loss & Update :0.7257
[PPODiag] kl_mean=0.0071, kl_p90=0.0188, kl_max=0.0292 | clipfrac_mean=0.012, logratio_std_mean=0.144, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.589, p10=0.585, min=0.585 | pg_loss_mean=0.0022, v_loss_mean=0.0178, ent_mean=0.0131 | gn_bb_mean=0.974, gn_bb_max=1.752 | gn_v_mean=0.273, gn_v_max=0.528

 12%|█▏        | 598/5000 [1:12:38<8:27:34,  6.92s/it]------------------ Training Record ------------------
Epoch: 598/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1153, reward_valid_std=4.1841
[BatchDiag] adv_mean=0.0153, adv_std=0.2852, adv_abs_mean=0.1880 | ret_mean=8.9632, ret_std=0.5845 | val_mean=8.9479, val_std=0.5338 | explained_var=0.762008
[GradSplit pre-clip] backbone=0.615431, critic=0.224792
[Loss] pg_loss=0.004626, entropy_loss=0.000013, value_loss=0.008514
[EpochKL] epoch=0 mean_kl=0.00772 max_kl=0.01484
[EarlyStop] epoch=1 mean_kl=0.02664 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02664 max_kl=0.06956
[Time] Env Create Time: 4.4051s |Rollout Collect Time: 1.7048s |Loss & Update :0.6495
[PPODiag] kl_mean=0.0172, kl_p90=0.0392, kl_max=0.0696 | clipfrac_mean=0.019, logratio_std_mean=0.257, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.686, p10=0.683, min=0.682 | pg_loss_mean=0.0032, v_loss_mean=0.0200, ent_mean=0.0149 | gn_bb_mean=1.434, gn_bb_max=3.638 | gn_v_mean=0.353, gn_v_max=0.680

 12%|█▏        | 599/5000 [1:12:45<8:23:58,  6.87s/it]------------------ Training Record ------------------
Epoch: 599/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.588, reward_valid_mean=2.1142, reward_valid_std=4.1844
[BatchDiag] adv_mean=-0.0668, adv_std=0.2898, adv_abs_mean=0.1904 | ret_mean=8.9696, ret_std=0.5805 | val_mean=9.0363, val_std=0.5219 | explained_var=0.750759
[GradSplit pre-clip] backbone=0.626696, critic=0.357916
[Loss] pg_loss=-0.112092, entropy_loss=0.000007, value_loss=0.006062
[EpochKL] epoch=0 mean_kl=0.00749 max_kl=0.02495
[EarlyStop] epoch=1 mean_kl=0.01418 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01418 max_kl=0.03079
[Time] Env Create Time: 4.3908s |Rollout Collect Time: 1.9478s |Loss & Update :0.7328
[PPODiag] kl_mean=0.0108, kl_p90=0.0268, kl_max=0.0308 | clipfrac_mean=0.015, logratio_std_mean=0.183, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.588, p10=0.584, min=0.582 | pg_loss_mean=0.0026, v_loss_mean=0.0201, ent_mean=0.0122 | gn_bb_mean=0.951, gn_bb_max=2.642 | gn_v_mean=0.358, gn_v_max=0.668

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 999 episodes: -2.995, Step: 19, Avg Done Step: 6.59, #CS visited: 0.16
D->C5->C2->C1->D->C4->C3->D
Eval cost : 3.4561s
-----------------------------
 12%|█▏        | 600/5000 [1:12:55<9:44:40,  7.97s/it]------------------ Training Record ------------------
Epoch: 600/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1097, reward_valid_std=4.1834
[BatchDiag] adv_mean=-0.0067, adv_std=0.2749, adv_abs_mean=0.1856 | ret_mean=8.9637, ret_std=0.5769 | val_mean=8.9704, val_std=0.4841 | explained_var=0.772943
[GradSplit pre-clip] backbone=0.382065, critic=0.210931
[Loss] pg_loss=-0.047938, entropy_loss=0.000007, value_loss=0.007057
[EpochKL] epoch=0 mean_kl=0.00251 max_kl=0.00803
[EarlyStop] epoch=1 mean_kl=0.01597 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01597 max_kl=0.02322
[Time] Env Create Time: 4.6294s |Rollout Collect Time: 1.9329s |Loss & Update :0.7430
[PPODiag] kl_mean=0.0092, kl_p90=0.0192, kl_max=0.0232 | clipfrac_mean=0.014, logratio_std_mean=0.162, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.590, p10=0.587, min=0.586 | pg_loss_mean=0.0026, v_loss_mean=0.0186, ent_mean=0.0126 | gn_bb_mean=0.943, gn_bb_max=2.654 | gn_v_mean=0.204, gn_v_max=0.368
[AttnScore] scale=1.0681, C=10.0

 12%|█▏        | 601/5000 [1:13:03<9:29:52,  7.77s/it]------------------ Training Record ------------------
Epoch: 601/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.692, reward_valid_mean=2.0942, reward_valid_std=4.1740
[BatchDiag] adv_mean=-0.0274, adv_std=0.3023, adv_abs_mean=0.1950 | ret_mean=8.9475, ret_std=0.5972 | val_mean=8.9749, val_std=0.5136 | explained_var=0.743705
[GradSplit pre-clip] backbone=1.128439, critic=0.246646
[Loss] pg_loss=-0.000377, entropy_loss=0.000016, value_loss=0.009118
[EpochKL] epoch=0 mean_kl=0.00431 max_kl=0.01161
[EpochKL] epoch=1 mean_kl=0.00841 max_kl=0.01446
[EarlyStop] epoch=2 mean_kl=0.01066 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01066 max_kl=0.02244
[Time] Env Create Time: 4.4203s |Rollout Collect Time: 1.7043s |Loss & Update :0.9651
[PPODiag] kl_mean=0.0078, kl_p90=0.0130, kl_max=0.0224 | clipfrac_mean=0.014, logratio_std_mean=0.159, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.692, p10=0.685, min=0.683 | pg_loss_mean=0.0006, v_loss_mean=0.0214, ent_mean=0.0154 | gn_bb_mean=0.557, gn_bb_max=1.128 | gn_v_mean=0.186, gn_v_max=0.285

 12%|█▏        | 602/5000 [1:13:10<9:14:44,  7.57s/it]------------------ Training Record ------------------
Epoch: 602/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1052, reward_valid_std=4.1801
[BatchDiag] adv_mean=0.0304, adv_std=0.2856, adv_abs_mean=0.1951 | ret_mean=8.9546, ret_std=0.5937 | val_mean=8.9242, val_std=0.5093 | explained_var=0.768682
[GradSplit pre-clip] backbone=0.351646, critic=0.473541
[Loss] pg_loss=-0.071990, entropy_loss=0.000016, value_loss=0.006955
[EpochKL] epoch=0 mean_kl=0.00104 max_kl=0.00198
[EpochKL] epoch=1 mean_kl=0.00522 max_kl=0.00948
[EpochKL] epoch=2 mean_kl=0.00666 max_kl=0.00955
[Time] Env Create Time: 4.4508s |Rollout Collect Time: 1.6887s |Loss & Update :0.9576
[PPODiag] kl_mean=0.0043, kl_p90=0.0090, kl_max=0.0095 | clipfrac_mean=0.012, logratio_std_mean=0.097, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.680 | pg_loss_mean=0.0014, v_loss_mean=0.0195, ent_mean=0.0155 | gn_bb_mean=0.771, gn_bb_max=1.571 | gn_v_mean=0.263, gn_v_max=0.503

 12%|█▏        | 603/5000 [1:13:17<9:04:15,  7.43s/it]------------------ Training Record ------------------
Epoch: 603/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1160, reward_valid_std=4.1839
[BatchDiag] adv_mean=-0.0249, adv_std=0.2591, adv_abs_mean=0.1750 | ret_mean=8.9773, ret_std=0.5646 | val_mean=9.0023, val_std=0.5040 | explained_var=0.789397
[GradSplit pre-clip] backbone=0.395678, critic=0.160141
[Loss] pg_loss=-0.060013, entropy_loss=0.000014, value_loss=0.006200
[EpochKL] epoch=0 mean_kl=0.00736 max_kl=0.02036
[EarlyStop] epoch=1 mean_kl=0.02141 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02141 max_kl=0.05119
[Time] Env Create Time: 4.4124s |Rollout Collect Time: 1.6858s |Loss & Update :0.6535
[PPODiag] kl_mean=0.0144, kl_p90=0.0300, kl_max=0.0512 | clipfrac_mean=0.018, logratio_std_mean=0.214, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.680, min=0.679 | pg_loss_mean=0.0049, v_loss_mean=0.0171, ent_mean=0.0149 | gn_bb_mean=1.453, gn_bb_max=4.931 | gn_v_mean=0.311, gn_v_max=0.466

 12%|█▏        | 604/5000 [1:13:24<8:49:18,  7.22s/it]------------------ Training Record ------------------
Epoch: 604/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1090, reward_valid_std=4.1793
[BatchDiag] adv_mean=0.0073, adv_std=0.2870, adv_abs_mean=0.1907 | ret_mean=8.9593, ret_std=0.5862 | val_mean=8.9520, val_std=0.5037 | explained_var=0.760273
[GradSplit pre-clip] backbone=2.102558, critic=0.299906
[Loss] pg_loss=-0.062057, entropy_loss=0.000013, value_loss=0.008079
[EpochKL] epoch=0 mean_kl=0.00923 max_kl=0.03770
[EarlyStop] epoch=1 mean_kl=0.01767 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01767 max_kl=0.04515
[Time] Env Create Time: 4.4264s |Rollout Collect Time: 1.9506s |Loss & Update :0.7317
[PPODiag] kl_mean=0.0134, kl_p90=0.0361, kl_max=0.0452 | clipfrac_mean=0.015, logratio_std_mean=0.207, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.590, p10=0.584, min=0.581 | pg_loss_mean=0.0009, v_loss_mean=0.0204, ent_mean=0.0137 | gn_bb_mean=0.785, gn_bb_max=2.103 | gn_v_mean=0.339, gn_v_max=0.662

 12%|█▏        | 605/5000 [1:13:31<8:46:39,  7.19s/it]------------------ Training Record ------------------
Epoch: 605/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1124, reward_valid_std=4.1774
[BatchDiag] adv_mean=0.0036, adv_std=0.2924, adv_abs_mean=0.1895 | ret_mean=8.9693, ret_std=0.5820 | val_mean=8.9657, val_std=0.5039 | explained_var=0.747518
[GradSplit pre-clip] backbone=0.801771, critic=0.237221
[Loss] pg_loss=-0.044429, entropy_loss=0.000013, value_loss=0.007731
[EpochKL] epoch=0 mean_kl=0.00268 max_kl=0.00814
[EpochKL] epoch=1 mean_kl=0.00710 max_kl=0.01403
[EarlyStop] epoch=2 mean_kl=0.01606 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01606 max_kl=0.03378
[Time] Env Create Time: 4.4171s |Rollout Collect Time: 1.9529s |Loss & Update :1.0661
[PPODiag] kl_mean=0.0086, kl_p90=0.0176, kl_max=0.0338 | clipfrac_mean=0.015, logratio_std_mean=0.147, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.590, p10=0.587, min=0.586 | pg_loss_mean=0.0023, v_loss_mean=0.0202, ent_mean=0.0130 | gn_bb_mean=0.788, gn_bb_max=2.542 | gn_v_mean=0.334, gn_v_max=0.580
[AttnScore] scale=1.0691, C=10.0

 12%|█▏        | 606/5000 [1:13:38<8:51:57,  7.26s/it]------------------ Training Record ------------------
Epoch: 606/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1068, reward_valid_std=4.1773
[BatchDiag] adv_mean=0.0095, adv_std=0.2811, adv_abs_mean=0.1850 | ret_mean=8.9605, ret_std=0.5852 | val_mean=8.9510, val_std=0.5237 | explained_var=0.769263
[GradSplit pre-clip] backbone=1.278622, critic=0.227238
[Loss] pg_loss=-0.018814, entropy_loss=0.000013, value_loss=0.009036
[EpochKL] epoch=0 mean_kl=0.00597 max_kl=0.01112
[EarlyStop] epoch=1 mean_kl=0.01213 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01213 max_kl=0.02687
[Time] Env Create Time: 4.6569s |Rollout Collect Time: 1.9503s |Loss & Update :0.7462
[PPODiag] kl_mean=0.0091, kl_p90=0.0143, kl_max=0.0269 | clipfrac_mean=0.016, logratio_std_mean=0.169, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.590, p10=0.585, min=0.580 | pg_loss_mean=0.0030, v_loss_mean=0.0197, ent_mean=0.0129 | gn_bb_mean=1.253, gn_bb_max=3.948 | gn_v_mean=0.353, gn_v_max=0.718

 12%|█▏        | 607/5000 [1:13:46<8:53:48,  7.29s/it]------------------ Training Record ------------------
Epoch: 607/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0980, reward_valid_std=4.1768
[BatchDiag] adv_mean=-0.0157, adv_std=0.3053, adv_abs_mean=0.1988 | ret_mean=8.9442, ret_std=0.5997 | val_mean=8.9599, val_std=0.4895 | explained_var=0.740810
[GradSplit pre-clip] backbone=0.447870, critic=0.269431
[Loss] pg_loss=-0.104764, entropy_loss=0.000012, value_loss=0.006987
[EpochKL] epoch=0 mean_kl=0.00547 max_kl=0.01255
[EarlyStop] epoch=1 mean_kl=0.01984 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01984 max_kl=0.03059
[Time] Env Create Time: 4.4573s |Rollout Collect Time: 1.7025s |Loss & Update :0.6606
[PPODiag] kl_mean=0.0127, kl_p90=0.0254, kl_max=0.0306 | clipfrac_mean=0.018, logratio_std_mean=0.214, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.683, min=0.682 | pg_loss_mean=0.0029, v_loss_mean=0.0221, ent_mean=0.0160 | gn_bb_mean=1.049, gn_bb_max=3.393 | gn_v_mean=0.273, gn_v_max=0.551

 12%|█▏        | 608/5000 [1:13:52<8:43:22,  7.15s/it]------------------ Training Record ------------------
Epoch: 608/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.593, reward_valid_mean=2.0978, reward_valid_std=4.1729
[BatchDiag] adv_mean=-0.0086, adv_std=0.2958, adv_abs_mean=0.1951 | ret_mean=8.9544, ret_std=0.5876 | val_mean=8.9630, val_std=0.5288 | explained_var=0.746569
[GradSplit pre-clip] backbone=0.594155, critic=0.152669
[Loss] pg_loss=-0.039101, entropy_loss=0.000011, value_loss=0.009167
[EpochKL] epoch=0 mean_kl=0.00192 max_kl=0.00553
[EarlyStop] epoch=1 mean_kl=0.01325 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01325 max_kl=0.02362
[Time] Env Create Time: 4.4595s |Rollout Collect Time: 1.9439s |Loss & Update :0.7349
[PPODiag] kl_mean=0.0076, kl_p90=0.0178, kl_max=0.0236 | clipfrac_mean=0.013, logratio_std_mean=0.134, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.593, p10=0.588, min=0.587 | pg_loss_mean=0.0024, v_loss_mean=0.0208, ent_mean=0.0132 | gn_bb_mean=1.064, gn_bb_max=2.422 | gn_v_mean=0.205, gn_v_max=0.389

 12%|█▏        | 609/5000 [1:14:00<8:43:00,  7.15s/it]------------------ Training Record ------------------
Epoch: 609/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1104, reward_valid_std=4.1803
[BatchDiag] adv_mean=-0.0011, adv_std=0.2774, adv_abs_mean=0.1838 | ret_mean=8.9649, ret_std=0.5851 | val_mean=8.9660, val_std=0.5276 | explained_var=0.775204
[GradSplit pre-clip] backbone=1.294865, critic=0.172546
[Loss] pg_loss=-0.059528, entropy_loss=0.000012, value_loss=0.006702
[EpochKL] epoch=0 mean_kl=0.00532 max_kl=0.01221
[EarlyStop] epoch=1 mean_kl=0.01144 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01144 max_kl=0.01955
[Time] Env Create Time: 4.4447s |Rollout Collect Time: 1.7211s |Loss & Update :0.6470
[PPODiag] kl_mean=0.0084, kl_p90=0.0147, kl_max=0.0196 | clipfrac_mean=0.017, logratio_std_mean=0.154, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.681, min=0.679 | pg_loss_mean=0.0035, v_loss_mean=0.0188, ent_mean=0.0170 | gn_bb_mean=1.007, gn_bb_max=1.976 | gn_v_mean=0.230, gn_v_max=0.568

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.963, Step: 7, Avg Done Step: 6.61, #CS visited: 0.12
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8561s
-----------------------------
 12%|█▏        | 610/5000 [1:14:08<9:16:58,  7.61s/it]------------------ Training Record ------------------
Epoch: 610/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1025, reward_valid_std=4.1786
[BatchDiag] adv_mean=-0.0105, adv_std=0.2875, adv_abs_mean=0.1882 | ret_mean=8.9538, ret_std=0.5922 | val_mean=8.9644, val_std=0.5184 | explained_var=0.764394
[GradSplit pre-clip] backbone=0.670810, critic=0.120165
[Loss] pg_loss=-0.005837, entropy_loss=0.000014, value_loss=0.007962
[EpochKL] epoch=0 mean_kl=0.00647 max_kl=0.01500
[EarlyStop] epoch=1 mean_kl=0.02895 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02895 max_kl=0.05627
[Time] Env Create Time: 4.4281s |Rollout Collect Time: 1.8968s |Loss & Update :0.6515
[PPODiag] kl_mean=0.0177, kl_p90=0.0448, kl_max=0.0563 | clipfrac_mean=0.020, logratio_std_mean=0.261, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.683 | pg_loss_mean=0.0037, v_loss_mean=0.0207, ent_mean=0.0165 | gn_bb_mean=1.314, gn_bb_max=7.243 | gn_v_mean=0.373, gn_v_max=0.637
[AttnScore] scale=1.0692, C=10.0

 12%|█▏        | 611/5000 [1:14:15<9:02:54,  7.42s/it]------------------ Training Record ------------------
Epoch: 611/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1089, reward_valid_std=4.1793
[BatchDiag] adv_mean=-0.0523, adv_std=0.2851, adv_abs_mean=0.1867 | ret_mean=8.9596, ret_std=0.5820 | val_mean=9.0119, val_std=0.4996 | explained_var=0.760044
[GradSplit pre-clip] backbone=0.680968, critic=0.131485
[Loss] pg_loss=-0.143789, entropy_loss=0.000012, value_loss=0.006154
[EpochKL] epoch=0 mean_kl=0.00220 max_kl=0.00510
[EpochKL] epoch=1 mean_kl=0.00921 max_kl=0.02739
[EarlyStop] epoch=2 mean_kl=0.01373 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01373 max_kl=0.02921
[Time] Env Create Time: 4.4358s |Rollout Collect Time: 1.6940s |Loss & Update :0.9566
[PPODiag] kl_mean=0.0084, kl_p90=0.0202, kl_max=0.0292 | clipfrac_mean=0.016, logratio_std_mean=0.157, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.679 | pg_loss_mean=0.0015, v_loss_mean=0.0197, ent_mean=0.0153 | gn_bb_mean=2.073, gn_bb_max=30.414 | gn_v_mean=0.219, gn_v_max=0.402

 12%|█▏        | 612/5000 [1:14:22<8:55:25,  7.32s/it]------------------ Training Record ------------------
Epoch: 612/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1165, reward_valid_std=4.1844
[BatchDiag] adv_mean=0.0244, adv_std=0.2753, adv_abs_mean=0.1879 | ret_mean=8.9713, ret_std=0.5776 | val_mean=8.9468, val_std=0.5030 | explained_var=0.772793
[GradSplit pre-clip] backbone=0.692434, critic=0.389965
[Loss] pg_loss=-0.004689, entropy_loss=0.000009, value_loss=0.010353
[EarlyStop] epoch=0 mean_kl=0.01411 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01411 max_kl=0.04152
[Time] Env Create Time: 4.4672s |Rollout Collect Time: 1.9488s |Loss & Update :0.3990
[PPODiag] kl_mean=0.0141, kl_p90=0.0349, kl_max=0.0415 | clipfrac_mean=0.015, logratio_std_mean=0.201, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.589, p10=0.582, min=0.581 | pg_loss_mean=0.0041, v_loss_mean=0.0186, ent_mean=0.0137 | gn_bb_mean=1.167, gn_bb_max=3.616 | gn_v_mean=0.336, gn_v_max=0.606

 12%|█▏        | 613/5000 [1:14:29<8:44:12,  7.17s/it]------------------ Training Record ------------------
Epoch: 613/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1093, reward_valid_std=4.1802
[BatchDiag] adv_mean=0.0183, adv_std=0.2897, adv_abs_mean=0.1917 | ret_mean=8.9454, ret_std=0.5888 | val_mean=8.9270, val_std=0.5040 | explained_var=0.757968
[GradSplit pre-clip] backbone=0.830174, critic=0.376548
[Loss] pg_loss=-0.057415, entropy_loss=0.000014, value_loss=0.007472
[EpochKL] epoch=0 mean_kl=0.00607 max_kl=0.01309
[EarlyStop] epoch=1 mean_kl=0.01804 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01804 max_kl=0.04257
[Time] Env Create Time: 4.4402s |Rollout Collect Time: 1.7006s |Loss & Update :0.6478
[PPODiag] kl_mean=0.0121, kl_p90=0.0199, kl_max=0.0426 | clipfrac_mean=0.018, logratio_std_mean=0.199, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.682, min=0.679 | pg_loss_mean=0.0022, v_loss_mean=0.0203, ent_mean=0.0176 | gn_bb_mean=1.012, gn_bb_max=4.209 | gn_v_mean=0.298, gn_v_max=0.502

 12%|█▏        | 614/5000 [1:14:36<8:35:44,  7.06s/it]------------------ Training Record ------------------
Epoch: 614/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1092, reward_valid_std=4.1790
[BatchDiag] adv_mean=-0.0004, adv_std=0.2910, adv_abs_mean=0.1871 | ret_mean=8.9583, ret_std=0.5888 | val_mean=8.9587, val_std=0.5445 | explained_var=0.755818
[GradSplit pre-clip] backbone=0.569098, critic=0.310025
[Loss] pg_loss=-0.034248, entropy_loss=0.000011, value_loss=0.009140
[EpochKL] epoch=0 mean_kl=0.00201 max_kl=0.00448
[EarlyStop] epoch=1 mean_kl=0.01462 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01462 max_kl=0.02102
[Time] Env Create Time: 4.4659s |Rollout Collect Time: 1.9516s |Loss & Update :0.7439
[PPODiag] kl_mean=0.0083, kl_p90=0.0195, kl_max=0.0210 | clipfrac_mean=0.014, logratio_std_mean=0.152, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.590, p10=0.584, min=0.583 | pg_loss_mean=0.0022, v_loss_mean=0.0201, ent_mean=0.0140 | gn_bb_mean=1.110, gn_bb_max=2.593 | gn_v_mean=0.291, gn_v_max=0.477

 12%|█▏        | 615/5000 [1:14:43<8:37:57,  7.09s/it]------------------ Training Record ------------------
Epoch: 615/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1188, reward_valid_std=4.1851
[BatchDiag] adv_mean=-0.0067, adv_std=0.2636, adv_abs_mean=0.1783 | ret_mean=8.9717, ret_std=0.5739 | val_mean=8.9784, val_std=0.5031 | explained_var=0.788991
[GradSplit pre-clip] backbone=0.941811, critic=0.187740
[Loss] pg_loss=-0.018622, entropy_loss=0.000011, value_loss=0.006236
[EpochKL] epoch=0 mean_kl=0.00847 max_kl=0.01624
[EarlyStop] epoch=1 mean_kl=0.04153 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.04153 max_kl=0.07883
[Time] Env Create Time: 4.4066s |Rollout Collect Time: 1.7061s |Loss & Update :0.6689
[PPODiag] kl_mean=0.0250, kl_p90=0.0678, kl_max=0.0788 | clipfrac_mean=0.021, logratio_std_mean=0.322, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.678 | pg_loss_mean=0.0046, v_loss_mean=0.0169, ent_mean=0.0149 | gn_bb_mean=0.883, gn_bb_max=2.494 | gn_v_mean=0.282, gn_v_max=0.597
[AttnScore] scale=1.0693, C=10.0

 12%|█▏        | 616/5000 [1:14:50<8:31:09,  7.00s/it]------------------ Training Record ------------------
Epoch: 616/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1159, reward_valid_std=4.1844
[BatchDiag] adv_mean=-0.0294, adv_std=0.2750, adv_abs_mean=0.1765 | ret_mean=8.9718, ret_std=0.5731 | val_mean=9.0012, val_std=0.5186 | explained_var=0.769766
[GradSplit pre-clip] backbone=1.837223, critic=0.420657
[Loss] pg_loss=0.050243, entropy_loss=0.000012, value_loss=0.009860
[EarlyStop] epoch=0 mean_kl=0.01699 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01699 max_kl=0.03007
[Time] Env Create Time: 4.6244s |Rollout Collect Time: 1.6931s |Loss & Update :0.3455
[PPODiag] kl_mean=0.0170, kl_p90=0.0284, kl_max=0.0301 | clipfrac_mean=0.019, logratio_std_mean=0.237, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.687, p10=0.680, min=0.678 | pg_loss_mean=0.0055, v_loss_mean=0.0183, ent_mean=0.0158 | gn_bb_mean=1.636, gn_bb_max=3.610 | gn_v_mean=0.238, gn_v_max=0.421

 12%|█▏        | 617/5000 [1:14:57<8:23:45,  6.90s/it]------------------ Training Record ------------------
Epoch: 617/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1201, reward_valid_std=4.1884
[BatchDiag] adv_mean=-0.0048, adv_std=0.2652, adv_abs_mean=0.1757 | ret_mean=8.9645, ret_std=0.5803 | val_mean=8.9693, val_std=0.5135 | explained_var=0.791098
[GradSplit pre-clip] backbone=2.388309, critic=0.142947
[Loss] pg_loss=-0.010910, entropy_loss=0.000013, value_loss=0.008159
[EarlyStop] epoch=0 mean_kl=0.01120 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01120 max_kl=0.02846
[Time] Env Create Time: 4.4715s |Rollout Collect Time: 1.7061s |Loss & Update :0.3603
[PPODiag] kl_mean=0.0112, kl_p90=0.0222, kl_max=0.0285 | clipfrac_mean=0.015, logratio_std_mean=0.201, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.685, p10=0.678, min=0.678 | pg_loss_mean=0.0026, v_loss_mean=0.0172, ent_mean=0.0147 | gn_bb_mean=1.046, gn_bb_max=2.388 | gn_v_mean=0.324, gn_v_max=0.566

 12%|█▏        | 618/5000 [1:15:03<8:15:48,  6.79s/it]------------------ Training Record ------------------
Epoch: 618/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.683, reward_valid_mean=2.1250, reward_valid_std=4.1907
[BatchDiag] adv_mean=0.0598, adv_std=0.2595, adv_abs_mean=0.1907 | ret_mean=8.9612, ret_std=0.5753 | val_mean=8.9014, val_std=0.4954 | explained_var=0.796579
[GradSplit pre-clip] backbone=2.087061, critic=0.518199
[Loss] pg_loss=0.059388, entropy_loss=0.000012, value_loss=0.010559
[EpochKL] epoch=0 mean_kl=0.00754 max_kl=0.02075
[EarlyStop] epoch=1 mean_kl=0.01850 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01850 max_kl=0.03755
[Time] Env Create Time: 4.4663s |Rollout Collect Time: 1.7026s |Loss & Update :0.6477
[PPODiag] kl_mean=0.0130, kl_p90=0.0226, kl_max=0.0375 | clipfrac_mean=0.018, logratio_std_mean=0.199, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.683, p10=0.679, min=0.679 | pg_loss_mean=0.0037, v_loss_mean=0.0162, ent_mean=0.0140 | gn_bb_mean=1.684, gn_bb_max=8.809 | gn_v_mean=0.286, gn_v_max=0.700

 12%|█▏        | 619/5000 [1:15:10<8:16:18,  6.80s/it]------------------ Training Record ------------------
Epoch: 619/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1089, reward_valid_std=4.1842
[BatchDiag] adv_mean=0.0184, adv_std=0.2664, adv_abs_mean=0.1771 | ret_mean=8.9667, ret_std=0.5836 | val_mean=8.9482, val_std=0.5399 | explained_var=0.791591
[GradSplit pre-clip] backbone=0.462861, critic=0.225652
[Loss] pg_loss=0.001560, entropy_loss=0.000017, value_loss=0.008056
[EpochKL] epoch=0 mean_kl=0.00264 max_kl=0.00817
[EarlyStop] epoch=1 mean_kl=0.01397 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01397 max_kl=0.02512
[Time] Env Create Time: 4.4383s |Rollout Collect Time: 1.7156s |Loss & Update :0.6533
[PPODiag] kl_mean=0.0083, kl_p90=0.0154, kl_max=0.0251 | clipfrac_mean=0.015, logratio_std_mean=0.139, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.683, min=0.679 | pg_loss_mean=0.0032, v_loss_mean=0.0177, ent_mean=0.0153 | gn_bb_mean=0.943, gn_bb_max=2.094 | gn_v_mean=0.375, gn_v_max=0.828

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.987, Step: 7, Avg Done Step: 6.59, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8395s
-----------------------------
 12%|█▏        | 620/5000 [1:15:19<8:57:19,  7.36s/it]------------------ Training Record ------------------
Epoch: 620/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1179, reward_valid_std=4.1841
[BatchDiag] adv_mean=-0.0150, adv_std=0.2574, adv_abs_mean=0.1695 | ret_mean=8.9724, ret_std=0.5681 | val_mean=8.9874, val_std=0.5261 | explained_var=0.794674
[GradSplit pre-clip] backbone=1.137963, critic=0.206720
[Loss] pg_loss=0.012977, entropy_loss=0.000014, value_loss=0.006317
[EarlyStop] epoch=0 mean_kl=0.01014 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01014 max_kl=0.02767
[Time] Env Create Time: 4.4245s |Rollout Collect Time: 1.7047s |Loss & Update :0.3504
[PPODiag] kl_mean=0.0101, kl_p90=0.0223, kl_max=0.0277 | clipfrac_mean=0.016, logratio_std_mean=0.162, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.686, p10=0.683, min=0.683 | pg_loss_mean=0.0046, v_loss_mean=0.0169, ent_mean=0.0157 | gn_bb_mean=1.109, gn_bb_max=1.564 | gn_v_mean=0.398, gn_v_max=0.646
[AttnScore] scale=1.0697, C=10.0

 12%|█▏        | 621/5000 [1:15:25<8:37:55,  7.10s/it]------------------ Training Record ------------------
Epoch: 621/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1156, reward_valid_std=4.1842
[BatchDiag] adv_mean=0.0220, adv_std=0.2619, adv_abs_mean=0.1781 | ret_mean=8.9667, ret_std=0.5811 | val_mean=8.9447, val_std=0.4947 | explained_var=0.796787
[GradSplit pre-clip] backbone=0.354817, critic=0.453903
[Loss] pg_loss=-0.069877, entropy_loss=0.000012, value_loss=0.006379
[EpochKL] epoch=0 mean_kl=0.00591 max_kl=0.01377
[EarlyStop] epoch=1 mean_kl=0.01787 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01787 max_kl=0.03260
[Time] Env Create Time: 4.4174s |Rollout Collect Time: 1.9457s |Loss & Update :0.7448
[PPODiag] kl_mean=0.0119, kl_p90=0.0277, kl_max=0.0326 | clipfrac_mean=0.017, logratio_std_mean=0.186, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.589, p10=0.583, min=0.581 | pg_loss_mean=0.0050, v_loss_mean=0.0170, ent_mean=0.0120 | gn_bb_mean=1.546, gn_bb_max=6.531 | gn_v_mean=0.342, gn_v_max=0.588

 12%|█▏        | 622/5000 [1:15:32<8:38:03,  7.10s/it]------------------ Training Record ------------------
Epoch: 622/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1161, reward_valid_std=4.1892
[BatchDiag] adv_mean=-0.0266, adv_std=0.2698, adv_abs_mean=0.1726 | ret_mean=8.9664, ret_std=0.5923 | val_mean=8.9930, val_std=0.5277 | explained_var=0.792598
[GradSplit pre-clip] backbone=1.040284, critic=0.192630
[Loss] pg_loss=-0.027220, entropy_loss=0.000015, value_loss=0.007718
[EarlyStop] epoch=0 mean_kl=0.02669 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.02669 max_kl=0.06099
[Time] Env Create Time: 4.6430s |Rollout Collect Time: 1.6989s |Loss & Update :0.3614
[PPODiag] kl_mean=0.0267, kl_p90=0.0551, kl_max=0.0610 | clipfrac_mean=0.020, logratio_std_mean=0.328, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.686, p10=0.683, min=0.679 | pg_loss_mean=0.0013, v_loss_mean=0.0174, ent_mean=0.0134 | gn_bb_mean=0.553, gn_bb_max=1.040 | gn_v_mean=0.400, gn_v_max=0.594

 12%|█▏        | 623/5000 [1:15:39<8:29:16,  6.98s/it]------------------ Training Record ------------------
Epoch: 623/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1011, reward_valid_std=4.1830
[BatchDiag] adv_mean=0.0215, adv_std=0.3009, adv_abs_mean=0.1993 | ret_mean=8.9436, ret_std=0.6122 | val_mean=8.9220, val_std=0.5118 | explained_var=0.758407
[GradSplit pre-clip] backbone=0.356997, critic=0.323000
[Loss] pg_loss=0.001994, entropy_loss=0.000019, value_loss=0.009409
[EpochKL] epoch=0 mean_kl=0.00217 max_kl=0.00611
[EpochKL] epoch=1 mean_kl=0.00554 max_kl=0.00911
[EpochKL] epoch=2 mean_kl=0.00885 max_kl=0.01408
[Time] Env Create Time: 4.4649s |Rollout Collect Time: 1.7020s |Loss & Update :0.9525
[PPODiag] kl_mean=0.0055, kl_p90=0.0104, kl_max=0.0141 | clipfrac_mean=0.013, logratio_std_mean=0.120, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.684, min=0.683 | pg_loss_mean=0.0022, v_loss_mean=0.0214, ent_mean=0.0141 | gn_bb_mean=0.808, gn_bb_max=3.081 | gn_v_mean=0.250, gn_v_max=0.398

 12%|█▏        | 624/5000 [1:15:46<8:32:11,  7.02s/it]------------------ Training Record ------------------
Epoch: 624/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.684, reward_valid_mean=2.1217, reward_valid_std=4.1889
[BatchDiag] adv_mean=0.0096, adv_std=0.2698, adv_abs_mean=0.1791 | ret_mean=8.9584, ret_std=0.5762 | val_mean=8.9489, val_std=0.5214 | explained_var=0.780717
[GradSplit pre-clip] backbone=1.110699, critic=0.221865
[Loss] pg_loss=-0.007096, entropy_loss=0.000013, value_loss=0.008323
[EpochKL] epoch=0 mean_kl=0.00678 max_kl=0.02086
[EarlyStop] epoch=1 mean_kl=0.01530 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01530 max_kl=0.02696
[Time] Env Create Time: 4.4387s |Rollout Collect Time: 1.7081s |Loss & Update :0.6681
[PPODiag] kl_mean=0.0110, kl_p90=0.0235, kl_max=0.0270 | clipfrac_mean=0.015, logratio_std_mean=0.197, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.684, p10=0.679, min=0.678 | pg_loss_mean=0.0028, v_loss_mean=0.0179, ent_mean=0.0145 | gn_bb_mean=0.903, gn_bb_max=1.667 | gn_v_mean=0.271, gn_v_max=0.643

 12%|█▎        | 625/5000 [1:15:53<8:27:32,  6.96s/it]------------------ Training Record ------------------
Epoch: 625/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.591, reward_valid_mean=2.1054, reward_valid_std=4.1776
[BatchDiag] adv_mean=0.0112, adv_std=0.2864, adv_abs_mean=0.1889 | ret_mean=8.9579, ret_std=0.5885 | val_mean=8.9467, val_std=0.5243 | explained_var=0.763100
[GradSplit pre-clip] backbone=0.261347, critic=0.260823
[Loss] pg_loss=-0.033302, entropy_loss=0.000012, value_loss=0.007258
[EpochKL] epoch=0 mean_kl=0.00604 max_kl=0.01464
[EarlyStop] epoch=1 mean_kl=0.01341 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01341 max_kl=0.02220
[Time] Env Create Time: 4.4339s |Rollout Collect Time: 1.9532s |Loss & Update :0.7425
[PPODiag] kl_mean=0.0097, kl_p90=0.0178, kl_max=0.0222 | clipfrac_mean=0.017, logratio_std_mean=0.167, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.591, p10=0.584, min=0.583 | pg_loss_mean=0.0029, v_loss_mean=0.0202, ent_mean=0.0148 | gn_bb_mean=1.103, gn_bb_max=6.101 | gn_v_mean=0.272, gn_v_max=0.673
[AttnScore] scale=1.0702, C=10.0

 13%|█▎        | 626/5000 [1:16:00<8:31:07,  7.01s/it]------------------ Training Record ------------------
Epoch: 626/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1054, reward_valid_std=4.1825
[BatchDiag] adv_mean=0.0277, adv_std=0.3002, adv_abs_mean=0.1952 | ret_mean=8.9450, ret_std=0.6075 | val_mean=8.9172, val_std=0.5283 | explained_var=0.755843
[GradSplit pre-clip] backbone=0.735053, critic=0.491037
[Loss] pg_loss=-0.064029, entropy_loss=0.000012, value_loss=0.009354
[EpochKL] epoch=0 mean_kl=0.00391 max_kl=0.01020
[EarlyStop] epoch=1 mean_kl=0.01148 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01148 max_kl=0.02000
[Time] Env Create Time: 4.4452s |Rollout Collect Time: 1.9341s |Loss & Update :0.7325
[PPODiag] kl_mean=0.0077, kl_p90=0.0174, kl_max=0.0200 | clipfrac_mean=0.013, logratio_std_mean=0.147, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.589, p10=0.582, min=0.579 | pg_loss_mean=0.0024, v_loss_mean=0.0218, ent_mean=0.0126 | gn_bb_mean=0.894, gn_bb_max=2.307 | gn_v_mean=0.363, gn_v_max=0.688

 13%|█▎        | 627/5000 [1:16:07<8:33:13,  7.04s/it]------------------ Training Record ------------------
Epoch: 627/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.685, reward_valid_mean=2.1190, reward_valid_std=4.1843
[BatchDiag] adv_mean=-0.0234, adv_std=0.2709, adv_abs_mean=0.1833 | ret_mean=8.9655, ret_std=0.5717 | val_mean=8.9889, val_std=0.5109 | explained_var=0.775404
[GradSplit pre-clip] backbone=0.844482, critic=0.175808
[Loss] pg_loss=-0.096119, entropy_loss=0.000015, value_loss=0.006076
[EpochKL] epoch=0 mean_kl=0.00234 max_kl=0.00807
[EpochKL] epoch=1 mean_kl=0.00990 max_kl=0.01827
[EarlyStop] epoch=2 mean_kl=0.01915 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01915 max_kl=0.02941
[Time] Env Create Time: 4.4316s |Rollout Collect Time: 1.6966s |Loss & Update :0.9555
[PPODiag] kl_mean=0.0105, kl_p90=0.0255, kl_max=0.0294 | clipfrac_mean=0.016, logratio_std_mean=0.170, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.685, p10=0.679, min=0.677 | pg_loss_mean=0.0042, v_loss_mean=0.0175, ent_mean=0.0154 | gn_bb_mean=1.662, gn_bb_max=17.251 | gn_v_mean=0.221, gn_v_max=0.547

 13%|█▎        | 628/5000 [1:16:14<8:34:01,  7.05s/it]------------------ Training Record ------------------
Epoch: 628/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1057, reward_valid_std=4.1751
[BatchDiag] adv_mean=-0.0450, adv_std=0.2789, adv_abs_mean=0.1835 | ret_mean=8.9688, ret_std=0.5741 | val_mean=9.0138, val_std=0.4767 | explained_var=0.764071
[GradSplit pre-clip] backbone=1.159921, critic=0.491594
[Loss] pg_loss=0.044099, entropy_loss=0.000018, value_loss=0.008909
[EarlyStop] epoch=0 mean_kl=0.01464 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01464 max_kl=0.02858
[Time] Env Create Time: 4.6453s |Rollout Collect Time: 1.6995s |Loss & Update :0.3560
[PPODiag] kl_mean=0.0146, kl_p90=0.0277, kl_max=0.0286 | clipfrac_mean=0.018, logratio_std_mean=0.236, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.680 | pg_loss_mean=0.0048, v_loss_mean=0.0198, ent_mean=0.0163 | gn_bb_mean=1.368, gn_bb_max=4.022 | gn_v_mean=0.448, gn_v_max=0.724

 13%|█▎        | 629/5000 [1:16:21<8:26:11,  6.95s/it]------------------ Training Record ------------------
Epoch: 629/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0976, reward_valid_std=4.1785
[BatchDiag] adv_mean=-0.0407, adv_std=0.2911, adv_abs_mean=0.1889 | ret_mean=8.9531, ret_std=0.5862 | val_mean=8.9938, val_std=0.5089 | explained_var=0.753460
[GradSplit pre-clip] backbone=0.497687, critic=0.267845
[Loss] pg_loss=-0.049552, entropy_loss=0.000012, value_loss=0.006984
[EpochKL] epoch=0 mean_kl=0.00687 max_kl=0.02079
[EpochKL] epoch=1 mean_kl=0.00945 max_kl=0.01490
[EarlyStop] epoch=2 mean_kl=0.01395 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01395 max_kl=0.02358
[Time] Env Create Time: 4.4618s |Rollout Collect Time: 1.6941s |Loss & Update :0.9632
[PPODiag] kl_mean=0.0101, kl_p90=0.0205, kl_max=0.0236 | clipfrac_mean=0.018, logratio_std_mean=0.178, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.684, min=0.680 | pg_loss_mean=0.0019, v_loss_mean=0.0203, ent_mean=0.0161 | gn_bb_mean=0.675, gn_bb_max=1.638 | gn_v_mean=0.283, gn_v_max=0.723

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.990, Step: 7, Avg Done Step: 6.60, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8542s
-----------------------------
 13%|█▎        | 630/5000 [1:16:30<9:10:53,  7.56s/it]------------------ Training Record ------------------
Epoch: 630/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1122, reward_valid_std=4.1849
[BatchDiag] adv_mean=0.0053, adv_std=0.2722, adv_abs_mean=0.1831 | ret_mean=8.9583, ret_std=0.5807 | val_mean=8.9530, val_std=0.5002 | explained_var=0.780189
[GradSplit pre-clip] backbone=0.500605, critic=0.269102
[Loss] pg_loss=-0.078343, entropy_loss=0.000010, value_loss=0.006131
[EpochKL] epoch=0 mean_kl=0.00402 max_kl=0.01114
[EpochKL] epoch=1 mean_kl=0.00977 max_kl=0.01880
[EarlyStop] epoch=2 mean_kl=0.01283 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01283 max_kl=0.01963
[Time] Env Create Time: 4.4347s |Rollout Collect Time: 1.9361s |Loss & Update :1.0823
[PPODiag] kl_mean=0.0089, kl_p90=0.0163, kl_max=0.0196 | clipfrac_mean=0.014, logratio_std_mean=0.168, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.589, p10=0.584, min=0.582 | pg_loss_mean=0.0013, v_loss_mean=0.0181, ent_mean=0.0120 | gn_bb_mean=0.663, gn_bb_max=1.835 | gn_v_mean=0.246, gn_v_max=0.532
[AttnScore] scale=1.0704, C=10.0

 13%|█▎        | 631/5000 [1:16:37<9:08:21,  7.53s/it]------------------ Training Record ------------------
Epoch: 631/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1025, reward_valid_std=4.1826
[BatchDiag] adv_mean=0.0185, adv_std=0.2917, adv_abs_mean=0.1921 | ret_mean=8.9427, ret_std=0.6001 | val_mean=8.9242, val_std=0.5250 | explained_var=0.763770
[GradSplit pre-clip] backbone=0.178439, critic=0.321544
[Loss] pg_loss=-0.023875, entropy_loss=0.000007, value_loss=0.009716
[EpochKL] epoch=0 mean_kl=0.00162 max_kl=0.00623
[EarlyStop] epoch=1 mean_kl=0.01067 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01067 max_kl=0.01738
[Time] Env Create Time: 4.4108s |Rollout Collect Time: 1.9372s |Loss & Update :0.7431
[PPODiag] kl_mean=0.0061, kl_p90=0.0140, kl_max=0.0174 | clipfrac_mean=0.012, logratio_std_mean=0.120, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.590, p10=0.585, min=0.578 | pg_loss_mean=0.0008, v_loss_mean=0.0201, ent_mean=0.0118 | gn_bb_mean=0.742, gn_bb_max=2.349 | gn_v_mean=0.337, gn_v_max=0.741

 13%|█▎        | 632/5000 [1:16:44<8:58:38,  7.40s/it]------------------ Training Record ------------------
Epoch: 632/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1072, reward_valid_std=4.1860
[BatchDiag] adv_mean=-0.0262, adv_std=0.2838, adv_abs_mean=0.1820 | ret_mean=8.9545, ret_std=0.5844 | val_mean=8.9806, val_std=0.5068 | explained_var=0.764112
[GradSplit pre-clip] backbone=1.116869, critic=0.317719
[Loss] pg_loss=0.035136, entropy_loss=0.000010, value_loss=0.008333
[EpochKL] epoch=0 mean_kl=0.00561 max_kl=0.01676
[EpochKL] epoch=1 mean_kl=0.00720 max_kl=0.01465
[EarlyStop] epoch=2 mean_kl=0.01188 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01188 max_kl=0.02357
[Time] Env Create Time: 4.3969s |Rollout Collect Time: 1.9361s |Loss & Update :1.0806
[PPODiag] kl_mean=0.0082, kl_p90=0.0166, kl_max=0.0236 | clipfrac_mean=0.013, logratio_std_mean=0.173, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.589, p10=0.582, min=0.578 | pg_loss_mean=0.0018, v_loss_mean=0.0193, ent_mean=0.0112 | gn_bb_mean=0.685, gn_bb_max=1.248 | gn_v_mean=0.252, gn_v_max=0.450

 13%|█▎        | 633/5000 [1:16:52<8:58:51,  7.40s/it]------------------ Training Record ------------------
Epoch: 633/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.588, reward_valid_mean=2.1151, reward_valid_std=4.1803
[BatchDiag] adv_mean=0.0012, adv_std=0.2741, adv_abs_mean=0.1792 | ret_mean=8.9595, ret_std=0.5747 | val_mean=8.9583, val_std=0.4955 | explained_var=0.772504
[GradSplit pre-clip] backbone=0.678443, critic=0.340764
[Loss] pg_loss=-0.129221, entropy_loss=0.000011, value_loss=0.005456
[EpochKL] epoch=0 mean_kl=0.00406 max_kl=0.01464
[EarlyStop] epoch=1 mean_kl=0.01118 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01118 max_kl=0.01721
[Time] Env Create Time: 4.6479s |Rollout Collect Time: 1.9514s |Loss & Update :0.7372
[PPODiag] kl_mean=0.0076, kl_p90=0.0156, kl_max=0.0172 | clipfrac_mean=0.014, logratio_std_mean=0.155, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.588, p10=0.582, min=0.582 | pg_loss_mean=0.0029, v_loss_mean=0.0180, ent_mean=0.0125 | gn_bb_mean=0.907, gn_bb_max=2.500 | gn_v_mean=0.235, gn_v_max=0.447

 13%|█▎        | 634/5000 [1:16:59<8:57:16,  7.38s/it]------------------ Training Record ------------------
Epoch: 634/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1113, reward_valid_std=4.1790
[BatchDiag] adv_mean=0.0082, adv_std=0.2677, adv_abs_mean=0.1824 | ret_mean=8.9770, ret_std=0.5779 | val_mean=8.9688, val_std=0.5077 | explained_var=0.785430
[GradSplit pre-clip] backbone=0.639108, critic=0.181021
[Loss] pg_loss=-0.019946, entropy_loss=0.000016, value_loss=0.007809
[EpochKL] epoch=0 mean_kl=0.00560 max_kl=0.01282
[EarlyStop] epoch=1 mean_kl=0.02859 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02859 max_kl=0.06819
[Time] Env Create Time: 4.4724s |Rollout Collect Time: 1.7078s |Loss & Update :0.6484
[PPODiag] kl_mean=0.0171, kl_p90=0.0414, kl_max=0.0682 | clipfrac_mean=0.020, logratio_std_mean=0.231, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.681 | pg_loss_mean=0.0046, v_loss_mean=0.0179, ent_mean=0.0172 | gn_bb_mean=1.043, gn_bb_max=3.270 | gn_v_mean=0.272, gn_v_max=0.658

 13%|█▎        | 635/5000 [1:17:06<8:45:03,  7.22s/it]------------------ Training Record ------------------
Epoch: 635/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1079, reward_valid_std=4.1879
[BatchDiag] adv_mean=-0.0388, adv_std=0.2828, adv_abs_mean=0.1803 | ret_mean=8.9593, ret_std=0.5899 | val_mean=8.9981, val_std=0.5197 | explained_var=0.770256
[GradSplit pre-clip] backbone=1.103854, critic=0.176014
[Loss] pg_loss=-0.110099, entropy_loss=0.000012, value_loss=0.006541
[EpochKL] epoch=0 mean_kl=0.00844 max_kl=0.02334
[EarlyStop] epoch=1 mean_kl=0.01987 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01987 max_kl=0.04605
[Time] Env Create Time: 4.4565s |Rollout Collect Time: 1.7075s |Loss & Update :0.6494
[PPODiag] kl_mean=0.0142, kl_p90=0.0304, kl_max=0.0461 | clipfrac_mean=0.016, logratio_std_mean=0.233, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.683, min=0.682 | pg_loss_mean=0.0043, v_loss_mean=0.0202, ent_mean=0.0137 | gn_bb_mean=0.861, gn_bb_max=1.491 | gn_v_mean=0.321, gn_v_max=0.711
[AttnScore] scale=1.0703, C=10.0

 13%|█▎        | 636/5000 [1:17:13<8:36:07,  7.10s/it]------------------ Training Record ------------------
Epoch: 636/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1142, reward_valid_std=4.1861
[BatchDiag] adv_mean=0.0145, adv_std=0.2959, adv_abs_mean=0.1939 | ret_mean=8.9561, ret_std=0.5995 | val_mean=8.9416, val_std=0.4901 | explained_var=0.756333
[GradSplit pre-clip] backbone=1.063787, critic=0.277672
[Loss] pg_loss=-0.016238, entropy_loss=0.000014, value_loss=0.008217
[EpochKL] epoch=0 mean_kl=0.00233 max_kl=0.00770
[EpochKL] epoch=1 mean_kl=0.00377 max_kl=0.00934
[EpochKL] epoch=2 mean_kl=0.00610 max_kl=0.01378
[Time] Env Create Time: 4.4580s |Rollout Collect Time: 1.7044s |Loss & Update :0.9567
[PPODiag] kl_mean=0.0041, kl_p90=0.0076, kl_max=0.0138 | clipfrac_mean=0.011, logratio_std_mean=0.107, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.686, p10=0.682, min=0.678 | pg_loss_mean=0.0007, v_loss_mean=0.0202, ent_mean=0.0131 | gn_bb_mean=0.606, gn_bb_max=1.497 | gn_v_mean=0.241, gn_v_max=0.595

 13%|█▎        | 637/5000 [1:17:20<8:36:31,  7.10s/it]------------------ Training Record ------------------
Epoch: 637/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1039, reward_valid_std=4.1859
[BatchDiag] adv_mean=-0.0051, adv_std=0.2863, adv_abs_mean=0.1881 | ret_mean=8.9524, ret_std=0.5975 | val_mean=8.9575, val_std=0.5199 | explained_var=0.770359
[GradSplit pre-clip] backbone=0.478059, critic=0.105025
[Loss] pg_loss=-0.012769, entropy_loss=0.000015, value_loss=0.008154
[EpochKL] epoch=0 mean_kl=0.00474 max_kl=0.01532
[EarlyStop] epoch=1 mean_kl=0.01746 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01746 max_kl=0.03291
[Time] Env Create Time: 4.4245s |Rollout Collect Time: 1.7069s |Loss & Update :0.6495
[PPODiag] kl_mean=0.0111, kl_p90=0.0228, kl_max=0.0329 | clipfrac_mean=0.017, logratio_std_mean=0.177, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.681, min=0.679 | pg_loss_mean=0.0024, v_loss_mean=0.0200, ent_mean=0.0159 | gn_bb_mean=1.164, gn_bb_max=5.108 | gn_v_mean=0.275, gn_v_max=0.615

 13%|█▎        | 638/5000 [1:17:27<8:29:23,  7.01s/it]------------------ Training Record ------------------
Epoch: 638/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0985, reward_valid_std=4.1773
[BatchDiag] adv_mean=-0.0195, adv_std=0.3024, adv_abs_mean=0.1956 | ret_mean=8.9564, ret_std=0.6013 | val_mean=8.9759, val_std=0.5214 | explained_var=0.747080
[GradSplit pre-clip] backbone=1.200914, critic=0.162555
[Loss] pg_loss=-0.014194, entropy_loss=0.000017, value_loss=0.009961
[EpochKL] epoch=0 mean_kl=0.00392 max_kl=0.01082
[EarlyStop] epoch=1 mean_kl=0.01934 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01934 max_kl=0.03846
[Time] Env Create Time: 4.4239s |Rollout Collect Time: 1.9445s |Loss & Update :0.7291
[PPODiag] kl_mean=0.0116, kl_p90=0.0260, kl_max=0.0385 | clipfrac_mean=0.017, logratio_std_mean=0.194, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.592, p10=0.588, min=0.586 | pg_loss_mean=0.0013, v_loss_mean=0.0221, ent_mean=0.0141 | gn_bb_mean=0.856, gn_bb_max=1.834 | gn_v_mean=0.261, gn_v_max=0.473

 13%|█▎        | 639/5000 [1:17:34<8:31:15,  7.03s/it]------------------ Training Record ------------------
Epoch: 639/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0991, reward_valid_std=4.1785
[BatchDiag] adv_mean=0.0012, adv_std=0.2950, adv_abs_mean=0.1905 | ret_mean=8.9492, ret_std=0.5972 | val_mean=8.9480, val_std=0.5224 | explained_var=0.755991
[GradSplit pre-clip] backbone=0.500466, critic=0.204191
[Loss] pg_loss=0.058942, entropy_loss=0.000014, value_loss=0.010343
[EpochKL] epoch=0 mean_kl=0.00148 max_kl=0.00554
[EpochKL] epoch=1 mean_kl=0.00731 max_kl=0.01105
[EpochKL] epoch=2 mean_kl=0.00892 max_kl=0.01335
[Time] Env Create Time: 4.4084s |Rollout Collect Time: 1.6996s |Loss & Update :0.9547
[PPODiag] kl_mean=0.0059, kl_p90=0.0120, kl_max=0.0133 | clipfrac_mean=0.012, logratio_std_mean=0.131, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.690, p10=0.683, min=0.678 | pg_loss_mean=0.0013, v_loss_mean=0.0204, ent_mean=0.0148 | gn_bb_mean=0.817, gn_bb_max=2.552 | gn_v_mean=0.219, gn_v_max=0.393

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.946, Step: 7, Avg Done Step: 6.63, #CS visited: 0.13
D->C5->C2->C3->D->C4->C1->D
Eval cost : 1.8440s
-----------------------------
 13%|█▎        | 640/5000 [1:17:43<9:13:06,  7.61s/it]------------------ Training Record ------------------
Epoch: 640/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0966, reward_valid_std=4.1737
[BatchDiag] adv_mean=-0.0093, adv_std=0.2827, adv_abs_mean=0.1860 | ret_mean=8.9578, ret_std=0.5954 | val_mean=8.9671, val_std=0.5176 | explained_var=0.774529
[GradSplit pre-clip] backbone=0.328176, critic=0.158453
[Loss] pg_loss=-0.060937, entropy_loss=0.000012, value_loss=0.006832
[EpochKL] epoch=0 mean_kl=0.00672 max_kl=0.01444
[EarlyStop] epoch=1 mean_kl=0.01759 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01759 max_kl=0.03565
[Time] Env Create Time: 4.6536s |Rollout Collect Time: 1.6990s |Loss & Update :0.6594
[PPODiag] kl_mean=0.0122, kl_p90=0.0241, kl_max=0.0357 | clipfrac_mean=0.018, logratio_std_mean=0.194, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.685, min=0.677 | pg_loss_mean=0.0027, v_loss_mean=0.0193, ent_mean=0.0160 | gn_bb_mean=0.790, gn_bb_max=1.858 | gn_v_mean=0.213, gn_v_max=0.364
[AttnScore] scale=1.0704, C=10.0

 13%|█▎        | 641/5000 [1:17:50<8:59:55,  7.43s/it]------------------ Training Record ------------------
Epoch: 641/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.0976, reward_valid_std=4.1764
[BatchDiag] adv_mean=-0.0142, adv_std=0.2879, adv_abs_mean=0.1854 | ret_mean=8.9554, ret_std=0.5990 | val_mean=8.9696, val_std=0.5418 | explained_var=0.768968
[GradSplit pre-clip] backbone=0.378351, critic=0.206384
[Loss] pg_loss=0.007330, entropy_loss=0.000012, value_loss=0.009509
[EarlyStop] epoch=0 mean_kl=0.01155 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01155 max_kl=0.03528
[Time] Env Create Time: 4.4107s |Rollout Collect Time: 1.9265s |Loss & Update :0.3989
[PPODiag] kl_mean=0.0116, kl_p90=0.0320, kl_max=0.0353 | clipfrac_mean=0.015, logratio_std_mean=0.167, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.592, p10=0.589, min=0.585 | pg_loss_mean=0.0044, v_loss_mean=0.0204, ent_mean=0.0138 | gn_bb_mean=1.067, gn_bb_max=1.986 | gn_v_mean=0.279, gn_v_max=0.466

 13%|█▎        | 642/5000 [1:17:56<8:44:39,  7.22s/it]------------------ Training Record ------------------
Epoch: 642/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1120, reward_valid_std=4.1850
[BatchDiag] adv_mean=-0.0297, adv_std=0.2809, adv_abs_mean=0.1803 | ret_mean=8.9604, ret_std=0.5931 | val_mean=8.9901, val_std=0.5089 | explained_var=0.775792
[GradSplit pre-clip] backbone=0.510467, critic=0.143623
[Loss] pg_loss=-0.068119, entropy_loss=0.000011, value_loss=0.006846
[EpochKL] epoch=0 mean_kl=0.00747 max_kl=0.01708
[EarlyStop] epoch=1 mean_kl=0.01387 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01387 max_kl=0.02133
[Time] Env Create Time: 4.4299s |Rollout Collect Time: 1.9152s |Loss & Update :0.7237
[PPODiag] kl_mean=0.0107, kl_p90=0.0185, kl_max=0.0213 | clipfrac_mean=0.019, logratio_std_mean=0.182, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.589, p10=0.585, min=0.581 | pg_loss_mean=0.0041, v_loss_mean=0.0197, ent_mean=0.0145 | gn_bb_mean=1.631, gn_bb_max=7.951 | gn_v_mean=0.233, gn_v_max=0.526

 13%|█▎        | 643/5000 [1:18:04<8:41:10,  7.18s/it]------------------ Training Record ------------------
Epoch: 643/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1029, reward_valid_std=4.1791
[BatchDiag] adv_mean=-0.0145, adv_std=0.3026, adv_abs_mean=0.1926 | ret_mean=8.9615, ret_std=0.5972 | val_mean=8.9760, val_std=0.5240 | explained_var=0.743255
[GradSplit pre-clip] backbone=0.555705, critic=0.203011
[Loss] pg_loss=-0.069017, entropy_loss=0.000017, value_loss=0.008282
[EpochKL] epoch=0 mean_kl=0.00297 max_kl=0.00740
[EarlyStop] epoch=1 mean_kl=0.01687 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01687 max_kl=0.02635
[Time] Env Create Time: 4.3693s |Rollout Collect Time: 1.6784s |Loss & Update :0.6549
[PPODiag] kl_mean=0.0099, kl_p90=0.0229, kl_max=0.0264 | clipfrac_mean=0.017, logratio_std_mean=0.168, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.678 | pg_loss_mean=0.0013, v_loss_mean=0.0214, ent_mean=0.0172 | gn_bb_mean=0.734, gn_bb_max=1.518 | gn_v_mean=0.248, gn_v_max=0.496

 13%|█▎        | 644/5000 [1:18:10<8:30:43,  7.03s/it]------------------ Training Record ------------------
Epoch: 644/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1056, reward_valid_std=4.1772
[BatchDiag] adv_mean=-0.0154, adv_std=0.2779, adv_abs_mean=0.1822 | ret_mean=8.9647, ret_std=0.5838 | val_mean=8.9801, val_std=0.5158 | explained_var=0.773354
[GradSplit pre-clip] backbone=0.533676, critic=0.109289
[Loss] pg_loss=-0.047437, entropy_loss=0.000019, value_loss=0.006599
[EpochKL] epoch=0 mean_kl=0.00386 max_kl=0.00964
[EarlyStop] epoch=1 mean_kl=0.01861 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01861 max_kl=0.04426
[Time] Env Create Time: 4.3808s |Rollout Collect Time: 1.6899s |Loss & Update :0.6579
[PPODiag] kl_mean=0.0112, kl_p90=0.0300, kl_max=0.0443 | clipfrac_mean=0.017, logratio_std_mean=0.170, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.690, p10=0.683, min=0.683 | pg_loss_mean=0.0035, v_loss_mean=0.0189, ent_mean=0.0155 | gn_bb_mean=0.922, gn_bb_max=2.016 | gn_v_mean=0.217, gn_v_max=0.480

 13%|█▎        | 645/5000 [1:18:17<8:23:57,  6.94s/it]------------------ Training Record ------------------
Epoch: 645/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.593, reward_valid_mean=2.0956, reward_valid_std=4.1728
[BatchDiag] adv_mean=-0.0136, adv_std=0.3130, adv_abs_mean=0.2010 | ret_mean=8.9511, ret_std=0.6013 | val_mean=8.9647, val_std=0.5179 | explained_var=0.728945
[GradSplit pre-clip] backbone=3.442742, critic=0.140265
[Loss] pg_loss=-0.029427, entropy_loss=0.000017, value_loss=0.010232
[EarlyStop] epoch=0 mean_kl=0.03358 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.03358 max_kl=0.06421
[Time] Env Create Time: 4.3453s |Rollout Collect Time: 1.9149s |Loss & Update :0.3961
[PPODiag] kl_mean=0.0336, kl_p90=0.0546, kl_max=0.0642 | clipfrac_mean=0.021, logratio_std_mean=0.469, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.593, p10=0.589, min=0.587 | pg_loss_mean=0.0036, v_loss_mean=0.0240, ent_mean=0.0163 | gn_bb_mean=2.140, gn_bb_max=7.766 | gn_v_mean=0.261, gn_v_max=0.435
[AttnScore] scale=1.0702, C=10.0

 13%|█▎        | 646/5000 [1:18:24<8:17:36,  6.86s/it]------------------ Training Record ------------------
Epoch: 646/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0952, reward_valid_std=4.1710
[BatchDiag] adv_mean=-0.0162, adv_std=0.3102, adv_abs_mean=0.1961 | ret_mean=8.9407, ret_std=0.5971 | val_mean=8.9570, val_std=0.5136 | explained_var=0.730089
[GradSplit pre-clip] backbone=0.807295, critic=0.117606
[Loss] pg_loss=-0.035441, entropy_loss=0.000025, value_loss=0.009162
[EarlyStop] epoch=0 mean_kl=0.01547 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01547 max_kl=0.02885
[Time] Env Create Time: 4.5821s |Rollout Collect Time: 1.6873s |Loss & Update :0.3540
[PPODiag] kl_mean=0.0155, kl_p90=0.0269, kl_max=0.0288 | clipfrac_mean=0.019, logratio_std_mean=0.232, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.691, p10=0.688, min=0.688 | pg_loss_mean=0.0023, v_loss_mean=0.0233, ent_mean=0.0172 | gn_bb_mean=0.697, gn_bb_max=1.045 | gn_v_mean=0.326, gn_v_max=0.526

 13%|█▎        | 647/5000 [1:18:30<8:12:24,  6.79s/it]------------------ Training Record ------------------
Epoch: 647/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1145, reward_valid_std=4.1853
[BatchDiag] adv_mean=-0.0284, adv_std=0.2737, adv_abs_mean=0.1807 | ret_mean=8.9634, ret_std=0.5778 | val_mean=8.9919, val_std=0.5166 | explained_var=0.775648
[GradSplit pre-clip] backbone=1.600904, critic=0.271699
[Loss] pg_loss=0.002899, entropy_loss=0.000018, value_loss=0.008707
[EarlyStop] epoch=0 mean_kl=0.01837 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01837 max_kl=0.08405
[Time] Env Create Time: 4.4008s |Rollout Collect Time: 1.6855s |Loss & Update :0.3515
[PPODiag] kl_mean=0.0184, kl_p90=0.0352, kl_max=0.0840 | clipfrac_mean=0.019, logratio_std_mean=0.182, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.686, p10=0.682, min=0.677 | pg_loss_mean=0.0041, v_loss_mean=0.0187, ent_mean=0.0168 | gn_bb_mean=1.249, gn_bb_max=1.811 | gn_v_mean=0.253, gn_v_max=0.427

 13%|█▎        | 648/5000 [1:18:37<8:04:42,  6.68s/it]------------------ Training Record ------------------
Epoch: 648/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1058, reward_valid_std=4.1837
[BatchDiag] adv_mean=0.0172, adv_std=0.2939, adv_abs_mean=0.1907 | ret_mean=8.9503, ret_std=0.5996 | val_mean=8.9330, val_std=0.5220 | explained_var=0.759697
[GradSplit pre-clip] backbone=0.724090, critic=0.346055
[Loss] pg_loss=-0.057599, entropy_loss=0.000014, value_loss=0.007959
[EpochKL] epoch=0 mean_kl=0.00300 max_kl=0.00551
[EpochKL] epoch=1 mean_kl=0.00801 max_kl=0.01149
[EarlyStop] epoch=2 mean_kl=0.01641 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01641 max_kl=0.03019
[Time] Env Create Time: 4.4040s |Rollout Collect Time: 1.6818s |Loss & Update :0.9535
[PPODiag] kl_mean=0.0091, kl_p90=0.0157, kl_max=0.0302 | clipfrac_mean=0.017, logratio_std_mean=0.154, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.682, min=0.678 | pg_loss_mean=0.0027, v_loss_mean=0.0204, ent_mean=0.0147 | gn_bb_mean=0.804, gn_bb_max=2.406 | gn_v_mean=0.295, gn_v_max=0.696

 13%|█▎        | 649/5000 [1:18:44<8:12:21,  6.79s/it]------------------ Training Record ------------------
Epoch: 649/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.687, reward_valid_mean=2.1124, reward_valid_std=4.1835
[BatchDiag] adv_mean=-0.0100, adv_std=0.2763, adv_abs_mean=0.1815 | ret_mean=8.9564, ret_std=0.5870 | val_mean=8.9664, val_std=0.5090 | explained_var=0.778450
[GradSplit pre-clip] backbone=0.956227, critic=0.106436
[Loss] pg_loss=-0.007360, entropy_loss=0.000012, value_loss=0.006804
[EpochKL] epoch=0 mean_kl=0.00217 max_kl=0.00429
[EpochKL] epoch=1 mean_kl=0.00781 max_kl=0.01272
[EarlyStop] epoch=2 mean_kl=0.02017 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.02017 max_kl=0.04227
[Time] Env Create Time: 4.3959s |Rollout Collect Time: 1.6896s |Loss & Update :0.9540
[PPODiag] kl_mean=0.0100, kl_p90=0.0216, kl_max=0.0423 | clipfrac_mean=0.015, logratio_std_mean=0.167, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.687, p10=0.680, min=0.676 | pg_loss_mean=0.0015, v_loss_mean=0.0187, ent_mean=0.0134 | gn_bb_mean=0.669, gn_bb_max=1.399 | gn_v_mean=0.260, gn_v_max=0.624

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.968, Step: 7, Avg Done Step: 6.59, #CS visited: 0.14
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.8224s
-----------------------------
 13%|█▎        | 650/5000 [1:18:53<8:57:56,  7.42s/it]------------------ Training Record ------------------
Epoch: 650/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1130, reward_valid_std=4.1817
[BatchDiag] adv_mean=0.0313, adv_std=0.2628, adv_abs_mean=0.1776 | ret_mean=8.9641, ret_std=0.5789 | val_mean=8.9329, val_std=0.5220 | explained_var=0.793914
[GradSplit pre-clip] backbone=0.247630, critic=0.294655
[Loss] pg_loss=0.014598, entropy_loss=0.000011, value_loss=0.007018
[EpochKL] epoch=0 mean_kl=0.00368 max_kl=0.00873
[EpochKL] epoch=1 mean_kl=0.00800 max_kl=0.01749
[EarlyStop] epoch=2 mean_kl=0.01004 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01004 max_kl=0.02086
[Time] Env Create Time: 4.3778s |Rollout Collect Time: 2.1097s |Loss & Update :1.0633
[PPODiag] kl_mean=0.0072, kl_p90=0.0157, kl_max=0.0209 | clipfrac_mean=0.014, logratio_std_mean=0.136, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.589, p10=0.583, min=0.578 | pg_loss_mean=0.0007, v_loss_mean=0.0168, ent_mean=0.0125 | gn_bb_mean=0.739, gn_bb_max=1.555 | gn_v_mean=0.327, gn_v_max=0.614
[AttnScore] scale=1.0701, C=10.0

 13%|█▎        | 651/5000 [1:19:00<9:00:40,  7.46s/it]------------------ Training Record ------------------
Epoch: 651/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1091, reward_valid_std=4.1826
[BatchDiag] adv_mean=-0.0169, adv_std=0.2652, adv_abs_mean=0.1749 | ret_mean=8.9705, ret_std=0.5774 | val_mean=8.9873, val_std=0.5356 | explained_var=0.789110
[GradSplit pre-clip] backbone=0.445680, critic=0.191527
[Loss] pg_loss=-0.033208, entropy_loss=0.000010, value_loss=0.004778
[EpochKL] epoch=0 mean_kl=0.00147 max_kl=0.00325
[EpochKL] epoch=1 mean_kl=0.00362 max_kl=0.00968
[EarlyStop] epoch=2 mean_kl=0.01830 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01830 max_kl=0.06693
[Time] Env Create Time: 4.4116s |Rollout Collect Time: 1.9158s |Loss & Update :1.0600
[PPODiag] kl_mean=0.0078, kl_p90=0.0149, kl_max=0.0669 | clipfrac_mean=0.012, logratio_std_mean=0.147, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.590, p10=0.584, min=0.583 | pg_loss_mean=0.0016, v_loss_mean=0.0174, ent_mean=0.0129 | gn_bb_mean=0.929, gn_bb_max=2.862 | gn_v_mean=0.291, gn_v_max=0.564

 13%|█▎        | 652/5000 [1:19:08<8:58:59,  7.44s/it]------------------ Training Record ------------------
Epoch: 652/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1192, reward_valid_std=4.1818
[BatchDiag] adv_mean=0.0419, adv_std=0.2574, adv_abs_mean=0.1826 | ret_mean=8.9587, ret_std=0.5730 | val_mean=8.9168, val_std=0.5278 | explained_var=0.798226
[GradSplit pre-clip] backbone=0.976745, critic=0.614136
[Loss] pg_loss=-0.092900, entropy_loss=0.000015, value_loss=0.006233
[EarlyStop] epoch=0 mean_kl=0.01125 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01125 max_kl=0.02933
[Time] Env Create Time: 4.4083s |Rollout Collect Time: 1.6894s |Loss & Update :0.3584
[PPODiag] kl_mean=0.0112, kl_p90=0.0218, kl_max=0.0293 | clipfrac_mean=0.014, logratio_std_mean=0.183, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.686, p10=0.678, min=0.672 | pg_loss_mean=0.0041, v_loss_mean=0.0168, ent_mean=0.0149 | gn_bb_mean=1.472, gn_bb_max=2.796 | gn_v_mean=0.410, gn_v_max=0.614

 13%|█▎        | 653/5000 [1:19:14<8:37:32,  7.14s/it]------------------ Training Record ------------------
Epoch: 653/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.589, reward_valid_mean=2.1129, reward_valid_std=4.1828
[BatchDiag] adv_mean=0.0104, adv_std=0.2677, adv_abs_mean=0.1771 | ret_mean=8.9633, ret_std=0.5789 | val_mean=8.9530, val_std=0.5420 | explained_var=0.786060
[GradSplit pre-clip] backbone=0.822972, critic=0.272821
[Loss] pg_loss=-0.041146, entropy_loss=0.000010, value_loss=0.007351
[EarlyStop] epoch=0 mean_kl=0.01566 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01566 max_kl=0.09434
[Time] Env Create Time: 4.3869s |Rollout Collect Time: 1.9275s |Loss & Update :0.3906
[PPODiag] kl_mean=0.0157, kl_p90=0.0394, kl_max=0.0943 | clipfrac_mean=0.013, logratio_std_mean=0.103, ratio_p95_mean=1.000 | valid_ratio_mb_mean=0.589, p10=0.583, min=0.583 | pg_loss_mean=0.0009, v_loss_mean=0.0177, ent_mean=0.0129 | gn_bb_mean=0.757, gn_bb_max=1.471 | gn_v_mean=0.305, gn_v_max=0.408

 13%|█▎        | 654/5000 [1:19:21<8:27:54,  7.01s/it]------------------ Training Record ------------------
Epoch: 654/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1040, reward_valid_std=4.1823
[BatchDiag] adv_mean=-0.0271, adv_std=0.2793, adv_abs_mean=0.1802 | ret_mean=8.9596, ret_std=0.5912 | val_mean=8.9867, val_std=0.5081 | explained_var=0.776775
[GradSplit pre-clip] backbone=0.457391, critic=0.184756
[Loss] pg_loss=-0.039551, entropy_loss=0.000014, value_loss=0.005352
[EpochKL] epoch=0 mean_kl=0.00518 max_kl=0.01536
[EarlyStop] epoch=1 mean_kl=0.01242 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01242 max_kl=0.01743
[Time] Env Create Time: 4.3948s |Rollout Collect Time: 1.6823s |Loss & Update :0.6461
[PPODiag] kl_mean=0.0088, kl_p90=0.0164, kl_max=0.0174 | clipfrac_mean=0.016, logratio_std_mean=0.159, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.682, min=0.679 | pg_loss_mean=0.0021, v_loss_mean=0.0189, ent_mean=0.0160 | gn_bb_mean=1.078, gn_bb_max=2.549 | gn_v_mean=0.230, gn_v_max=0.585

 13%|█▎        | 655/5000 [1:19:27<8:21:31,  6.93s/it]------------------ Training Record ------------------
Epoch: 655/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1063, reward_valid_std=4.1786
[BatchDiag] adv_mean=-0.0154, adv_std=0.2791, adv_abs_mean=0.1830 | ret_mean=8.9661, ret_std=0.5867 | val_mean=8.9815, val_std=0.5060 | explained_var=0.773745
[GradSplit pre-clip] backbone=0.801722, critic=0.166770
[Loss] pg_loss=-0.097281, entropy_loss=0.000014, value_loss=0.006259
[EpochKL] epoch=0 mean_kl=0.00357 max_kl=0.00983
[EarlyStop] epoch=1 mean_kl=0.01616 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01616 max_kl=0.02947
[Time] Env Create Time: 4.3818s |Rollout Collect Time: 1.6926s |Loss & Update :0.6607
[PPODiag] kl_mean=0.0099, kl_p90=0.0185, kl_max=0.0295 | clipfrac_mean=0.016, logratio_std_mean=0.164, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.690, p10=0.682, min=0.678 | pg_loss_mean=0.0039, v_loss_mean=0.0190, ent_mean=0.0154 | gn_bb_mean=1.365, gn_bb_max=7.802 | gn_v_mean=0.239, gn_v_max=0.463
[AttnScore] scale=1.0702, C=10.0

 13%|█▎        | 656/5000 [1:19:34<8:17:16,  6.87s/it]------------------ Training Record ------------------
Epoch: 656/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1094, reward_valid_std=4.1752
[BatchDiag] adv_mean=-0.0320, adv_std=0.3013, adv_abs_mean=0.1847 | ret_mean=8.9529, ret_std=0.5883 | val_mean=8.9849, val_std=0.5277 | explained_var=0.737657
[GradSplit pre-clip] backbone=0.667210, critic=0.270513
[Loss] pg_loss=-0.011428, entropy_loss=0.000015, value_loss=0.007711
[EpochKL] epoch=0 mean_kl=0.00682 max_kl=0.01724
[EarlyStop] epoch=1 mean_kl=0.01058 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01058 max_kl=0.01567
[Time] Env Create Time: 4.5976s |Rollout Collect Time: 1.6834s |Loss & Update :0.6468
[PPODiag] kl_mean=0.0087, kl_p90=0.0154, kl_max=0.0172 | clipfrac_mean=0.018, logratio_std_mean=0.155, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.684, min=0.682 | pg_loss_mean=0.0023, v_loss_mean=0.0217, ent_mean=0.0165 | gn_bb_mean=1.050, gn_bb_max=2.389 | gn_v_mean=0.310, gn_v_max=0.531

 13%|█▎        | 657/5000 [1:19:41<8:18:27,  6.89s/it]------------------ Training Record ------------------
Epoch: 657/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.592, reward_valid_mean=2.1013, reward_valid_std=4.1751
[BatchDiag] adv_mean=0.0126, adv_std=0.2939, adv_abs_mean=0.1907 | ret_mean=8.9541, ret_std=0.5976 | val_mean=8.9415, val_std=0.5174 | explained_var=0.758129
[GradSplit pre-clip] backbone=1.236570, critic=0.155950
[Loss] pg_loss=0.010908, entropy_loss=0.000016, value_loss=0.008528
[EpochKL] epoch=0 mean_kl=0.00245 max_kl=0.00821
[EpochKL] epoch=1 mean_kl=0.00749 max_kl=0.01711
[EpochKL] epoch=2 mean_kl=0.00923 max_kl=0.01323
[Time] Env Create Time: 4.4125s |Rollout Collect Time: 1.9268s |Loss & Update :1.0665
[PPODiag] kl_mean=0.0064, kl_p90=0.0125, kl_max=0.0171 | clipfrac_mean=0.015, logratio_std_mean=0.133, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.592, p10=0.586, min=0.584 | pg_loss_mean=0.0013, v_loss_mean=0.0206, ent_mean=0.0142 | gn_bb_mean=0.965, gn_bb_max=5.951 | gn_v_mean=0.245, gn_v_max=0.509

 13%|█▎        | 658/5000 [1:19:49<8:29:37,  7.04s/it]------------------ Training Record ------------------
Epoch: 658/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1115, reward_valid_std=4.1769
[BatchDiag] adv_mean=0.0435, adv_std=0.2876, adv_abs_mean=0.1992 | ret_mean=8.9554, ret_std=0.5859 | val_mean=8.9119, val_std=0.5132 | explained_var=0.759026
[GradSplit pre-clip] backbone=1.621012, critic=0.540190
[Loss] pg_loss=-0.008820, entropy_loss=0.000018, value_loss=0.009747
[EarlyStop] epoch=0 mean_kl=0.01109 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01109 max_kl=0.03363
[Time] Env Create Time: 4.4115s |Rollout Collect Time: 1.9182s |Loss & Update :0.4001
[PPODiag] kl_mean=0.0111, kl_p90=0.0249, kl_max=0.0336 | clipfrac_mean=0.014, logratio_std_mean=0.215, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.590, p10=0.586, min=0.586 | pg_loss_mean=0.0021, v_loss_mean=0.0205, ent_mean=0.0145 | gn_bb_mean=0.745, gn_bb_max=1.621 | gn_v_mean=0.395, gn_v_max=0.540

 13%|█▎        | 659/5000 [1:19:55<8:22:44,  6.95s/it]------------------ Training Record ------------------
Epoch: 659/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.1015, reward_valid_std=4.1755
[BatchDiag] adv_mean=-0.0001, adv_std=0.2829, adv_abs_mean=0.1904 | ret_mean=8.9664, ret_std=0.5819 | val_mean=8.9664, val_std=0.5297 | explained_var=0.763701
[GradSplit pre-clip] backbone=0.572341, critic=0.308562
[Loss] pg_loss=-0.106937, entropy_loss=0.000012, value_loss=0.005405
[EpochKL] epoch=0 mean_kl=0.00419 max_kl=0.01596
[EpochKL] epoch=1 mean_kl=0.00553 max_kl=0.01334
[EarlyStop] epoch=2 mean_kl=0.01094 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01094 max_kl=0.02091
[Time] Env Create Time: 4.4044s |Rollout Collect Time: 1.6983s |Loss & Update :0.9486
[PPODiag] kl_mean=0.0069, kl_p90=0.0147, kl_max=0.0209 | clipfrac_mean=0.014, logratio_std_mean=0.139, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.684, min=0.680 | pg_loss_mean=0.0011, v_loss_mean=0.0193, ent_mean=0.0147 | gn_bb_mean=0.606, gn_bb_max=1.857 | gn_v_mean=0.303, gn_v_max=0.729

----- Evaluation Result -----
Number of Customers: 5 Number of Charging Stations: 2
Evaluation over 1000 episodes: -2.954, Step: 8, Avg Done Step: 6.61, #CS visited: 0.13
D->C5->C2->C1->D->C4->C3->D
Eval cost : 1.9491s
-----------------------------
 13%|█▎        | 660/5000 [1:20:04<9:07:45,  7.57s/it]------------------ Training Record ------------------
Epoch: 660/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.691, reward_valid_mean=2.0969, reward_valid_std=4.1760
[BatchDiag] adv_mean=0.0034, adv_std=0.2958, adv_abs_mean=0.1966 | ret_mean=8.9530, ret_std=0.5991 | val_mean=8.9496, val_std=0.4970 | explained_var=0.756184
[GradSplit pre-clip] backbone=0.466030, critic=0.241000
[Loss] pg_loss=-0.004003, entropy_loss=0.000016, value_loss=0.007137
[EpochKL] epoch=0 mean_kl=0.00114 max_kl=0.00259
[EpochKL] epoch=1 mean_kl=0.00881 max_kl=0.01941
[EarlyStop] epoch=2 mean_kl=0.01205 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01205 max_kl=0.02159
[Time] Env Create Time: 4.3800s |Rollout Collect Time: 1.6823s |Loss & Update :0.9551
[PPODiag] kl_mean=0.0073, kl_p90=0.0192, kl_max=0.0216 | clipfrac_mean=0.013, logratio_std_mean=0.141, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.691, p10=0.685, min=0.682 | pg_loss_mean=0.0013, v_loss_mean=0.0208, ent_mean=0.0150 | gn_bb_mean=0.780, gn_bb_max=1.857 | gn_v_mean=0.284, gn_v_max=0.595
[AttnScore] scale=1.0705, C=10.0

 13%|█▎        | 661/5000 [1:20:11<8:55:35,  7.41s/it]------------------ Training Record ------------------
Epoch: 661/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.1013, reward_valid_std=4.1765
[BatchDiag] adv_mean=-0.0141, adv_std=0.3100, adv_abs_mean=0.1932 | ret_mean=8.9521, ret_std=0.6016 | val_mean=8.9663, val_std=0.5140 | explained_var=0.734529
[GradSplit pre-clip] backbone=1.311136, critic=0.134050
[Loss] pg_loss=-0.007890, entropy_loss=0.000021, value_loss=0.009833
[EarlyStop] epoch=0 mean_kl=0.01964 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01964 max_kl=0.05982
[Time] Env Create Time: 4.3698s |Rollout Collect Time: 1.6875s |Loss & Update :0.3614
[PPODiag] kl_mean=0.0196, kl_p90=0.0434, kl_max=0.0598 | clipfrac_mean=0.018, logratio_std_mean=0.323, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.690, p10=0.685, min=0.682 | pg_loss_mean=0.0023, v_loss_mean=0.0226, ent_mean=0.0173 | gn_bb_mean=0.765, gn_bb_max=1.311 | gn_v_mean=0.215, gn_v_max=0.340

 13%|█▎        | 662/5000 [1:20:18<8:34:03,  7.11s/it]------------------ Training Record ------------------
Epoch: 662/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.689, reward_valid_mean=2.1044, reward_valid_std=4.1783
[BatchDiag] adv_mean=0.0013, adv_std=0.2906, adv_abs_mean=0.1910 | ret_mean=8.9543, ret_std=0.5913 | val_mean=8.9529, val_std=0.5012 | explained_var=0.758486
[GradSplit pre-clip] backbone=0.769458, critic=0.175443
[Loss] pg_loss=0.063105, entropy_loss=0.000016, value_loss=0.009311
[EpochKL] epoch=0 mean_kl=0.00220 max_kl=0.00526
[EpochKL] epoch=1 mean_kl=0.00945 max_kl=0.02070
[EarlyStop] epoch=2 mean_kl=0.01745 > target_kl=0.01000
[EpochKL] epoch=2 mean_kl=0.01745 max_kl=0.03191
[Time] Env Create Time: 4.5916s |Rollout Collect Time: 1.6849s |Loss & Update :0.9597
[PPODiag] kl_mean=0.0097, kl_p90=0.0204, kl_max=0.0319 | clipfrac_mean=0.019, logratio_std_mean=0.158, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.689, p10=0.683, min=0.678 | pg_loss_mean=0.0036, v_loss_mean=0.0205, ent_mean=0.0176 | gn_bb_mean=2.261, gn_bb_max=33.071 | gn_v_mean=0.277, gn_v_max=0.719

 13%|█▎        | 663/5000 [1:20:25<8:36:41,  7.15s/it]------------------ Training Record ------------------
Epoch: 663/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.690, reward_valid_mean=2.0998, reward_valid_std=4.1739
[BatchDiag] adv_mean=0.0445, adv_std=0.2971, adv_abs_mean=0.2095 | ret_mean=8.9441, ret_std=0.5959 | val_mean=8.8996, val_std=0.5275 | explained_var=0.751424
[GradSplit pre-clip] backbone=0.452170, critic=0.762968
[Loss] pg_loss=-0.114960, entropy_loss=0.000015, value_loss=0.007308
[EpochKL] epoch=0 mean_kl=0.00449 max_kl=0.00873
[EarlyStop] epoch=1 mean_kl=0.01238 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01238 max_kl=0.02362
[Time] Env Create Time: 4.4496s |Rollout Collect Time: 1.7124s |Loss & Update :0.6492
[PPODiag] kl_mean=0.0084, kl_p90=0.0213, kl_max=0.0236 | clipfrac_mean=0.016, logratio_std_mean=0.161, ratio_p95_mean=1.003 | valid_ratio_mb_mean=0.690, p10=0.683, min=0.681 | pg_loss_mean=0.0028, v_loss_mean=0.0219, ent_mean=0.0171 | gn_bb_mean=1.113, gn_bb_max=2.834 | gn_v_mean=0.510, gn_v_max=1.128

 13%|█▎        | 664/5000 [1:20:32<8:29:16,  7.05s/it]------------------ Training Record ------------------
Epoch: 664/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.686, reward_valid_mean=2.1205, reward_valid_std=4.1817
[BatchDiag] adv_mean=-0.0068, adv_std=0.2679, adv_abs_mean=0.1768 | ret_mean=8.9700, ret_std=0.5745 | val_mean=8.9768, val_std=0.5137 | explained_var=0.782463
[GradSplit pre-clip] backbone=0.334103, critic=0.124145
[Loss] pg_loss=-0.058926, entropy_loss=0.000014, value_loss=0.005182
[EpochKL] epoch=0 mean_kl=0.00373 max_kl=0.01075
[EarlyStop] epoch=1 mean_kl=0.01428 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.01428 max_kl=0.03297
[Time] Env Create Time: 4.4112s |Rollout Collect Time: 1.6879s |Loss & Update :0.6586
[PPODiag] kl_mean=0.0090, kl_p90=0.0191, kl_max=0.0330 | clipfrac_mean=0.017, logratio_std_mean=0.151, ratio_p95_mean=1.002 | valid_ratio_mb_mean=0.686, p10=0.680, min=0.675 | pg_loss_mean=0.0024, v_loss_mean=0.0175, ent_mean=0.0165 | gn_bb_mean=0.938, gn_bb_max=2.189 | gn_v_mean=0.251, gn_v_max=0.457

 13%|█▎        | 665/5000 [1:20:39<8:22:53,  6.96s/it]------------------ Training Record ------------------
Epoch: 665/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=7, valid_ratio=0.590, reward_valid_mean=2.1147, reward_valid_std=4.1816
[BatchDiag] adv_mean=-0.0309, adv_std=0.2782, adv_abs_mean=0.1773 | ret_mean=8.9784, ret_std=0.5806 | val_mean=9.0094, val_std=0.5106 | explained_var=0.770317
[GradSplit pre-clip] backbone=0.419237, critic=0.152194
[Loss] pg_loss=-0.051770, entropy_loss=0.000012, value_loss=0.007205
[EpochKL] epoch=0 mean_kl=0.00304 max_kl=0.00624
[EarlyStop] epoch=1 mean_kl=0.02079 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02079 max_kl=0.06323
[Time] Env Create Time: 4.3945s |Rollout Collect Time: 1.9383s |Loss & Update :0.7206
[PPODiag] kl_mean=0.0119, kl_p90=0.0266, kl_max=0.0632 | clipfrac_mean=0.017, logratio_std_mean=0.175, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.590, p10=0.587, min=0.586 | pg_loss_mean=0.0043, v_loss_mean=0.0184, ent_mean=0.0127 | gn_bb_mean=1.211, gn_bb_max=3.500 | gn_v_mean=0.200, gn_v_max=0.270
[AttnScore] scale=1.0709, C=10.0

 13%|█▎        | 666/5000 [1:20:46<8:24:48,  6.99s/it]------------------ Training Record ------------------
Epoch: 666/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1120, reward_valid_std=4.1795
[BatchDiag] adv_mean=-0.0317, adv_std=0.2870, adv_abs_mean=0.1869 | ret_mean=8.9706, ret_std=0.5827 | val_mean=9.0023, val_std=0.5008 | explained_var=0.757403
[GradSplit pre-clip] backbone=1.356730, critic=0.158969
[Loss] pg_loss=-0.064567, entropy_loss=0.000011, value_loss=0.008286
[EarlyStop] epoch=0 mean_kl=0.01539 > target_kl=0.01000
[EpochKL] epoch=0 mean_kl=0.01539 max_kl=0.05758
[Time] Env Create Time: 4.3798s |Rollout Collect Time: 1.6860s |Loss & Update :0.3471
[PPODiag] kl_mean=0.0154, kl_p90=0.0351, kl_max=0.0576 | clipfrac_mean=0.013, logratio_std_mean=0.256, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.685, min=0.683 | pg_loss_mean=0.0017, v_loss_mean=0.0198, ent_mean=0.0149 | gn_bb_mean=0.940, gn_bb_max=2.101 | gn_v_mean=0.272, gn_v_max=0.553

 13%|█▎        | 667/5000 [1:20:52<8:12:13,  6.82s/it]------------------ Training Record ------------------
Epoch: 667/5000
Customer Numbers: 3 Charging Stations Numbers: 1
Avg Customer Visits: 3.00
Finish Rate: 102400/102400 = 1.000
Current lambda_fail (before): 0.000
Updated lambda_fail: 0.000
----------------------------------------------------
[RolloutDiag] valid_step=6, valid_ratio=0.688, reward_valid_mean=2.1107, reward_valid_std=4.1784
[BatchDiag] adv_mean=-0.0418, adv_std=0.2834, adv_abs_mean=0.1843 | ret_mean=8.9618, ret_std=0.5870 | val_mean=9.0036, val_std=0.5023 | explained_var=0.766974
[GradSplit pre-clip] backbone=1.115197, critic=0.378306
[Loss] pg_loss=0.009897, entropy_loss=0.000017, value_loss=0.008606
[EpochKL] epoch=0 mean_kl=0.00256 max_kl=0.00553
[EarlyStop] epoch=1 mean_kl=0.02536 > target_kl=0.01000
[EpochKL] epoch=1 mean_kl=0.02536 max_kl=0.05201
[Time] Env Create Time: 4.3835s |Rollout Collect Time: 1.6854s |Loss & Update :0.6478
[PPODiag] kl_mean=0.0140, kl_p90=0.0313, kl_max=0.0520 | clipfrac_mean=0.018, logratio_std_mean=0.211, ratio_p95_mean=1.001 | valid_ratio_mb_mean=0.688, p10=0.681, min=0.679 | pg_loss_mean=0.0023, v_loss_mean=0.0198, ent_mean=0.0164 | gn_bb_mean=0.962, gn_bb_max=1.836 | gn_v_mean=0.412, gn_v_max=0.844

 13%|█▎        | 668/5000 [1:20:59<8:09:58,  6.79s/it]